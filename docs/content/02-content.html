<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.5">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph Bulbulia">
<meta name="dcterms.date" content="2025-03-04">

<title>Causal diagrams: Five Elementary Structures – PSYC 434 Conducting Research Across Cultures: Trimester 1, 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-cb64309e6bcb4fe4e8f7b1d812ed84fe.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ebb6838dc08a669b2ff582ce1331d571.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 434 Conducting Research Across Cultures: Trimester 1, 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../content/course-outline.html"> 
<span class="menu-text">Course Outline</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-content" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Content</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-content">    
        <li>
    <a class="dropdown-item" href="../content/glossary.pdf">
 <span class="dropdown-text">Glossary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/course-outline.html">
 <span class="dropdown-text">Course Outline</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/01-content.html">
 <span class="dropdown-text">Week 1: Course Introduction - R (installing packages)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/02-content.html">
 <span class="dropdown-text">Week 2: Causal Diagrams - Elementary Structures and Rules - R (using the interface)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/03-content.html">
 <span class="dropdown-text">Week 3: Causal Diagrams - Confounding Bias - R (regression/simulation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/04-content.html">
 <span class="dropdown-text">Week 4: Causal Diagrams - Interaction, Measurement Bias, Selection Bias - R (regression/simulation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/05-content.html">
 <span class="dropdown-text">Week 5: Causal Inference - Average Treatment Effects - R (regression/simulation: ATE)</span></a>
  </li>  
        <li class="dropdown-header">Week 6: In Class Test</li>
        <li>
    <a class="dropdown-item" href="../content/07-content.html">
 <span class="dropdown-text">Week 7: Conditional Average Treatment Effects (CATE) - R (regression/simulation: ATE)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/08-content.html">
 <span class="dropdown-text">Week 8: Causal Inference - Estimation of ATE and CATE - R and LaTeX</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/09-content.html">
 <span class="dropdown-text">Week 9: Hands On: A Full Study Analysis in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/10-content.html">
 <span class="dropdown-text">Week 10: Hands On: Writing Up Your Analysis: Quarto Documents</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/11-content.html">
 <span class="dropdown-text">Week 11: Measurement: Factor Analysis, CFA, MultiGroup CFA, Partial Invariance</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/12-content.html">
 <span class="dropdown-text">Week 12: Measurement: Conceptual Problems</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Causal diagrams: Five Elementary Structures</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Joseph Bulbulia <a href="mailto:joseph.bulbulia@vuw.ac.nz" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-5861-2056" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Victoria University of Wellington, New Zealand
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 4, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#seminar" id="toc-seminar" class="nav-link active" data-scroll-target="#seminar">Seminar</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#review" id="toc-review" class="nav-link" data-scroll-target="#review">Review</a></li>
  <li><a href="#definitions" id="toc-definitions" class="nav-link" data-scroll-target="#definitions">Definitions</a></li>
  <li><a href="#introduction-to-causal-diagrams." id="toc-introduction-to-causal-diagrams." class="nav-link" data-scroll-target="#introduction-to-causal-diagrams.">Introduction to Causal Diagrams.</a>
  <ul class="collapse">
  <li><a href="#the-meaning-of-our-symbols" id="toc-the-meaning-of-our-symbols" class="nav-link" data-scroll-target="#the-meaning-of-our-symbols">The meaning of our symbols</a></li>
  <li><a href="#elements-of-our-causal-graphs" id="toc-elements-of-our-causal-graphs" class="nav-link" data-scroll-target="#elements-of-our-causal-graphs">Elements of our Causal Graphs</a></li>
  </ul></li>
  <li><a href="#the-five-elementary-structures-of-causality" id="toc-the-five-elementary-structures-of-causality" class="nav-link" data-scroll-target="#the-five-elementary-structures-of-causality">The Five Elementary Structures of Causality</a></li>
  <li><a href="#the-four-rules-of-confounding-control" id="toc-the-four-rules-of-confounding-control" class="nav-link" data-scroll-target="#the-four-rules-of-confounding-control">The Four Rules of Confounding Control</a></li>
  </ul></li>
  <li><a href="#lab-regression-in-r-graphing-and-elements-of-simulation" id="toc-lab-regression-in-r-graphing-and-elements-of-simulation" class="nav-link" data-scroll-target="#lab-regression-in-r-graphing-and-elements-of-simulation">Lab – Regression in R, Graphing, and Elements of Simulation</a>
  <ul class="collapse">
  <li><a href="#simulating-data-in-r-outcome-treatment" id="toc-simulating-data-in-r-outcome-treatment" class="nav-link" data-scroll-target="#simulating-data-in-r-outcome-treatment">Simulating Data in R: <code>Outcome ~ Treatment</code></a></li>
  <li><a href="#simulating-outcomes-from-treatments" id="toc-simulating-outcomes-from-treatments" class="nav-link" data-scroll-target="#simulating-outcomes-from-treatments">Simulating Outcomes from Treatments</a></li>
  <li><a href="#visualising-our-simulated-data" id="toc-visualising-our-simulated-data" class="nav-link" data-scroll-target="#visualising-our-simulated-data">Visualising Our Simulated Data</a></li>
  <li><a href="#sec-histogram" id="toc-sec-histogram" class="nav-link" data-scroll-target="#sec-histogram">Histogram</a></li>
  <li><a href="#excercise-1" id="toc-excercise-1" class="nav-link" data-scroll-target="#excercise-1">Excercise 1</a></li>
  <li><a href="#simulating-data-for-familiar-statistical-tests" id="toc-simulating-data-for-familiar-statistical-tests" class="nav-link" data-scroll-target="#simulating-data-for-familiar-statistical-tests">Simulating data for familiar statistical tests</a></li>
  <li><a href="#understanding-regression-using-data-simulation" id="toc-understanding-regression-using-data-simulation" class="nav-link" data-scroll-target="#understanding-regression-using-data-simulation">Understanding Regression Using Data Simulation</a>
  <ul class="collapse">
  <li><a href="#simulating-continuous-treatment-variable-and-outcome-variable" id="toc-simulating-continuous-treatment-variable-and-outcome-variable" class="nav-link" data-scroll-target="#simulating-continuous-treatment-variable-and-outcome-variable">Simulating Continuous Treatment Variable and Outcome Variable</a></li>
  <li><a href="#run-linear-model" id="toc-run-linear-model" class="nav-link" data-scroll-target="#run-linear-model">Run Linear Model</a></li>
  </ul></li>
  <li><a href="#equivalence-of-anova-and-regression" id="toc-equivalence-of-anova-and-regression" class="nav-link" data-scroll-target="#equivalence-of-anova-and-regression">Equivalence of ANOVA and Regression</a></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a></li>
  <li><a href="#combination-plots" id="toc-combination-plots" class="nav-link" data-scroll-target="#combination-plots">Combination Plots</a></li>
  <li><a href="#upshot" id="toc-upshot" class="nav-link" data-scroll-target="#upshot">Upshot</a></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2">Exercise 2</a></li>
  <li><a href="#what-you-have-learned" id="toc-what-you-have-learned" class="nav-link" data-scroll-target="#what-you-have-learned">What You Have Learned</a></li>
  <li><a href="#for-more-information-about-the-packages-used-here" id="toc-for-more-information-about-the-packages-used-here" class="nav-link" data-scroll-target="#for-more-information-about-the-packages-used-here">For more information about the packages used here:</a></li>
  <li><a href="#appendix-a" id="toc-appendix-a" class="nav-link" data-scroll-target="#appendix-a">Appendix A: Solutions</a>
  <ul class="collapse">
  <li><a href="#solution-excercise-2-simulate-data-and-regression-reporting" id="toc-solution-excercise-2-simulate-data-and-regression-reporting" class="nav-link" data-scroll-target="#solution-excercise-2-simulate-data-and-regression-reporting">Solution Excercise 2: simulate data and regression reporting</a></li>
  </ul></li>
  <li><a href="#appendix-b-how-anova-can-deliver-the-functionality-of-linear-regressions" id="toc-appendix-b-how-anova-can-deliver-the-functionality-of-linear-regressions" class="nav-link" data-scroll-target="#appendix-b-how-anova-can-deliver-the-functionality-of-linear-regressions">Appendix B: How ANOVA can deliver the functionality of Linear Regressions</a></li>
  <li><a href="#appendix-c-adding-complexity-in-simulation" id="toc-appendix-c-adding-complexity-in-simulation" class="nav-link" data-scroll-target="#appendix-c-adding-complexity-in-simulation">Appendix C: Adding Complexity in Simulation</a>
  <ul class="collapse">
  <li><a href="#simulating-data-continued" id="toc-simulating-data-continued" class="nav-link" data-scroll-target="#simulating-data-continued">Simulating Data… Continued</a></li>
  <li><a href="#more-complexity" id="toc-more-complexity" class="nav-link" data-scroll-target="#more-complexity">More complexity</a></li>
  <li><a href="#visualising-simulated-data" id="toc-visualising-simulated-data" class="nav-link" data-scroll-target="#visualising-simulated-data">Visualising Simulated Data</a></li>
  </ul></li>
  <li><a href="#appendix-d-causal-inference-glossary" id="toc-appendix-d-causal-inference-glossary" class="nav-link" data-scroll-target="#appendix-d-causal-inference-glossary">Appendix D: Causal Inference Glossary</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Readings
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Barrett M (2023). <em>ggdag: Analyze and Create Elegant Directed Acyclic Graphs</em>. R package version 0.2.7.9000, <a href="https://github.com/malcolmbarrett/ggdag" class="uri">https://github.com/malcolmbarrett/ggdag</a></li>
<li>“An Introduction to Directed Acyclic Graphs”, <a href="https://r-causal.github.io/ggdag/articles/intro-to-dags.html" class="uri">https://r-causal.github.io/ggdag/articles/intro-to-dags.html</a></li>
<li>“Common Structures of Bias”, <a href="https://r-causal.github.io/ggdag/articles/bias-structures.html" class="uri">https://r-causal.github.io/ggdag/articles/bias-structures.html</a></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts for the test(s):
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Confounding</strong></li>
<li><strong>Causal Directed Acyclic Graph</strong></li>
<li><strong>Five Elementary Causal Structures</strong></li>
<li><strong>d-separation</strong></li>
<li><strong>Back door path</strong></li>
<li><strong>Conditioning</strong></li>
<li><strong>Fork bias</strong></li>
<li><strong>Collider bias</strong></li>
<li><strong>Mediator bias</strong></li>
<li><strong>Four Rules of Confounding Control</strong></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Download Your Laboratory R Script Here
</div>
</div>
<div class="callout-body-container callout-body">
<p>Assuming you have installed R and RStudio:</p>
<ol type="1">
<li><p>Download the R script for Lab 01 by clicking the link below. This script contains the code you will work with during your laboratory session.</p></li>
<li><p>After downloading, open RStudio.</p></li>
<li><p>In RStudio, create a new R script file by going to <code>File &gt; New File &gt; R Script</code>.</p></li>
<li><p>Create a new<code>.R</code> file called <code>02-lab.R</code> and provide your name, contact, data, and a brief title such as “Rimulating the basic five basic causal structures in R”</p></li>
</ol>
<p>Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Bob leBob</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  29 Feb 2024</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  bob@lebob.fr</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#. Lab 02 - Simulating The Five Basic Structures of Cauality</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li><p>Copy and paste the code chunks below from your computer onto the script during class.</p></li>
<li><p>Save the new R script file in a clearly defined project directory folder for easy access during the lab.</p></li>
<li><p>Bring your computer to the lab.</p></li>
</ol>
<p>Note: you may also download the lab here <a href="https://raw.githubusercontent.com/go-bayes/psyc-434-2024/main/laboratory/02-lab.R">Download the R script for Lab 02</a></p>
</div>
</div>
<section id="seminar" class="level1 page-columns page-full">
<h1>Seminar</h1>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<ul>
<li>Understand basic features of causal diagrams: definitions and applications</li>
<li>Introduction to the five elementary causal structures</li>
<li>Lab: Gentle Introduction to Simulation and Regression (TBC over the upcoming weeks)</li>
</ul>
</section>
<section id="review" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="review">Review</h3>
<ol type="1">
<li>Psychological research begins with two questions:</li>
</ol>
<blockquote class="blockquote">
<ol type="1">
<li>What do I want to know?</li>
<li>For which population does this knowledge generalise?</li>
</ol>
</blockquote>
<p>This course considers how to ask psychological questions that pertain to populations with different characteristics</p>
<ol start="2" type="1">
<li><p>In psychological research, we typically ask questions about the causes and consequences of thought and behaviour - “What if?” questions <span class="citation" data-cites="hernan2024WHATIF">(<a href="#ref-hernan2024WHATIF" role="doc-biblioref">Hernan and Robins 2024</a>)</span>.</p></li>
<li><p>The following concepts help us to describe two distinct failure modes in psychological research when asking “What if?” questions:</p></li>
</ol>
<div class="no-row-height column-margin column-container"><div id="ref-hernan2024WHATIF" class="csl-entry" role="listitem">
Hernan, M. A., and J. M. Robins. 2024. <em>Causal Inference: What If?</em> Chapman &amp; Hall/CRC Monographs on Statistics &amp; Applied Probab. Taylor &amp; Francis. <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/</a>.
</div></div><ul>
<li><p><strong>The Concept of External Validity</strong>: the extent to which the findings of a study can be generalised to other situations, people, settings, and time periods. That is, we want to know if our findings carry beyond the <em>sample population</em> to the <em>target population</em>. We fail when our results do not generalise as we think. More fundamentally, we fail when we have not clearly defined our question or our target population.</p></li>
<li><p><strong>The Concept of Internal Validity</strong>: the extent to which the associations we obtain from data reflect causality. In psychological science, we use “independent variable” and “dependent variable.” Sometimes we use the terms “exogenous variable” and “endogenous variable.” Sometimes we use the term “predictor variable” to describe the “dependent” or “endogenous” variable. These words are confusing. When asking “What if?” questions, we want to understand what would happen if we intervened. In this course, we will use the term “treatment” or, equivalently the term “exposure” to denote the intervention; we will use the term “outcome” to denote the effect of an intervention.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;“What if?” questions implicitly invoke the idea of intervening on the world. “If we did <em>this</em>, <em>then</em> what would happen to <em>that</em>…?” Our preferred terminology reflects our interest in the effects of interventions.</p></div></div><ol start="5" type="1">
<li>During the first part of the course, our primary focus will be on challenges to internal validity from <strong>confounding bias.</strong></li>
</ol>
</section>
<section id="definitions" class="level2">
<h2 class="anchored" data-anchor-id="definitions">Definitions</h2>
<div id="def-internal-validity" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1</strong></span> We say internal validity is compromised if the association between the treatment and outcome in a study does not consistently reflect causality in the sample population as defined at baseline.</p>
</div>
<div id="def-external-validity" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2</strong></span> We say external validity is compromised if the association between the treatment and outcome in a study does not consistently reflect causality in the target population as defined at baseline.</p>
</div>
<p>The concept of “confounding bias” helps to clarify what it is at stake when evaluating the <em>internal validity</em> of a study. As we shall see, there are several equivalent definitions of “confounding bias,” which we will describe during the upcoming weeks.</p>
<p>The definition of confounding bias that we will examine today is:</p>
<div id="def-confounding" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3</strong></span> We say there is confounding bias if there is an open back-door path between the treatment and outcome or if the path between the treatment and outcome is blocked.</p>
</div>
<p>Today, our purpose will be to clarify the meaning of each term in this definition. To that end, we will introduce the five elementary graphical structures employed in causal diagrams. We will then explain the four elementary rules that allow investigators to identify causal effects from the asserted relations in a causal diagram. First, what are causal diagrams?</p>
</section>
<section id="introduction-to-causal-diagrams." class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="introduction-to-causal-diagrams.">Introduction to Causal Diagrams.</h2>
<p>Causal diagrams, also called causal graphs, Directed Acyclic Graphs, and Causal Directed Acyclic Graphs, are graphical tools whose primary purpose is to enable investigators to detect confounding biases.</p>
<p><strong>Remarkably, causal diagrams are rarely used in psychology!</strong></p>
<p>Before describing how causal diagrams work, we first define the meanings of their symbols. Note there is no single convention for creating causal diagrams, so it is important that we are clear when defining our meanings.</p>
<section id="the-meaning-of-our-symbols" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-meaning-of-our-symbols">The meaning of our symbols</h3>
<p>The conventions that describe the meanings of our symbols are given in <a href="#fig-conventions" class="quarto-xref">Figure&nbsp;1</a>.</p>
<div id="fig-conventions" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-conventions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="terminologylocalconventions.pdf" class="quarto-figure quarto-figure-left" style="width:100.0%;height:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-conventions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Our variable naming conventions. This figure is adapted from <span class="citation" data-cites="bulbulia2023">(<a href="#ref-bulbulia2023" role="doc-biblioref">Bulbulia 2024</a>)</span>
<div id="ref-bulbulia2023" class="csl-entry" role="listitem">
Bulbulia, J. A. 2024. <span>“Methods in Causal Inference Part 1: Causal Diagrams and Confounding.”</span> <em>Evolutionary Human Sciences</em> 6: e40. <a href="https://doi.org/10.1017/ehs.2024.35">https://doi.org/10.1017/ehs.2024.35</a>.
</div></figcaption>
</figure>
</div>
<p>For us:</p>
<p><span class="math inline">X</span> denotes a variable without reference to its role;</p>
<p><span class="math inline">A</span> denotes the “treatment” or “exposure” variable. This is the variable for which we seek to understand the effect of intervening on it. It is the “cause;”</p>
<p><span class="math inline">Y</span> denotes the outcome or response of an intervention. It is the “effect.” Last week we considered whether marriage <span class="math inline">A</span> causes happiness <span class="math inline">Y</span>.</p>
<p><span class="math inline">Y(a)</span> denotes the counterfactual or potential state of <span class="math inline">Y</span> in response to setting the level of the exposure to a specific level, <span class="math inline">A=a</span>. As we will consider in the second half of the course, to consistently estimate causal effects we will need to evaluate counterfactual or potential states of the world. Keeping to our example, we will need to do more than evaluate marriage and happiness in people over time. We will need to evaluate how happy the unmarried people would have been had they been married and how happy the married people would have been had they not been married. Of course, these events cannot be directly observed. Thus to address fundamental questions in psychology, we need to contrast counterfactual states of the world. This might seem like science fiction; however, we are already familiar with methods for obtaining such counterfactual contrasts – namely, randomised controlled experiments! We will return to this concept later, but for now, it will be useful for you to understand the notation.</p>
<p><span class="math inline">L</span> denotes a measured confounder or set of confounders is defined as a variable which, if conditioned upon, closes an open back-door path between the treatment <span class="math inline">A</span> and the outcome <span class="math inline">Y</span>. Consider the scenario where happiness at time 0 (<span class="math inline">L</span>) affects both the probability of getting married at time 1 (<span class="math inline">A</span>) and one’s happiness at time 2 (<span class="math inline">Y</span>). In this case, <span class="math inline">L</span> serves as a confounder because it influences both the treatment (marriage at time 1) and the outcome (happiness at time 2), potentially opening a back-door path that confounds the estimated effect of marriage on happiness.</p>
<p>To accurately estimate the causal effect of marriage on happiness, then, it is essential to control for <span class="math inline">L</span>. With cross-sectional data, such control might be difficult.</p>
<p><span class="math inline">U</span> denotes an unmeasured confounder – that is a variable that may affect both the treatment and the outcome, but for which we have no direct measurement. Suppose cultural upbringing affects both whether someone gets married and whether they are happy. If this variable is not measured, we cannot accurately estimate a causal effect of marriage on happiness.</p>
<p><span class="math inline">M</span> denotes a mediator or a variable along the path from exposure to outcome. For example, perhaps marriage causes wealth and wealth causes happiness. As we shall see, conditioning on “wealth” when estimating the effect of marriage on happiness will make it seem that marriage does not cause happiness when it does, <em>through</em> wealth.</p>
<p><span class="math inline">\bar{X}</span> denotes a sequence of variables, for example, a sequence of treatments. Imagine we were interested in the causal effect of marriage and remarriage on well-being. In this case, there are two treatments <span class="math inline">A_0</span> and <span class="math inline">A_1</span> and four potential contrasts. For the scenario of marriage and remarriage affecting well-being, we denote the potential outcomes as <span class="math inline">Y(a_0, a_1)</span>, where <span class="math inline">a_0</span> and <span class="math inline">a_1</span> represent the specific values taken by <span class="math inline">A_0</span> and <span class="math inline">A_1</span>, respectively. Given two treatments, <span class="math inline">A_0</span> and <span class="math inline">A_1</span>, four primary contrasts of interest correspond to the different combinations of these treatments. These contrasts allow us to compare the causal effects of being married versus not and remarried versus not on well-being. The potential outcomes under these conditions can be specified as follows:</p>
<ol type="1">
<li><span class="math inline">Y(0, 0)</span>: The potential outcome when there is no marriage.</li>
<li><span class="math inline">Y(0, 1)</span>: The potential outcome when there is marriage.</li>
<li><span class="math inline">Y(1, 0)</span>: The potential outcome when there is divorce.</li>
<li><span class="math inline">Y(1, 1)</span>: The potential outcome from marriage prevalence.</li>
</ol>
<p>Each of these outcomes allows for a specific contrast to be made, comparing the well-being under different scenarios of marriage and remarriage. Which do we want to contrast? Note, the question about ‘the causal effects of marriage on happiness’ is ambiguous because we have not stated the causal contrast we are interested in.</p>
<p><span class="math inline">\mathcal{R}</span> denotes a randomisation or a chance event.</p>
</section>
<section id="elements-of-our-causal-graphs" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="elements-of-our-causal-graphs">Elements of our Causal Graphs</h3>
<p>The conventions that describe components of our causal graphs are given in <a href="#fig-general" class="quarto-xref">Figure&nbsp;2</a>.</p>
<div id="fig-general" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-general-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="terminologygeneral.pdf" class="quarto-figure quarto-figure-left" style="width:100.0%;height:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-general-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Nodes, Edges, Conditioning Conventions. This figure is adapted from <span class="citation" data-cites="bulbulia2023">(<a href="#ref-bulbulia2023" role="doc-biblioref">Bulbulia 2024</a>)</span>
<div id="ref-bulbulia2023" class="csl-entry" role="listitem">
Bulbulia, J. A. 2024. <span>“Methods in Causal Inference Part 1: Causal Diagrams and Confounding.”</span> <em>Evolutionary Human Sciences</em> 6: e40. <a href="https://doi.org/10.1017/ehs.2024.35">https://doi.org/10.1017/ehs.2024.35</a>.
</div></figcaption>
</figure>
</div>
<section id="time-indexing" class="level4">
<h4 class="anchored" data-anchor-id="time-indexing">Time indexing</h4>
<p>In our causal diagrams, we will implement two conventions to accurately depict the temporal order of events.</p>
<p>First, the layout of a causal diagram will be structured from left to right to reflect the sequence of causality as it unfolds in reality. This orientation is crucial because causal diagrams must inherently be acyclic and because causality itself is inherently temporal.</p>
<p>Second, we will enhance the representation of the event sequence within our diagrams by systematically indexing our nodes according to the relative timing of events. If an event represented by <span class="math inline">X_0</span> precedes another event represented by <span class="math inline">X_1</span>, the indexing will indicate this chronological order.</p>
</section>
<section id="representing-uncertainty-in-timing-explicitly" class="level4">
<h4 class="anchored" data-anchor-id="representing-uncertainty-in-timing-explicitly">Representing uncertainty in timing explicitly</h4>
<p>In settings in which the sequence of events is ambiguous or cannot be definitively known, particularly in the context of cross-sectional data where all measurements are taken at a single point in time, we adopt a specific convention to express causality under uncertainty: <span class="math inline">X_{\phi t}</span>. This notation allows us to propose a temporal order without clear, time-specific measurements, acknowledging our speculation.</p>
<p>For instance, when the timing between events is unclear, we denote an event that is presumed to occur first as <span class="math inline">X_{\phi 0}</span> and a subsequent event as <span class="math inline">X_{\phi 1}</span>, indicating a tentative ordering where <span class="math inline">X_{\phi 0}</span> is thought to precede <span class="math inline">X_{\phi 1}</span>. However, it is essential to underscore that this notation signals our uncertainty regarding the actual timing of events; our measurements do not give us the confidence to assert this sequence definitively.</p>
</section>
<section id="arrows" class="level4">
<h4 class="anchored" data-anchor-id="arrows">Arrows</h4>
<p>As indicated in <a href="#fig-general" class="quarto-xref">Figure&nbsp;2</a>, black arrows denote causality, red arrows reveal an open backdoor path, dashed black arrows denote attenuation, and red dashed arrows denote bias in a true causal association between <span class="math inline">A</span> and <span class="math inline">Y</span>. Finally, a blue arrow with a circle point denotes effect-measure modification, also known as “effect modification.” We might be interested in treatment effect heterogeneity without evaluating the causality in the sources of this heterogeneity. For example, we cannot typically imagine any intervention in which people could be randomised into cultures. However, we may be interested in whether the effects of an intervention that might be manipulable, such as marriage, differ by culture. To clarify this interest, we require a non-causal arrow.</p>
<p><span class="math inline">\mathcal{R}\to A</span> denotes a random treatment assignment.</p>
</section>
<section id="boxes" class="level4">
<h4 class="anchored" data-anchor-id="boxes">Boxes</h4>
<p>We use a black box to denote conditioning that reduces confounding or that is inert.</p>
<p>We use a red box to describe settings in which conditioning on a variable introduces confounding bias.</p>
<p>Occasionally we will use a dashed circle do denote a latent variable, that is, a variable that is either not measured or not conditioned upon.</p>
</section>
<section id="terminology-for-conditional-independence" class="level4">
<h4 class="anchored" data-anchor-id="terminology-for-conditional-independence">Terminology for Conditional Independence</h4>
<p>The bottom panel of <a href="#fig-general" class="quarto-xref">Figure&nbsp;2</a> shows some mathematical notation. Do not be alarmed, we are safe! Part 1 of the course will not require more complicated math than this notation. And we shall see that the notation is a compact way to describe intuitions that can be expressed less compactly in words:</p>
<ul>
<li><p><strong>Statistical Independence (<span class="math inline">\coprod</span>):</strong> in the context of causal inference, statistical independence between the treatment and potential outcomes, denoted as <span class="math inline">A \coprod Y(a)</span>, means the treatment assignment is independent of the potential outcomes. This assumption is critical for estimating causal effects without bias.</p></li>
<li><p><strong>Statistical Dependence (<span class="math inline">\cancel\coprod</span>):</strong> conversely, <span class="math inline">\cancel\coprod</span> denotes statistical dependence, indicating that the distribution of one variable is influenced by the other. For example, <span class="math inline">A \cancel\coprod Y(a)</span> implies that the treatment assignment is related to the potential outcomes, potentially introducing bias into causal estimates.</p></li>
<li><p><strong>Conditioning (<span class="math inline">|</span>):</strong> conditioning, denoted by the vertical line <span class="math inline">|</span>, allows for specifying contexts or conditions under which independence or dependence holds.</p>
<ul>
<li><p><strong>Conditional Independence (<span class="math inline">A \coprod Y(a)|L</span>):</strong> This means that once we account for a set of variables <span class="math inline">L</span>, the treatment and potential outcomes are independent. This condition is often the basis for strategies aiming to control for confounding.</p></li>
<li><p><strong>Conditional Dependence (<span class="math inline">A \cancel\coprod Y(a)|L</span>):</strong> States that potential outcomes and treatments are not independent after conditioning on <span class="math inline">L</span>, indicating a need for careful consideration in the analysis to avoid biased causal inferences.</p></li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="the-five-elementary-structures-of-causality" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-five-elementary-structures-of-causality">The Five Elementary Structures of Causality</h2>
<p>Judea Pearl proved that all elementary structures of causality can be represented graphically <span class="citation" data-cites="pearl2009a">(<a href="#ref-pearl2009a" role="doc-biblioref">Pearl 2009</a>)</span>. <a href="#fig-directedgraph" class="quarto-xref">Figure&nbsp;3</a> presents this five elementary structures.</p>
<div class="no-row-height column-margin column-container"><div id="ref-pearl2009a" class="csl-entry" role="listitem">
Pearl, Judea. 2009. <em>Causality</em>. Cambridge University Press.
</div></div><div id="fig-directedgraph" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-directedgraph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="terminologydirectedgraph.pdf" class="quarto-figure quarto-figure-left" style="width:100.0%;height:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-directedgraph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Five elementary structures. This figure is adapted from <span class="citation" data-cites="bulbulia2023">(<a href="#ref-bulbulia2023" role="doc-biblioref">Bulbulia 2024</a>)</span>.
<div id="ref-bulbulia2023" class="csl-entry" role="listitem">
Bulbulia, J. A. 2024. <span>“Methods in Causal Inference Part 1: Causal Diagrams and Confounding.”</span> <em>Evolutionary Human Sciences</em> 6: e40. <a href="https://doi.org/10.1017/ehs.2024.35">https://doi.org/10.1017/ehs.2024.35</a>.
</div></figcaption>
</figure>
</div>
<p>The structures are as follows:</p>
<ul>
<li><strong>Two Variables:</strong>
<ol type="1">
<li><strong>Causality Absent:</strong> There is no causal effect between variables <span class="math inline">A</span> and <span class="math inline">B</span>. They do not influence each other, denoted as <span class="math inline">A \coprod B</span>, indicating they are statistically independent.</li>
<li><strong>Causality:</strong> Variable <span class="math inline">A</span> causally affects variable <span class="math inline">B</span>. This relationship suggests an association between them, denoted as <span class="math inline">A \cancel\coprod B</span>, indicating they are statistically dependent.</li>
</ol></li>
<li><strong>Three Variables:</strong>
<ol start="3" type="1">
<li><strong>Fork:</strong> Variable <span class="math inline">A</span> causally affects both <span class="math inline">B</span> and <span class="math inline">C</span>. Variables <span class="math inline">B</span> and <span class="math inline">C</span> are conditionally independent given <span class="math inline">A</span>, denoted as <span class="math inline">B \coprod C | A</span>. This structure implies that knowing <span class="math inline">A</span> removes any association between <span class="math inline">B</span> and <span class="math inline">C</span> due to their common cause.</li>
<li><strong>Chain:</strong> A causal chain exists where <span class="math inline">C</span> is affected by <span class="math inline">B</span>, which in turn is affected by <span class="math inline">A</span>. Variables <span class="math inline">A</span> and <span class="math inline">C</span> are conditionally independent given <span class="math inline">B</span>, denoted as <span class="math inline">A \coprod C | B</span>. This indicates that <span class="math inline">B</span> mediates the effect of <span class="math inline">A</span> on <span class="math inline">C</span>, and knowing <span class="math inline">B</span> breaks the association between <span class="math inline">A</span> and <span class="math inline">C</span>.</li>
<li><strong>Collider:</strong> Variable <span class="math inline">C</span> is affected by both <span class="math inline">A</span> and <span class="math inline">B</span>, which are independent. However, conditioning on <span class="math inline">C</span> induces an association between <span class="math inline">A</span> and <span class="math inline">B</span>, denoted as <span class="math inline">A \cancel\coprod B | C</span>. This structure is unique because it suggests that <span class="math inline">A</span> and <span class="math inline">B</span>, while initially independent, become associated when we account for their common effect <span class="math inline">C</span>.</li>
</ol></li>
</ul>
<p>Once we understand the basic relationships between two variables, we can build upon these to create more complex relationships. These structures help us see how statistical independences and dependencies emerge from the data, allowing us to clarify the causal relationships we presume exist. Such clarity is crucial for ensuring that confounders are balanced across treatment groups, given all measured confounders, so that <span class="math inline">Y(a) \coprod A | L</span>.</p>
<p>You might wonder, “If not from the data, where do our assumptions about causality come from?” This question will come up repeatedly throughout the course. The short answer is that our assumptions are based on existing knowledge. This reliance on current knowledge might seem counterintuitive for buiding scientific knowledge-— shouldn’t we use data to build knowledge, not the other way around? Yes, but it is not that straightforward. Data often hold the answers we’re looking for but can be ambiguous. When the causal structure is unclear, it is important to sketch out different causal diagrams, explore their implications, and, if necessary, conduct separate analyses based on these diagrams.</p>
<p>Otto Neurath, an Austrian philosopher and a member of the Vienna Circle, famously used the metaphor of a ship that must be rebuilt at sea to describe the process of scientific theory and knowledge development.</p>
<div class="page-columns page-full"><blockquote class="blockquote">
<p>Duhem has shown … that every statement about any happening is saturated with hypotheses of all sorts and that these in the end are derived from our whole world-view. We are like sailors who on the open sea must reconstruct their ship but are never able to start afresh from the bottom. Where a beam is taken away a new one must at once be put there, and for this the rest of the ship is used as support. In this way, by using the old beams and driftwood, the ship can be shaped entirely anew, but only by gradual reconstruction. <span class="citation" data-cites="neurath1973">(<a href="#ref-neurath1973" role="doc-biblioref">Neurath 1973, 199</a>)</span></p>
</blockquote><div class="no-row-height column-margin column-container"><div id="ref-neurath1973" class="csl-entry" role="listitem">
Neurath, Otto. 1973. <span>“Anti-Spengler.”</span> In <em>Empiricism and Sociology</em>, edited by Marie Neurath and Robert S. Cohen, 158–213. Dordrecht: Springer Netherlands. <a href="https://doi.org/10.1007/978-94-010-2525-6_6">https://doi.org/10.1007/978-94-010-2525-6_6</a>.
</div></div></div>
<p>This quotation emphasises the iterative process that accumulates scientific knowledge; new insights are cast from the foundation of existing knowledge. Causal diagrams are at home in Neurath’s boat. The tradition of science that believes that knowledge develops from the results of statistical tests applied to data should be resisted. The data alone typically do not contain the answers we seek.</p>
</section>
<section id="the-four-rules-of-confounding-control" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-four-rules-of-confounding-control">The Four Rules of Confounding Control</h2>
<p><a href="#fig-terminologyconfounders" class="quarto-xref">Figure&nbsp;4</a> describe the four elementary rules of confounding control:</p>
<div id="fig-terminologyconfounders" class="quarto-float quarto-figure quarto-figure-left anchored page-columns page-full" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-terminologyconfounders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="terminologyelconfounders.pdf" class="quarto-figure quarto-figure-left" style="width:100.0%;height:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-terminologyconfounders-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Four rules of confounding control
</figcaption>
</figure>
</div>
<ol type="1">
<li><p><strong>Condition on Common Cause or its Proxy</strong>: this rule applies to settings in which the treatment (<span class="math inline">A</span>) and the outcome (<span class="math inline">Y</span>) share common causes. By conditioning on these common causes, we block the open backdoor paths that could introduce bias into our causal estimates. Controlling for these common causes (or their proxies) helps tp isolate the specific effect of <span class="math inline">A</span> on <span class="math inline">Y</span>. (We do not draw a path from $ A Y$ because we do not assume this path.)</p></li>
<li><p><strong>Do Not Condition on a Mediator</strong>: this rule applies to settings in which the variable <span class="math inline">L</span> is a mediator of <span class="math inline">A \to Y</span>. Here, conditioning on a mediator will bias the total causal effect estimate. Later in the course, we will discuss the assumptions required for causal mediation. For now, if we are interested in total effect estimates, we must not condition on a mediator. Here we draw the path from <span class="math inline">A \to Y</span> to ensure that if such a path exists, it will not become biased from our conditioning strategy.</p></li>
<li><p><strong>Do Not Condition on a Collider</strong>: this rule applies to settings in which we <span class="math inline">L</span> is a common effect of <span class="math inline">A</span> and <span class="math inline">Y</span>. Conditioning on a collider may invoke a spurious association. Last week we considered an example in which marriage caused wealth and happiness caused wealth. Conditioning on wealth in this setting will induce an association between happiness and marriage. Why? If we know the outcome, wealth, then we know there are at least two ways of wealth. Among those wealthy but low on happiness, we can predict that they are more likely to be married, for how else would they be wealthy? Similarly, among those who are wealthy and are not married, we can predict that they are happy, for how else would they be wealthy if not through marriage? These relationships are predictable entirely without a causal association between marriage and happiness!</p></li>
<li><p><strong>Proxy Rule: Conditioning on a Descendent Is Akin to Conditioning on Its Parent</strong>: this rule applies to settings in which we <span class="math inline">L’</span> is an effect from another variable <span class="math inline">L</span>. The graph considers when <span class="math inline">L’</span> is downstream of a collider. For example, suppose we condition on home ownership, which is an effect of wealth. Such conditioning will open up a non-causal path without causation because home ownership is a proxy for wealth. Consider, if someone owns a house but is not married, they are more likely to be happy, for how else could they accumulate the wealth required for home ownership? Likewise, if someone is unhappy and owns a house, we can infer that they are more likely to be married because how else would they be wealthy? Conditioning on a proxy for a collider here is akin to conditioning on the collider itself.</p></li>
</ol>
<p>However, we can also use the proxy rule to reduce bias. Return to the earlier example in which there is an unmeasured common cause of marriage and happiness, which we called “cultural upbringing” Suppose we have not measured this variable but have measured proxies for this variable, such as country of birth, childhood religion, number of languages one speaks, and others. By controlling for baseline values of these proxies, we can exert more control over unmeasured confounding. Even if bias is not eliminated, we should reduce bias wherever possible, which includes not introducing new biases, such as mediator bias, along the way. Later in the course, we will teach you how to perform sensitivity analyses to verify the robustness of your results to unmeasured confounding. Sensitivity analysis is critical because where the data are observational, we cannot entirely rule out unmeasured confounding.</p>
</section>
</section>
<section id="lab-regression-in-r-graphing-and-elements-of-simulation" class="level1 page-columns page-full">
<h1>Lab – Regression in R, Graphing, and Elements of Simulation</h1>
<section id="simulating-data-in-r-outcome-treatment" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="simulating-data-in-r-outcome-treatment">Simulating Data in R: <code>Outcome ~ Treatment</code></h2>
<section id="step-1-set-up-your-r-environment" class="level4">
<h4 class="anchored" data-anchor-id="step-1-set-up-your-r-environment">Step 1: Set Up Your R Environment</h4>
<p>Ensure R or RStudio is installed and open.</p>
</section>
<section id="step-2-set-a-seed-for-reproducibility" class="level4">
<h4 class="anchored" data-anchor-id="step-2-set-a-seed-for-reproducibility">Step 2: Set a Seed for Reproducibility</h4>
<p>To ensure that your simulated data can be reproduced exactly. Again, it is good practice to set a seed before generating random data. This makes your analyses and simulations replicable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># use any number to set the seed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-3-simulate-continuous-data-one-variable" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="step-3-simulate-continuous-data-one-variable">Step 3: Simulate Continuous Data: One Variable</h4>
<p>To simulate continuous data, you can use functions like <code>rnorm()</code> for normal distributions, <code>runif()</code> for uniform distributions, etc. Here we simulate 100 normally distributed data points with a mean of 50 and a standard deviation of 10:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of observations</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data_continuous <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mean, sd)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_continuous)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44.39524 47.69823 65.58708 50.70508 51.29288 67.15065</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view using base R histogram</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_continuous)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-content_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div></div></div>
</section>
<section id="step-4-simulate-categorical-data" class="level4">
<h4 class="anchored" data-anchor-id="step-4-simulate-categorical-data">Step 4: Simulate Categorical Data</h4>
<p>Categorical data can be simulated using the <code>sample()</code> function. Here, we simulate a binary variable (gender) with two levels for 100 observations. There is equal probability of assignment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data_categorical <span class="ot">&lt;-</span> <span class="fu">sample</span>(levels, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_categorical)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Female" "Female" "Female" "Male"   "Female" "Female"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_categorical)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data_categorical
Female   Male 
    49     51 </code></pre>
</div>
</div>
<p>To generate categories with unequal probabilities, you can use the <code>sample()</code> function by specifying the <code>prob</code> parameter, which defines the probability of selecting each level. This allows for simulating categorical data where the distribution between categories is not uniform.</p>
<p>Below is an example that modifies your initial code to create a categorical variable with unequal probabilities for “Male” and “Female”. Here is an example with unequal probabilities:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define levels and number of observations</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># total number of observations</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate categorical data with unequal probabilities</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>data_categorical_unequal <span class="ot">&lt;-</span> <span class="fu">sample</span>(levels, n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># view the first few elements</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># head(data_categorical_unequal)</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_categorical_unequal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data_categorical_unequal
Female   Male 
    69     31 </code></pre>
</div>
</div>
</section>
</section>
<section id="simulating-outcomes-from-treatments" class="level2">
<h2 class="anchored" data-anchor-id="simulating-outcomes-from-treatments">Simulating Outcomes from Treatments</h2>
<p>In this example, the <code>prob</code> parameter is set to <code>c(0.3, 0.7)</code>, indicating a 30% probability for “Male” and a 70% probability for “Female”. This results in a simulated dataset where approximately 30% of the observations are “Male” and 70% are “Female”, reflecting the specified unequal probabilities. Adjust the probabilities as needed to fit the scenario you wish to simulate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|fig-cap: "Box plot of simulated scores by groups."</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note: running this code will do no harm if the libraries are already installed.</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install (if necessary) libraries</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># graphs</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggplot2)) {</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># tables</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(parameters)) {</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"parameters"</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(parameters)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(parameters)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co"># reporting</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(report)) {</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"report"</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(report)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(report)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="co"># predictive graphs</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggeffects)) {</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggeffects"</span>)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggeffects)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggeffects)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="co"># assembling graphs</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(patchwork)) {</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="co"># if libraries are already install, start here</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># reproducibility</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>groupA_scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>) <span class="co"># simulate scores for group A</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>groupB_scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">105</span>, <span class="at">sd =</span> <span class="dv">15</span>) <span class="co"># simulate scores for group B</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a><span class="co"># ombine into a data frame</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>df_scores <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">100</span>), <span class="at">scores =</span> <span class="fu">c</span>(groupA_scores, groupB_scores))</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="co"># commands to view data</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a> <span class="co">#str(df_scores)</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of columns</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(df_scores)</span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a><span class="co"># top rows (uncomment)</span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a><span class="co"># head(df_scores)</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a><span class="co"># bottom rows  (uncomment)</span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a><span class="co"># tail(df_scores)</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a><span class="co"># check structure of data  (uncomment)</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a><span class="co"># str(df_scores)</span></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a><span class="co"># make group a factor (not strictly necessary here, but useful in outher applications)</span></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>df_scores_1 <span class="ot">&lt;-</span> df_scores <span class="sc">|&gt;</span> </span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as.factor</span>(group))</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_scores_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  group    scores
1     A  91.59287
2     A  96.54734
3     A 123.38062
4     A 101.05763
5     A 101.93932
6     A 125.72597</code></pre>
</div>
</div>
</section>
<section id="visualising-our-simulated-data" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="visualising-our-simulated-data">Visualising Our Simulated Data</h2>
<p>Understanding your data visually is as important as the statistical analysis itself. Let’s create a simple plot to compare the score distributions between the two groups.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot your data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_scores_1, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> scores, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Score Distribution by Group"</span>, <span class="at">x =</span> <span class="st">"Group"</span>, <span class="at">y =</span> <span class="st">"Scores"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="02-content_files/figure-html/visualize-data-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="margin-caption">Score Distribution by Group</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-histogram" class="level2">
<h2 class="anchored" data-anchor-id="sec-histogram">Histogram</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fig-cap: "Histogram of simulated scores, by group, using facet_wrap()"</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># H=histograms for both groups</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_scores_1, <span class="fu">aes</span>(<span class="at">x =</span> scores, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Scores by Group"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Scores"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-content_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="excercise-1" class="level2">
<h2 class="anchored" data-anchor-id="excercise-1">Excercise 1</h2>
<ol type="1">
<li><p>Modify the simulation parameters to change each group’s mean and standard deviation. Observe how these changes affect the distribution.</p></li>
<li><p>Go to the <a href="#sec-histogram">histogram</a>. Experiment with different bin widths. In your own words, how do large and small numbers speak differently to the data? When might you use one histogram and not another.</p></li>
</ol>
</section>
<section id="simulating-data-for-familiar-statistical-tests" class="level2">
<h2 class="anchored" data-anchor-id="simulating-data-for-familiar-statistical-tests">Simulating data for familiar statistical tests</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tbl-caption: "results of a one-sample t-test."</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate some data</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 100 random normal values with mean = 5</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># perform one-sample t-test</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># testing if the mean of the data is reliably different from 4</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>mod_first_test<span class="ot">&lt;-</span> <span class="fu">t.test</span>(data, <span class="at">mu =</span> <span class="dv">4</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># table</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">parameters</span>(mod_first_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>One Sample t-test

Parameter | Mean |   mu | Difference |       95% CI | t(99) |      p
--------------------------------------------------------------------
data      | 5.09 | 4.00 |       1.09 | [4.91, 5.27] | 11.95 | &lt; .001

Alternative hypothesis: true mean is not equal to 4</code></pre>
</div>
</div>
<p>We can automatically report these results using the <code>report</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># report results automatically</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(mod_first_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations.

The One Sample t-test testing the difference between data (mean = 5.09) and mu
= 4 suggests that the effect is positive, statistically significant, and large
(difference = 1.09, 95% CI [4.91, 5.27], t(99) = 11.95, p &lt; .001; Cohen's d =
1.19, 95% CI [0.94, 1.45])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for two groups</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 50 random normal values, mean = 5</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="fl">5.5</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 50 random normal values, mean = 5.5</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># two-sample t-test</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>mod_t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(group1, group2)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(mod_t_test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations.

The Welch Two Sample t-test testing the difference between group1 and group2
(mean of x = 5.03, mean of y = 5.65) suggests that the effect is negative,
statistically significant, and medium (difference = -0.61, 95% CI [-0.98,
-0.25], t(97.95) = -3.34, p = 0.001; Cohen's d = -0.67, 95% CI [-1.07, -0.26])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">parameters</span>(mod_t_test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Welch Two Sample t-test

Parameter1 | Parameter2 | Mean_Parameter1 | Mean_Parameter2 | Difference
------------------------------------------------------------------------
group1     |     group2 |            5.03 |            5.65 |      -0.61

Parameter1 |         95% CI | t(97.95) |     p
----------------------------------------------
group1     | [-0.98, -0.25] |    -3.34 | 0.001

Alternative hypothesis: true difference in means is not equal to 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate pre-test and post-test scores</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>pre_test <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>post_test <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span>  pre_test <span class="sc">+</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># assume an increase</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># perform paired t-test</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>mod_pre_post <span class="ot">&lt;-</span> <span class="fu">t.test</span>(pre_test, post_test, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(mod_pre_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations.

The Paired t-test testing the difference between pre_test and post_test (mean
difference = -5.89) suggests that the effect is negative, statistically
significant, and large (difference = -5.89, 95% CI [-7.45, -4.33], t(29) =
-7.73, p &lt; .001; Cohen's d = -1.41, 95% CI [-1.91, -0.90])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">parameters</span>(mod_pre_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Paired t-test

Parameter |     Group | Difference | t(29) |      p |         95% CI
--------------------------------------------------------------------
pre_test  | post_test |      -5.89 | -7.73 | &lt; .001 | [-7.45, -4.33]

Alternative hypothesis: true mean difference is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="understanding-regression-using-data-simulation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="understanding-regression-using-data-simulation">Understanding Regression Using Data Simulation</h2>
<section id="simulating-continuous-treatment-variable-and-outcome-variable" class="level3">
<h3 class="anchored" data-anchor-id="simulating-continuous-treatment-variable-and-outcome-variable">Simulating Continuous Treatment Variable and Outcome Variable</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library for enhanced model reporting</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># choose a seed number for consistency</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># define the number of observations</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># total observations</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate continuous treatment variable A</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>) <span class="co"># mean = 50, sd = 10 for A</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the effect size of A on Y</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>beta_a <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># explicit effect size</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate outcome variable Y including an error term</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>outcome <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> beta_a <span class="sc">*</span> treatment <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>) <span class="co"># Y = intercept + beta_a*A + error</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataframe</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">treatment =</span> treatment,<span class="at">outcome =</span> outcome)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co"># view the structure and first few rows of the data frame</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  2 variables:
 $ treatment: num  44.4 47.7 65.6 50.7 51.3 ...
 $ outcome  : num  79.6 105.5 131.2 99.5 88.6 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  treatment   outcome
1  44.39524  79.58236
2  47.69823 105.53412
3  65.58708 131.24033
4  50.70508  99.45932
5  51.29288  88.55338
6  67.15065 138.40075</code></pre>
</div>
</div>
</section>
<section id="run-linear-model" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="run-linear-model">Run Linear Model</h3>
<p>Before moving on to regression analysis, ensure students understand the structure and distribution of the simulated data. Encourage them to use <code>summary()</code>, <code>plot()</code>, and other exploratory data analysis functions.</p>
<section id="regression-analysis-of-continuous-treatment-effect" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="regression-analysis-of-continuous-treatment-effect">Regression Analysis of Continuous Treatment Effect</h4>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># perform linear regression of Y on A</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> treatment, <span class="at">data =</span> df)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># display the regression model summary</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = outcome ~ treatment, data = df)

Residuals:
   Min     1Q Median     3Q    Max 
-38.15 -13.67  -1.75  11.61  65.81 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   8.1911    11.0530   0.741     0.46    
treatment     1.8951     0.2138   8.865  3.5e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.41 on 98 degrees of freedom
Multiple R-squared:  0.4451,    Adjusted R-squared:  0.4394 
F-statistic:  78.6 on 1 and 98 DF,  p-value: 3.497e-14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model in a reader-friendly format</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>report_fit <span class="ot">&lt;-</span> report<span class="sc">::</span><span class="fu">report</span>(fit)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment to print the model report</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(report_fit)</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># use ggeffects to view predicted values</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggemmeans</span>(fit,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"treatment"</span>))</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot see</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(predicted_values,  <span class="at">dot_alpha =</span> <span class="fl">0.35</span>,   <span class="at">show_data =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> .<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="02-content_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="margin-caption">Graph of regression line showing uncertainty.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="equivalence-of-anova-and-regression" class="level2">
<h2 class="anchored" data-anchor-id="equivalence-of-anova-and-regression">Equivalence of ANOVA and Regression</h2>
<p>We will simulate data in R to show that a one-way ANOVA is a particular case of linear regression with categorical predictors. We will give some reasons for preferring regression (in some settings).</p>
</section>
<section id="method" class="level2">
<h2 class="anchored" data-anchor-id="method">Method</h2>
<p>First, we simulate a dataset with one categorical independent variable with three levels (groups) and a continuous outcome (also called a “dependant”) variable. This setup allows us to apply both ANOVA and linear regression for comparison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nice tables</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># reproducibility</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">90</span> <span class="co"># total number of observations</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># number of groups</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate independent variable (grouping factor)</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">each =</span> n<span class="sc">/</span>k))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 3 levels "1","2","3": 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate outcome variable</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">220</span>) <span class="co"># Mean for each group</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># Standard deviation (same for all groups)</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate random data</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fu">rep</span>(means, <span class="at">each =</span> n<span class="sc">/</span>k), <span class="at">sd =</span> sd)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># make data frame</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>df_1 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(y, group)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>anova_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> group, <span class="at">data =</span> df_1)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(anova_model)</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>table_anova <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(anova_model)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(anova_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The ANOVA (formula: y ~ group) suggests that:

  - The main effect of group is statistically significant and large (F(2, 87) =
786.88, p &lt; .001; Eta2 = 0.95, 95% CI [0.93, 1.00])

Effect sizes were labelled following Field's (2013) recommendations.</code></pre>
</div>
</div>
<p>Next, we analyse the same data using linear regression. In R, regression models automatically convert categorical variables into dummy variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for tables (just installed)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># regression model </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>fit_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> group, <span class="at">data =</span> df_1)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment if you want an ordinary summary</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(regression_model)</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>table_fit <span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_regression)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print table</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>table_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Coefficient |   SE |           95% CI | t(87) |      p
--------------------------------------------------------------------
(Intercept) |       99.29 | 2.46 | [ 94.41, 104.18] | 40.40 | &lt; .001
group [2]   |        3.38 | 3.48 | [ -3.53,  10.29] |  0.97 | 0.333 
group [3]   |      121.07 | 3.48 | [114.16, 127.98] | 34.83 | &lt; .001</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>report_fit <span class="ot">&lt;-</span> <span class="fu">report_parameters</span>(fit_regression)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">#print</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>report_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - The intercept is statistically significant and positive (beta = 99.29, 95% CI [94.41, 104.18], t(87) = 40.40, p &lt; .001; Std. beta = -0.71, 95% CI [-0.80, -0.63])
  - The effect of group [2] is statistically non-significant and positive (beta = 3.38, 95% CI [-3.53, 10.29], t(87) = 0.97, p = 0.333; Std. beta = 0.06, 95% CI [-0.06, 0.18])
  - The effect of group [3] is statistically significant and positive (beta = 121.07, 95% CI [114.16, 127.98], t(87) = 34.83, p &lt; .001; Std. beta = 2.08, 95% CI [1.96, 2.20])</code></pre>
</div>
</div>
</section>
<section id="combination-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="combination-plots">Combination Plots</h2>
<p>We can create and combine individual plots, as showin in <a href="#fig-coefplot" class="quarto-xref">Figure&nbsp;5</a>, as follows:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regression --------------------------------------------------------------</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># graph the output of the parameters table and assign to object</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>coefficient_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(table_fit)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggeffects plot - create predictive plot.</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this gives the expected values by group </span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>predictive_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_regression, <span class="at">terms =</span> <span class="st">"group"</span>),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot_alpha =</span> <span class="fl">0.35</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">jitter =</span> .<span class="dv">1</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span>  <span class="st">"reefs"</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">260</span>)) <span class="sc">+</span> <span class="co"># change y axis</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predictive Graph"</span>, <span class="at">x =</span> <span class="st">"Treatment Group"</span>, <span class="at">y =</span> <span class="st">"Response"</span>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co"># view (uncomment to see it alone)</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="co">#predictive_plot</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co"># show all color palettes (uncomment to see colour options)</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co"># show_pals()</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple plots using `patchwork`</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="co"># create a plot</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>my_first_combination_plot <span class="ot">&lt;-</span> coefficient_plot <span class="sc">/</span> predictive_plot  <span class="sc">+</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Coefficient and Predictive plots with two panels "</span>,</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a><span class="co"># save a plot to your directory, make sure to create one called "figs"</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="do">## check directory (uncomments)</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="co"># here::here()</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a><span class="co"># save (change values if necessary )</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  my_first_combination_plot,</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"figs"</span>),</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">12</span>,</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"my_first_combination_plot.jpeg"</span>,</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">'jpeg'</span>,</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">limitsize =</span> <span class="cn">FALSE</span>,</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">600</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>my_first_combination_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-coefplot" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-coefplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="02-content_files/figure-html/fig-coefplot-1.png" class="img-fluid figure-img column-page-inset-right" width="672">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig" id="fig-coefplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: This is a combined plot
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="upshot" class="level2">
<h2 class="anchored" data-anchor-id="upshot">Upshot</h2>
<p>ANOVA partitions variance into between-group and within-group components. Regression analysis estimates the mean of the <code>dependent variable</code> as a linear function of the <code>independent (including categorical)</code> variables. For many questions, ANOVA is appropriate, however, when comparing groups, we often want a finer-grained interpretation. Regression is built for obtaining this finer grain comparisons. Note: comparisons do not establish causality. We will return to regression over the next few weeks and use regression to hone your skills in R. Later, along the way, you’ll learn more about data visualisation, modelling, and reporting. These skills are essential for your final report. They are also skills that you will serve you beyond this course.</p>
</section>
<section id="exercise-2" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2">Exercise 2</h2>
<p>Perform a linear regression analysis using R. Follow the detailed instructions below to simulate the necessary data, execute the regression, and report your findings:</p>
<ol type="1">
<li><strong>Simulate Data:</strong>
<ul>
<li>Generate two continuous variables, <code>Y</code> and <code>A</code>, with <code>n = 100</code> observations each.</li>
<li>The variable <code>A</code> should have a mean of <code>50</code> and a standard deviation (<code>sd</code>) of <code>10</code>.</li>
</ul></li>
<li><strong>Define the Relationship:</strong>
<ul>
<li>Simulate the variable <code>Y</code> such that it is linearly related to <code>A</code> with a specified effect size. The effect size of <code>A</code> on <code>Y</code> must be explicitly defined as <code>2</code>.</li>
</ul></li>
<li><strong>Incorporate an Error Term:</strong>
<ul>
<li>When simulating <code>Y</code>, include an error term with a standard deviation (<code>sd</code>) of <code>20</code> to introduce variability.</li>
</ul></li>
<li><strong>Regression Analysis:</strong>
<ul>
<li>Use the <code>lm()</code> function in R to regress <code>Y</code> on <code>A</code>.</li>
<li>Ensure the regression model captures the specified effect of <code>A</code> on <code>Y</code>.</li>
</ul></li>
<li><strong>Report the Results:</strong>
<ul>
<li>Output the regression model summary to examine the coefficients, including the effect of <code>A</code> on <code>Y</code>, and assess the model’s overall fit and significance.</li>
</ul></li>
</ol>
<p>Here is a template to get you started. Copy the code and paste it into your R script.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  seed for reproducibility</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>( ) <span class="co"># numbers go in brackets</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span>   <span class="co"># number goes here</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for variable A with specified mean and sd</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">mean =</span> , <span class="co"># set your number here </span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">sd =</span> )<span class="co"># set your number here </span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co"># define the specified effect size of A on Y</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>beta_A <span class="ot">&lt;-</span>   <span class="co"># define your effect with a number here </span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data and make data frame in one step</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>df_3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate data for variable A with specified mean and sd</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> A, <span class="co"># from above</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="dv">5</span> <span class="sc">+</span> beta_A <span class="sc">*</span> A <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>) <span class="co">#  effect is intercept + ...</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_3)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df_3)</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="co">#  linear regression of Y on A</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A, <span class="at">data =</span> df_3)</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="co">#  results (standard code)</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(model)</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="co"># time saving reports</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_3)</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-you-have-learned" class="level2">
<h2 class="anchored" data-anchor-id="what-you-have-learned">What You Have Learned</h2>
<ul>
<li><strong>Data simulation:</strong></li>
</ul>
<p>You’ve learned to simulate datasets in R. This is a important skill for exploring statistical concepts and causal inference. Congratulations!</p>
<ul>
<li><strong>Data visualisation:</strong></li>
</ul>
<p>You’ve expanded your capacity for data visualisation.</p>
<ul>
<li><p><strong>Statistical tests:</strong> You’ve conducted basic statistical tests, including t-tests and ANOVA, and regression.</p></li>
<li><p><strong>Understanding ANOVA and regression:</strong></p></li>
</ul>
<p>You’ve examined the equivalence of ANOVA and regression analysis</p>
</section>
<section id="for-more-information-about-the-packages-used-here" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="for-more-information-about-the-packages-used-here">For more information about the packages used here:</h2>
<ul>
<li><p><a href="https://ggplot2.tidyverse.org/">ggplot2</a>: A system for declaratively creating graphics, based on The Grammar of Graphics.</p></li>
<li><p><a href="https://easystats.github.io/parameters/">Parameters package</a>: Provides utilities for processing model parameters and their metrics.</p></li>
<li><p><a href="https://easystats.github.io/report/index.html">Report package</a>: Facilitates the automated generation of reports from statistical models.</p></li>
<li><p><span class="citation" data-cites="montgomery2018">Montgomery, Nyhan, and Torres (<a href="#ref-montgomery2018" role="doc-biblioref">2018</a>)</span> describes confounding in experiments - well worth a read.</p></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-montgomery2018" class="csl-entry" role="listitem">
Montgomery, Jacob M., Brendan Nyhan, and Michelle Torres. 2018. <span>“How Conditioning on Posttreatment Variables Can Ruin Your Experiment and What to Do about It.”</span> <em>American Journal of Political Science</em> 62 (3): 760–75. <a href="https://doi.org/10.1111/ajps.12357">https://doi.org/10.1111/ajps.12357</a>.
</div></div></section>
<section id="appendix-a" class="level2">
<h2 class="anchored" data-anchor-id="appendix-a">Appendix A: Solutions</h2>
<section id="solution-excercise-2-simulate-data-and-regression-reporting" class="level3">
<h3 class="anchored" data-anchor-id="solution-excercise-2-simulate-data-and-regression-reporting">Solution Excercise 2: simulate data and regression reporting</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  seed for reproducibility</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for variable A with specified mean and sd</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># define the specified effect size of A on Y</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>beta_A <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data and make data frame in one step</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>df_3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate data for variable A with specified mean and sd</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span>  <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="dv">5</span> <span class="sc">+</span>  <span class="co"># intercept (optional)</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    beta_A <span class="sc">*</span> A <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         A         Y
1 52.23925  87.98766
2 38.43777 106.60413
3 54.22419 107.68437
4 36.75245 117.09730
5 51.41084 133.74473
6 44.63952  70.74512</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  2 variables:
 $ A: num  52.2 38.4 54.2 36.8 51.4 ...
 $ Y: num  88 107 108 117 134 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression of Y on A</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A, <span class="at">data =</span> df_3)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># results </span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(model)</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># nicer report</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Coefficient |    SE |          95% CI | t(98) |      p
--------------------------------------------------------------------
(Intercept) |      109.17 | 14.62 | [80.17, 138.18] |  7.47 | &lt; .001
A           |   -3.80e-03 |  0.28 | [-0.57,   0.56] | -0.01 | 0.989 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict Y with A (formula: Y
~ A). The model explains a statistically not significant and very weak
proportion of variance (R2 = 1.83e-06, F(1, 98) = 1.79e-04, p = 0.989, adj. R2
= -0.01). The model's intercept, corresponding to A = 0, is at 109.17 (95% CI
[80.17, 138.18], t(98) = 7.47, p &lt; .001). Within this model:

  - The effect of A is statistically non-significant and negative (beta =
-3.80e-03, 95% CI [-0.57, 0.56], t(98) = -0.01, p = 0.989; Std. beta =
-1.35e-03, 95% CI [-0.20, 0.20])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
</section>
<section id="appendix-b-how-anova-can-deliver-the-functionality-of-linear-regressions" class="level2">
<h2 class="anchored" data-anchor-id="appendix-b-how-anova-can-deliver-the-functionality-of-linear-regressions">Appendix B: How ANOVA can deliver the functionality of Linear Regressions</h2>
<p>We can get group comparisons with ANOVA, for example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct Tukey's HSD test for post hoc comparisons</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>tukey_post_hoc <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_model)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_post_hoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = y ~ group, data = df_1)

$group
          diff        lwr       upr     p adj
2-1   3.381631  -4.906624  11.66989 0.5958959
3-1 121.072862 112.784607 129.36112 0.0000000
3-2 117.691231 109.402975 125.97949 0.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_post_hoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-content_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Regression and ANOVA are equivalent</p>
</section>
<section id="appendix-c-adding-complexity-in-simulation" class="level2">
<h2 class="anchored" data-anchor-id="appendix-c-adding-complexity-in-simulation">Appendix C: Adding Complexity in Simulation</h2>
<section id="simulating-data-continued" class="level3">
<h3 class="anchored" data-anchor-id="simulating-data-continued">Simulating Data… Continued</h3>
<p>Data frames are used in R to store data tables. To simulate a dataset with both continuous and categorical data, you can combine the above steps:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame with simulated data for ID, Gender, Age, and Income</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>data_frame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate a sequence of IDs from 1 to n</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># randomly assign 'Male' or 'Female' to each observation</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gender =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate 'Age' data: normally distributed with mean 30 and sd 5</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate 'Income' data: normally distributed with mean 50000 and sd 10000</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Income =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50000</span>, <span class="at">sd =</span> <span class="dv">10000</span>)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that you can sample probabilistically for your groups</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># total number of observations</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 'Gender' with a 40/60 proportion for Male/Female</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>Gender <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="more-complexity" class="level3">
<h3 class="anchored" data-anchor-id="more-complexity">More complexity</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the number of observations</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the 'Age' variable</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>sd_age <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>Age <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mean_age, <span class="at">sd =</span> sd_age)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># define coefficients explicitly</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="dv">20000</span>   <span class="co"># Intercept for the income equation</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>beta_age <span class="ot">&lt;-</span> <span class="dv">1500</span>     <span class="co"># Coefficient for the effect of age on income</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>error_sd <span class="ot">&lt;-</span> <span class="dv">10000</span>    <span class="co"># Standard deviation of the error term</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate 'Income' based on 'Age' and defined coefficients</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>Income <span class="ot">&lt;-</span> intercept <span class="sc">+</span> beta_age <span class="sc">*</span> Age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> error_sd)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame to hold the simulated data</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>data_complex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Age, Income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualising-simulated-data" class="level3">
<h3 class="anchored" data-anchor-id="visualising-simulated-data">Visualising Simulated Data</h3>
<p>Visualising your simulated data can help understand its distribution and relationships. Use the <code>ggplot2</code> package for this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_complex, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Income)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simulated Age vs. Income"</span>, <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Income"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-content_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="appendix-d-causal-inference-glossary" class="level2">
<h2 class="anchored" data-anchor-id="appendix-d-causal-inference-glossary">Appendix D: Causal Inference Glossary</h2>
<p>Note, as of yet, we have only encountered several of the terms in this glossary.</p>
<p><a href="../content/glossary.pdf">Glossary of key terms in causal inference</a></p>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - Chang W (2023). _extrafont: Tools for Using Fonts_. R package version 0.19, &lt;https://CRAN.R-project.org/package=extrafont&gt;.
  - Grolemund G, Wickham H (2011). "Dates and Times Made Easy with lubridate." _Journal of Statistical Software_, *40*(3), 1-25. &lt;https://www.jstatsoft.org/v40/i03/&gt;.
  - Lüdecke D (2018). "ggeffects: Tidy Data Frames of Marginal Effects from Regression Models." _Journal of Open Source Software_, *3*(26), 772. doi:10.21105/joss.00772 &lt;https://doi.org/10.21105/joss.00772&gt;.
  - Lüdecke D, Ben-Shachar M, Patil I, Makowski D (2020). "Extracting, Computing and Exploring the Parameters of Statistical Models using R." _Journal of Open Source Software_, *5*(53), 2445. doi:10.21105/joss.02445 &lt;https://doi.org/10.21105/joss.02445&gt;.
  - Makowski D, Lüdecke D, Patil I, Thériault R, Ben-Shachar M, Wiernik B (2023). "Automated Results Reporting as a Practical Tool to Improve Reproducibility and Methodological Best Practices Adoption." _CRAN_. &lt;https://easystats.github.io/report/&gt;.
  - Müller K, Wickham H (2023). _tibble: Simple Data Frames_. R package version 3.2.1, &lt;https://CRAN.R-project.org/package=tibble&gt;.
  - Pedersen T (2024). _patchwork: The Composer of Plots_. R package version 1.3.0, &lt;https://CRAN.R-project.org/package=patchwork&gt;.
  - R Core Team (2024). _R: A Language and Environment for Statistical Computing_. R Foundation for Statistical Computing, Vienna, Austria. &lt;https://www.R-project.org/&gt;.
  - Wickham H (2016). _ggplot2: Elegant Graphics for Data Analysis_. Springer-Verlag New York. ISBN 978-3-319-24277-4, &lt;https://ggplot2.tidyverse.org&gt;.
  - Wickham H (2023). _forcats: Tools for Working with Categorical Variables (Factors)_. R package version 1.0.0, &lt;https://CRAN.R-project.org/package=forcats&gt;.
  - Wickham H (2023). _stringr: Simple, Consistent Wrappers for Common String Operations_. R package version 1.5.1, &lt;https://CRAN.R-project.org/package=stringr&gt;.
  - Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). "Welcome to the tidyverse." _Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 &lt;https://doi.org/10.21105/joss.01686&gt;.
  - Wickham H, François R, Henry L, Müller K, Vaughan D (2023). _dplyr: A Grammar of Data Manipulation_. R package version 1.1.4, &lt;https://CRAN.R-project.org/package=dplyr&gt;.
  - Wickham H, Henry L (2025). _purrr: Functional Programming Tools_. R package version 1.0.4, &lt;https://CRAN.R-project.org/package=purrr&gt;.
  - Wickham H, Hester J, Bryan J (2024). _readr: Read Rectangular Text Data_. R package version 2.1.5, &lt;https://CRAN.R-project.org/package=readr&gt;.
  - Wickham H, Vaughan D, Girlich M (2024). _tidyr: Tidy Messy Data_. R package version 1.3.1, &lt;https://CRAN.R-project.org/package=tidyr&gt;.
  - Xie Y (2024). _tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents_. R package version 0.54, &lt;https://github.com/rstudio/tinytex&gt;. Xie Y (2019). "TinyTeX: A lightweight, cross-platform, and easy-to-maintain LaTeX distribution based on TeX Live." _TUGboat_, *40*(1), 30-32. &lt;https://tug.org/TUGboat/Contents/contents40-1.html&gt;.</code></pre>
</div>
</div>


<!-- -->


</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb62" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Causal diagrams: Five Elementary Structures"</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-MAR-04"</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> /Users/joseph/GIT/templates/bib/references.bib</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co">    warnings: FALSE</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co">    error: FALSE</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">    messages: FALSE</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: kate</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools:</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: FALSE</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="an">html-math-method:</span><span class="co"> katex</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="an">citation-location:</span><span class="co"> margin</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="an">code-block-border-left:</span><span class="co"> true</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: FALSE</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: FALSE</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/libs2.R")</span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/funs.R")</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">ALERT</span><span class="co">: UNCOMMENT THIS AND DOWNLOAD THE FUNCTIONS FROM JB's GITHUB</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a><span class="co"># source(</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a><span class="co"># source(</span></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"</span></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a><span class="co"># for making graphs</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"extrafont"</span>)</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"all"</span>)</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Readings</span></span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Barrett M (2023). _ggdag: Analyze and Create Elegant Directed Acyclic Graphs_. R package version 0.2.7.9000, <span class="ot">&lt;https://github.com/malcolmbarrett/ggdag&gt;</span></span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>"An Introduction to Directed Acyclic Graphs", <span class="ot">&lt;https://r-causal.github.io/ggdag/articles/intro-to-dags.html&gt;</span></span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>"Common Structures of Bias", <span class="ot">&lt;https://r-causal.github.io/ggdag/articles/bias-structures.html&gt;</span></span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key concepts for the test(s):</span></span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Confounding**</span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Causal Directed Acyclic Graph** </span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Five Elementary Causal Structures**</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**d-separation**</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Back door path**</span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Conditioning**</span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Fork bias**</span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Collider bias**</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Mediator bias**</span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Four Rules of Confounding Control**</span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true" tabindex="-1"></a><span class="fu">## Download Your Laboratory R Script Here</span></span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a>Assuming you have installed R and RStudio:</span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Download the R script for Lab 01 by clicking the link below. This script contains the code you will work with during your laboratory session.</span>
<span id="cb62-78"><a href="#cb62-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>After downloading, open RStudio. </span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>In RStudio, create a new R script file by going to <span class="in">`File &gt; New File &gt; R Script`</span>.</span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Create a new<span class="in">`.R`</span> file called <span class="in">`02-lab.R`</span> and provide your name, contact, data, and a brief title such as "Rimulating the basic five basic causal structures in R" </span>
<span id="cb62-84"><a href="#cb62-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-85"><a href="#cb62-85" aria-hidden="true" tabindex="-1"></a>Example: </span>
<span id="cb62-86"><a href="#cb62-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-89"><a href="#cb62-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-90"><a href="#cb62-90" aria-hidden="true" tabindex="-1"></a><span class="co">#  Bob leBob</span></span>
<span id="cb62-91"><a href="#cb62-91" aria-hidden="true" tabindex="-1"></a><span class="co">#  29 Feb 2024</span></span>
<span id="cb62-92"><a href="#cb62-92" aria-hidden="true" tabindex="-1"></a><span class="co">#  bob@lebob.fr</span></span>
<span id="cb62-93"><a href="#cb62-93" aria-hidden="true" tabindex="-1"></a><span class="co">#. Lab 02 - Simulating The Five Basic Structures of Cauality</span></span>
<span id="cb62-94"><a href="#cb62-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-95"><a href="#cb62-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-96"><a href="#cb62-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-97"><a href="#cb62-97" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Copy and paste the code chunks below from your computer onto the script during class. </span>
<span id="cb62-98"><a href="#cb62-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-99"><a href="#cb62-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-100"><a href="#cb62-100" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Save the new R script file in a clearly defined project directory folder for easy access during the lab.</span>
<span id="cb62-101"><a href="#cb62-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-102"><a href="#cb62-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-103"><a href="#cb62-103" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Bring your computer to the lab.  </span>
<span id="cb62-104"><a href="#cb62-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-105"><a href="#cb62-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-106"><a href="#cb62-106" aria-hidden="true" tabindex="-1"></a>Note: you may also download the lab here <span class="co">[</span><span class="ot">Download the R script for Lab 02</span><span class="co">](https://raw.githubusercontent.com/go-bayes/psyc-434-2024/main/laboratory/02-lab.R)</span></span>
<span id="cb62-107"><a href="#cb62-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-108"><a href="#cb62-108" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-109"><a href="#cb62-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-110"><a href="#cb62-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-111"><a href="#cb62-111" aria-hidden="true" tabindex="-1"></a><span class="fu"># Seminar</span></span>
<span id="cb62-112"><a href="#cb62-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-113"><a href="#cb62-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-114"><a href="#cb62-114" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overview </span></span>
<span id="cb62-115"><a href="#cb62-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-116"><a href="#cb62-116" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand basic features of causal diagrams: definitions and applications</span>
<span id="cb62-117"><a href="#cb62-117" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Introduction to the five elementary causal structures</span>
<span id="cb62-118"><a href="#cb62-118" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Lab: Gentle Introduction to Simulation and Regression (TBC over the upcoming weeks)</span>
<span id="cb62-119"><a href="#cb62-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-120"><a href="#cb62-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-121"><a href="#cb62-121" aria-hidden="true" tabindex="-1"></a><span class="fu">### Review</span></span>
<span id="cb62-122"><a href="#cb62-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-123"><a href="#cb62-123" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Psychological research begins with two questions: </span>
<span id="cb62-124"><a href="#cb62-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-125"><a href="#cb62-125" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 1. What do I want to know? </span></span>
<span id="cb62-126"><a href="#cb62-126" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 2. For which population does this knowledge generalise?</span>  </span>
<span id="cb62-127"><a href="#cb62-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-128"><a href="#cb62-128" aria-hidden="true" tabindex="-1"></a>This course considers how to ask psychological questions that pertain to populations with different characteristics </span>
<span id="cb62-129"><a href="#cb62-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-130"><a href="#cb62-130" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>In psychological research, we typically ask questions about the causes and consequences of thought and behaviour - "What if?" questions <span class="co">[</span><span class="ot">@hernan2024WHATIF</span><span class="co">]</span>. </span>
<span id="cb62-131"><a href="#cb62-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-132"><a href="#cb62-132" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The following concepts help us to describe two distinct failure modes in psychological research when asking "What if?" questions:</span>
<span id="cb62-133"><a href="#cb62-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-134"><a href="#cb62-134" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**The Concept of External Validity**: the extent to which the findings of a study can be generalised to other situations, people, settings, and time periods. That is, we want to know if our findings carry beyond the *sample population* to the *target population*.  We fail when our results do not generalise as we think.  More fundamentally, we fail when we have not clearly defined our question or our target population.</span>
<span id="cb62-135"><a href="#cb62-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-136"><a href="#cb62-136" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**The Concept of Internal Validity**: the extent to which the associations we obtain from data reflect causality. In psychological science, we use "independent variable" and "dependent variable." Sometimes we use the terms "exogenous variable" and "endogenous variable."  Sometimes we use the term "predictor variable" to describe the "dependent" or "endogenous" variable. These words are confusing.  When asking "What if?" questions, we want to understand what would happen if we intervened.  In this course, we will use the term "treatment" or, equivalently the term "exposure" to denote the intervention; we will use the term "outcome" to denote the effect of an intervention.<span class="ot">[^note]</span></span>
<span id="cb62-137"><a href="#cb62-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-138"><a href="#cb62-138" aria-hidden="true" tabindex="-1"></a><span class="ot">[^note]: </span>"What if?" questions implicitly invoke the idea of intervening on the world. "If we did *this*, *then* what would happen to *that*...?" Our preferred terminology reflects our interest in the effects of interventions.</span>
<span id="cb62-139"><a href="#cb62-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-140"><a href="#cb62-140" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>During the first part of the course, our primary focus will be on challenges to internal validity from **confounding bias.**  </span>
<span id="cb62-141"><a href="#cb62-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-142"><a href="#cb62-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-143"><a href="#cb62-143" aria-hidden="true" tabindex="-1"></a><span class="fu">## Definitions</span></span>
<span id="cb62-144"><a href="#cb62-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-145"><a href="#cb62-145" aria-hidden="true" tabindex="-1"></a>::: {#def-internal-validity}</span>
<span id="cb62-146"><a href="#cb62-146" aria-hidden="true" tabindex="-1"></a>We say internal validity is compromised if the association between the treatment and outcome in a study does not consistently reflect causality in the sample population as defined at baseline.</span>
<span id="cb62-147"><a href="#cb62-147" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-148"><a href="#cb62-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-149"><a href="#cb62-149" aria-hidden="true" tabindex="-1"></a>::: {#def-external-validity}</span>
<span id="cb62-150"><a href="#cb62-150" aria-hidden="true" tabindex="-1"></a>We say external validity is compromised if the association between the treatment and outcome in a study does not consistently reflect causality in the target population as defined at baseline.</span>
<span id="cb62-151"><a href="#cb62-151" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-152"><a href="#cb62-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-153"><a href="#cb62-153" aria-hidden="true" tabindex="-1"></a>The concept of "confounding bias" helps to clarify what it is at stake when evaluating the *internal validity* of a study.  As we shall see, there are several equivalent definitions of "confounding bias," which we will describe during the upcoming weeks. </span>
<span id="cb62-154"><a href="#cb62-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-155"><a href="#cb62-155" aria-hidden="true" tabindex="-1"></a>The definition of confounding bias that we will examine today is:</span>
<span id="cb62-156"><a href="#cb62-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-157"><a href="#cb62-157" aria-hidden="true" tabindex="-1"></a>::: {#def-confounding}</span>
<span id="cb62-158"><a href="#cb62-158" aria-hidden="true" tabindex="-1"></a>We say there is confounding bias if there is an open back-door path between the treatment and outcome or if the path between the treatment and outcome is blocked.</span>
<span id="cb62-159"><a href="#cb62-159" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-160"><a href="#cb62-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-161"><a href="#cb62-161" aria-hidden="true" tabindex="-1"></a>Today, our purpose will be to clarify the meaning of each term in this definition. To that end, we will introduce the five elementary graphical structures employed in causal diagrams. We will then explain the four elementary rules that allow investigators to identify causal effects from the asserted relations in a causal diagram. First, what are causal diagrams? </span>
<span id="cb62-162"><a href="#cb62-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-163"><a href="#cb62-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-164"><a href="#cb62-164" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction to Causal Diagrams.</span></span>
<span id="cb62-165"><a href="#cb62-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-166"><a href="#cb62-166" aria-hidden="true" tabindex="-1"></a>Causal diagrams, also called causal graphs, Directed Acyclic Graphs, and Causal Directed Acyclic Graphs, are graphical tools whose primary purpose is to enable investigators to detect confounding biases.</span>
<span id="cb62-167"><a href="#cb62-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-168"><a href="#cb62-168" aria-hidden="true" tabindex="-1"></a>**Remarkably, causal diagrams are rarely used in psychology!**</span>
<span id="cb62-169"><a href="#cb62-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-170"><a href="#cb62-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-171"><a href="#cb62-171" aria-hidden="true" tabindex="-1"></a>Before describing how causal diagrams work, we first define the meanings of their symbols. Note there is no single convention for creating causal diagrams, so it is important that we are clear when defining our meanings.</span>
<span id="cb62-172"><a href="#cb62-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-173"><a href="#cb62-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-174"><a href="#cb62-174" aria-hidden="true" tabindex="-1"></a><span class="fu">### The meaning of our symbols</span></span>
<span id="cb62-175"><a href="#cb62-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-176"><a href="#cb62-176" aria-hidden="true" tabindex="-1"></a>The conventions that describe the meanings of our symbols are given in @fig-conventions.</span>
<span id="cb62-177"><a href="#cb62-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-178"><a href="#cb62-178" aria-hidden="true" tabindex="-1"></a>::: {#fig-conventions}</span>
<span id="cb62-179"><a href="#cb62-179" aria-hidden="true" tabindex="-1"></a><span class="al">![](terminologylocalconventions.pdf)</span>{fig-align="left" height=100% width=100%}</span>
<span id="cb62-180"><a href="#cb62-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-181"><a href="#cb62-181" aria-hidden="true" tabindex="-1"></a>Our variable naming conventions. This figure is adapted from <span class="co">[</span><span class="ot">@bulbulia2023</span><span class="co">]</span></span>
<span id="cb62-182"><a href="#cb62-182" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-183"><a href="#cb62-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-184"><a href="#cb62-184" aria-hidden="true" tabindex="-1"></a>For us:</span>
<span id="cb62-185"><a href="#cb62-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-186"><a href="#cb62-186" aria-hidden="true" tabindex="-1"></a>$X$ denotes a variable without reference to its role;</span>
<span id="cb62-187"><a href="#cb62-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-188"><a href="#cb62-188" aria-hidden="true" tabindex="-1"></a>$A$ denotes the "treatment" or "exposure" variable. This is the variable for which we seek to understand the effect of intervening on it. It is the "cause;" </span>
<span id="cb62-189"><a href="#cb62-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-190"><a href="#cb62-190" aria-hidden="true" tabindex="-1"></a>$Y$ denotes the outcome or response of an intervention. It is the "effect." Last week we considered whether marriage $A$ causes happiness $Y$.</span>
<span id="cb62-191"><a href="#cb62-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-192"><a href="#cb62-192" aria-hidden="true" tabindex="-1"></a>$Y(a)$ denotes the counterfactual or potential state of $Y$ in response to setting the level of the exposure to a specific level, $A=a$. As we will consider in the second half of the course, to consistently estimate causal effects we will need to evaluate counterfactual or potential states of the world.  Keeping to our example, we will need to do more than evaluate marriage and happiness in people over time. We will need to evaluate how happy the unmarried people would have been had they been married and how happy the married people would have been had they not been married. Of course, these events cannot be directly observed. Thus to address fundamental questions in psychology, we need to contrast counterfactual states of the world. This might seem like science fiction; however, we are already familiar with methods for obtaining such counterfactual contrasts -- namely, randomised controlled experiments! We will return to this concept later, but for now, it will be useful for you to understand the notation. </span>
<span id="cb62-193"><a href="#cb62-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-194"><a href="#cb62-194" aria-hidden="true" tabindex="-1"></a>$L$ denotes a measured confounder or set of confounders is defined as a variable which, if conditioned upon, closes an open back-door path between the treatment $A$ and the outcome $Y$.  Consider the scenario where happiness at time 0 ($L$) affects both the probability of getting married at time 1 ($A$) and one's happiness at time 2 ($Y$). In this case, $L$ serves as a confounder because it influences both the treatment (marriage at time 1) and the outcome (happiness at time 2), potentially opening a back-door path that confounds the estimated effect of marriage on happiness.</span>
<span id="cb62-195"><a href="#cb62-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-196"><a href="#cb62-196" aria-hidden="true" tabindex="-1"></a>To accurately estimate the causal effect of marriage on happiness, then, it is essential to control for $L$. With cross-sectional data, such control might be difficult. </span>
<span id="cb62-197"><a href="#cb62-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-198"><a href="#cb62-198" aria-hidden="true" tabindex="-1"></a>$U$ denotes an unmeasured confounder -- that is a variable that may affect both the treatment and the outcome, but for which we have no direct measurement. Suppose cultural upbringing affects both whether someone gets married and whether they are happy.  If this variable is not measured, we cannot accurately estimate a causal effect of marriage on happiness.</span>
<span id="cb62-199"><a href="#cb62-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-200"><a href="#cb62-200" aria-hidden="true" tabindex="-1"></a>$M$ denotes a mediator or a variable along the path from exposure to outcome. For example, perhaps marriage causes wealth and wealth causes happiness. As we shall see, conditioning on "wealth" when estimating the effect of marriage on happiness will make it seem that marriage does not cause happiness when it does, *through* wealth.</span>
<span id="cb62-201"><a href="#cb62-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-202"><a href="#cb62-202" aria-hidden="true" tabindex="-1"></a>$\bar{X}$ denotes a sequence of variables, for example, a sequence of treatments.  Imagine we were interested in the causal effect of marriage and remarriage on well-being. In this case, there are two treatments $A_0$ and $A_1$ and four potential contrasts. For the scenario of marriage and remarriage affecting well-being, we denote the potential outcomes as $Y(a_0, a_1)$, where $a_0$ and $a_1$ represent the specific values taken by $A_0$ and $A_1$, respectively. Given two treatments, $A_0$ and $A_1$, four primary contrasts of interest correspond to the different combinations of these treatments. These contrasts allow us to compare the causal effects of being married versus not and remarried versus not on well-being. The potential outcomes under these conditions can be specified as follows:</span>
<span id="cb62-203"><a href="#cb62-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-204"><a href="#cb62-204" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$Y(0, 0)$: The potential outcome when there is no marriage.</span>
<span id="cb62-205"><a href="#cb62-205" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>$Y(0, 1)$: The potential outcome when there is marriage. </span>
<span id="cb62-206"><a href="#cb62-206" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>$Y(1, 0)$: The potential outcome when there is divorce.</span>
<span id="cb62-207"><a href="#cb62-207" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>$Y(1, 1)$: The potential outcome from marriage prevalence.</span>
<span id="cb62-208"><a href="#cb62-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-209"><a href="#cb62-209" aria-hidden="true" tabindex="-1"></a>Each of these outcomes allows for a specific contrast to be made, comparing the well-being under different scenarios of marriage and remarriage. Which do we want to contrast?  Note, the question about 'the causal effects of marriage on happiness' is ambiguous because we have not stated the causal contrast we are interested in. </span>
<span id="cb62-210"><a href="#cb62-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-211"><a href="#cb62-211" aria-hidden="true" tabindex="-1"></a>$\mathcal{R}$ denotes a randomisation or a chance event.</span>
<span id="cb62-212"><a href="#cb62-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-213"><a href="#cb62-213" aria-hidden="true" tabindex="-1"></a><span class="fu">### Elements of our Causal Graphs </span></span>
<span id="cb62-214"><a href="#cb62-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-215"><a href="#cb62-215" aria-hidden="true" tabindex="-1"></a>The conventions that describe components of our causal graphs are given in @fig-general.</span>
<span id="cb62-216"><a href="#cb62-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-217"><a href="#cb62-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-218"><a href="#cb62-218" aria-hidden="true" tabindex="-1"></a>::: {#fig-general}</span>
<span id="cb62-219"><a href="#cb62-219" aria-hidden="true" tabindex="-1"></a><span class="al">![](terminologygeneral.pdf)</span>{fig-align="left" height=100% width=100%}</span>
<span id="cb62-220"><a href="#cb62-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-221"><a href="#cb62-221" aria-hidden="true" tabindex="-1"></a>Nodes, Edges, Conditioning Conventions. This figure is adapted from <span class="co">[</span><span class="ot">@bulbulia2023</span><span class="co">]</span></span>
<span id="cb62-222"><a href="#cb62-222" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-223"><a href="#cb62-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-224"><a href="#cb62-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-225"><a href="#cb62-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-226"><a href="#cb62-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-227"><a href="#cb62-227" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Time indexing</span></span>
<span id="cb62-228"><a href="#cb62-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-229"><a href="#cb62-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-230"><a href="#cb62-230" aria-hidden="true" tabindex="-1"></a>In our causal diagrams, we will implement two conventions to accurately depict the temporal order of events.</span>
<span id="cb62-231"><a href="#cb62-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-232"><a href="#cb62-232" aria-hidden="true" tabindex="-1"></a>First, the layout of a causal diagram will be structured from left to right to reflect the sequence of causality as it unfolds in reality. This orientation is crucial because causal diagrams must inherently be acyclic and because causality itself is inherently temporal. </span>
<span id="cb62-233"><a href="#cb62-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-234"><a href="#cb62-234" aria-hidden="true" tabindex="-1"></a>Second, we will enhance the representation of the event sequence within our diagrams by systematically indexing our nodes according to the relative timing of events. If an event represented by $X_0$ precedes another event represented by $X_1$, the indexing will indicate this chronological order.</span>
<span id="cb62-235"><a href="#cb62-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-236"><a href="#cb62-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-237"><a href="#cb62-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-238"><a href="#cb62-238" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Representing uncertainty in timing explicitly</span></span>
<span id="cb62-239"><a href="#cb62-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-240"><a href="#cb62-240" aria-hidden="true" tabindex="-1"></a>In settings in which the sequence of events is ambiguous or cannot be definitively known, particularly in the context of cross-sectional data where all measurements are taken at a single point in time, we adopt a specific convention to express causality under uncertainty: $X_{\phi t}$. This notation allows us to propose a temporal order without clear, time-specific measurements, acknowledging our speculation.</span>
<span id="cb62-241"><a href="#cb62-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-242"><a href="#cb62-242" aria-hidden="true" tabindex="-1"></a>For instance, when the timing between events is unclear, we denote an event that is presumed to occur first as $X_{\phi 0}$ and a subsequent event as $X_{\phi 1}$, indicating a tentative ordering where $X_{\phi 0}$ is thought to precede $X_{\phi 1}$. However, it is essential to underscore that this notation signals our uncertainty regarding the actual timing of events; our measurements do not give us the confidence to assert this sequence definitively.</span>
<span id="cb62-243"><a href="#cb62-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-244"><a href="#cb62-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-245"><a href="#cb62-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-246"><a href="#cb62-246" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Arrows</span></span>
<span id="cb62-247"><a href="#cb62-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-248"><a href="#cb62-248" aria-hidden="true" tabindex="-1"></a>As indicated in @fig-general, black arrows denote causality, red arrows reveal an open backdoor path, dashed black arrows denote attenuation, and red dashed arrows denote bias in a true causal association between $A$ and $Y$. Finally, a blue arrow with a circle point denotes effect-measure modification, also known as "effect modification."  We might be interested in treatment effect heterogeneity without evaluating the causality in the sources of this heterogeneity.  For example, we cannot typically imagine any intervention in which people could be randomised into cultures.  However, we may be interested in whether the effects of an intervention that might be manipulable, such as marriage, differ by culture.  To clarify this interest, we require a non-causal arrow. </span>
<span id="cb62-249"><a href="#cb62-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-250"><a href="#cb62-250" aria-hidden="true" tabindex="-1"></a>$\mathcal{R}\to A$ denotes a random treatment assignment. </span>
<span id="cb62-251"><a href="#cb62-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-252"><a href="#cb62-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-253"><a href="#cb62-253" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Boxes</span></span>
<span id="cb62-254"><a href="#cb62-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-255"><a href="#cb62-255" aria-hidden="true" tabindex="-1"></a>We use a black box to denote conditioning that reduces confounding or that is inert. </span>
<span id="cb62-256"><a href="#cb62-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-257"><a href="#cb62-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-258"><a href="#cb62-258" aria-hidden="true" tabindex="-1"></a>We use a red box to describe settings in which conditioning on a variable introduces confounding bias. </span>
<span id="cb62-259"><a href="#cb62-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-260"><a href="#cb62-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-261"><a href="#cb62-261" aria-hidden="true" tabindex="-1"></a>Occasionally we will use a dashed circle do denote a latent variable, that is, a variable that is either not measured or not conditioned upon. </span>
<span id="cb62-262"><a href="#cb62-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-263"><a href="#cb62-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-264"><a href="#cb62-264" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Terminology for Conditional Independence</span></span>
<span id="cb62-265"><a href="#cb62-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-266"><a href="#cb62-266" aria-hidden="true" tabindex="-1"></a>The bottom panel of @fig-general shows some mathematical notation. Do not be alarmed, we are safe! Part 1 of the course will not require more complicated math than this notation. And we shall see that the notation is a compact way to describe intuitions that can be expressed less compactly in words:</span>
<span id="cb62-267"><a href="#cb62-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-268"><a href="#cb62-268" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Statistical Independence ($\coprod$):** in the context of causal inference, statistical independence between the treatment and potential outcomes, denoted as $A \coprod Y(a)$, means the treatment assignment is independent of the potential outcomes. This assumption is critical for estimating causal effects without bias.</span>
<span id="cb62-269"><a href="#cb62-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-270"><a href="#cb62-270" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Statistical Dependence ($\cancel\coprod$):** conversely, $\cancel\coprod$ denotes statistical dependence, indicating that the distribution of one variable is influenced by the other. For example, $A \cancel\coprod Y(a)$ implies that the treatment assignment is related to the potential outcomes, potentially introducing bias into causal estimates.</span>
<span id="cb62-271"><a href="#cb62-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-272"><a href="#cb62-272" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Conditioning ($|$):** conditioning, denoted by the vertical line $|$, allows for specifying contexts or conditions under which independence or dependence holds.</span>
<span id="cb62-273"><a href="#cb62-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-274"><a href="#cb62-274" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>**Conditional Independence ($A \coprod Y(a)|L$):** This means that once we account for a set of variables $L$, the treatment and potential outcomes are independent. This condition is often the basis for strategies aiming to control for confounding.</span>
<span id="cb62-275"><a href="#cb62-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-276"><a href="#cb62-276" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>**Conditional Dependence ($A \cancel\coprod Y(a)|L$):** States that potential outcomes and treatments are not independent after conditioning on $L$, indicating a need for careful consideration in the analysis to avoid biased causal inferences.</span>
<span id="cb62-277"><a href="#cb62-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-278"><a href="#cb62-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-279"><a href="#cb62-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-280"><a href="#cb62-280" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Five Elementary Structures of Causality</span></span>
<span id="cb62-281"><a href="#cb62-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-282"><a href="#cb62-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-283"><a href="#cb62-283" aria-hidden="true" tabindex="-1"></a>Judea Pearl proved that all elementary structures of causality can be represented graphically <span class="co">[</span><span class="ot">@pearl2009a</span><span class="co">]</span>.  @fig-directedgraph presents this five elementary structures. </span>
<span id="cb62-284"><a href="#cb62-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-285"><a href="#cb62-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-286"><a href="#cb62-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-287"><a href="#cb62-287" aria-hidden="true" tabindex="-1"></a>::: {#fig-directedgraph}</span>
<span id="cb62-288"><a href="#cb62-288" aria-hidden="true" tabindex="-1"></a><span class="al">![](terminologydirectedgraph.pdf)</span>{fig-align="left" height=100% width=100%}</span>
<span id="cb62-289"><a href="#cb62-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-290"><a href="#cb62-290" aria-hidden="true" tabindex="-1"></a>Five elementary structures. This figure is adapted from <span class="co">[</span><span class="ot">@bulbulia2023</span><span class="co">]</span>.</span>
<span id="cb62-291"><a href="#cb62-291" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-292"><a href="#cb62-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-293"><a href="#cb62-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-294"><a href="#cb62-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-295"><a href="#cb62-295" aria-hidden="true" tabindex="-1"></a>The structures are as follows: </span>
<span id="cb62-296"><a href="#cb62-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-297"><a href="#cb62-297" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Two Variables:**</span>
<span id="cb62-298"><a href="#cb62-298" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>**Causality Absent:** There is no causal effect between variables $A$ and $B$. They do not influence each other, denoted as $A \coprod B$, indicating they are statistically independent.</span>
<span id="cb62-299"><a href="#cb62-299" aria-hidden="true" tabindex="-1"></a><span class="ss">    2. </span>**Causality:** Variable $A$ causally affects variable $B$. This relationship suggests an association between them, denoted as $A \cancel\coprod B$, indicating they are statistically dependent.</span>
<span id="cb62-300"><a href="#cb62-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-301"><a href="#cb62-301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Three Variables:**</span>
<span id="cb62-302"><a href="#cb62-302" aria-hidden="true" tabindex="-1"></a><span class="ss">    3. </span>**Fork:** Variable $A$ causally affects both $B$ and $C$. Variables $B$ and $C$ are conditionally independent given $A$, denoted as $B \coprod C | A$. This structure implies that knowing $A$ removes any association between $B$ and $C$ due to their common cause.</span>
<span id="cb62-303"><a href="#cb62-303" aria-hidden="true" tabindex="-1"></a><span class="ss">    4. </span>**Chain:** A causal chain exists where $C$ is affected by $B$, which in turn is affected by $A$. Variables $A$ and $C$ are conditionally independent given $B$, denoted as $A \coprod C | B$. This indicates that $B$ mediates the effect of $A$ on $C$, and knowing $B$ breaks the association between $A$ and $C$.</span>
<span id="cb62-304"><a href="#cb62-304" aria-hidden="true" tabindex="-1"></a><span class="ss">    5. </span>**Collider:** Variable $C$ is affected by both $A$ and $B$, which are independent. However, conditioning on $C$ induces an association between $A$ and $B$, denoted as $A \cancel\coprod B | C$. This structure is unique because it suggests that $A$ and $B$, while initially independent, become associated when we account for their common effect $C$.</span>
<span id="cb62-305"><a href="#cb62-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-306"><a href="#cb62-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-307"><a href="#cb62-307" aria-hidden="true" tabindex="-1"></a>Once we understand the basic relationships between two variables, we can build upon these to create more complex relationships. These structures help us see how statistical independences and dependencies emerge from the data, allowing us to clarify the causal relationships we presume exist. Such clarity is crucial for ensuring that confounders are balanced across treatment groups, given all measured confounders, so that $Y(a) \coprod A | L$.</span>
<span id="cb62-308"><a href="#cb62-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-309"><a href="#cb62-309" aria-hidden="true" tabindex="-1"></a>You might wonder, "If not from the data, where do our assumptions about causality come from?" This question will come up repeatedly throughout the course. The short answer is that our assumptions are based on existing knowledge. This reliance on current knowledge might seem counterintuitive for buiding scientific knowledge-— shouldn't we use data to build knowledge, not the other way around? Yes, but it is not that straightforward. Data often hold the answers we're looking for but can be ambiguous. When the causal structure is unclear, it is important to sketch out different causal diagrams, explore their implications, and, if necessary, conduct separate analyses based on these diagrams.</span>
<span id="cb62-310"><a href="#cb62-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-311"><a href="#cb62-311" aria-hidden="true" tabindex="-1"></a>Otto Neurath, an Austrian philosopher and a member of the Vienna Circle, famously used the metaphor of a ship that must be rebuilt at sea to describe the process of scientific theory and knowledge development. </span>
<span id="cb62-312"><a href="#cb62-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-313"><a href="#cb62-313" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Duhem has shown ... that every statement about any happening is saturated with hypotheses of all sorts and that these in the end are derived from our whole world-view. We are like sailors who on the open sea must reconstruct their ship but are never able to start afresh from the bottom. Where a beam is taken away a new one must at once be put there, and for this the rest of the ship is used as support. In this way, by using the old beams and driftwood, the ship can be shaped entirely anew, but only by gradual reconstruction. </span><span class="co">[</span><span class="ot">@neurath1973, p.199</span><span class="co">]</span></span>
<span id="cb62-314"><a href="#cb62-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-315"><a href="#cb62-315" aria-hidden="true" tabindex="-1"></a>This quotation emphasises the iterative process that accumulates scientific knowledge;  new insights are cast from the foundation of existing knowledge. Causal diagrams are at home in Neurath's boat. The tradition of science that believes that knowledge develops from the results of statistical tests applied to data should be resisted. The data alone typically do not contain the answers we seek.</span>
<span id="cb62-316"><a href="#cb62-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-317"><a href="#cb62-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-318"><a href="#cb62-318" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Four Rules of Confounding Control</span></span>
<span id="cb62-319"><a href="#cb62-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-320"><a href="#cb62-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-321"><a href="#cb62-321" aria-hidden="true" tabindex="-1"></a>@fig-terminologyconfounders describe the four elementary rules of confounding control:</span>
<span id="cb62-322"><a href="#cb62-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-323"><a href="#cb62-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-324"><a href="#cb62-324" aria-hidden="true" tabindex="-1"></a>::: {#fig-terminologyconfounders}</span>
<span id="cb62-325"><a href="#cb62-325" aria-hidden="true" tabindex="-1"></a><span class="al">![](terminologyelconfounders.pdf)</span>{fig-align="left" height=100% width=100%}</span>
<span id="cb62-326"><a href="#cb62-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-327"><a href="#cb62-327" aria-hidden="true" tabindex="-1"></a>Four rules of confounding control</span>
<span id="cb62-328"><a href="#cb62-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-329"><a href="#cb62-329" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb62-330"><a href="#cb62-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-331"><a href="#cb62-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-332"><a href="#cb62-332" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Condition on Common Cause or its Proxy**: this rule applies to settings in which the treatment ($A$) and the outcome ($Y$) share common causes. By conditioning on these common causes, we block the open backdoor paths that could introduce bias into our causal estimates. Controlling for these common causes (or their proxies) helps tp isolate the specific effect of $A$ on $Y$. (We do not draw a path from $ A \to Y$ because we do not assume this path.)</span>
<span id="cb62-333"><a href="#cb62-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-334"><a href="#cb62-334" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Do Not Condition on a Mediator**:  this rule applies to settings in which the variable $L$ is a mediator of $A \to Y$. Here, conditioning on a mediator will bias the total causal effect estimate. Later in the course, we will discuss the assumptions required for causal mediation.  For now, if we are interested in total effect estimates, we must not condition on a mediator.  Here we draw the path from $A \to Y$ to ensure that if such a path exists, it will not become biased from our conditioning strategy. </span>
<span id="cb62-335"><a href="#cb62-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-336"><a href="#cb62-336" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Do Not Condition on a Collider**: this rule applies to settings in which we $L$ is a common effect of $A$ and $Y$. Conditioning on a collider may invoke a spurious association.  Last week we considered an example in which marriage caused wealth and happiness caused wealth. Conditioning on wealth in this setting will induce an association between happiness and marriage. Why?  If we know the outcome, wealth, then we know there are at least two ways of wealth.  Among those wealthy but low on happiness, we can predict that they are more likely to be married, for how else would they be wealthy? Similarly, among those who are wealthy and are not married, we can predict that they are happy, for how else would they be wealthy if not through marriage? These relationships are predictable entirely without a causal association between marriage and happiness!</span>
<span id="cb62-337"><a href="#cb62-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-338"><a href="#cb62-338" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Proxy Rule: Conditioning on a Descendent Is Akin to Conditioning on Its Parent**: this rule applies to settings in which we $L’$ is an effect from another variable $L$.  The graph considers when $L’$ is downstream of a collider.  For example, suppose we condition on home ownership, which is an effect of wealth. Such conditioning will open up a non-causal path without causation because home ownership is a proxy for wealth.  Consider, if someone owns a house but is not married, they are more likely to be happy, for how else could they accumulate the wealth required for home ownership?  Likewise, if someone is unhappy and owns a house, we can infer that they are more likely to be married because how else would they be wealthy? Conditioning on a proxy for a collider here is akin to conditioning on the collider itself.  </span>
<span id="cb62-339"><a href="#cb62-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-340"><a href="#cb62-340" aria-hidden="true" tabindex="-1"></a>However, we can also use the proxy rule to reduce bias. Return to the earlier example in which there is an unmeasured common cause of marriage and happiness, which we called "cultural upbringing"  Suppose we have not measured this variable but have measured proxies for this variable, such as country of birth, childhood religion, number of languages one speaks, and others.  By controlling for baseline values of these proxies, we can exert more control over unmeasured confounding. Even if bias is not eliminated, we should reduce bias wherever possible, which includes not introducing new biases, such as mediator bias, along the way.  Later in the course, we will teach you how to perform sensitivity analyses to verify the robustness of your results to unmeasured confounding.  Sensitivity analysis is critical because where the data are observational, we cannot entirely rule out unmeasured confounding. </span>
<span id="cb62-341"><a href="#cb62-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-342"><a href="#cb62-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-343"><a href="#cb62-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-344"><a href="#cb62-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-345"><a href="#cb62-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-346"><a href="#cb62-346" aria-hidden="true" tabindex="-1"></a><span class="fu"># Lab -- Regression in R, Graphing, and Elements of Simulation </span></span>
<span id="cb62-347"><a href="#cb62-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-348"><a href="#cb62-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-349"><a href="#cb62-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-350"><a href="#cb62-350" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulating Data in R:  `Outcome ~ Treatment`</span></span>
<span id="cb62-351"><a href="#cb62-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-352"><a href="#cb62-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-353"><a href="#cb62-353" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 1: Set Up Your R Environment</span></span>
<span id="cb62-354"><a href="#cb62-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-355"><a href="#cb62-355" aria-hidden="true" tabindex="-1"></a>Ensure R or RStudio is installed and open. </span>
<span id="cb62-356"><a href="#cb62-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-357"><a href="#cb62-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-358"><a href="#cb62-358" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 2: Set a Seed for Reproducibility</span></span>
<span id="cb62-359"><a href="#cb62-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-360"><a href="#cb62-360" aria-hidden="true" tabindex="-1"></a>To ensure that your simulated data can be reproduced exactly. Again, it is good practice to set a seed before generating random data. This makes your analyses and simulations replicable.</span>
<span id="cb62-361"><a href="#cb62-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-364"><a href="#cb62-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-365"><a href="#cb62-365" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># use any number to set the seed</span></span>
<span id="cb62-366"><a href="#cb62-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-367"><a href="#cb62-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-368"><a href="#cb62-368" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 3: Simulate Continuous Data: One Variable </span></span>
<span id="cb62-369"><a href="#cb62-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-370"><a href="#cb62-370" aria-hidden="true" tabindex="-1"></a>To simulate continuous data, you can use functions like <span class="in">`rnorm()`</span> for normal distributions, <span class="in">`runif()`</span> for uniform distributions, etc. Here we simulate 100 normally distributed data points with a mean of 50 and a standard deviation of 10:</span>
<span id="cb62-371"><a href="#cb62-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-374"><a href="#cb62-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-375"><a href="#cb62-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb62-376"><a href="#cb62-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-377"><a href="#cb62-377" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of observations</span></span>
<span id="cb62-378"><a href="#cb62-378" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb62-379"><a href="#cb62-379" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb62-380"><a href="#cb62-380" aria-hidden="true" tabindex="-1"></a>data_continuous <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mean, sd)</span>
<span id="cb62-381"><a href="#cb62-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-382"><a href="#cb62-382" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb62-383"><a href="#cb62-383" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_continuous)</span>
<span id="cb62-384"><a href="#cb62-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-385"><a href="#cb62-385" aria-hidden="true" tabindex="-1"></a><span class="co"># view using base R histogram</span></span>
<span id="cb62-386"><a href="#cb62-386" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_continuous)</span>
<span id="cb62-387"><a href="#cb62-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-388"><a href="#cb62-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-389"><a href="#cb62-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-390"><a href="#cb62-390" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 4: Simulate Categorical Data</span></span>
<span id="cb62-391"><a href="#cb62-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-392"><a href="#cb62-392" aria-hidden="true" tabindex="-1"></a>Categorical data can be simulated using the <span class="in">`sample()`</span> function. Here, we simulate a binary variable (gender) with two levels for 100 observations. There is equal probability of assignment.</span>
<span id="cb62-393"><a href="#cb62-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-396"><a href="#cb62-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-397"><a href="#cb62-397" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>)</span>
<span id="cb62-398"><a href="#cb62-398" aria-hidden="true" tabindex="-1"></a>data_categorical <span class="ot">&lt;-</span> <span class="fu">sample</span>(levels, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-399"><a href="#cb62-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-400"><a href="#cb62-400" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb62-401"><a href="#cb62-401" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_categorical)</span>
<span id="cb62-402"><a href="#cb62-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-403"><a href="#cb62-403" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb62-404"><a href="#cb62-404" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_categorical)</span>
<span id="cb62-405"><a href="#cb62-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-406"><a href="#cb62-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-407"><a href="#cb62-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-408"><a href="#cb62-408" aria-hidden="true" tabindex="-1"></a>To generate categories with unequal probabilities, you can use the <span class="in">`sample()`</span> function by specifying the <span class="in">`prob`</span> parameter, which defines the probability of selecting each level. This allows for simulating categorical data where the distribution between categories is not uniform. </span>
<span id="cb62-409"><a href="#cb62-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-410"><a href="#cb62-410" aria-hidden="true" tabindex="-1"></a>Below is an example that modifies your initial code to create a categorical variable with unequal probabilities for "Male" and "Female". Here is an example with unequal probabilities:</span>
<span id="cb62-411"><a href="#cb62-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-414"><a href="#cb62-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-415"><a href="#cb62-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb62-416"><a href="#cb62-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb62-417"><a href="#cb62-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-418"><a href="#cb62-418" aria-hidden="true" tabindex="-1"></a><span class="co"># define levels and number of observations</span></span>
<span id="cb62-419"><a href="#cb62-419" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>)</span>
<span id="cb62-420"><a href="#cb62-420" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># total number of observations</span></span>
<span id="cb62-421"><a href="#cb62-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-422"><a href="#cb62-422" aria-hidden="true" tabindex="-1"></a><span class="co"># generate categorical data with unequal probabilities</span></span>
<span id="cb62-423"><a href="#cb62-423" aria-hidden="true" tabindex="-1"></a>data_categorical_unequal <span class="ot">&lt;-</span> <span class="fu">sample</span>(levels, n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>))</span>
<span id="cb62-424"><a href="#cb62-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-425"><a href="#cb62-425" aria-hidden="true" tabindex="-1"></a><span class="co"># view the first few elements</span></span>
<span id="cb62-426"><a href="#cb62-426" aria-hidden="true" tabindex="-1"></a><span class="co"># head(data_categorical_unequal)</span></span>
<span id="cb62-427"><a href="#cb62-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-428"><a href="#cb62-428" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb62-429"><a href="#cb62-429" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_categorical_unequal)</span>
<span id="cb62-430"><a href="#cb62-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-431"><a href="#cb62-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-432"><a href="#cb62-432" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulating Outcomes from Treatments</span></span>
<span id="cb62-433"><a href="#cb62-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-434"><a href="#cb62-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-435"><a href="#cb62-435" aria-hidden="true" tabindex="-1"></a>In this example, the <span class="in">`prob`</span> parameter is set to <span class="in">`c(0.3, 0.7)`</span>, indicating a 30% probability for "Male" and a 70% probability for "Female". This results in a simulated dataset where approximately 30% of the observations are "Male" and 70% are "Female", reflecting the specified unequal probabilities. Adjust the probabilities as needed to fit the scenario you wish to simulate.</span>
<span id="cb62-436"><a href="#cb62-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-437"><a href="#cb62-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-438"><a href="#cb62-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r simulate-data}</span></span>
<span id="cb62-439"><a href="#cb62-439" aria-hidden="true" tabindex="-1"></a><span class="co">#|fig-cap: "Box plot of simulated scores by groups."</span></span>
<span id="cb62-440"><a href="#cb62-440" aria-hidden="true" tabindex="-1"></a><span class="co"># note: running this code will do no harm if the libraries are already installed.</span></span>
<span id="cb62-441"><a href="#cb62-441" aria-hidden="true" tabindex="-1"></a><span class="co"># install (if necessary) libraries</span></span>
<span id="cb62-442"><a href="#cb62-442" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb62-443"><a href="#cb62-443" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb62-444"><a href="#cb62-444" aria-hidden="true" tabindex="-1"></a><span class="co"># graphs</span></span>
<span id="cb62-445"><a href="#cb62-445" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggplot2)) {</span>
<span id="cb62-446"><a href="#cb62-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb62-447"><a href="#cb62-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb62-448"><a href="#cb62-448" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-449"><a href="#cb62-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb62-450"><a href="#cb62-450" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-451"><a href="#cb62-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-452"><a href="#cb62-452" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling</span></span>
<span id="cb62-453"><a href="#cb62-453" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {</span>
<span id="cb62-454"><a href="#cb62-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb62-455"><a href="#cb62-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb62-456"><a href="#cb62-456" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-457"><a href="#cb62-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb62-458"><a href="#cb62-458" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-459"><a href="#cb62-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-460"><a href="#cb62-460" aria-hidden="true" tabindex="-1"></a><span class="co"># tables</span></span>
<span id="cb62-461"><a href="#cb62-461" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(parameters)) {</span>
<span id="cb62-462"><a href="#cb62-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"parameters"</span>)</span>
<span id="cb62-463"><a href="#cb62-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(parameters)</span>
<span id="cb62-464"><a href="#cb62-464" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-465"><a href="#cb62-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(parameters)</span>
<span id="cb62-466"><a href="#cb62-466" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-467"><a href="#cb62-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-468"><a href="#cb62-468" aria-hidden="true" tabindex="-1"></a><span class="co"># reporting</span></span>
<span id="cb62-469"><a href="#cb62-469" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(report)) {</span>
<span id="cb62-470"><a href="#cb62-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"report"</span>)</span>
<span id="cb62-471"><a href="#cb62-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(report)</span>
<span id="cb62-472"><a href="#cb62-472" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-473"><a href="#cb62-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(report)</span>
<span id="cb62-474"><a href="#cb62-474" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-475"><a href="#cb62-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-476"><a href="#cb62-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-477"><a href="#cb62-477" aria-hidden="true" tabindex="-1"></a><span class="co"># predictive graphs</span></span>
<span id="cb62-478"><a href="#cb62-478" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggeffects)) {</span>
<span id="cb62-479"><a href="#cb62-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggeffects"</span>)</span>
<span id="cb62-480"><a href="#cb62-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggeffects)</span>
<span id="cb62-481"><a href="#cb62-481" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-482"><a href="#cb62-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggeffects)</span>
<span id="cb62-483"><a href="#cb62-483" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-484"><a href="#cb62-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-485"><a href="#cb62-485" aria-hidden="true" tabindex="-1"></a><span class="co"># assembling graphs</span></span>
<span id="cb62-486"><a href="#cb62-486" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(patchwork)) {</span>
<span id="cb62-487"><a href="#cb62-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"patchwork"</span>)</span>
<span id="cb62-488"><a href="#cb62-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb62-489"><a href="#cb62-489" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-490"><a href="#cb62-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb62-491"><a href="#cb62-491" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-492"><a href="#cb62-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-493"><a href="#cb62-493" aria-hidden="true" tabindex="-1"></a><span class="co"># if libraries are already install, start here</span></span>
<span id="cb62-494"><a href="#cb62-494" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb62-495"><a href="#cb62-495" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-496"><a href="#cb62-496" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb62-497"><a href="#cb62-497" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb62-498"><a href="#cb62-498" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb62-499"><a href="#cb62-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-500"><a href="#cb62-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-501"><a href="#cb62-501" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># reproducibility</span></span>
<span id="cb62-502"><a href="#cb62-502" aria-hidden="true" tabindex="-1"></a>groupA_scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>) <span class="co"># simulate scores for group A</span></span>
<span id="cb62-503"><a href="#cb62-503" aria-hidden="true" tabindex="-1"></a>groupB_scores <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">105</span>, <span class="at">sd =</span> <span class="dv">15</span>) <span class="co"># simulate scores for group B</span></span>
<span id="cb62-504"><a href="#cb62-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-505"><a href="#cb62-505" aria-hidden="true" tabindex="-1"></a><span class="co"># ombine into a data frame</span></span>
<span id="cb62-506"><a href="#cb62-506" aria-hidden="true" tabindex="-1"></a>df_scores <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">100</span>), <span class="at">scores =</span> <span class="fu">c</span>(groupA_scores, groupB_scores))</span>
<span id="cb62-507"><a href="#cb62-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-508"><a href="#cb62-508" aria-hidden="true" tabindex="-1"></a><span class="co"># commands to view data</span></span>
<span id="cb62-509"><a href="#cb62-509" aria-hidden="true" tabindex="-1"></a> <span class="co">#str(df_scores)</span></span>
<span id="cb62-510"><a href="#cb62-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-511"><a href="#cb62-511" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of columns</span></span>
<span id="cb62-512"><a href="#cb62-512" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(df_scores)</span></span>
<span id="cb62-513"><a href="#cb62-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-514"><a href="#cb62-514" aria-hidden="true" tabindex="-1"></a><span class="co"># top rows (uncomment)</span></span>
<span id="cb62-515"><a href="#cb62-515" aria-hidden="true" tabindex="-1"></a><span class="co"># head(df_scores)</span></span>
<span id="cb62-516"><a href="#cb62-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-517"><a href="#cb62-517" aria-hidden="true" tabindex="-1"></a><span class="co"># bottom rows  (uncomment)</span></span>
<span id="cb62-518"><a href="#cb62-518" aria-hidden="true" tabindex="-1"></a><span class="co"># tail(df_scores)</span></span>
<span id="cb62-519"><a href="#cb62-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-520"><a href="#cb62-520" aria-hidden="true" tabindex="-1"></a><span class="co"># check structure of data  (uncomment)</span></span>
<span id="cb62-521"><a href="#cb62-521" aria-hidden="true" tabindex="-1"></a><span class="co"># str(df_scores)</span></span>
<span id="cb62-522"><a href="#cb62-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-523"><a href="#cb62-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-524"><a href="#cb62-524" aria-hidden="true" tabindex="-1"></a><span class="co"># make group a factor (not strictly necessary here, but useful in outher applications)</span></span>
<span id="cb62-525"><a href="#cb62-525" aria-hidden="true" tabindex="-1"></a>df_scores_1 <span class="ot">&lt;-</span> df_scores <span class="sc">|&gt;</span> </span>
<span id="cb62-526"><a href="#cb62-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as.factor</span>(group))</span>
<span id="cb62-527"><a href="#cb62-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-528"><a href="#cb62-528" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_scores_1)</span>
<span id="cb62-529"><a href="#cb62-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-530"><a href="#cb62-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-531"><a href="#cb62-531" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualising Our Simulated Data</span></span>
<span id="cb62-532"><a href="#cb62-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-533"><a href="#cb62-533" aria-hidden="true" tabindex="-1"></a>Understanding your data visually is as important as the statistical analysis itself. Let's create a simple plot to compare the score distributions between the two groups.</span>
<span id="cb62-534"><a href="#cb62-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-535"><a href="#cb62-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r visualize-data, fig.cap="Score Distribution by Group"}</span></span>
<span id="cb62-536"><a href="#cb62-536" aria-hidden="true" tabindex="-1"></a><span class="co"># plot your data</span></span>
<span id="cb62-537"><a href="#cb62-537" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_scores_1, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> scores, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb62-538"><a href="#cb62-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb62-539"><a href="#cb62-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-540"><a href="#cb62-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Score Distribution by Group"</span>, <span class="at">x =</span> <span class="st">"Group"</span>, <span class="at">y =</span> <span class="st">"Scores"</span>)</span>
<span id="cb62-541"><a href="#cb62-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-542"><a href="#cb62-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-543"><a href="#cb62-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-544"><a href="#cb62-544" aria-hidden="true" tabindex="-1"></a><span class="fu">## Histogram {#sec-histogram}</span></span>
<span id="cb62-545"><a href="#cb62-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-548"><a href="#cb62-548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-549"><a href="#cb62-549" aria-hidden="true" tabindex="-1"></a><span class="co">#fig-cap: "Histogram of simulated scores, by group, using facet_wrap()"</span></span>
<span id="cb62-550"><a href="#cb62-550" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-551"><a href="#cb62-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-552"><a href="#cb62-552" aria-hidden="true" tabindex="-1"></a><span class="co"># H=histograms for both groups</span></span>
<span id="cb62-553"><a href="#cb62-553" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_scores_1, <span class="fu">aes</span>(<span class="at">x =</span> scores, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb62-554"><a href="#cb62-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb62-555"><a href="#cb62-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Scores by Group"</span>,</span>
<span id="cb62-556"><a href="#cb62-556" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Scores"</span>,</span>
<span id="cb62-557"><a href="#cb62-557" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb62-558"><a href="#cb62-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="fu">theme_minimal</span>() </span>
<span id="cb62-559"><a href="#cb62-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-560"><a href="#cb62-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-561"><a href="#cb62-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-562"><a href="#cb62-562" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excercise 1</span></span>
<span id="cb62-563"><a href="#cb62-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-564"><a href="#cb62-564" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Modify the simulation parameters to change each group's mean and standard deviation. Observe how these changes affect the distribution.</span>
<span id="cb62-565"><a href="#cb62-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-566"><a href="#cb62-566" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Go to the <span class="co">[</span><span class="ot">histogram</span><span class="co">](#sec-histogram)</span>. Experiment with different bin widths. In your own words, how do large and small numbers speak differently to the data? When might you use one histogram and not another. </span>
<span id="cb62-567"><a href="#cb62-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-568"><a href="#cb62-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-569"><a href="#cb62-569" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulating data for familiar statistical tests </span></span>
<span id="cb62-570"><a href="#cb62-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-571"><a href="#cb62-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-574"><a href="#cb62-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-575"><a href="#cb62-575" aria-hidden="true" tabindex="-1"></a><span class="co"># tbl-caption: "results of a one-sample t-test."</span></span>
<span id="cb62-576"><a href="#cb62-576" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate some data</span></span>
<span id="cb62-577"><a href="#cb62-577" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-578"><a href="#cb62-578" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 100 random normal values with mean = 5</span></span>
<span id="cb62-579"><a href="#cb62-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-580"><a href="#cb62-580" aria-hidden="true" tabindex="-1"></a><span class="co"># perform one-sample t-test</span></span>
<span id="cb62-581"><a href="#cb62-581" aria-hidden="true" tabindex="-1"></a><span class="co"># testing if the mean of the data is reliably different from 4</span></span>
<span id="cb62-582"><a href="#cb62-582" aria-hidden="true" tabindex="-1"></a>mod_first_test<span class="ot">&lt;-</span> <span class="fu">t.test</span>(data, <span class="at">mu =</span> <span class="dv">4</span>)</span>
<span id="cb62-583"><a href="#cb62-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-584"><a href="#cb62-584" aria-hidden="true" tabindex="-1"></a><span class="co"># table</span></span>
<span id="cb62-585"><a href="#cb62-585" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">parameters</span>(mod_first_test)</span>
<span id="cb62-586"><a href="#cb62-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-587"><a href="#cb62-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-588"><a href="#cb62-588" aria-hidden="true" tabindex="-1"></a>We can automatically report these results using the <span class="in">`report`</span> package: </span>
<span id="cb62-589"><a href="#cb62-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-590"><a href="#cb62-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-593"><a href="#cb62-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-594"><a href="#cb62-594" aria-hidden="true" tabindex="-1"></a><span class="co"># report results automatically</span></span>
<span id="cb62-595"><a href="#cb62-595" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(mod_first_test)</span>
<span id="cb62-596"><a href="#cb62-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-597"><a href="#cb62-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-598"><a href="#cb62-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-601"><a href="#cb62-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-602"><a href="#cb62-602" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for two groups</span></span>
<span id="cb62-603"><a href="#cb62-603" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-604"><a href="#cb62-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-605"><a href="#cb62-605" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 50 random normal values, mean = 5</span></span>
<span id="cb62-606"><a href="#cb62-606" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="fl">5.5</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 50 random normal values, mean = 5.5</span></span>
<span id="cb62-607"><a href="#cb62-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-608"><a href="#cb62-608" aria-hidden="true" tabindex="-1"></a><span class="co"># two-sample t-test</span></span>
<span id="cb62-609"><a href="#cb62-609" aria-hidden="true" tabindex="-1"></a>mod_t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(group1, group2)</span>
<span id="cb62-610"><a href="#cb62-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-611"><a href="#cb62-611" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(mod_t_test_result)</span>
<span id="cb62-612"><a href="#cb62-612" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">parameters</span>(mod_t_test_result)</span>
<span id="cb62-613"><a href="#cb62-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-614"><a href="#cb62-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-617"><a href="#cb62-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-618"><a href="#cb62-618" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate pre-test and post-test scores</span></span>
<span id="cb62-619"><a href="#cb62-619" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-620"><a href="#cb62-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-621"><a href="#cb62-621" aria-hidden="true" tabindex="-1"></a>pre_test <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb62-622"><a href="#cb62-622" aria-hidden="true" tabindex="-1"></a>post_test <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span>  pre_test <span class="sc">+</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># assume an increase</span></span>
<span id="cb62-623"><a href="#cb62-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-624"><a href="#cb62-624" aria-hidden="true" tabindex="-1"></a><span class="co"># perform paired t-test</span></span>
<span id="cb62-625"><a href="#cb62-625" aria-hidden="true" tabindex="-1"></a>mod_pre_post <span class="ot">&lt;-</span> <span class="fu">t.test</span>(pre_test, post_test, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-626"><a href="#cb62-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-627"><a href="#cb62-627" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(mod_pre_post)</span>
<span id="cb62-628"><a href="#cb62-628" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">parameters</span>(mod_pre_post)</span>
<span id="cb62-629"><a href="#cb62-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-630"><a href="#cb62-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-631"><a href="#cb62-631" aria-hidden="true" tabindex="-1"></a><span class="fu">##  Understanding Regression Using Data Simulation</span></span>
<span id="cb62-632"><a href="#cb62-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-633"><a href="#cb62-633" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulating Continuous Treatment Variable and Outcome Variable</span></span>
<span id="cb62-634"><a href="#cb62-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-637"><a href="#cb62-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-638"><a href="#cb62-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb62-639"><a href="#cb62-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb62-640"><a href="#cb62-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-641"><a href="#cb62-641" aria-hidden="true" tabindex="-1"></a><span class="co"># library for enhanced model reporting</span></span>
<span id="cb62-642"><a href="#cb62-642" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-643"><a href="#cb62-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-644"><a href="#cb62-644" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb62-645"><a href="#cb62-645" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb62-646"><a href="#cb62-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-647"><a href="#cb62-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-648"><a href="#cb62-648" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb62-649"><a href="#cb62-649" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># choose a seed number for consistency</span></span>
<span id="cb62-650"><a href="#cb62-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-651"><a href="#cb62-651" aria-hidden="true" tabindex="-1"></a><span class="co"># define the number of observations</span></span>
<span id="cb62-652"><a href="#cb62-652" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># total observations</span></span>
<span id="cb62-653"><a href="#cb62-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-654"><a href="#cb62-654" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate continuous treatment variable A</span></span>
<span id="cb62-655"><a href="#cb62-655" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>) <span class="co"># mean = 50, sd = 10 for A</span></span>
<span id="cb62-656"><a href="#cb62-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-657"><a href="#cb62-657" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the effect size of A on Y</span></span>
<span id="cb62-658"><a href="#cb62-658" aria-hidden="true" tabindex="-1"></a>beta_a <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># explicit effect size</span></span>
<span id="cb62-659"><a href="#cb62-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-660"><a href="#cb62-660" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate outcome variable Y including an error term</span></span>
<span id="cb62-661"><a href="#cb62-661" aria-hidden="true" tabindex="-1"></a>outcome <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> beta_a <span class="sc">*</span> treatment <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>) <span class="co"># Y = intercept + beta_a*A + error</span></span>
<span id="cb62-662"><a href="#cb62-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-663"><a href="#cb62-663" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataframe</span></span>
<span id="cb62-664"><a href="#cb62-664" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">treatment =</span> treatment,<span class="at">outcome =</span> outcome)</span>
<span id="cb62-665"><a href="#cb62-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-666"><a href="#cb62-666" aria-hidden="true" tabindex="-1"></a><span class="co"># view the structure and first few rows of the data frame</span></span>
<span id="cb62-667"><a href="#cb62-667" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span>
<span id="cb62-668"><a href="#cb62-668" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb62-669"><a href="#cb62-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-670"><a href="#cb62-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-671"><a href="#cb62-671" aria-hidden="true" tabindex="-1"></a><span class="fu">### Run Linear Model</span></span>
<span id="cb62-672"><a href="#cb62-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-673"><a href="#cb62-673" aria-hidden="true" tabindex="-1"></a>Before moving on to regression analysis, ensure students understand the structure and distribution of the simulated data. Encourage them to use <span class="in">`summary()`</span>, <span class="in">`plot()`</span>, and other exploratory data analysis functions.</span>
<span id="cb62-674"><a href="#cb62-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-675"><a href="#cb62-675" aria-hidden="true" tabindex="-1"></a><span class="fu">####  Regression Analysis of Continuous Treatment Effect</span></span>
<span id="cb62-676"><a href="#cb62-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-679"><a href="#cb62-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-680"><a href="#cb62-680" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Graph of regression line showing uncertainty."</span></span>
<span id="cb62-681"><a href="#cb62-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb62-682"><a href="#cb62-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb62-683"><a href="#cb62-683" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-684"><a href="#cb62-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-685"><a href="#cb62-685" aria-hidden="true" tabindex="-1"></a><span class="co"># perform linear regression of Y on A</span></span>
<span id="cb62-686"><a href="#cb62-686" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> treatment, <span class="at">data =</span> df)</span>
<span id="cb62-687"><a href="#cb62-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-688"><a href="#cb62-688" aria-hidden="true" tabindex="-1"></a><span class="co"># display the regression model summary</span></span>
<span id="cb62-689"><a href="#cb62-689" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb62-690"><a href="#cb62-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-691"><a href="#cb62-691" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model in a reader-friendly format</span></span>
<span id="cb62-692"><a href="#cb62-692" aria-hidden="true" tabindex="-1"></a>report_fit <span class="ot">&lt;-</span> report<span class="sc">::</span><span class="fu">report</span>(fit)</span>
<span id="cb62-693"><a href="#cb62-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-694"><a href="#cb62-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-695"><a href="#cb62-695" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment to print the model report</span></span>
<span id="cb62-696"><a href="#cb62-696" aria-hidden="true" tabindex="-1"></a><span class="co"># print(report_fit)</span></span>
<span id="cb62-697"><a href="#cb62-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-698"><a href="#cb62-698" aria-hidden="true" tabindex="-1"></a><span class="co"># use ggeffects to view predicted values</span></span>
<span id="cb62-699"><a href="#cb62-699" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb62-700"><a href="#cb62-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-701"><a href="#cb62-701" aria-hidden="true" tabindex="-1"></a>predicted_values <span class="ot">&lt;-</span> ggeffects<span class="sc">::</span><span class="fu">ggemmeans</span>(fit,</span>
<span id="cb62-702"><a href="#cb62-702" aria-hidden="true" tabindex="-1"></a>                     <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"treatment"</span>))</span>
<span id="cb62-703"><a href="#cb62-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-704"><a href="#cb62-704" aria-hidden="true" tabindex="-1"></a><span class="co"># plot see</span></span>
<span id="cb62-705"><a href="#cb62-705" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(predicted_values,  <span class="at">dot_alpha =</span> <span class="fl">0.35</span>,   <span class="at">show_data =</span> <span class="cn">TRUE</span>, <span class="at">jitter =</span> .<span class="dv">1</span>)</span>
<span id="cb62-706"><a href="#cb62-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-707"><a href="#cb62-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-708"><a href="#cb62-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-709"><a href="#cb62-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-710"><a href="#cb62-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-711"><a href="#cb62-711" aria-hidden="true" tabindex="-1"></a><span class="fu">## Equivalence of ANOVA and Regression</span></span>
<span id="cb62-712"><a href="#cb62-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-713"><a href="#cb62-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-714"><a href="#cb62-714" aria-hidden="true" tabindex="-1"></a>We will simulate data in R to show that a one-way ANOVA is a particular case of linear regression with categorical predictors. We will give some reasons for preferring regression (in some settings).</span>
<span id="cb62-715"><a href="#cb62-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-716"><a href="#cb62-716" aria-hidden="true" tabindex="-1"></a><span class="fu">## Method</span></span>
<span id="cb62-717"><a href="#cb62-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-718"><a href="#cb62-718" aria-hidden="true" tabindex="-1"></a>First, we simulate a dataset with one categorical independent variable with three levels (groups) and a continuous outcome (also called a "dependant") variable. This setup allows us to apply both ANOVA and linear regression for comparison.</span>
<span id="cb62-719"><a href="#cb62-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-722"><a href="#cb62-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-723"><a href="#cb62-723" aria-hidden="true" tabindex="-1"></a><span class="co"># nice tables</span></span>
<span id="cb62-724"><a href="#cb62-724" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb62-725"><a href="#cb62-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-726"><a href="#cb62-726" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># reproducibility</span></span>
<span id="cb62-727"><a href="#cb62-727" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">90</span> <span class="co"># total number of observations</span></span>
<span id="cb62-728"><a href="#cb62-728" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># number of groups</span></span>
<span id="cb62-729"><a href="#cb62-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-730"><a href="#cb62-730" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate independent variable (grouping factor)</span></span>
<span id="cb62-731"><a href="#cb62-731" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">each =</span> n<span class="sc">/</span>k))</span>
<span id="cb62-732"><a href="#cb62-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-733"><a href="#cb62-733" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb62-734"><a href="#cb62-734" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(group)</span>
<span id="cb62-735"><a href="#cb62-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-736"><a href="#cb62-736" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate outcome variable</span></span>
<span id="cb62-737"><a href="#cb62-737" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">220</span>) <span class="co"># Mean for each group</span></span>
<span id="cb62-738"><a href="#cb62-738" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># Standard deviation (same for all groups)</span></span>
<span id="cb62-739"><a href="#cb62-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-740"><a href="#cb62-740" aria-hidden="true" tabindex="-1"></a><span class="co"># generate random data</span></span>
<span id="cb62-741"><a href="#cb62-741" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fu">rep</span>(means, <span class="at">each =</span> n<span class="sc">/</span>k), <span class="at">sd =</span> sd)</span>
<span id="cb62-742"><a href="#cb62-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-743"><a href="#cb62-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-744"><a href="#cb62-744" aria-hidden="true" tabindex="-1"></a><span class="co"># make data frame</span></span>
<span id="cb62-745"><a href="#cb62-745" aria-hidden="true" tabindex="-1"></a>df_1 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(y, group)</span>
<span id="cb62-746"><a href="#cb62-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-747"><a href="#cb62-747" aria-hidden="true" tabindex="-1"></a>anova_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> group, <span class="at">data =</span> df_1)</span>
<span id="cb62-748"><a href="#cb62-748" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(anova_model)</span></span>
<span id="cb62-749"><a href="#cb62-749" aria-hidden="true" tabindex="-1"></a>table_anova <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(anova_model)</span>
<span id="cb62-750"><a href="#cb62-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-751"><a href="#cb62-751" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model</span></span>
<span id="cb62-752"><a href="#cb62-752" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(anova_model)</span>
<span id="cb62-753"><a href="#cb62-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-754"><a href="#cb62-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-755"><a href="#cb62-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-756"><a href="#cb62-756" aria-hidden="true" tabindex="-1"></a>Next, we analyse the same data using linear regression. In R, regression models automatically convert categorical variables into dummy variables.</span>
<span id="cb62-757"><a href="#cb62-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-758"><a href="#cb62-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-761"><a href="#cb62-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-762"><a href="#cb62-762" aria-hidden="true" tabindex="-1"></a><span class="co"># for tables (just installed)</span></span>
<span id="cb62-763"><a href="#cb62-763" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb62-764"><a href="#cb62-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-765"><a href="#cb62-765" aria-hidden="true" tabindex="-1"></a><span class="co"># regression model </span></span>
<span id="cb62-766"><a href="#cb62-766" aria-hidden="true" tabindex="-1"></a>fit_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> group, <span class="at">data =</span> df_1)</span>
<span id="cb62-767"><a href="#cb62-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-768"><a href="#cb62-768" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment if you want an ordinary summary</span></span>
<span id="cb62-769"><a href="#cb62-769" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(regression_model)</span></span>
<span id="cb62-770"><a href="#cb62-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-771"><a href="#cb62-771" aria-hidden="true" tabindex="-1"></a>table_fit <span class="ot">&lt;-</span> parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_regression)</span>
<span id="cb62-772"><a href="#cb62-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-773"><a href="#cb62-773" aria-hidden="true" tabindex="-1"></a><span class="co"># print table</span></span>
<span id="cb62-774"><a href="#cb62-774" aria-hidden="true" tabindex="-1"></a>table_fit</span>
<span id="cb62-775"><a href="#cb62-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-776"><a href="#cb62-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-779"><a href="#cb62-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-780"><a href="#cb62-780" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb62-781"><a href="#cb62-781" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb62-782"><a href="#cb62-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-783"><a href="#cb62-783" aria-hidden="true" tabindex="-1"></a><span class="co"># report the model</span></span>
<span id="cb62-784"><a href="#cb62-784" aria-hidden="true" tabindex="-1"></a>report_fit <span class="ot">&lt;-</span> <span class="fu">report_parameters</span>(fit_regression)</span>
<span id="cb62-785"><a href="#cb62-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-786"><a href="#cb62-786" aria-hidden="true" tabindex="-1"></a><span class="co">#print</span></span>
<span id="cb62-787"><a href="#cb62-787" aria-hidden="true" tabindex="-1"></a>report_fit</span>
<span id="cb62-788"><a href="#cb62-788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-789"><a href="#cb62-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-790"><a href="#cb62-790" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combination Plots</span></span>
<span id="cb62-791"><a href="#cb62-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-792"><a href="#cb62-792" aria-hidden="true" tabindex="-1"></a>We can create and combine individual plots, as showin in @fig-coefplot, as follows: </span>
<span id="cb62-793"><a href="#cb62-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-796"><a href="#cb62-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-797"><a href="#cb62-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-coefplot</span></span>
<span id="cb62-798"><a href="#cb62-798" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "This is a combined plot"</span></span>
<span id="cb62-799"><a href="#cb62-799" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-column: page-inset-right</span></span>
<span id="cb62-800"><a href="#cb62-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-801"><a href="#cb62-801" aria-hidden="true" tabindex="-1"></a><span class="co"># regression --------------------------------------------------------------</span></span>
<span id="cb62-802"><a href="#cb62-802" aria-hidden="true" tabindex="-1"></a><span class="co"># graph the output of the parameters table and assign to object</span></span>
<span id="cb62-803"><a href="#cb62-803" aria-hidden="true" tabindex="-1"></a>coefficient_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(table_fit)</span>
<span id="cb62-804"><a href="#cb62-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-805"><a href="#cb62-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-806"><a href="#cb62-806" aria-hidden="true" tabindex="-1"></a><span class="co"># ggeffects plot - create predictive plot.</span></span>
<span id="cb62-807"><a href="#cb62-807" aria-hidden="true" tabindex="-1"></a><span class="co"># this gives the expected values by group </span></span>
<span id="cb62-808"><a href="#cb62-808" aria-hidden="true" tabindex="-1"></a>predictive_plot <span class="ot">&lt;-</span> <span class="fu">plot</span>(</span>
<span id="cb62-809"><a href="#cb62-809" aria-hidden="true" tabindex="-1"></a>  ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(fit_regression, <span class="at">terms =</span> <span class="st">"group"</span>),</span>
<span id="cb62-810"><a href="#cb62-810" aria-hidden="true" tabindex="-1"></a>  <span class="at">dot_alpha =</span> <span class="fl">0.35</span>,</span>
<span id="cb62-811"><a href="#cb62-811" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-812"><a href="#cb62-812" aria-hidden="true" tabindex="-1"></a>  <span class="at">jitter =</span> .<span class="dv">1</span>,</span>
<span id="cb62-813"><a href="#cb62-813" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span>  <span class="st">"reefs"</span></span>
<span id="cb62-814"><a href="#cb62-814" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb62-815"><a href="#cb62-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">260</span>)) <span class="sc">+</span> <span class="co"># change y axis</span></span>
<span id="cb62-816"><a href="#cb62-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predictive Graph"</span>, <span class="at">x =</span> <span class="st">"Treatment Group"</span>, <span class="at">y =</span> <span class="st">"Response"</span>)</span>
<span id="cb62-817"><a href="#cb62-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-818"><a href="#cb62-818" aria-hidden="true" tabindex="-1"></a><span class="co"># view (uncomment to see it alone)</span></span>
<span id="cb62-819"><a href="#cb62-819" aria-hidden="true" tabindex="-1"></a><span class="co">#predictive_plot</span></span>
<span id="cb62-820"><a href="#cb62-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-821"><a href="#cb62-821" aria-hidden="true" tabindex="-1"></a><span class="co"># show all color palettes (uncomment to see colour options)</span></span>
<span id="cb62-822"><a href="#cb62-822" aria-hidden="true" tabindex="-1"></a><span class="co"># show_pals()</span></span>
<span id="cb62-823"><a href="#cb62-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-824"><a href="#cb62-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-825"><a href="#cb62-825" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple plots using `patchwork`</span></span>
<span id="cb62-826"><a href="#cb62-826" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb62-827"><a href="#cb62-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-828"><a href="#cb62-828" aria-hidden="true" tabindex="-1"></a><span class="co"># create a plot</span></span>
<span id="cb62-829"><a href="#cb62-829" aria-hidden="true" tabindex="-1"></a>my_first_combination_plot <span class="ot">&lt;-</span> coefficient_plot <span class="sc">/</span> predictive_plot  <span class="sc">+</span></span>
<span id="cb62-830"><a href="#cb62-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Coefficient and Predictive plots with two panels "</span>,</span>
<span id="cb62-831"><a href="#cb62-831" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb62-832"><a href="#cb62-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-833"><a href="#cb62-833" aria-hidden="true" tabindex="-1"></a><span class="co"># save a plot to your directory, make sure to create one called "figs"</span></span>
<span id="cb62-834"><a href="#cb62-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-835"><a href="#cb62-835" aria-hidden="true" tabindex="-1"></a><span class="do">## check directory (uncomments)</span></span>
<span id="cb62-836"><a href="#cb62-836" aria-hidden="true" tabindex="-1"></a><span class="co"># here::here()</span></span>
<span id="cb62-837"><a href="#cb62-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-838"><a href="#cb62-838" aria-hidden="true" tabindex="-1"></a><span class="co"># save (change values if necessary )</span></span>
<span id="cb62-839"><a href="#cb62-839" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb62-840"><a href="#cb62-840" aria-hidden="true" tabindex="-1"></a>  my_first_combination_plot,</span>
<span id="cb62-841"><a href="#cb62-841" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"figs"</span>),</span>
<span id="cb62-842"><a href="#cb62-842" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">12</span>,</span>
<span id="cb62-843"><a href="#cb62-843" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb62-844"><a href="#cb62-844" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb62-845"><a href="#cb62-845" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"my_first_combination_plot.jpeg"</span>,</span>
<span id="cb62-846"><a href="#cb62-846" aria-hidden="true" tabindex="-1"></a>  <span class="at">device =</span> <span class="st">'jpeg'</span>,</span>
<span id="cb62-847"><a href="#cb62-847" aria-hidden="true" tabindex="-1"></a>  <span class="at">limitsize =</span> <span class="cn">FALSE</span>,</span>
<span id="cb62-848"><a href="#cb62-848" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">600</span></span>
<span id="cb62-849"><a href="#cb62-849" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-850"><a href="#cb62-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-851"><a href="#cb62-851" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb62-852"><a href="#cb62-852" aria-hidden="true" tabindex="-1"></a>my_first_combination_plot</span>
<span id="cb62-853"><a href="#cb62-853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-854"><a href="#cb62-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-855"><a href="#cb62-855" aria-hidden="true" tabindex="-1"></a><span class="fu">## Upshot</span></span>
<span id="cb62-856"><a href="#cb62-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-857"><a href="#cb62-857" aria-hidden="true" tabindex="-1"></a>ANOVA partitions variance into between-group and within-group components. Regression analysis estimates the mean of the <span class="in">`dependent variable`</span> as a linear function of the <span class="in">`independent (including categorical)`</span> variables. For many questions, ANOVA is appropriate, however, when comparing groups, we often want a finer-grained interpretation. Regression is built for obtaining this finer grain comparisons. Note: comparisons do not establish causality. We will return to regression over the next few weeks and use regression to hone your skills in R. Later, along the way, you'll learn more about data visualisation, modelling, and reporting. These skills are essential for your final report. They are also skills that you will serve you beyond this course. </span>
<span id="cb62-858"><a href="#cb62-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-859"><a href="#cb62-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-860"><a href="#cb62-860" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 2</span></span>
<span id="cb62-861"><a href="#cb62-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-862"><a href="#cb62-862" aria-hidden="true" tabindex="-1"></a>Perform a linear regression analysis using R. Follow the detailed instructions below to simulate the necessary data, execute the regression, and report your findings:</span>
<span id="cb62-863"><a href="#cb62-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-864"><a href="#cb62-864" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Simulate Data:**</span>
<span id="cb62-865"><a href="#cb62-865" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Generate two continuous variables, <span class="in">`Y`</span> and <span class="in">`A`</span>, with <span class="in">`n = 100`</span> observations each.</span>
<span id="cb62-866"><a href="#cb62-866" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The variable <span class="in">`A`</span> should have a mean of <span class="in">`50`</span> and a standard deviation (<span class="in">`sd`</span>) of <span class="in">`10`</span>.</span>
<span id="cb62-867"><a href="#cb62-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-868"><a href="#cb62-868" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Define the Relationship:**</span>
<span id="cb62-869"><a href="#cb62-869" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Simulate the variable <span class="in">`Y`</span> such that it is linearly related to <span class="in">`A`</span> with a specified effect size. The effect size of <span class="in">`A`</span> on <span class="in">`Y`</span> must be explicitly defined as <span class="in">`2`</span>.</span>
<span id="cb62-870"><a href="#cb62-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-871"><a href="#cb62-871" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Incorporate an Error Term:**</span>
<span id="cb62-872"><a href="#cb62-872" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>When simulating <span class="in">`Y`</span>, include an error term with a standard deviation (<span class="in">`sd`</span>) of <span class="in">`20`</span> to introduce variability.</span>
<span id="cb62-873"><a href="#cb62-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-874"><a href="#cb62-874" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Regression Analysis:**</span>
<span id="cb62-875"><a href="#cb62-875" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Use the <span class="in">`lm()`</span> function in R to regress <span class="in">`Y`</span> on <span class="in">`A`</span>.</span>
<span id="cb62-876"><a href="#cb62-876" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Ensure the regression model captures the specified effect of <span class="in">`A`</span> on <span class="in">`Y`</span>.</span>
<span id="cb62-877"><a href="#cb62-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-878"><a href="#cb62-878" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Report the Results:**</span>
<span id="cb62-879"><a href="#cb62-879" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Output the regression model summary to examine the coefficients, including the effect of <span class="in">`A`</span> on <span class="in">`Y`</span>, and assess the model's overall fit and significance.</span>
<span id="cb62-880"><a href="#cb62-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-881"><a href="#cb62-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-882"><a href="#cb62-882" aria-hidden="true" tabindex="-1"></a>Here is a template to get you started. Copy the code and paste it into your R script. </span>
<span id="cb62-883"><a href="#cb62-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-884"><a href="#cb62-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-885"><a href="#cb62-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-888"><a href="#cb62-888" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-889"><a href="#cb62-889" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb62-890"><a href="#cb62-890" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb62-891"><a href="#cb62-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-892"><a href="#cb62-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-893"><a href="#cb62-893" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb62-894"><a href="#cb62-894" aria-hidden="true" tabindex="-1"></a><span class="co">#  seed for reproducibility</span></span>
<span id="cb62-895"><a href="#cb62-895" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>( ) <span class="co"># numbers go in brackets</span></span>
<span id="cb62-896"><a href="#cb62-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-897"><a href="#cb62-897" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations</span></span>
<span id="cb62-898"><a href="#cb62-898" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span>   <span class="co"># number goes here</span></span>
<span id="cb62-899"><a href="#cb62-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-900"><a href="#cb62-900" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for variable A with specified mean and sd</span></span>
<span id="cb62-901"><a href="#cb62-901" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, </span>
<span id="cb62-902"><a href="#cb62-902" aria-hidden="true" tabindex="-1"></a>           <span class="at">mean =</span> , <span class="co"># set your number here </span></span>
<span id="cb62-903"><a href="#cb62-903" aria-hidden="true" tabindex="-1"></a>           <span class="at">sd =</span> )<span class="co"># set your number here </span></span>
<span id="cb62-904"><a href="#cb62-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-905"><a href="#cb62-905" aria-hidden="true" tabindex="-1"></a><span class="co"># define the specified effect size of A on Y</span></span>
<span id="cb62-906"><a href="#cb62-906" aria-hidden="true" tabindex="-1"></a>beta_A <span class="ot">&lt;-</span>   <span class="co"># define your effect with a number here </span></span>
<span id="cb62-907"><a href="#cb62-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-908"><a href="#cb62-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-909"><a href="#cb62-909" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data and make data frame in one step</span></span>
<span id="cb62-910"><a href="#cb62-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-911"><a href="#cb62-911" aria-hidden="true" tabindex="-1"></a>df_3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-912"><a href="#cb62-912" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate data for variable A with specified mean and sd</span></span>
<span id="cb62-913"><a href="#cb62-913" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> A, <span class="co"># from above</span></span>
<span id="cb62-914"><a href="#cb62-914" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="dv">5</span> <span class="sc">+</span> beta_A <span class="sc">*</span> A <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>) <span class="co">#  effect is intercept + ...</span></span>
<span id="cb62-915"><a href="#cb62-915" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-916"><a href="#cb62-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-917"><a href="#cb62-917" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb62-918"><a href="#cb62-918" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_3)</span>
<span id="cb62-919"><a href="#cb62-919" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df_3)</span>
<span id="cb62-920"><a href="#cb62-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-921"><a href="#cb62-921" aria-hidden="true" tabindex="-1"></a><span class="co">#  linear regression of Y on A</span></span>
<span id="cb62-922"><a href="#cb62-922" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A, <span class="at">data =</span> df_3)</span>
<span id="cb62-923"><a href="#cb62-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-924"><a href="#cb62-924" aria-hidden="true" tabindex="-1"></a><span class="co">#  results (standard code)</span></span>
<span id="cb62-925"><a href="#cb62-925" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(model)</span></span>
<span id="cb62-926"><a href="#cb62-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-927"><a href="#cb62-927" aria-hidden="true" tabindex="-1"></a><span class="co"># time saving reports</span></span>
<span id="cb62-928"><a href="#cb62-928" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_3)</span>
<span id="cb62-929"><a href="#cb62-929" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit_3)</span>
<span id="cb62-930"><a href="#cb62-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-931"><a href="#cb62-931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-932"><a href="#cb62-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-933"><a href="#cb62-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-934"><a href="#cb62-934" aria-hidden="true" tabindex="-1"></a><span class="fu">## What You Have Learned</span></span>
<span id="cb62-935"><a href="#cb62-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-936"><a href="#cb62-936" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Data simulation:** </span>
<span id="cb62-937"><a href="#cb62-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-938"><a href="#cb62-938" aria-hidden="true" tabindex="-1"></a>You've learned to simulate datasets in R. This is a important skill for exploring statistical concepts and causal inference. Congratulations! </span>
<span id="cb62-939"><a href="#cb62-939" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-940"><a href="#cb62-940" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Data visualisation:** </span>
<span id="cb62-941"><a href="#cb62-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-942"><a href="#cb62-942" aria-hidden="true" tabindex="-1"></a>You've expanded your capacity for data visualisation.</span>
<span id="cb62-943"><a href="#cb62-943" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-944"><a href="#cb62-944" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Statistical tests:** You've conducted basic statistical tests, including t-tests and ANOVA, and regression.</span>
<span id="cb62-945"><a href="#cb62-945" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-946"><a href="#cb62-946" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Understanding ANOVA and regression:** </span>
<span id="cb62-947"><a href="#cb62-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-948"><a href="#cb62-948" aria-hidden="true" tabindex="-1"></a>You've examined the equivalence of ANOVA and regression analysis</span>
<span id="cb62-949"><a href="#cb62-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-950"><a href="#cb62-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-951"><a href="#cb62-951" aria-hidden="true" tabindex="-1"></a><span class="fu">## For more information about the packages used here:</span></span>
<span id="cb62-952"><a href="#cb62-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-953"><a href="#cb62-953" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="co">[</span><span class="ot">ggplot2</span><span class="co">](https://ggplot2.tidyverse.org/)</span>: A system for declaratively creating graphics, based on The Grammar of Graphics.</span>
<span id="cb62-954"><a href="#cb62-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-955"><a href="#cb62-955" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="co">[</span><span class="ot">Parameters package</span><span class="co">](https://easystats.github.io/parameters/)</span>: Provides utilities for processing model parameters and their metrics.</span>
<span id="cb62-956"><a href="#cb62-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-957"><a href="#cb62-957" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="co">[</span><span class="ot">Report package</span><span class="co">](https://easystats.github.io/report/index.html)</span>: Facilitates the automated generation of reports from statistical models.</span>
<span id="cb62-958"><a href="#cb62-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-959"><a href="#cb62-959" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>@montgomery2018 describes confounding in experiments - well worth a read.</span>
<span id="cb62-960"><a href="#cb62-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-961"><a href="#cb62-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-962"><a href="#cb62-962" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix A: Solutions {#appendix-a}</span></span>
<span id="cb62-963"><a href="#cb62-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-964"><a href="#cb62-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-965"><a href="#cb62-965" aria-hidden="true" tabindex="-1"></a><span class="fu">### Solution Excercise 2: simulate data and regression reporting </span></span>
<span id="cb62-966"><a href="#cb62-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-967"><a href="#cb62-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-970"><a href="#cb62-970" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-971"><a href="#cb62-971" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb62-972"><a href="#cb62-972" aria-hidden="true" tabindex="-1"></a><span class="co">#  seed for reproducibility</span></span>
<span id="cb62-973"><a href="#cb62-973" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb62-974"><a href="#cb62-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-975"><a href="#cb62-975" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations</span></span>
<span id="cb62-976"><a href="#cb62-976" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb62-977"><a href="#cb62-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-978"><a href="#cb62-978" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data for variable A with specified mean and sd</span></span>
<span id="cb62-979"><a href="#cb62-979" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb62-980"><a href="#cb62-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-981"><a href="#cb62-981" aria-hidden="true" tabindex="-1"></a><span class="co"># define the specified effect size of A on Y</span></span>
<span id="cb62-982"><a href="#cb62-982" aria-hidden="true" tabindex="-1"></a>beta_A <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb62-983"><a href="#cb62-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-984"><a href="#cb62-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-985"><a href="#cb62-985" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate data and make data frame in one step</span></span>
<span id="cb62-986"><a href="#cb62-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-987"><a href="#cb62-987" aria-hidden="true" tabindex="-1"></a>df_3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-988"><a href="#cb62-988" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate data for variable A with specified mean and sd</span></span>
<span id="cb62-989"><a href="#cb62-989" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span>  <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb62-990"><a href="#cb62-990" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="dv">5</span> <span class="sc">+</span>  <span class="co"># intercept (optional)</span></span>
<span id="cb62-991"><a href="#cb62-991" aria-hidden="true" tabindex="-1"></a>    beta_A <span class="sc">*</span> A <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb62-992"><a href="#cb62-992" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-993"><a href="#cb62-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-994"><a href="#cb62-994" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb62-995"><a href="#cb62-995" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_3)</span>
<span id="cb62-996"><a href="#cb62-996" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df_3)</span>
<span id="cb62-997"><a href="#cb62-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-998"><a href="#cb62-998" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression of Y on A</span></span>
<span id="cb62-999"><a href="#cb62-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1000"><a href="#cb62-1000" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> A, <span class="at">data =</span> df_3)</span>
<span id="cb62-1001"><a href="#cb62-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1002"><a href="#cb62-1002" aria-hidden="true" tabindex="-1"></a><span class="co"># results </span></span>
<span id="cb62-1003"><a href="#cb62-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(model)</span></span>
<span id="cb62-1004"><a href="#cb62-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1005"><a href="#cb62-1005" aria-hidden="true" tabindex="-1"></a><span class="co"># nicer report</span></span>
<span id="cb62-1006"><a href="#cb62-1006" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(fit_3)</span>
<span id="cb62-1007"><a href="#cb62-1007" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(fit_3)</span>
<span id="cb62-1008"><a href="#cb62-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1009"><a href="#cb62-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1010"><a href="#cb62-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1011"><a href="#cb62-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1012"><a href="#cb62-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1013"><a href="#cb62-1013" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix B: How ANOVA can deliver the functionality of Linear Regressions</span></span>
<span id="cb62-1014"><a href="#cb62-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1015"><a href="#cb62-1015" aria-hidden="true" tabindex="-1"></a>We can get group comparisons with ANOVA, for example:</span>
<span id="cb62-1016"><a href="#cb62-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1019"><a href="#cb62-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1020"><a href="#cb62-1020" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct Tukey's HSD test for post hoc comparisons</span></span>
<span id="cb62-1021"><a href="#cb62-1021" aria-hidden="true" tabindex="-1"></a>tukey_post_hoc <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_model)</span>
<span id="cb62-1022"><a href="#cb62-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1023"><a href="#cb62-1023" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb62-1024"><a href="#cb62-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_post_hoc)</span>
<span id="cb62-1025"><a href="#cb62-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_post_hoc)</span>
<span id="cb62-1026"><a href="#cb62-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1027"><a href="#cb62-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1028"><a href="#cb62-1028" aria-hidden="true" tabindex="-1"></a>Regression and ANOVA are equivalent</span>
<span id="cb62-1029"><a href="#cb62-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1030"><a href="#cb62-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1031"><a href="#cb62-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix C: Adding Complexity in Simulation</span></span>
<span id="cb62-1032"><a href="#cb62-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1033"><a href="#cb62-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1034"><a href="#cb62-1034" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulating Data... Continued</span></span>
<span id="cb62-1035"><a href="#cb62-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1036"><a href="#cb62-1036" aria-hidden="true" tabindex="-1"></a>Data frames are used in R to store data tables. To simulate a dataset with both continuous and categorical data, you can combine the above steps:</span>
<span id="cb62-1037"><a href="#cb62-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1040"><a href="#cb62-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1041"><a href="#cb62-1041" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame with simulated data for ID, Gender, Age, and Income</span></span>
<span id="cb62-1042"><a href="#cb62-1042" aria-hidden="true" tabindex="-1"></a>data_frame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-1043"><a href="#cb62-1043" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate a sequence of IDs from 1 to n</span></span>
<span id="cb62-1044"><a href="#cb62-1044" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb62-1045"><a href="#cb62-1045" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1046"><a href="#cb62-1046" aria-hidden="true" tabindex="-1"></a>  <span class="co"># randomly assign 'Male' or 'Female' to each observation</span></span>
<span id="cb62-1047"><a href="#cb62-1047" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gender =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-1048"><a href="#cb62-1048" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1049"><a href="#cb62-1049" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate 'Age' data: normally distributed with mean 30 and sd 5</span></span>
<span id="cb62-1050"><a href="#cb62-1050" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb62-1051"><a href="#cb62-1051" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-1052"><a href="#cb62-1052" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulate 'Income' data: normally distributed with mean 50000 and sd 10000</span></span>
<span id="cb62-1053"><a href="#cb62-1053" aria-hidden="true" tabindex="-1"></a>  <span class="at">Income =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50000</span>, <span class="at">sd =</span> <span class="dv">10000</span>)</span>
<span id="cb62-1054"><a href="#cb62-1054" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-1055"><a href="#cb62-1055" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1056"><a href="#cb62-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1057"><a href="#cb62-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1058"><a href="#cb62-1058" aria-hidden="true" tabindex="-1"></a>Note that you can sample probabilistically for your groups</span>
<span id="cb62-1059"><a href="#cb62-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1062"><a href="#cb62-1062" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1063"><a href="#cb62-1063" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># total number of observations</span></span>
<span id="cb62-1064"><a href="#cb62-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1065"><a href="#cb62-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 'Gender' with a 40/60 proportion for Male/Female</span></span>
<span id="cb62-1066"><a href="#cb62-1066" aria-hidden="true" tabindex="-1"></a>Gender <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</span>
<span id="cb62-1067"><a href="#cb62-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1068"><a href="#cb62-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1069"><a href="#cb62-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">### More complexity </span></span>
<span id="cb62-1070"><a href="#cb62-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1073"><a href="#cb62-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1074"><a href="#cb62-1074" aria-hidden="true" tabindex="-1"></a><span class="co"># set the number of observations</span></span>
<span id="cb62-1075"><a href="#cb62-1075" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb62-1076"><a href="#cb62-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1077"><a href="#cb62-1077" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the 'Age' variable</span></span>
<span id="cb62-1078"><a href="#cb62-1078" aria-hidden="true" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb62-1079"><a href="#cb62-1079" aria-hidden="true" tabindex="-1"></a>sd_age <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb62-1080"><a href="#cb62-1080" aria-hidden="true" tabindex="-1"></a>Age <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mean_age, <span class="at">sd =</span> sd_age)</span>
<span id="cb62-1081"><a href="#cb62-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1082"><a href="#cb62-1082" aria-hidden="true" tabindex="-1"></a><span class="co"># define coefficients explicitly</span></span>
<span id="cb62-1083"><a href="#cb62-1083" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="dv">20000</span>   <span class="co"># Intercept for the income equation</span></span>
<span id="cb62-1084"><a href="#cb62-1084" aria-hidden="true" tabindex="-1"></a>beta_age <span class="ot">&lt;-</span> <span class="dv">1500</span>     <span class="co"># Coefficient for the effect of age on income</span></span>
<span id="cb62-1085"><a href="#cb62-1085" aria-hidden="true" tabindex="-1"></a>error_sd <span class="ot">&lt;-</span> <span class="dv">10000</span>    <span class="co"># Standard deviation of the error term</span></span>
<span id="cb62-1086"><a href="#cb62-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1087"><a href="#cb62-1087" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate 'Income' based on 'Age' and defined coefficients</span></span>
<span id="cb62-1088"><a href="#cb62-1088" aria-hidden="true" tabindex="-1"></a>Income <span class="ot">&lt;-</span> intercept <span class="sc">+</span> beta_age <span class="sc">*</span> Age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> error_sd)</span>
<span id="cb62-1089"><a href="#cb62-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1090"><a href="#cb62-1090" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame to hold the simulated data</span></span>
<span id="cb62-1091"><a href="#cb62-1091" aria-hidden="true" tabindex="-1"></a>data_complex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Age, Income)</span>
<span id="cb62-1092"><a href="#cb62-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1093"><a href="#cb62-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1094"><a href="#cb62-1094" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualising Simulated Data</span></span>
<span id="cb62-1095"><a href="#cb62-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1096"><a href="#cb62-1096" aria-hidden="true" tabindex="-1"></a>Visualising your simulated data can help understand its distribution and relationships. Use the <span class="in">`ggplot2`</span> package for this:</span>
<span id="cb62-1097"><a href="#cb62-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1100"><a href="#cb62-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1101"><a href="#cb62-1101" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-1102"><a href="#cb62-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_complex, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Income)) <span class="sc">+</span></span>
<span id="cb62-1103"><a href="#cb62-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-1104"><a href="#cb62-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-1105"><a href="#cb62-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simulated Age vs. Income"</span>, <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Income"</span>)</span>
<span id="cb62-1106"><a href="#cb62-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb62-1107"><a href="#cb62-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1108"><a href="#cb62-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1109"><a href="#cb62-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1110"><a href="#cb62-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix D: Causal Inference Glossary</span></span>
<span id="cb62-1111"><a href="#cb62-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1112"><a href="#cb62-1112" aria-hidden="true" tabindex="-1"></a>Note, as of yet, we have only encountered several of the terms in this glossary.</span>
<span id="cb62-1113"><a href="#cb62-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1114"><a href="#cb62-1114" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Glossary of key terms in causal inference</span><span class="co">](/content/glossary.pdf)</span></span>
<span id="cb62-1115"><a href="#cb62-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1116"><a href="#cb62-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1117"><a href="#cb62-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1118"><a href="#cb62-1118" aria-hidden="true" tabindex="-1"></a><span class="fu">### Packages</span></span>
<span id="cb62-1119"><a href="#cb62-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-1122"><a href="#cb62-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-1123"><a href="#cb62-1123" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span>
<span id="cb62-1124"><a href="#cb62-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>