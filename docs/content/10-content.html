<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.20">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph Bulbulia">
<meta name="dcterms.date" content="2025-05-13">

<title>Hands On Working With Quarto Manuscript – PSYC 434 Conducting Research Across Cultures: Trimester 1, 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-6b83053bd867e91890e3c09412db0bb7.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b150b11e25d71d79f94868488eae0a4a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 434 Conducting Research Across Cultures: Trimester 1, 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../content/course-outline.html"> 
<span class="menu-text">Course Outline</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-content" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Content</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-content">    
        <li>
    <a class="dropdown-item" href="../content/glossary.pdf">
 <span class="dropdown-text">Glossary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/course-outline.html">
 <span class="dropdown-text">Course Outline</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/01-content.html">
 <span class="dropdown-text">Week 1: Course Introduction - R (installing packages)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/02-content.html">
 <span class="dropdown-text">Week 2: Causal Diagrams - Elementary Structures and Rules - R (using the interface)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/03-content.html">
 <span class="dropdown-text">Week 3: Causal Diagrams - Confounding Bias - R (regression/simulation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/04-content.html">
 <span class="dropdown-text">Week 4: Causal Diagrams - Interaction, Measurement Bias, Selection Bias - R (regression/simulation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/05-content.html">
 <span class="dropdown-text">Week 5: Causal Inference - Average Treatment Effects - R (regression/simulation: ATE)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/06-content.html">
 <span class="dropdown-text">Week 6: Conditional Average Treatment Effects (CATE) - R (regression/simulation: ATE)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/07-quiz.html">
 <span class="dropdown-text">Week 7: In Class Test</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/08-content.html">
 <span class="dropdown-text">Week 8: Estimation of ATE and CATE using machine learning - R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/09-content.html">
 <span class="dropdown-text">Week 9: Theoretically postulated Subgroups analysis- R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/10-content.html">
 <span class="dropdown-text">Week 10: Hands On: Writing Up Your Analysis: Quarto Documents</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/11-content.html">
 <span class="dropdown-text">Week 11: Measurement: Factor Analysis, CFA, MultiGroup CFA, Partial Invariance/ And How These Approaches Fail</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/12-content.html">
 <span class="dropdown-text">Week 12: Student Presentations</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Hands On Working With Quarto Manuscript</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Joseph Bulbulia <a href="mailto:joseph.bulbulia@vuw.ac.nz" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-5861-2056" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Victoria University of Wellington, New Zealand
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 13, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#part-1-quarto-manuscripts" id="toc-part-1-quarto-manuscripts" class="nav-link active" data-scroll-target="#part-1-quarto-manuscripts">Part 1: Quarto manuscripts</a></li>
  <li><a href="#code-review-your-analysis" id="toc-code-review-your-analysis" class="nav-link" data-scroll-target="#code-review-your-analysis">Code review: YOUR analysis</a></li>
  <li><a href="#quarto-with-boilerplate" id="toc-quarto-with-boilerplate" class="nav-link" data-scroll-target="#quarto-with-boilerplate">Quarto with <code>boilerplate</code></a>
  <ul class="collapse">
  <li><a href="#script-0-set-up-your-library" id="toc-script-0-set-up-your-library" class="nav-link" data-scroll-target="#script-0-set-up-your-library">Script 0: Set up your library/</a></li>
  <li><a href="#script-1-addingrevising-measures" id="toc-script-1-addingrevising-measures" class="nav-link" data-scroll-target="#script-1-addingrevising-measures">Script 1: Adding/Revising Measures</a></li>
  <li><a href="#script-3-setting-up-your-manuscript-document" id="toc-script-3-setting-up-your-manuscript-document" class="nav-link" data-scroll-target="#script-3-setting-up-your-manuscript-document">Script 3: Setting Up Your Manuscript Document</a></li>
  <li><a href="#what-you-have-learned" id="toc-what-you-have-learned" class="nav-link" data-scroll-target="#what-you-have-learned">What You Have Learned</a></li>
  <li><a href="#frequently-asked-questions" id="toc-frequently-asked-questions" class="nav-link" data-scroll-target="#frequently-asked-questions">Frequently Asked Questions</a>
  <ul class="collapse">
  <li><a href="#do-i-need-to-use-quarto-for-making-my-report" id="toc-do-i-need-to-use-quarto-for-making-my-report" class="nav-link" data-scroll-target="#do-i-need-to-use-quarto-for-making-my-report">Do I need to use ‘quarto’ for making my report?</a></li>
  <li><a href="#i-cannot-save-or-retrieve-files-from-folders" id="toc-i-cannot-save-or-retrieve-files-from-folders" class="nav-link" data-scroll-target="#i-cannot-save-or-retrieve-files-from-folders">I cannot save or retrieve files from folders</a></li>
  <li><a href="#i-cannot-run-margot_causal_forest_parallel" id="toc-i-cannot-run-margot_causal_forest_parallel" class="nav-link" data-scroll-target="#i-cannot-run-margot_causal_forest_parallel">I cannot run ‘margot_causal_forest_parallel()’</a></li>
  <li><a href="#i-cannot-run-margot_flip_forests_parallel" id="toc-i-cannot-run-margot_flip_forests_parallel" class="nav-link" data-scroll-target="#i-cannot-run-margot_flip_forests_parallel">I cannot run ‘margot_flip_forests_parallel()’</a></li>
  <li><a href="#my-r-code-is-not-working" id="toc-my-r-code-is-not-working" class="nav-link" data-scroll-target="#my-r-code-is-not-working">My R code is not working</a></li>
  <li><a href="#i-do-not-know-how-margot-package-functions-work" id="toc-i-do-not-know-how-margot-package-functions-work" class="nav-link" data-scroll-target="#i-do-not-know-how-margot-package-functions-work">I do not know how ‘margot’ package functions work</a></li>
  <li><a href="#what-is-the-recommended-workflow-for-investigating-heterogeneity" id="toc-what-is-the-recommended-workflow-for-investigating-heterogeneity" class="nav-link" data-scroll-target="#what-is-the-recommended-workflow-for-investigating-heterogeneity">What is the recommended workflow for investigating heterogeneity?</a></li>
  <li><a href="#i-cannot-create-a-quarto-document" id="toc-i-cannot-create-a-quarto-document" class="nav-link" data-scroll-target="#i-cannot-create-a-quarto-document">I cannot create a ‘quarto’ document</a></li>
  <li><a href="#i-cannot-render-the-quarto-document-as-pdf" id="toc-i-cannot-render-the-quarto-document-as-pdf" class="nav-link" data-scroll-target="#i-cannot-render-the-quarto-document-as-pdf">I cannot render the ‘quarto’ document as PDF</a></li>
  <li><a href="#is-it-plagiarism-to-use-the-boiler-plate-outputs-verbatim" id="toc-is-it-plagiarism-to-use-the-boiler-plate-outputs-verbatim" class="nav-link" data-scroll-target="#is-it-plagiarism-to-use-the-boiler-plate-outputs-verbatim">Is it plagiarism to use the boiler-plate outputs verbatim?</a></li>
  <li><a href="#i-do-not-have-a-boiler-plate-template-used-in-the-example-script" id="toc-i-do-not-have-a-boiler-plate-template-used-in-the-example-script" class="nav-link" data-scroll-target="#i-do-not-have-a-boiler-plate-template-used-in-the-example-script">I do not have a boiler-plate template used in the example script</a></li>
  <li><a href="#my-code-was-working-with-the-old-template-where-can-i-find-it" id="toc-my-code-was-working-with-the-old-template-where-can-i-find-it" class="nav-link" data-scroll-target="#my-code-was-working-with-the-old-template-where-can-i-find-it">My code was working with the old template, where can I find it?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="part-1-quarto-manuscripts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="part-1-quarto-manuscripts">Part 1: Quarto manuscripts</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Required</strong> Download Quarto here: - Use the <code>prelease</code> version: https://quarto.org/docs/download/ <strong>Optional</strong> - <span class="citation" data-cites="Bulbulia2024PracticalGuide">(<a href="#ref-Bulbulia2024PracticalGuide" role="doc-biblioref">Bulbulia 2024</a>)</span> <a href="https://osf.io/preprints/psyarxiv/uyg3d">link</a> - <span class="citation" data-cites="hoffman2023">(<a href="#ref-hoffman2023" role="doc-biblioref">Hoffman et al. 2023</a>)</span> <a href="https://arxiv.org/pdf/2304.09460.pdf">link</a></p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="ref-hoffman2023" class="csl-entry" role="listitem">
Hoffman, Katherine L., Diego Salazar-Barreto, Kara E. Rudolph, and Iván Díaz. 2023. <span>“Introducing Longitudinal Modified Treatment Policies: A Unified Framework for Studying Complex Exposures,”</span> April. <a href="https://doi.org/10.48550/arXiv.2304.09460">https://doi.org/10.48550/arXiv.2304.09460</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-Bulbulia2024PracticalGuide" class="csl-entry" role="listitem">
Bulbulia, J. A. 2024. <span>“A Practical Guide to Causal Inference in Three-Wave Panel Studies.”</span> OSF. <a href="https://doi.org/10.31234/osf.io/uyg3d">https://doi.org/10.31234/osf.io/uyg3d</a>.
</div></div><div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Entering bibliographic details</li>
<li>Writing up your manuscript</li>
</ul>
</div>
</div>
</section>
<section id="code-review-your-analysis" class="level1">
<h1>Code review: YOUR analysis</h1>
<ul>
<li>Create a new Rstudio project</li>
<li>Modify <em>these</em> scripts</li>
</ul>
<div class="callout-note-script-0">
<p><a href="../laboratory/lab-10/00-setup-L10.R">Download full lab scripts 0</a></p>
</div>
<div class="callout-note-script-1">
<p><a href="../laboratory/ ../laboratory/lab-10/01-init-L10.R">Download full lab scripts 1</a></p>
</div>
<div class="callout-note-script-2">
<p><a href="../laboratory/lab-10/02-make-wide-L10.R">Download full lab scripts 2</a></p>
</div>
<div class="callout-note-script-3">
<p><a href="../laboratory/lab-10/03-models-L10-v3.R">Download full lab scripts 3</a></p>
</div>
</section>
<section id="quarto-with-boilerplate" class="level1 page-columns page-full">
<h1>Quarto with <code>boilerplate</code></h1>
<div class="callout-quarto-manuscript-template">
<p><a href="../quarto/new_initial_quarto_document.docx">Download Quarto Template</a></p>
</div>
<section id="script-0-set-up-your-library" class="level2">
<h2 class="anchored" data-anchor-id="script-0-set-up-your-library">Script 0: Set up your library/</h2>
<p>Note – rerun this script if you are missing updated templates, as they have been updated 23 May 2025</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># script 00: read initial boilerplate data (for students)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># load required packages --------------------------------------------------</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"boilerplate"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"devtools"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"devtools"</span>)  <span class="co"># install devtools if missing</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"go-bayes/boilerplate"</span>)  <span class="co"># install boilerplate</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boilerplate)  <span class="co"># manage boilerplate data</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cli)          <span class="co"># friendly messages</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)         <span class="co"># project paths</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)           <span class="co"># file system utilities</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure correct boilerplate version --------------------------------------</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>min_version <span class="ot">&lt;-</span> <span class="st">"1.0.43"</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (utils<span class="sc">::</span><span class="fu">packageVersion</span>(<span class="st">"boilerplate"</span>) <span class="sc">&lt;</span> min_version) {</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"please install boilerplate &gt;= "</span>, min_version, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"  devtools::install_github('go-bayes/boilerplate')"</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h1</span>(<span class="st">"boilerplate loaded ✔"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># create local data folders ------------------------------------------------</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>path_data   <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"example_boilerplate_data"</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>path_quarto <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"quarto"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(path_data)    <span class="co"># create data folder if needed</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h2</span>(<span class="st">"data folder ready ✔"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># import student boilerplate data ------------------------------------------</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># close connections </span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">closeAllConnections</span>()</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># function</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>load_student_boilerplate <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  base_url   <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/go-bayes/templates/main/student_boilerplate_data/"</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"measures"</span>, <span class="st">"methods"</span>, <span class="st">"results"</span>, <span class="st">"discussion"</span>, <span class="st">"appendix"</span>, <span class="st">"template"</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  cli<span class="sc">::</span><span class="fu">cli_text</span>(<span class="st">"loading student boilerplate data from GitHub…"</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initialise empty list and assign category names</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  student_db <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">length</span>(categories))</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(student_db) <span class="ot">&lt;-</span> categories</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (cat <span class="cf">in</span> categories) {</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    cli<span class="sc">::</span><span class="fu">cli_text</span>(<span class="st">"  – loading {.strong {cat}} database…"</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    rds_url  <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base_url, cat, <span class="st">"_db.rds"</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    tmp_file <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">".rds"</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    student_db[[cat]] <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># download to a temporary file, then read it</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>      utils<span class="sc">::</span><span class="fu">download.file</span>(rds_url, tmp_file,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mode =</span> <span class="st">"wb"</span>,</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>                           <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"libcurl"</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">readRDS</span>(tmp_file)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>      cli<span class="sc">::</span><span class="fu">cli_alert_warning</span>(<span class="st">"failed to load {.strong {cat}}: {e$message}"</span>)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>()  <span class="co"># fallback empty list</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">finally =</span> {</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>      <span class="co"># always remove the temp file</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unlink</span>(tmp_file)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  cli<span class="sc">::</span><span class="fu">cli_text</span>(<span class="st">"successfully loaded {length(student_db)} categories"</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  student_db</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co"># after clearing connections, run:</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>student_unified_db <span class="ot">&lt;-</span> <span class="fu">load_student_boilerplate</span>()</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="co"># save imported data -------------------------------------------------------</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="fu">boilerplate_save</span>(</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  student_unified_db,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_path     =</span> path_data,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">create_backup =</span> <span class="cn">FALSE</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h1</span>(<span class="st">"data saved ✔"</span>)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a><span class="co"># set up bibliography and APA-7 template -----------------------------------</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(<span class="st">"quarto"</span>)  <span class="co"># for title.tex</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="co"># download title.tex (probably safe to overwrite)</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">url      =</span> <span class="st">"https://raw.githubusercontent.com/go-bayes/templates/refs/heads/main/quarto/title.tex"</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">"quarto/title.tex"</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode     =</span> <span class="st">"wb"</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(<span class="st">"bibliography"</span>)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(<span class="st">"csl"</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="co"># check if references.bib exists before downloading</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>bib_path <span class="ot">&lt;-</span> <span class="st">"quarto/references.bib"</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (fs<span class="sc">::</span><span class="fu">file_exists</span>(bib_path)) {</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  cli<span class="sc">::</span><span class="fu">cli_alert_info</span>(<span class="st">"references.bib already exists - skipping download"</span>)</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  cli<span class="sc">::</span><span class="fu">cli_text</span>(<span class="st">"  existing file: {.file {bib_path}}"</span>)</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">url      =</span> <span class="st">"https://raw.githubusercontent.com/go-bayes/templates/refs/heads/main/bib/references.bib"</span>,</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> bib_path,</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode     =</span> <span class="st">"wb"</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  cli<span class="sc">::</span><span class="fu">cli_alert_success</span>(<span class="st">"references.bib downloaded"</span>)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="co"># download apa7.csl (style file - probably safe to update)</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">url      =</span> <span class="st">"https://raw.githubusercontent.com/go-bayes/templates/refs/heads/main/csl/apa-7.csl"</span>,</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">"quarto/apa7.csl"</span>,</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode     =</span> <span class="st">"wb"</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h1</span>(<span class="st">"bibliography and CSL setup complete ✔"</span>)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h1</span>(<span class="st">"bibliography and CSL setup complete ✔"</span>)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a><span class="co"># end of script: do not rerun this file ------------------------------------</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(student_unified_db<span class="sc">$</span>methods<span class="sc">$</span>analytic_approach<span class="sc">$</span>general_approach_cate_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Type <code>y</code> when R asks whether to overwrite the boilerplate files; this replaces them with the latest versions. Press <code>n</code> (or just hit Enter) to keep what you already have.</p>
<p>Your own edits—such as custom rows in the measures table – are stored elsewhere, so they will not be overwritten. One tap, no tears.</p>
<p>Take-away: <code>y</code> refreshes the templates; <code>n</code> preserves the status quo.</p>
</div>
</div>
<p>This is how the the printout in your R console should look (depending on how recently you’ve run your script):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># save imported data -------------------------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">boilerplate_save</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   student_unified_db,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data_path     =</span> path_data,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">create_backup =</span> <span class="cn">FALSE</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ℹ preparing to save <span class="dv">6</span> databases</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ℹ processing measures <span class="fu">database</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> measures database</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>ℹ saving measures database to <span class="sc">/</span>Users<span class="sc">/</span>your_machine_path<span class="sc">-</span><span class="er">/</span>example_boilerplate_data<span class="sc">/</span>measures_db.rds</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>✔ saved measures database</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>ℹ processing methods <span class="fu">database</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">1</span> new entries will be added<span class="sc">:</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">+</span> student_target_population</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span> <span class="dv">2</span> entries will be removed<span class="sc">:</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>   <span class="sc">-</span> target_population</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>   <span class="sc">-</span> sample</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>Save methods database with these changes? [y<span class="sc">/</span>n]<span class="sc">:</span> y</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>ℹ saving methods database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>methods_db.rds</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>✔ saved methods database</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>ℹ processing results <span class="fu">database</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> results database</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>ℹ saving results database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>results_db.rds</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>✔ saved results database</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>ℹ processing discussion <span class="fu">database</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">2</span> existing entries will be modified<span class="sc">:</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">~</span> student_authors_statement</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">~</span> student_ethics</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>Save discussion database with these changes? [y<span class="sc">/</span>n]<span class="sc">:</span> y</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>ℹ saving discussion database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>discussion_db.rds</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>✔ saved discussion database</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>ℹ processing appendix <span class="fu">database</span> (<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> appendix database</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>ℹ saving appendix database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>appendix_db.rds</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>✔ saved appendix database</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>ℹ processing template <span class="fu">database</span> (<span class="dv">6</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> template database</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>ℹ saving template database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>template_db.rds</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>✔ saved template database</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>✔ successfully saved all <span class="dv">6</span> databases</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="script-1-addingrevising-measures" class="level2">
<h2 class="anchored" data-anchor-id="script-1-addingrevising-measures">Script 1: Adding/Revising Measures</h2>
<p>Note – rerun this script if you are missing updated templates, as they have been updated 23 May 2025</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># script 01: add or revise measures (for students)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load required packages --------------------------------------------------</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"boilerplate"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"devtools"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"devtools"</span>)  <span class="co"># install devtools if missing</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"go-bayes/boilerplate"</span>)  <span class="co"># install boilerplate</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boilerplate)  <span class="co"># tools for measure management</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cli)          <span class="co"># user-friendly messages</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)         <span class="co"># project-friendly file paths</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure correct boilerplate version --------------------------------------</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (utils<span class="sc">::</span><span class="fu">packageVersion</span>(<span class="st">"boilerplate"</span>) <span class="sc">&lt;</span> <span class="st">"1.0.41"</span>) {</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"please install boilerplate &gt;= 1.0.41: \</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">       devtools::install_github('go-bayes/boilerplate')"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h1</span>(<span class="st">"boilerplate loaded ✔"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># define data paths --------------------------------------------------------</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>path_src   <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"example_boilerplate_data"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>path_final <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"final_boilerplate_data"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># create final data directory if needed -----------------------------------</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(path_final)) {</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(path_final)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h1</span>(<span class="st">"data folder ready ✔"</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co"># import unified database --------------------------------------------------</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>unified_db <span class="ot">&lt;-</span> <span class="fu">boilerplate_import</span>(<span class="at">data_path =</span> path_src)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># save a copy to avoid overwriting original --------------------------------</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">boilerplate_save</span>(</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  unified_db,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_path   =</span> path_final,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_file =</span> <span class="st">"unified_db"</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h2</span>(<span class="st">"database imported and saved ✔"</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect structure and existing measures ----------------------------------</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(unified_db, <span class="at">max.level =</span> <span class="dv">2</span>)     <span class="co"># glance at top-level structure</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(unified_db<span class="sc">$</span>measures))  <span class="co"># list defined measures</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co"># example: check for a specific measure ------------------------------------</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>measure_name <span class="ot">&lt;-</span> <span class="st">"emp_job_satisfaction"</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.null</span>(unified_db<span class="sc">$</span>measures[[measure_name]])) {</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  cli<span class="sc">::</span><span class="fu">cli_alert_info</span>(<span class="st">"{measure_name} not defined yet"</span>)</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(unified_db<span class="sc">$</span>measures[[measure_name]])</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="co"># add a new measure --------------------------------------------------------</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>unified_db<span class="sc">$</span>measures[[measure_name]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">name        =</span> <span class="st">"Job Satisfaction"</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">"job satisfaction was measured with a single item."</span>,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference   =</span> <span class="st">"eisenbarth2022aspects"</span>,</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">waves       =</span> <span class="st">"1-present"</span>,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">keywords    =</span> <span class="fu">c</span>(<span class="st">"employment"</span>, <span class="st">"mental health"</span>),</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">items       =</span> <span class="fu">list</span>(<span class="st">"how satisfied are you with your current job?"</span>)</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>unified_db<span class="sc">$</span>measures[[<span class="st">"cyberbulling"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="co"># use the measure name in `colnames(df_nz_long)`</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note that cyberbulling is not actually in our simulated dataset </span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this is just an llustration</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">name        =</span> <span class="st">"Cyberbulling"</span>,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">"Cyberbulling was measured with a single item."</span>,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference   =</span> <span class="st">"wang2019cyberbullying"</span>,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">waves       =</span> <span class="st">"6-11"</span>,</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">keywords    =</span> <span class="fu">c</span>(<span class="st">"mental health"</span>),</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">items       =</span> <span class="fu">list</span>(<span class="st">"Has someone ever used the internet, a mobile phone, or digital camera to hurt, intimidate or embarrass you?"</span>)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="co"># saving a new measure</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>unified_db<span class="sc">$</span>measures[[<span class="st">"pwi"</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">name        =</span> <span class="st">"Personal Well-Being Index"</span>,</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">"The Personal Well-Being Index consists of three items, asking 'How satisfied are you with...' "</span>,</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference   =</span> <span class="st">"cummins2003development"</span>,</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">waves       =</span> <span class="st">"1-present"</span>,</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">keywords    =</span> <span class="fu">c</span>(<span class="st">"employment"</span>, <span class="st">"mental health"</span>),</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">items       =</span> <span class="fu">list</span>(<span class="st">"'Your standard of living.'"</span>, <span class="st">"'Your health.'"</span>, <span class="st">"'Your future security.'"</span>, <span class="st">"'Your personal relationships.'"</span>)</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="co"># save with backup ---------------------------------------------------------</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a><span class="fu">boilerplate_save</span>(</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>  unified_db,</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_path     =</span> path_final,</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">create_backup =</span> <span class="cn">TRUE</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h2</span>(<span class="st">"new measure added and saved ✔"</span>)</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="co"># revise an existing measure ------------------------------------------------</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>revise_name <span class="ot">&lt;-</span> <span class="st">"family_time_binary"</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h1</span>(<span class="st">"revising {revise_name}"</span>)</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="co"># use modifyList to update only changed fields</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>unified_db<span class="sc">$</span>measures[[revise_name]] <span class="ot">&lt;-</span> <span class="fu">modifyList</span>(</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>  unified_db<span class="sc">$</span>measures[[revise_name]],</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">name        =</span> <span class="st">"Family Time (binary)"</span>,</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">description =</span> <span class="st">"code string (binary): 0 = none, 1 = any time"</span>,</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">reference   =</span> <span class="st">"@sibley2020"</span>,</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">waves       =</span> <span class="st">"10-13"</span>,</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">keywords    =</span> <span class="fu">c</span>(<span class="st">"cooperation"</span>)</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a><span class="co"># view revised measure ------------------------------------------------------</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(unified_db<span class="sc">$</span>measures[[revise_name]])</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a><span class="co"># save all changes -----------------------------------------------------------</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a><span class="fu">boilerplate_save</span>(</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>  unified_db,</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_path =</span> path_final,</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">confirm   =</span> <span class="cn">TRUE</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>cli<span class="sc">::</span><span class="fu">cli_h2</span>(<span class="st">"measure revised and saved ✔"</span>)</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a><span class="co"># to reload updated database, uncomment the following line --------------</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a><span class="co"># unified_db &lt;- boilerplate_import(data_path = path_final)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>remember to type ‘y’ to save changes</li>
</ul>
</div>
</div>
<p>When re-running your scripts, the printout should allow you to save to your working database folder. When saving tick ‘y’</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># save a copy to avoid overwriting original --------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">boilerplate_save</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   unified_db,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data_path   =</span> path_final,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">output_file =</span> <span class="st">"unified_db"</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>ℹ preparing to save <span class="dv">6</span> databases</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ℹ processing measures <span class="fu">database</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> measures database</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ℹ saving measures database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>measures_db.rds</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>✔ saved measures database</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>ℹ processing methods <span class="fu">database</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">1</span> new entries will be added<span class="sc">:</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">+</span> student_target_population</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span> <span class="dv">2</span> entries will be removed<span class="sc">:</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>   <span class="sc">-</span> target_population</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>   <span class="sc">-</span> sample</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>Save methods database with these changes? [y<span class="sc">/</span>n]<span class="sc">:</span> y</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>ℹ created backup at<span class="sc">:</span> <span class="er">/</span>Users<span class="sc">/</span>your_path<span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>methods_db.rds<span class="fl">.20250523</span>_131930.bak</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>ℹ saving methods database to  <span class="sc">/</span>Users<span class="sc">/</span>your_path<span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>methods_db.rds</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>✔ saved methods database</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>ℹ processing results <span class="fu">database</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> results database</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>ℹ saving results database to  <span class="sc">/</span>Users<span class="sc">/</span>your_path<span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>results_db.rds</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>✔ saved results database</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>ℹ processing discussion <span class="fu">database</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">2</span> existing entries will be modified<span class="sc">:</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">~</span> student_authors_statement</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">~</span> student_ethics</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>Save discussion database with these changes? [y<span class="sc">/</span>n]<span class="sc">:</span> y</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>ℹ created backup at<span class="sc">:</span> <span class="er">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>discussion_db.rds<span class="fl">.20250523</span>_131933.bak</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>ℹ saving discussion database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>discussion_db.rds</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>✔ saved discussion database</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>ℹ processing appendix <span class="fu">database</span> (<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> appendix database</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>ℹ saving appendix database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>appendix_db.rds</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>✔ saved appendix database</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>ℹ processing template <span class="fu">database</span> (<span class="dv">6</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> template database</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>ℹ saving template database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>template_db.rds</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>✔ saved template database</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>✔ successfully saved all <span class="dv">6</span> databases</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="script-3-setting-up-your-manuscript-document" class="level2">
<h2 class="anchored" data-anchor-id="script-3-setting-up-your-manuscript-document">Script 3: Setting Up Your Manuscript Document</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>save this document as a <code>.qmd</code> file in a directory called ‘quarto’ (in your rstudio project)</li>
<li>please run the code line-by-line (ctr/cmd + ENTER) before rendering</li>
<li>to render a document click ‘Render’</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="⚠️ IMPORTANT: flipped outcomes">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
⚠️ IMPORTANT: flipped outcomes
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before you run the analysis, check whether you inverted any outcomes.<br>
Set:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>use_flipped <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># ← make TRUE if you flipped outcomes; FALSE otherwise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>title<span class="sc">:</span> <span class="st">"Your Title"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>abstract<span class="sc">:</span> <span class="er">|</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="er">**</span>Background<span class="sc">**</span><span class="er">:</span> (Brief few sentences)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Objectives<span class="sc">**</span><span class="er">:</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.</span> Estimate the causal effect of YOUR EXPOSURE on YOUR OUTCOMES measured one year later.</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">2.</span> Evaluate whether these effects vary across the population.</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fl">3.</span> Provide policy guidance on which individuals might benefit most.</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Method<span class="sc">**</span><span class="er">:</span> We conducted a three<span class="sc">-</span>wave retrospective cohort <span class="fu">study</span> (waves XX<span class="sc">-</span>XXX, October XXXX<span class="sc">--</span>October XXXX) using data <span class="sc">*</span>SIMULATED<span class="sc">*</span> from the New Zealand Attitudes and Values Study, a nationally representative panel. Participants were eligible <span class="cf">if</span> they participated <span class="cf">in</span> the NZAVS <span class="cf">in</span> the baseline <span class="fu">wave</span> (XXXX,...). We defined the exposure <span class="fu">as</span> (XXXX  <span class="sc">&gt;</span> NUMBER on a <span class="dv">1-7</span> Likert <span class="fu">Scale</span> (<span class="dv">1</span> <span class="ot">=</span> yes, <span class="dv">0</span> <span class="ot">=</span> no)). To address attrition, we applied inverse probability of censoring weights; to improve external validity, we applied weights to the population distribution of Age, Ethnicity, and Gender. We computed expected mean outcomes <span class="cf">for</span> the population <span class="cf">in</span> each exposure <span class="fu">condition</span> (high XXXX<span class="sc">/</span>low XXXXX). Under standard causal assumptions of unconfoundedness, the contrast provides an unbiased average treatment effect. We then used causal forests to detect heterogeneity <span class="cf">in</span> these effects and employed policy tree algorithms to identify <span class="fu">individuals</span> (<span class="st">"strong responders"</span>) likely to experience the greatest benefits.</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Results<span class="sc">**</span><span class="er">:</span>   Increasing XXXXX leads to XXXXX. Heterogeneous responses <span class="fu">to</span> (e.g. <span class="sc">*</span>Forgiveness<span class="sc">*</span>, <span class="sc">*</span>Personal Well<span class="sc">-</span>Being<span class="sc">*</span>, and <span class="sc">*</span>Life<span class="sc">-</span>Satisfaction<span class="sc">*</span>...) reveal structural variability <span class="cf">in</span> subpopulations...</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Implications<span class="sc">**</span><span class="er">:</span> (Brief few sentences)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Keywords<span class="sc">**</span><span class="er">:</span> <span class="er">*</span>Causal Inference<span class="sc">*</span>;  <span class="sc">*</span>Cross<span class="sc">-</span>validation<span class="sc">*</span>; <span class="sc">*</span>Distress<span class="sc">*</span>; <span class="sc">*</span>Employment<span class="sc">*</span>; <span class="sc">*</span>Longitudinal<span class="sc">*</span>; <span class="sc">*</span>Machine Learning<span class="sc">*</span>; <span class="sc">*</span>Religion<span class="sc">*</span>; <span class="sc">*</span>Semi<span class="sc">-</span>parametric<span class="sc">*</span>; <span class="sc">*</span>Targeted Learning<span class="sc">*</span>.</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>author<span class="sc">:</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span> name<span class="sc">:</span> YOUR NAME</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    affiliation<span class="sc">:</span> Victoria University of Wellington, New Zealand</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    email<span class="sc">:</span> XXXXX</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    corresponding<span class="sc">:</span> yes</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>keywords<span class="sc">:</span> [Causal Inference, Cross<span class="sc">-</span>validation,...]</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>editor_options<span class="sc">:</span> </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  chunk_output_type<span class="sc">:</span> console</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>date<span class="sc">:</span> <span class="st">"last-modified"</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>fontfamily<span class="sc">:</span> libertinus</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>bibliography<span class="sc">:</span> references.bib</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>csl<span class="sc">:</span> apa7.csl</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>format<span class="sc">:</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  docx<span class="sc">:</span> <span class="co"># comment this out if you want pdf</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    default<span class="sc">:</span> false  <span class="co"># comment this out if you want pdf</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  pdf<span class="sc">:</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    pdf<span class="sc">-</span>engine<span class="sc">:</span> lualatex</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    sanitise<span class="sc">:</span> true</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    keep<span class="sc">-</span>tex<span class="sc">:</span> true</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    link<span class="sc">-</span>citations<span class="sc">:</span> true</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    colorlinks<span class="sc">:</span> true</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    documentclass<span class="sc">:</span> article</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    classoption<span class="sc">:</span> [<span class="st">"single column"</span>]</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    lof<span class="sc">:</span> false</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    lot<span class="sc">:</span> false</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    geometry<span class="sc">:</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> top<span class="ot">=</span><span class="dv">30</span>mm</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> left<span class="ot">=</span><span class="dv">25</span>mm</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> heightrounded</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> headsep<span class="ot">=</span><span class="dv">22</span>pt</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> headheight<span class="ot">=</span><span class="dv">11</span>pt</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> footskip<span class="ot">=</span><span class="dv">33</span>pt</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> ignorehead</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> ignorefoot</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    header<span class="sc">-</span>includes<span class="sc">:</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> \let\oldtabular\tabular</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> \renewcommand{\tabular}{\small\oldtabular}</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> \setlength{\tabcolsep}{<span class="dv">4</span>pt}  <span class="co"># adjust this value as needed</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>execute<span class="sc">:</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  echo<span class="sc">:</span> false</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  warning<span class="sc">:</span> false</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  include<span class="sc">:</span> true</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  eval<span class="sc">:</span> true</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: setup</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: false</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="at"># ── initialisation and setup ──────────────────────────────────────────────────</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a><span class="at"># save this file in your project root (e.g. 'quarto/1_setup.R')</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a><span class="at"># load here to manage paths</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a><span class="at">dep &lt;- requireNamespace("here", quietly = TRUE)</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="at">if (!dep) install.packages("here")</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="at">library(here)</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a><span class="at"># create required folders (these will likely already exist)</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a><span class="at">dirs &lt;- c(</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a><span class="at">  here("quarto"),</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a><span class="at">  here("bibliography"),</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="at">  here("save_directory"),</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="at">  here("csl")</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a><span class="at">for (d in dirs) {</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="at">  if (!dir.exists(d)) dir.create(d, recursive = TRUE)</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a><span class="at"># ensure tinytex for PDF rendering</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a><span class="at">if (!requireNamespace("tinytex", quietly = TRUE)) {</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a><span class="at">  install.packages("tinytex")</span></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a><span class="at">  tinytex::install_tinytex()</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a><span class="at"># ensure pacman for package management</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a><span class="at">if (!requireNamespace("pacman", quietly = TRUE)) {</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a><span class="at">  install.packages("pacman")</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="at"># min version of margot</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="at">if (packageVersion("margot") &lt; "1.0.54") {</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a><span class="at">  stop(</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a><span class="at">    "please install margot &gt;= 1.0.54 for this workflow</span><span class="sc">\n</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a><span class="at">       run: </span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a><span class="at">       devtools::install_github('go-bayes/margot')</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a><span class="at">"</span></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="at"># call library</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a><span class="at">library("margot")</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a><span class="at"># check package version</span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a><span class="at">packageVersion(pkg = "margot")</span></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a><span class="at"># load (and install if needed) all required packages</span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a><span class="at">pacman::p_load(</span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate, shiny, tidyverse,</span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a><span class="at">  kableExtra, glue, patchwork, stringr,</span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a><span class="at">  ggplot2, ggeffects, parameters,</span></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a><span class="at">  table1, knitr, extrafont, here, cli</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a><span class="at"># load fonts (requires prior extrafont::font_import())</span></span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a><span class="at">if (requireNamespace("extrafont", quietly = TRUE)) {</span></span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a><span class="at">  extrafont::loadfonts(device = "all")</span></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a><span class="at">  message("'extrafont' not installed; skipping font loading")</span></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a><span class="at"># reproducibility</span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a><span class="at">set.seed(123)</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a><span class="at"># copy CSL and BibTeX into quarto folder</span></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a><span class="at">src_files &lt;- list(</span></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a><span class="at">  c(here("csl", "apa7.csl"),     here("quarto", "apa7.csl")),</span></span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a><span class="at">  c(here("bibliography", "references.bib"), here("quarto", "references.bib"))</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a><span class="at">for (f in src_files) {</span></span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a><span class="at">  if (!file.exists(f[2]) &amp;&amp; file.exists(f[1])) {</span></span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a><span class="at">    file.copy(f[1], f[2])</span></span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a><span class="at"># ── define paths and import data ──────────────────────────────────────────────</span></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a><span class="at">push_mods                  &lt;- here::here("save_directory")</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a><span class="at">final_boilerplate_data     &lt;- here::here("final_boilerplate_data")</span></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a><span class="at">unified_db                 &lt;- boilerplate_import(data_path = final_boilerplate_data)</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a><span class="at"># ── read study variables ──────────────────────────────────────────────────────</span></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a><span class="at">baseline_vars              &lt;- margot::here_read("baseline_vars")</span></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a><span class="at">exposure_var               &lt;- margot::here_read("exposure_var")</span></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a><span class="at">outcome_vars               &lt;- margot::here_read("outcome_vars")</span></span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a><span class="at"># ── define study waves ────────────────────────────────────────────────────────</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a><span class="at">baseline_wave              &lt;- margot::here_read("baseline_wave")</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a><span class="at">exposure_waves             &lt;- margot::here_read("exposure_waves")</span></span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a><span class="at">outcome_wave               &lt;- margot::here_read("outcome_wave")</span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a><span class="at">baseline_wave_glued        &lt;- glue::glue(baseline_wave)</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a><span class="at"># ── define study parameters ───────────────────────────────────────────────────</span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a><span class="at">study_years                &lt;- "2018-2021"</span></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a><span class="at">name_exposure              &lt;- here_read("name_exposure")</span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a><span class="at">name_outcome_variables     &lt;- "MY OUTCOME VARIABLES IN THIS STUDY"</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a><span class="at">name_exposure_lower        &lt;- tolower(name_exposure)</span></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a><span class="at"># ── read tables for manuscript ────────────────────────────────────────────────</span></span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_baseline    &lt;- margot::here_read("baseline_table")</span></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_exposures   &lt;- margot::here_read("exposure_table")</span></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_outcomes    &lt;- margot::here_read("outcomes_table")</span></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a><span class="at">margot_bind_tables_markdown &lt;- margot::here_read("margot_bind_tables_markdown")</span></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a><span class="at"># ── sample size information ───────────────────────────────────────────────────</span></span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a><span class="at">n_total                    &lt;- margot::here_read("n_total")</span></span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a><span class="at">n_participants             &lt;- here_read("n_participants")</span></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a><span class="at"># ── variable labels and mappings ──────────────────────────────────────────────</span></span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a><span class="at">var_labels_measures        &lt;- here_read("var_labels_measures")</span></span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a><span class="at">label_mapping_all          &lt;- here_read("label_mapping_all")</span></span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a><span class="at"># ── import data for visualisation ─────────────────────────────────────────────</span></span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a><span class="at">original_df                &lt;- margot::here_read('df_wide', push_mods)</span></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a><span class="at">df_grf                     &lt;- margot::here_read('df_grf', push_mods)</span></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a><span class="at"># co-variates</span></span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a><span class="at">E                          &lt;- margot::here_read('E', push_mods)</span></span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a><span class="at"># select covariates and drop numeric attributes</span></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a><span class="at">X                          &lt;- margot::remove_numeric_attributes(df_grf[E])</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a><span class="at"># ── define nice names and regimes ─────────────────────────────────────────────</span></span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a><span class="at">nice_name_exposure         &lt;- stringr::str_to_sentence(name_exposure)</span></span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a><span class="at">name_outcomes_lower        &lt;- "multi-dimensional wellbeing"</span></span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a><span class="at">nice_name_outcome          &lt;- stringr::str_to_sentence(name_outcomes_lower)</span></span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a><span class="at"># title</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a><span class="at">ate_title                  &lt;- glue("ATE Effects of {nice_name_exposure} on {nice_name_outcome}")</span></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a><span class="at"># ── define exposure thresholds and regimes ────────────────────────────────────</span></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a><span class="at">lower_cut                  &lt;- here_read("lower_cut")</span></span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a><span class="at">upper_cut                  &lt;- here_read("upper_cut")</span></span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a><span class="at">threshold                  &lt;- here_read("threshold")</span></span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a><span class="at">inverse_threshold          &lt;- here_read("inverse_threshold")</span></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a><span class="at">scale_range                &lt;- margot::here_read("scale_range")</span></span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a><span class="at"># create and check variables</span></span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a><span class="at">value_exposure             &lt;- glue::glue(threshold,"", upper_cut,", ", scale_range)</span></span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a><span class="at">value_control              &lt;- glue::glue(inverse_threshold, upper_cut,", ", scale_range)</span></span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a><span class="at"># regimes</span></span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a><span class="at">name_control_regime_lower  &lt;- glue::glue("low {name_exposure_lower}")</span></span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a><span class="at">value_exposure_regime      &lt;- glue::glue("Set {name_exposure} {threshold} {upper_cut} {scale_range}")</span></span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a><span class="at">value_control_regime       &lt;- glue::glue("Set {name_exposure} {inverse_threshold} {upper_cut} {scale_range}")</span></span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a><span class="at">contrast_template          &lt;- "We used causal forests to estimate an average treatment effect as a contrast between *{name_control_regime_lower}* and *{name_exposure_lower}* on {name_outcomes_lower}."</span></span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a><span class="at">contrast_text              &lt;- glue(contrast_template)</span></span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a><span class="at"># ── import histogram of binary exposure ───────────────────────────────────────</span></span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a><span class="at">graph_cut                  &lt;- margot::here_read("graph_cut")</span></span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a><span class="at"># ── verify assumptions (positivity) ───────────────────────────────────────────</span></span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a><span class="at">transition_tables          &lt;- margot::here_read("transition_tables")</span></span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a><span class="at">transition_tables_binary   &lt;- here_read("transition_tables_binary")</span></span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a><span class="at"># ── generate measures text for methods section ────────────────────────────────</span></span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a><span class="at">baseline_measures_text     &lt;- boilerplate_generate_measures(</span></span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a><span class="at">  variable_heading = "Baseline Covariates",</span></span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a><span class="at">  variables        = baseline_vars,</span></span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a><span class="at">  db               = unified_db,</span></span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a><span class="at">  heading_level    = 3,</span></span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a><span class="at">  subheading_level = 4,</span></span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a><span class="at">  print_waves      = FALSE,</span></span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mappings   = var_labels_measures</span></span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a><span class="at">exposure_measures_text     &lt;- boilerplate_generate_measures(</span></span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a><span class="at">  variable_heading = "Exposure Variable",</span></span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a><span class="at">  variables        = name_exposure,</span></span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a><span class="at">  db               = unified_db,</span></span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a><span class="at">  heading_level    = 3,</span></span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a><span class="at">  subheading_level = 4,</span></span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a><span class="at">  print_waves      = FALSE,</span></span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mappings   = var_labels_measures</span></span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a><span class="at">outcome_measures_text      &lt;- boilerplate_generate_measures(</span></span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a><span class="at">  variable_heading = "Outcome Variables",</span></span>
<span id="cb6-243"><a href="#cb6-243" aria-hidden="true" tabindex="-1"></a><span class="at">  variables        = outcome_vars,</span></span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a><span class="at">  db               = unified_db,</span></span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a><span class="at">  heading_level    = 3,</span></span>
<span id="cb6-246"><a href="#cb6-246" aria-hidden="true" tabindex="-1"></a><span class="at">  subheading_level = 4,</span></span>
<span id="cb6-247"><a href="#cb6-247" aria-hidden="true" tabindex="-1"></a><span class="at">  print_waves      = FALSE,</span></span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mappings   = var_labels_measures</span></span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a><span class="at"># ── exposure description from database ────────────────────────────────────────</span></span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a><span class="at">measures_exposure          &lt;- glue::glue(unified_db$measures[[name_exposure]]$description)</span></span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a><span class="at"># ── set plot defaults for ate plots ───────────────────────────────────────────</span></span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a><span class="at">base_defaults_binary       &lt;- list(</span></span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a><span class="at">  type                     = "RD",</span></span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a><span class="at">  title                    = ate_title,</span></span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a><span class="at">  e_val_bound_threshold    = 1.2,</span></span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a><span class="at">  colors                   = c(</span></span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a><span class="at">    "positive"     = "#E69F00",</span></span>
<span id="cb6-261"><a href="#cb6-261" aria-hidden="true" tabindex="-1"></a><span class="at">    "not reliable" = "grey50",</span></span>
<span id="cb6-262"><a href="#cb6-262" aria-hidden="true" tabindex="-1"></a><span class="at">    "negative"     = "#56B4E9"</span></span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a><span class="at">  ),</span></span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a><span class="at">  x_offset                 = -0.25,</span></span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a><span class="at">  x_lim_lo                 = -0.25,</span></span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a><span class="at">  x_lim_hi                 = 0.25,</span></span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a><span class="at">  text_size                = 5,</span></span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a><span class="at">  linewidth                = 0.75,</span></span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a><span class="at">  estimate_scale           = 1,</span></span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a><span class="at">  base_size                = 20,</span></span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a><span class="at">  point_size               = 4,</span></span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a><span class="at">  title_size               = 20,</span></span>
<span id="cb6-273"><a href="#cb6-273" aria-hidden="true" tabindex="-1"></a><span class="at">  subtitle_size            = 16,</span></span>
<span id="cb6-274"><a href="#cb6-274" aria-hidden="true" tabindex="-1"></a><span class="at">  legend_text_size         = 10,</span></span>
<span id="cb6-275"><a href="#cb6-275" aria-hidden="true" tabindex="-1"></a><span class="at">  legend_title_size        = 10,</span></span>
<span id="cb6-276"><a href="#cb6-276" aria-hidden="true" tabindex="-1"></a><span class="at">  include_coefficients     = FALSE</span></span>
<span id="cb6-277"><a href="#cb6-277" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-278"><a href="#cb6-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-279"><a href="#cb6-279" aria-hidden="true" tabindex="-1"></a><span class="at"># ── create plot options for outcomes ──────────────────────────────────────────</span></span>
<span id="cb6-280"><a href="#cb6-280" aria-hidden="true" tabindex="-1"></a><span class="at">outcomes_options_all       &lt;- margot_plot_create_options(</span></span>
<span id="cb6-281"><a href="#cb6-281" aria-hidden="true" tabindex="-1"></a><span class="at">  title           = ate_title,</span></span>
<span id="cb6-282"><a href="#cb6-282" aria-hidden="true" tabindex="-1"></a><span class="at">  base_defaults   = base_defaults_binary,</span></span>
<span id="cb6-283"><a href="#cb6-283" aria-hidden="true" tabindex="-1"></a><span class="at">  subtitle        = "",</span></span>
<span id="cb6-284"><a href="#cb6-284" aria-hidden="true" tabindex="-1"></a><span class="at">  filename_prefix = "grf"</span></span>
<span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a><span class="at"># ── load model results ────────────────────────────────────────────────────────</span></span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a><span class="at">models_binary  &lt;- margot::here_read_qs("models_binary", push_mods)</span></span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a><span class="at"># CRITICAL DECISION POINT: FLIPPED OUTCOMES OR NOT</span></span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a><span class="at"># ********** READ THIS CAREFULLY **********</span></span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a><span class="at"># if you DID NOT flip any outcomes:</span></span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a><span class="at">#   - set: use_flipped &lt;- FALSE</span></span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a><span class="at">#   - this will use models_binary throughout</span></span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a><span class="at">#   - this will use label_mapping_all throughout</span></span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a><span class="at">#</span></span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a><span class="at"># if you DID flip outcomes:</span></span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a><span class="at">#   - set: use_flipped &lt;- TRUE</span></span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a><span class="at">#   - ensure models_binary_flipped_all exists</span></span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a><span class="at">#   - ensure flip_outcomes vector exists</span></span>
<span id="cb6-304"><a href="#cb6-304" aria-hidden="true" tabindex="-1"></a><span class="at">#   - this will create label_mapping_all_flipped</span></span>
<span id="cb6-305"><a href="#cb6-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-306"><a href="#cb6-306" aria-hidden="true" tabindex="-1"></a><span class="at">use_flipped &lt;- TRUE  # &lt;- MAKE TRUE IF YOU FLIPPED OUTCOMES, </span><span class="st">`</span>FALSE<span class="st">`</span><span class="at"> otherwise </span></span>
<span id="cb6-307"><a href="#cb6-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-308"><a href="#cb6-308" aria-hidden="true" tabindex="-1"></a><span class="at"># set up variables based on whether outcomes were flipped</span></span>
<span id="cb6-309"><a href="#cb6-309" aria-hidden="true" tabindex="-1"></a><span class="at">if (use_flipped) {</span></span>
<span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a><span class="at">  # check that required objects exist</span></span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a><span class="at">  if (!exists("models_binary_flipped_all")) {</span></span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a><span class="at">    models_binary_flipped_all &lt;- here_read_qs("models_binary_flipped_all", push_mods)</span></span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb6-314"><a href="#cb6-314" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a><span class="at">  # try to read flip_outcomes and flipped_names</span></span>
<span id="cb6-316"><a href="#cb6-316" aria-hidden="true" tabindex="-1"></a><span class="at">  # use tryCatch to handle missing files gracefully</span></span>
<span id="cb6-317"><a href="#cb6-317" aria-hidden="true" tabindex="-1"></a><span class="at">  flip_outcomes &lt;- tryCatch(</span></span>
<span id="cb6-318"><a href="#cb6-318" aria-hidden="true" tabindex="-1"></a><span class="at">    here_read("flip_outcomes"),</span></span>
<span id="cb6-319"><a href="#cb6-319" aria-hidden="true" tabindex="-1"></a><span class="at">    error = function(e) {</span></span>
<span id="cb6-320"><a href="#cb6-320" aria-hidden="true" tabindex="-1"></a><span class="at">      stop("flip_outcomes file not found. Please ensure it exists if use_flipped = TRUE")</span></span>
<span id="cb6-321"><a href="#cb6-321" aria-hidden="true" tabindex="-1"></a><span class="at">    }</span></span>
<span id="cb6-322"><a href="#cb6-322" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-323"><a href="#cb6-323" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-324"><a href="#cb6-324" aria-hidden="true" tabindex="-1"></a><span class="at">  flipped_names &lt;- tryCatch(</span></span>
<span id="cb6-325"><a href="#cb6-325" aria-hidden="true" tabindex="-1"></a><span class="at">    here_read("flipped_names"),</span></span>
<span id="cb6-326"><a href="#cb6-326" aria-hidden="true" tabindex="-1"></a><span class="at">    error = function(e) {</span></span>
<span id="cb6-327"><a href="#cb6-327" aria-hidden="true" tabindex="-1"></a><span class="at">      stop("flipped_names file not found. Please ensure it exists if use_flipped = TRUE")</span></span>
<span id="cb6-328"><a href="#cb6-328" aria-hidden="true" tabindex="-1"></a><span class="at">    }</span></span>
<span id="cb6-329"><a href="#cb6-329" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-330"><a href="#cb6-330" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-331"><a href="#cb6-331" aria-hidden="true" tabindex="-1"></a><span class="at">  # create flipped label mapping</span></span>
<span id="cb6-332"><a href="#cb6-332" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping_all_flipped &lt;- margot_reversed_labels(label_mapping_all, flip_outcomes)</span></span>
<span id="cb6-333"><a href="#cb6-333" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-334"><a href="#cb6-334" aria-hidden="true" tabindex="-1"></a><span class="at">  # use flipped models and labels</span></span>
<span id="cb6-335"><a href="#cb6-335" aria-hidden="true" tabindex="-1"></a><span class="at">  models_for_analysis &lt;- models_binary_flipped_all</span></span>
<span id="cb6-336"><a href="#cb6-336" aria-hidden="true" tabindex="-1"></a><span class="at">  labels_for_analysis &lt;- label_mapping_all_flipped</span></span>
<span id="cb6-337"><a href="#cb6-337" aria-hidden="true" tabindex="-1"></a><span class="at">  flipped_list &lt;- paste(flipped_names, collapse = ", ")</span></span>
<span id="cb6-338"><a href="#cb6-338" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-339"><a href="#cb6-339" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-340"><a href="#cb6-340" aria-hidden="true" tabindex="-1"></a><span class="at">  # use standard models and labels (no flipping)</span></span>
<span id="cb6-341"><a href="#cb6-341" aria-hidden="true" tabindex="-1"></a><span class="at">  models_for_analysis &lt;- models_binary</span></span>
<span id="cb6-342"><a href="#cb6-342" aria-hidden="true" tabindex="-1"></a><span class="at">  labels_for_analysis &lt;- label_mapping_all</span></span>
<span id="cb6-343"><a href="#cb6-343" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-344"><a href="#cb6-344" aria-hidden="true" tabindex="-1"></a><span class="at">  # ensure flipped_names is a character vector, not a function</span></span>
<span id="cb6-345"><a href="#cb6-345" aria-hidden="true" tabindex="-1"></a><span class="at">  # remove any existing flipped_names object that might be a function</span></span>
<span id="cb6-346"><a href="#cb6-346" aria-hidden="true" tabindex="-1"></a><span class="at">  if (exists("flipped_names") &amp;&amp; is.function(flipped_names)) {</span></span>
<span id="cb6-347"><a href="#cb6-347" aria-hidden="true" tabindex="-1"></a><span class="at">    rm(flipped_names)</span></span>
<span id="cb6-348"><a href="#cb6-348" aria-hidden="true" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb6-349"><a href="#cb6-349" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-350"><a href="#cb6-350" aria-hidden="true" tabindex="-1"></a><span class="at">  flipped_names &lt;- character(0)  # empty character vector</span></span>
<span id="cb6-351"><a href="#cb6-351" aria-hidden="true" tabindex="-1"></a><span class="at">  flipped_list &lt;- ""</span></span>
<span id="cb6-352"><a href="#cb6-352" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-353"><a href="#cb6-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-354"><a href="#cb6-354" aria-hidden="true" tabindex="-1"></a><span class="at"># ── average treatment effects (ate) analysis ──────────────────────────────────</span></span>
<span id="cb6-355"><a href="#cb6-355" aria-hidden="true" tabindex="-1"></a><span class="at">ate_results &lt;- margot_plot(</span></span>
<span id="cb6-356"><a href="#cb6-356" aria-hidden="true" tabindex="-1"></a><span class="at">  models_binary$combined_table,</span></span>
<span id="cb6-357"><a href="#cb6-357" aria-hidden="true" tabindex="-1"></a><span class="at">  options               = outcomes_options_all,</span></span>
<span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping         = label_mapping_all,  # always use standard labels for ate</span></span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a><span class="at">  include_coefficients  = FALSE,</span></span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a><span class="at">  save_output           = FALSE,</span></span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a><span class="at">  order                 = "evaluebound_asc",</span></span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a><span class="at">  original_df           = original_df,</span></span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a><span class="at">  e_val_bound_threshold = 1.2,</span></span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a><span class="at">  rename_ate            = TRUE,</span></span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a><span class="at">  adjust                = "bonferroni",</span></span>
<span id="cb6-366"><a href="#cb6-366" aria-hidden="true" tabindex="-1"></a><span class="at">  alpha                 = 0.05</span></span>
<span id="cb6-367"><a href="#cb6-367" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a><span class="at"># HETEROGENEITY ANALYSIS</span></span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a><span class="at"># this section adapts based on whether outcomes were flipped</span></span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a><span class="at"># check package version for heterogeneity analysis</span></span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a><span class="at">stopifnot(utils::packageVersion("margot") &gt;= "1.0.54")</span></span>
<span id="cb6-376"><a href="#cb6-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-377"><a href="#cb6-377" aria-hidden="true" tabindex="-1"></a><span class="at"># helper function for printing tables</span></span>
<span id="cb6-378"><a href="#cb6-378" aria-hidden="true" tabindex="-1"></a><span class="at">print_rate &lt;- function(tbl) {</span></span>
<span id="cb6-379"><a href="#cb6-379" aria-hidden="true" tabindex="-1"></a><span class="at">  tbl |&gt;</span></span>
<span id="cb6-380"><a href="#cb6-380" aria-hidden="true" tabindex="-1"></a><span class="at">    mutate(across(where(is.numeric), \(x) round(x, 2))) |&gt;</span></span>
<span id="cb6-381"><a href="#cb6-381" aria-hidden="true" tabindex="-1"></a><span class="at">    kbl(format = "markdown")</span></span>
<span id="cb6-382"><a href="#cb6-382" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-383"><a href="#cb6-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-384"><a href="#cb6-384" aria-hidden="true" tabindex="-1"></a><span class="at"># ── 1. screen for heterogeneity (rate autoc + rate qini) ─────────────────────</span></span>
<span id="cb6-385"><a href="#cb6-385" aria-hidden="true" tabindex="-1"></a><span class="at">rate_results &lt;- margot_rate(</span></span>
<span id="cb6-386"><a href="#cb6-386" aria-hidden="true" tabindex="-1"></a><span class="at">  models        = models_for_analysis,</span></span>
<span id="cb6-387"><a href="#cb6-387" aria-hidden="true" tabindex="-1"></a><span class="at">  policy        = "treat_best",</span></span>
<span id="cb6-388"><a href="#cb6-388" aria-hidden="true" tabindex="-1"></a><span class="at">  alpha         = 0.20,</span></span>
<span id="cb6-389"><a href="#cb6-389" aria-hidden="true" tabindex="-1"></a><span class="at">  adjust        = "fdr",</span></span>
<span id="cb6-390"><a href="#cb6-390" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping = labels_for_analysis</span></span>
<span id="cb6-391"><a href="#cb6-391" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-392"><a href="#cb6-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-393"><a href="#cb6-393" aria-hidden="true" tabindex="-1"></a><span class="at"># interpret rate results</span></span>
<span id="cb6-394"><a href="#cb6-394" aria-hidden="true" tabindex="-1"></a><span class="at">if (use_flipped) {</span></span>
<span id="cb6-395"><a href="#cb6-395" aria-hidden="true" tabindex="-1"></a><span class="at">  rate_interp &lt;- margot_interpret_rate(</span></span>
<span id="cb6-396"><a href="#cb6-396" aria-hidden="true" tabindex="-1"></a><span class="at">    rate_results,</span></span>
<span id="cb6-397"><a href="#cb6-397" aria-hidden="true" tabindex="-1"></a><span class="at">    flipped_outcomes      = flipped_names,</span></span>
<span id="cb6-398"><a href="#cb6-398" aria-hidden="true" tabindex="-1"></a><span class="at">    adjust_positives_only = TRUE</span></span>
<span id="cb6-399"><a href="#cb6-399" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-400"><a href="#cb6-400" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-401"><a href="#cb6-401" aria-hidden="true" tabindex="-1"></a><span class="at">  rate_interp &lt;- margot_interpret_rate(</span></span>
<span id="cb6-402"><a href="#cb6-402" aria-hidden="true" tabindex="-1"></a><span class="at">    rate_results,</span></span>
<span id="cb6-403"><a href="#cb6-403" aria-hidden="true" tabindex="-1"></a><span class="at">    flipped_outcomes      = NULL,  # no flipped outcomes</span></span>
<span id="cb6-404"><a href="#cb6-404" aria-hidden="true" tabindex="-1"></a><span class="at">    adjust_positives_only = TRUE</span></span>
<span id="cb6-405"><a href="#cb6-405" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-406"><a href="#cb6-406" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-407"><a href="#cb6-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-408"><a href="#cb6-408" aria-hidden="true" tabindex="-1"></a><span class="at">cat(rate_interp$comparison, "</span><span class="sc">\n</span><span class="at">")</span></span>
<span id="cb6-409"><a href="#cb6-409" aria-hidden="true" tabindex="-1"></a><span class="at">cli_h2("Analysis ready for Appendix ✔")</span></span>
<span id="cb6-410"><a href="#cb6-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-411"><a href="#cb6-411" aria-hidden="true" tabindex="-1"></a><span class="at"># organise model names by evidence strength</span></span>
<span id="cb6-412"><a href="#cb6-412" aria-hidden="true" tabindex="-1"></a><span class="at">model_groups &lt;- list(</span></span>
<span id="cb6-413"><a href="#cb6-413" aria-hidden="true" tabindex="-1"></a><span class="at">  autoc       = rate_interp$autoc_model_names,</span></span>
<span id="cb6-414"><a href="#cb6-414" aria-hidden="true" tabindex="-1"></a><span class="at">  qini        = rate_interp$qini_model_names,</span></span>
<span id="cb6-415"><a href="#cb6-415" aria-hidden="true" tabindex="-1"></a><span class="at">  either      = rate_interp$either_model_names,</span></span>
<span id="cb6-416"><a href="#cb6-416" aria-hidden="true" tabindex="-1"></a><span class="at">  exploratory = rate_interp$not_excluded_either</span></span>
<span id="cb6-417"><a href="#cb6-417" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-418"><a href="#cb6-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-419"><a href="#cb6-419" aria-hidden="true" tabindex="-1"></a><span class="at"># ── 2. plot rate autoc curves (if any exist) ─────────────────────────────────</span></span>
<span id="cb6-420"><a href="#cb6-420" aria-hidden="true" tabindex="-1"></a><span class="at">if (length(model_groups$autoc) &gt; 0) {</span></span>
<span id="cb6-421"><a href="#cb6-421" aria-hidden="true" tabindex="-1"></a><span class="at">  autoc_plots &lt;- margot_plot_rate_batch(</span></span>
<span id="cb6-422"><a href="#cb6-422" aria-hidden="true" tabindex="-1"></a><span class="at">    models        = models_for_analysis,</span></span>
<span id="cb6-423"><a href="#cb6-423" aria-hidden="true" tabindex="-1"></a><span class="at">    save_plots    = FALSE,</span></span>
<span id="cb6-424"><a href="#cb6-424" aria-hidden="true" tabindex="-1"></a><span class="at">    label_mapping = labels_for_analysis,</span></span>
<span id="cb6-425"><a href="#cb6-425" aria-hidden="true" tabindex="-1"></a><span class="at">    model_names   = model_groups$autoc</span></span>
<span id="cb6-426"><a href="#cb6-426" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-427"><a href="#cb6-427" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-428"><a href="#cb6-428" aria-hidden="true" tabindex="-1"></a><span class="at">  # store first autoc name if it exists</span></span>
<span id="cb6-429"><a href="#cb6-429" aria-hidden="true" tabindex="-1"></a><span class="at">  if (nrow(rate_results$rate_autoc) &gt; 0) {</span></span>
<span id="cb6-430"><a href="#cb6-430" aria-hidden="true" tabindex="-1"></a><span class="at">    autoc_name_1 &lt;- rate_results$rate_autoc$outcome[[1]]</span></span>
<span id="cb6-431"><a href="#cb6-431" aria-hidden="true" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb6-432"><a href="#cb6-432" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-433"><a href="#cb6-433" aria-hidden="true" tabindex="-1"></a><span class="at">  autoc_plots &lt;- list()</span></span>
<span id="cb6-434"><a href="#cb6-434" aria-hidden="true" tabindex="-1"></a><span class="at">  message("no significant rate autoc results found")</span></span>
<span id="cb6-435"><a href="#cb6-435" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-436"><a href="#cb6-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-437"><a href="#cb6-437" aria-hidden="true" tabindex="-1"></a><span class="at"># ── 3. qini curves + gain interpretation ──────────────────────────────────────</span></span>
<span id="cb6-438"><a href="#cb6-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-439"><a href="#cb6-439" aria-hidden="true" tabindex="-1"></a><span class="at"># define plot settings (move here so they exist even if not used)</span></span>
<span id="cb6-440"><a href="#cb6-440" aria-hidden="true" tabindex="-1"></a><span class="at">policy_tree_defaults &lt;- list(</span></span>
<span id="cb6-441"><a href="#cb6-441" aria-hidden="true" tabindex="-1"></a><span class="at">  point_alpha              = 0.5,</span></span>
<span id="cb6-442"><a href="#cb6-442" aria-hidden="true" tabindex="-1"></a><span class="at">  title_size               = 12,</span></span>
<span id="cb6-443"><a href="#cb6-443" aria-hidden="true" tabindex="-1"></a><span class="at">  subtitle_size            = 12,</span></span>
<span id="cb6-444"><a href="#cb6-444" aria-hidden="true" tabindex="-1"></a><span class="at">  axis_title_size          = 12,</span></span>
<span id="cb6-445"><a href="#cb6-445" aria-hidden="true" tabindex="-1"></a><span class="at">  legend_title_size        = 12,</span></span>
<span id="cb6-446"><a href="#cb6-446" aria-hidden="true" tabindex="-1"></a><span class="at">  split_line_color         = "red",</span></span>
<span id="cb6-447"><a href="#cb6-447" aria-hidden="true" tabindex="-1"></a><span class="at">  split_line_alpha         = 0.8,</span></span>
<span id="cb6-448"><a href="#cb6-448" aria-hidden="true" tabindex="-1"></a><span class="at">  split_label_color        = "red",</span></span>
<span id="cb6-449"><a href="#cb6-449" aria-hidden="true" tabindex="-1"></a><span class="at">  split_label_nudge_factor = 0.007</span></span>
<span id="cb6-450"><a href="#cb6-450" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-451"><a href="#cb6-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-452"><a href="#cb6-452" aria-hidden="true" tabindex="-1"></a><span class="at">decision_tree_defaults &lt;- list(</span></span>
<span id="cb6-453"><a href="#cb6-453" aria-hidden="true" tabindex="-1"></a><span class="at">  span_ratio        = 0.1,</span></span>
<span id="cb6-454"><a href="#cb6-454" aria-hidden="true" tabindex="-1"></a><span class="at">  text_size         = 4,</span></span>
<span id="cb6-455"><a href="#cb6-455" aria-hidden="true" tabindex="-1"></a><span class="at">  y_padding         = 0.5,</span></span>
<span id="cb6-456"><a href="#cb6-456" aria-hidden="true" tabindex="-1"></a><span class="at">  edge_label_offset = 0.02,</span></span>
<span id="cb6-457"><a href="#cb6-457" aria-hidden="true" tabindex="-1"></a><span class="at">  border_size       = 0.01</span></span>
<span id="cb6-458"><a href="#cb6-458" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-459"><a href="#cb6-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-460"><a href="#cb6-460" aria-hidden="true" tabindex="-1"></a><span class="at"># run initial qini analysis</span></span>
<span id="cb6-461"><a href="#cb6-461" aria-hidden="true" tabindex="-1"></a><span class="at">qini_results &lt;- margot_policy(</span></span>
<span id="cb6-462"><a href="#cb6-462" aria-hidden="true" tabindex="-1"></a><span class="at">  models_for_analysis,</span></span>
<span id="cb6-463"><a href="#cb6-463" aria-hidden="true" tabindex="-1"></a><span class="at">  save_plots         = FALSE,</span></span>
<span id="cb6-464"><a href="#cb6-464" aria-hidden="true" tabindex="-1"></a><span class="at">  output_dir         = here::here(push_mods),</span></span>
<span id="cb6-465"><a href="#cb6-465" aria-hidden="true" tabindex="-1"></a><span class="at">  decision_tree_args = decision_tree_defaults,</span></span>
<span id="cb6-466"><a href="#cb6-466" aria-hidden="true" tabindex="-1"></a><span class="at">  policy_tree_args   = policy_tree_defaults,</span></span>
<span id="cb6-467"><a href="#cb6-467" aria-hidden="true" tabindex="-1"></a><span class="at">  model_names        = names(models_for_analysis$results),</span></span>
<span id="cb6-468"><a href="#cb6-468" aria-hidden="true" tabindex="-1"></a><span class="at">  original_df        = original_df,</span></span>
<span id="cb6-469"><a href="#cb6-469" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping      = labels_for_analysis,</span></span>
<span id="cb6-470"><a href="#cb6-470" aria-hidden="true" tabindex="-1"></a><span class="at">  max_depth          = 2L,</span></span>
<span id="cb6-471"><a href="#cb6-471" aria-hidden="true" tabindex="-1"></a><span class="at">  output_objects     = c("qini_plot", "diff_gain_summaries")</span></span>
<span id="cb6-472"><a href="#cb6-472" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-473"><a href="#cb6-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-474"><a href="#cb6-474" aria-hidden="true" tabindex="-1"></a><span class="at"># interpret qini results</span></span>
<span id="cb6-475"><a href="#cb6-475" aria-hidden="true" tabindex="-1"></a><span class="at">qini_gain &lt;- margot_interpret_qini(</span></span>
<span id="cb6-476"><a href="#cb6-476" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_results,</span></span>
<span id="cb6-477"><a href="#cb6-477" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping = labels_for_analysis</span></span>
<span id="cb6-478"><a href="#cb6-478" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-479"><a href="#cb6-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-480"><a href="#cb6-480" aria-hidden="true" tabindex="-1"></a><span class="at">print_rate(qini_gain$summary_table)</span></span>
<span id="cb6-481"><a href="#cb6-481" aria-hidden="true" tabindex="-1"></a><span class="at">cat(qini_gain$qini_explanation, "</span><span class="sc">\n</span><span class="at">")</span></span>
<span id="cb6-482"><a href="#cb6-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-483"><a href="#cb6-483" aria-hidden="true" tabindex="-1"></a><span class="at">reliable_ids &lt;- qini_gain$reliable_model_ids</span></span>
<span id="cb6-484"><a href="#cb6-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-485"><a href="#cb6-485" aria-hidden="true" tabindex="-1"></a><span class="at"># ── 4. policy trees (only if reliable models exist) ──────────────────────────</span></span>
<span id="cb6-486"><a href="#cb6-486" aria-hidden="true" tabindex="-1"></a><span class="at">if (length(reliable_ids) &gt; 0) {</span></span>
<span id="cb6-487"><a href="#cb6-487" aria-hidden="true" tabindex="-1"></a><span class="at">  # recompute for reliable models only</span></span>
<span id="cb6-488"><a href="#cb6-488" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_results_valid &lt;- margot_policy(</span></span>
<span id="cb6-489"><a href="#cb6-489" aria-hidden="true" tabindex="-1"></a><span class="at">    models_for_analysis,</span></span>
<span id="cb6-490"><a href="#cb6-490" aria-hidden="true" tabindex="-1"></a><span class="at">    save_plots         = FALSE,</span></span>
<span id="cb6-491"><a href="#cb6-491" aria-hidden="true" tabindex="-1"></a><span class="at">    output_dir         = here::here(push_mods),</span></span>
<span id="cb6-492"><a href="#cb6-492" aria-hidden="true" tabindex="-1"></a><span class="at">    decision_tree_args = decision_tree_defaults,</span></span>
<span id="cb6-493"><a href="#cb6-493" aria-hidden="true" tabindex="-1"></a><span class="at">    policy_tree_args   = policy_tree_defaults,</span></span>
<span id="cb6-494"><a href="#cb6-494" aria-hidden="true" tabindex="-1"></a><span class="at">    model_names        = reliable_ids,</span></span>
<span id="cb6-495"><a href="#cb6-495" aria-hidden="true" tabindex="-1"></a><span class="at">    original_df        = original_df,</span></span>
<span id="cb6-496"><a href="#cb6-496" aria-hidden="true" tabindex="-1"></a><span class="at">    label_mapping      = labels_for_analysis,</span></span>
<span id="cb6-497"><a href="#cb6-497" aria-hidden="true" tabindex="-1"></a><span class="at">    max_depth          = 2L,</span></span>
<span id="cb6-498"><a href="#cb6-498" aria-hidden="true" tabindex="-1"></a><span class="at">    output_objects     = c("qini_plot", "diff_gain_summaries")</span></span>
<span id="cb6-499"><a href="#cb6-499" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-500"><a href="#cb6-500" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-501"><a href="#cb6-501" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_plots &lt;- map(qini_results_valid, ~ .x$qini_plot)</span></span>
<span id="cb6-502"><a href="#cb6-502" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_names &lt;- margot_get_labels(reliable_ids, labels_for_analysis)</span></span>
<span id="cb6-503"><a href="#cb6-503" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-504"><a href="#cb6-504" aria-hidden="true" tabindex="-1"></a><span class="at">  # compute policy trees</span></span>
<span id="cb6-505"><a href="#cb6-505" aria-hidden="true" tabindex="-1"></a><span class="at">  policy_results_2L &lt;- margot_policy(</span></span>
<span id="cb6-506"><a href="#cb6-506" aria-hidden="true" tabindex="-1"></a><span class="at">    models_for_analysis,</span></span>
<span id="cb6-507"><a href="#cb6-507" aria-hidden="true" tabindex="-1"></a><span class="at">    save_plots         = FALSE,</span></span>
<span id="cb6-508"><a href="#cb6-508" aria-hidden="true" tabindex="-1"></a><span class="at">    output_dir         = here::here(push_mods),</span></span>
<span id="cb6-509"><a href="#cb6-509" aria-hidden="true" tabindex="-1"></a><span class="at">    decision_tree_args = decision_tree_defaults,</span></span>
<span id="cb6-510"><a href="#cb6-510" aria-hidden="true" tabindex="-1"></a><span class="at">    policy_tree_args   = policy_tree_defaults,</span></span>
<span id="cb6-511"><a href="#cb6-511" aria-hidden="true" tabindex="-1"></a><span class="at">    model_names        = reliable_ids,</span></span>
<span id="cb6-512"><a href="#cb6-512" aria-hidden="true" tabindex="-1"></a><span class="at">    max_depth          = 2L,</span></span>
<span id="cb6-513"><a href="#cb6-513" aria-hidden="true" tabindex="-1"></a><span class="at">    original_df        = original_df,</span></span>
<span id="cb6-514"><a href="#cb6-514" aria-hidden="true" tabindex="-1"></a><span class="at">    label_mapping      = labels_for_analysis,</span></span>
<span id="cb6-515"><a href="#cb6-515" aria-hidden="true" tabindex="-1"></a><span class="at">    output_objects     = c("combined_plot")</span></span>
<span id="cb6-516"><a href="#cb6-516" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-517"><a href="#cb6-517" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-518"><a href="#cb6-518" aria-hidden="true" tabindex="-1"></a><span class="at">  policy_plots &lt;- map(policy_results_2L, ~ .x$combined_plot)</span></span>
<span id="cb6-519"><a href="#cb6-519" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-520"><a href="#cb6-520" aria-hidden="true" tabindex="-1"></a><span class="at">  # generate plain language interpretation</span></span>
<span id="cb6-521"><a href="#cb6-521" aria-hidden="true" tabindex="-1"></a><span class="at">  policy_text &lt;- margot_interpret_policy_batch(</span></span>
<span id="cb6-522"><a href="#cb6-522" aria-hidden="true" tabindex="-1"></a><span class="at">    models        = models_for_analysis,</span></span>
<span id="cb6-523"><a href="#cb6-523" aria-hidden="true" tabindex="-1"></a><span class="at">    original_df   = original_df,</span></span>
<span id="cb6-524"><a href="#cb6-524" aria-hidden="true" tabindex="-1"></a><span class="at">    model_names   = reliable_ids,</span></span>
<span id="cb6-525"><a href="#cb6-525" aria-hidden="true" tabindex="-1"></a><span class="at">    label_mapping = labels_for_analysis,</span></span>
<span id="cb6-526"><a href="#cb6-526" aria-hidden="true" tabindex="-1"></a><span class="at">    max_depth     = 2L</span></span>
<span id="cb6-527"><a href="#cb6-527" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-528"><a href="#cb6-528" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-529"><a href="#cb6-529" aria-hidden="true" tabindex="-1"></a><span class="at">  cat(policy_text, "</span><span class="sc">\n</span><span class="at">")</span></span>
<span id="cb6-530"><a href="#cb6-530" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-531"><a href="#cb6-531" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-532"><a href="#cb6-532" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_plots &lt;- list()</span></span>
<span id="cb6-533"><a href="#cb6-533" aria-hidden="true" tabindex="-1"></a><span class="at">  policy_plots &lt;- list()</span></span>
<span id="cb6-534"><a href="#cb6-534" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_names &lt;- character(0)</span></span>
<span id="cb6-535"><a href="#cb6-535" aria-hidden="true" tabindex="-1"></a><span class="at">  policy_text &lt;- "No reliable heterogeneous treatment effects found."</span></span>
<span id="cb6-536"><a href="#cb6-536" aria-hidden="true" tabindex="-1"></a><span class="at">  message("no reliable qini models found - skipping policy tree analysis")</span></span>
<span id="cb6-537"><a href="#cb6-537" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-538"><a href="#cb6-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-539"><a href="#cb6-539" aria-hidden="true" tabindex="-1"></a><span class="at">cli::cli_h1("Finished: heterogeneity analysis complete ✔")</span></span>
<span id="cb6-540"><a href="#cb6-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-541"><a href="#cb6-541" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-542"><a href="#cb6-542" aria-hidden="true" tabindex="-1"></a><span class="at"># OPTIONAL: PLANNED SUBGROUP COMPARISON</span></span>
<span id="cb6-543"><a href="#cb6-543" aria-hidden="true" tabindex="-1"></a><span class="at"># uncomment this section if you want to do subgroup analysis</span></span>
<span id="cb6-544"><a href="#cb6-544" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-545"><a href="#cb6-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-546"><a href="#cb6-546" aria-hidden="true" tabindex="-1"></a><span class="at"># # ── subgroup comparison settings ──────────────────────────────────────────────</span></span>
<span id="cb6-547"><a href="#cb6-547" aria-hidden="true" tabindex="-1"></a><span class="at"># x_offset_comp &lt;- 1.0</span></span>
<span id="cb6-548"><a href="#cb6-548" aria-hidden="true" tabindex="-1"></a><span class="at"># x_lim_lo_comp &lt;- -1.0</span></span>
<span id="cb6-549"><a href="#cb6-549" aria-hidden="true" tabindex="-1"></a><span class="at"># x_lim_hi_comp &lt;- 1.0 </span></span>
<span id="cb6-550"><a href="#cb6-550" aria-hidden="true" tabindex="-1"></a><span class="at"># </span></span>
<span id="cb6-551"><a href="#cb6-551" aria-hidden="true" tabindex="-1"></a><span class="at"># base_defaults_comparisons &lt;- list(</span></span>
<span id="cb6-552"><a href="#cb6-552" aria-hidden="true" tabindex="-1"></a><span class="at">#   type                  = "RD",</span></span>
<span id="cb6-553"><a href="#cb6-553" aria-hidden="true" tabindex="-1"></a><span class="at">#   title                 = ate_title,</span></span>
<span id="cb6-554"><a href="#cb6-554" aria-hidden="true" tabindex="-1"></a><span class="at">#   e_val_bound_threshold = 1.2,</span></span>
<span id="cb6-555"><a href="#cb6-555" aria-hidden="true" tabindex="-1"></a><span class="at">#   label_mapping         = "label_mapping_all",</span></span>
<span id="cb6-556"><a href="#cb6-556" aria-hidden="true" tabindex="-1"></a><span class="at">#   adjust                = "bonferroni",</span></span>
<span id="cb6-557"><a href="#cb6-557" aria-hidden="true" tabindex="-1"></a><span class="at">#   alpha                 = 0.05,</span></span>
<span id="cb6-558"><a href="#cb6-558" aria-hidden="true" tabindex="-1"></a><span class="at">#   colors                = c(</span></span>
<span id="cb6-559"><a href="#cb6-559" aria-hidden="true" tabindex="-1"></a><span class="at">#     "positive"     = "#E69F00",</span></span>
<span id="cb6-560"><a href="#cb6-560" aria-hidden="true" tabindex="-1"></a><span class="at">#     "not reliable" = "grey50",</span></span>
<span id="cb6-561"><a href="#cb6-561" aria-hidden="true" tabindex="-1"></a><span class="at">#     "negative"     = "#56B4E9"</span></span>
<span id="cb6-562"><a href="#cb6-562" aria-hidden="true" tabindex="-1"></a><span class="at">#   ),</span></span>
<span id="cb6-563"><a href="#cb6-563" aria-hidden="true" tabindex="-1"></a><span class="at">#   x_offset              = x_offset_comp,</span></span>
<span id="cb6-564"><a href="#cb6-564" aria-hidden="true" tabindex="-1"></a><span class="at">#   x_lim_lo              = x_lim_lo_comp,</span></span>
<span id="cb6-565"><a href="#cb6-565" aria-hidden="true" tabindex="-1"></a><span class="at">#   x_lim_hi              = x_lim_hi_comp,</span></span>
<span id="cb6-566"><a href="#cb6-566" aria-hidden="true" tabindex="-1"></a><span class="at">#   text_size             = 8,</span></span>
<span id="cb6-567"><a href="#cb6-567" aria-hidden="true" tabindex="-1"></a><span class="at">#   linewidth             = 0.75,</span></span>
<span id="cb6-568"><a href="#cb6-568" aria-hidden="true" tabindex="-1"></a><span class="at">#   estimate_scale        = 1,</span></span>
<span id="cb6-569"><a href="#cb6-569" aria-hidden="true" tabindex="-1"></a><span class="at">#   base_size             = 18,</span></span>
<span id="cb6-570"><a href="#cb6-570" aria-hidden="true" tabindex="-1"></a><span class="at">#   point_size            = 4,</span></span>
<span id="cb6-571"><a href="#cb6-571" aria-hidden="true" tabindex="-1"></a><span class="at">#   title_size            = 19,</span></span>
<span id="cb6-572"><a href="#cb6-572" aria-hidden="true" tabindex="-1"></a><span class="at">#   subtitle_size         = 16,</span></span>
<span id="cb6-573"><a href="#cb6-573" aria-hidden="true" tabindex="-1"></a><span class="at">#   legend_text_size      = 10,</span></span>
<span id="cb6-574"><a href="#cb6-574" aria-hidden="true" tabindex="-1"></a><span class="at">#   legend_title_size     = 10,</span></span>
<span id="cb6-575"><a href="#cb6-575" aria-hidden="true" tabindex="-1"></a><span class="at">#   include_coefficients  = FALSE</span></span>
<span id="cb6-576"><a href="#cb6-576" aria-hidden="true" tabindex="-1"></a><span class="at"># )</span></span>
<span id="cb6-577"><a href="#cb6-577" aria-hidden="true" tabindex="-1"></a><span class="at"># </span></span>
<span id="cb6-578"><a href="#cb6-578" aria-hidden="true" tabindex="-1"></a><span class="at"># # define age-based subgroups</span></span>
<span id="cb6-579"><a href="#cb6-579" aria-hidden="true" tabindex="-1"></a><span class="at"># complex_condition_age &lt;- between(X[,"t0_age_z"], -1, 1)</span></span>
<span id="cb6-580"><a href="#cb6-580" aria-hidden="true" tabindex="-1"></a><span class="at"># </span></span>
<span id="cb6-581"><a href="#cb6-581" aria-hidden="true" tabindex="-1"></a><span class="at"># # check age bounds on the raw scale</span></span>
<span id="cb6-582"><a href="#cb6-582" aria-hidden="true" tabindex="-1"></a><span class="at"># mean(original_df$t0_age) + c(-1, 1) * sd(original_df$t0_age)</span></span>
<span id="cb6-583"><a href="#cb6-583" aria-hidden="true" tabindex="-1"></a><span class="at"># </span></span>
<span id="cb6-584"><a href="#cb6-584" aria-hidden="true" tabindex="-1"></a><span class="at"># # age subsets</span></span>
<span id="cb6-585"><a href="#cb6-585" aria-hidden="true" tabindex="-1"></a><span class="at"># subsets_standard_age &lt;- list(</span></span>
<span id="cb6-586"><a href="#cb6-586" aria-hidden="true" tabindex="-1"></a><span class="at">#   Younger = list(</span></span>
<span id="cb6-587"><a href="#cb6-587" aria-hidden="true" tabindex="-1"></a><span class="at">#     var      = "t0_age_z",</span></span>
<span id="cb6-588"><a href="#cb6-588" aria-hidden="true" tabindex="-1"></a><span class="at">#     value    = -1,</span></span>
<span id="cb6-589"><a href="#cb6-589" aria-hidden="true" tabindex="-1"></a><span class="at">#     operator = "&lt;",</span></span>
<span id="cb6-590"><a href="#cb6-590" aria-hidden="true" tabindex="-1"></a><span class="at">#     label    = "Age &lt; 35"</span></span>
<span id="cb6-591"><a href="#cb6-591" aria-hidden="true" tabindex="-1"></a><span class="at">#   ),</span></span>
<span id="cb6-592"><a href="#cb6-592" aria-hidden="true" tabindex="-1"></a><span class="at">#   Middle = list(</span></span>
<span id="cb6-593"><a href="#cb6-593" aria-hidden="true" tabindex="-1"></a><span class="at">#     var              = "t0_age_z",</span></span>
<span id="cb6-594"><a href="#cb6-594" aria-hidden="true" tabindex="-1"></a><span class="at">#     subset_condition = complex_condition_age,</span></span>
<span id="cb6-595"><a href="#cb6-595" aria-hidden="true" tabindex="-1"></a><span class="at">#     label            = "Age 35-62"</span></span>
<span id="cb6-596"><a href="#cb6-596" aria-hidden="true" tabindex="-1"></a><span class="at">#   ),</span></span>
<span id="cb6-597"><a href="#cb6-597" aria-hidden="true" tabindex="-1"></a><span class="at">#   Older = list(</span></span>
<span id="cb6-598"><a href="#cb6-598" aria-hidden="true" tabindex="-1"></a><span class="at">#     var      = "t0_age_z",</span></span>
<span id="cb6-599"><a href="#cb6-599" aria-hidden="true" tabindex="-1"></a><span class="at">#     value    = 1,</span></span>
<span id="cb6-600"><a href="#cb6-600" aria-hidden="true" tabindex="-1"></a><span class="at">#     operator = "&gt;",</span></span>
<span id="cb6-601"><a href="#cb6-601" aria-hidden="true" tabindex="-1"></a><span class="at">#     label    = "Age &gt; 62"</span></span>
<span id="cb6-602"><a href="#cb6-602" aria-hidden="true" tabindex="-1"></a><span class="at">#   )</span></span>
<span id="cb6-603"><a href="#cb6-603" aria-hidden="true" tabindex="-1"></a><span class="at"># )</span></span>
<span id="cb6-604"><a href="#cb6-604" aria-hidden="true" tabindex="-1"></a><span class="at"># </span></span>
<span id="cb6-605"><a href="#cb6-605" aria-hidden="true" tabindex="-1"></a><span class="at"># # run batch subgroup analysis</span></span>
<span id="cb6-606"><a href="#cb6-606" aria-hidden="true" tabindex="-1"></a><span class="at"># planned_subset_results &lt;- margot_planned_subgroups_batch(</span></span>
<span id="cb6-607"><a href="#cb6-607" aria-hidden="true" tabindex="-1"></a><span class="at">#   domain_models = list(models_binary),  # always use models_binary for subgroups</span></span>
<span id="cb6-608"><a href="#cb6-608" aria-hidden="true" tabindex="-1"></a><span class="at">#   X             = X,</span></span>
<span id="cb6-609"><a href="#cb6-609" aria-hidden="true" tabindex="-1"></a><span class="at">#   base_defaults = base_defaults_comparisons,</span></span>
<span id="cb6-610"><a href="#cb6-610" aria-hidden="true" tabindex="-1"></a><span class="at">#   subset_types  = list(cohort = subsets_standard_age),</span></span>
<span id="cb6-611"><a href="#cb6-611" aria-hidden="true" tabindex="-1"></a><span class="at">#   original_df   = original_df,</span></span>
<span id="cb6-612"><a href="#cb6-612" aria-hidden="true" tabindex="-1"></a><span class="at">#   label_mapping = label_mapping_all,  # always use standard labels</span></span>
<span id="cb6-613"><a href="#cb6-613" aria-hidden="true" tabindex="-1"></a><span class="at">#   domain_names  = "wellbeing",</span></span>
<span id="cb6-614"><a href="#cb6-614" aria-hidden="true" tabindex="-1"></a><span class="at">#   subtitles     = "",</span></span>
<span id="cb6-615"><a href="#cb6-615" aria-hidden="true" tabindex="-1"></a><span class="at">#   adjust        = "bonferroni",</span></span>
<span id="cb6-616"><a href="#cb6-616" aria-hidden="true" tabindex="-1"></a><span class="at">#   alpha         = 0.05</span></span>
<span id="cb6-617"><a href="#cb6-617" aria-hidden="true" tabindex="-1"></a><span class="at"># )</span></span>
<span id="cb6-618"><a href="#cb6-618" aria-hidden="true" tabindex="-1"></a><span class="at"># </span></span>
<span id="cb6-619"><a href="#cb6-619" aria-hidden="true" tabindex="-1"></a><span class="at"># # create comparison plot</span></span>
<span id="cb6-620"><a href="#cb6-620" aria-hidden="true" tabindex="-1"></a><span class="at"># plots_subgroup_age_young_old &lt;- wrap_plots(</span></span>
<span id="cb6-621"><a href="#cb6-621" aria-hidden="true" tabindex="-1"></a><span class="at">#   list(</span></span>
<span id="cb6-622"><a href="#cb6-622" aria-hidden="true" tabindex="-1"></a><span class="at">#     planned_subset_results$wellbeing$cohort$results$</span><span class="st">`</span>Age <span class="sc">&lt;</span> <span class="dv">35</span><span class="st">`</span><span class="at">$plot,</span></span>
<span id="cb6-623"><a href="#cb6-623" aria-hidden="true" tabindex="-1"></a><span class="at">#     planned_subset_results$wellbeing$cohort$results$</span><span class="st">`</span>Age <span class="sc">&gt;</span> <span class="dv">62</span><span class="st">`</span><span class="at">$plot</span></span>
<span id="cb6-624"><a href="#cb6-624" aria-hidden="true" tabindex="-1"></a><span class="at">#   ), ncol = 1) +</span></span>
<span id="cb6-625"><a href="#cb6-625" aria-hidden="true" tabindex="-1"></a><span class="at">#   plot_annotation(</span></span>
<span id="cb6-626"><a href="#cb6-626" aria-hidden="true" tabindex="-1"></a><span class="at">#     title = "Younger vs Older",</span></span>
<span id="cb6-627"><a href="#cb6-627" aria-hidden="true" tabindex="-1"></a><span class="at">#     theme = theme(plot.title = element_text(size = 18, face = "bold"))</span></span>
<span id="cb6-628"><a href="#cb6-628" aria-hidden="true" tabindex="-1"></a><span class="at">#   )</span></span>
<span id="cb6-629"><a href="#cb6-629" aria-hidden="true" tabindex="-1"></a><span class="at"># </span></span>
<span id="cb6-630"><a href="#cb6-630" aria-hidden="true" tabindex="-1"></a><span class="at"># # compare young vs old groups</span></span>
<span id="cb6-631"><a href="#cb6-631" aria-hidden="true" tabindex="-1"></a><span class="at"># group_comparison_age_young_old &lt;- margot_compare_groups(</span></span>
<span id="cb6-632"><a href="#cb6-632" aria-hidden="true" tabindex="-1"></a><span class="at">#   group1_name     = "People Under 35 Years Old",</span></span>
<span id="cb6-633"><a href="#cb6-633" aria-hidden="true" tabindex="-1"></a><span class="at">#   group2_name     = "People Over 62 Years Old", </span></span>
<span id="cb6-634"><a href="#cb6-634" aria-hidden="true" tabindex="-1"></a><span class="at">#   planned_subset_results$wellbeing$cohort$results$</span><span class="st">`</span>Age <span class="sc">&lt;</span> <span class="dv">35</span><span class="st">`</span><span class="at">$transformed_table,</span></span>
<span id="cb6-635"><a href="#cb6-635" aria-hidden="true" tabindex="-1"></a><span class="at">#   planned_subset_results$wellbeing$cohort$results$</span><span class="st">`</span>Age <span class="sc">&gt;</span> <span class="dv">62</span><span class="st">`</span><span class="at">$transformed_table,</span></span>
<span id="cb6-636"><a href="#cb6-636" aria-hidden="true" tabindex="-1"></a><span class="at">#   type            = "RD",</span></span>
<span id="cb6-637"><a href="#cb6-637" aria-hidden="true" tabindex="-1"></a><span class="at">#   decimal_places  = 3</span></span>
<span id="cb6-638"><a href="#cb6-638" aria-hidden="true" tabindex="-1"></a><span class="at"># )</span></span>
<span id="cb6-639"><a href="#cb6-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-640"><a href="#cb6-640" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-641"><a href="#cb6-641" aria-hidden="true" tabindex="-1"></a><span class="at"># DEFINE GLOBAL VARIABLES FOR TEXT GENERATION</span></span>
<span id="cb6-642"><a href="#cb6-642" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb6-643"><a href="#cb6-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-644"><a href="#cb6-644" aria-hidden="true" tabindex="-1"></a><span class="at">global_vars &lt;- list(</span></span>
<span id="cb6-645"><a href="#cb6-645" aria-hidden="true" tabindex="-1"></a><span class="at">  name_exposure_variable     = nice_name_exposure,</span></span>
<span id="cb6-646"><a href="#cb6-646" aria-hidden="true" tabindex="-1"></a><span class="at">  n_total                    = n_total,</span></span>
<span id="cb6-647"><a href="#cb6-647" aria-hidden="true" tabindex="-1"></a><span class="at">  ate_adjustment             = "bonferroni", </span></span>
<span id="cb6-648"><a href="#cb6-648" aria-hidden="true" tabindex="-1"></a><span class="at">  ate_alpha                  = "0.05",</span></span>
<span id="cb6-649"><a href="#cb6-649" aria-hidden="true" tabindex="-1"></a><span class="at">  cate_adjustment            = "Benjamini–Hochberg false-discovery-rate adjustment",</span></span>
<span id="cb6-650"><a href="#cb6-650" aria-hidden="true" tabindex="-1"></a><span class="at">  cate_alpha                 = "0.1",             </span></span>
<span id="cb6-651"><a href="#cb6-651" aria-hidden="true" tabindex="-1"></a><span class="at">  sample_ratio_policy        = "70/30",</span></span>
<span id="cb6-652"><a href="#cb6-652" aria-hidden="true" tabindex="-1"></a><span class="at">  n_participants             = n_participants,</span></span>
<span id="cb6-653"><a href="#cb6-653" aria-hidden="true" tabindex="-1"></a><span class="at">  exposure_variable          = name_exposure,</span></span>
<span id="cb6-654"><a href="#cb6-654" aria-hidden="true" tabindex="-1"></a><span class="at">  name_exposure_lower        = name_exposure_lower,</span></span>
<span id="cb6-655"><a href="#cb6-655" aria-hidden="true" tabindex="-1"></a><span class="at">  name_control_regime_lower  = name_control_regime_lower,</span></span>
<span id="cb6-656"><a href="#cb6-656" aria-hidden="true" tabindex="-1"></a><span class="at">  name_outcome_variables     = "Self Esteem", # &lt;- adjust to your study</span></span>
<span id="cb6-657"><a href="#cb6-657" aria-hidden="true" tabindex="-1"></a><span class="at">  name_outcomes_lower        = name_outcomes_lower,</span></span>
<span id="cb6-658"><a href="#cb6-658" aria-hidden="true" tabindex="-1"></a><span class="at">  name_exposure_capfirst     = nice_name_exposure,</span></span>
<span id="cb6-659"><a href="#cb6-659" aria-hidden="true" tabindex="-1"></a><span class="at">  measures_exposure          = measures_exposure,</span></span>
<span id="cb6-660"><a href="#cb6-660" aria-hidden="true" tabindex="-1"></a><span class="at">  value_exposure_regime      = value_exposure_regime,</span></span>
<span id="cb6-661"><a href="#cb6-661" aria-hidden="true" tabindex="-1"></a><span class="at">  value_control_regime       = value_control_regime,</span></span>
<span id="cb6-662"><a href="#cb6-662" aria-hidden="true" tabindex="-1"></a><span class="at">  flipped_list               = flipped_list,</span></span>
<span id="cb6-663"><a href="#cb6-663" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_explain_grf       = "E",</span></span>
<span id="cb6-664"><a href="#cb6-664" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_assumptions_grf   = "F",</span></span>
<span id="cb6-665"><a href="#cb6-665" aria-hidden="true" tabindex="-1"></a><span class="at">  name_exposure_threshold    = "1",</span></span>
<span id="cb6-666"><a href="#cb6-666" aria-hidden="true" tabindex="-1"></a><span class="at">  name_control_threshold     = "0",</span></span>
<span id="cb6-667"><a href="#cb6-667" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_measures          = "A",</span></span>
<span id="cb6-668"><a href="#cb6-668" aria-hidden="true" tabindex="-1"></a><span class="at">  value_control              = value_control,</span></span>
<span id="cb6-669"><a href="#cb6-669" aria-hidden="true" tabindex="-1"></a><span class="at">  value_exposure             = value_exposure,</span></span>
<span id="cb6-670"><a href="#cb6-670" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_positivity        = "C",</span></span>
<span id="cb6-671"><a href="#cb6-671" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_rate              = "D",</span></span>
<span id="cb6-672"><a href="#cb6-672" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_qini_curve        = "D",</span></span>
<span id="cb6-673"><a href="#cb6-673" aria-hidden="true" tabindex="-1"></a><span class="at">  train_proportion_decision_tree = ".7",</span></span>
<span id="cb6-674"><a href="#cb6-674" aria-hidden="true" tabindex="-1"></a><span class="at">  training_proportion        = ".7",</span></span>
<span id="cb6-675"><a href="#cb6-675" aria-hidden="true" tabindex="-1"></a><span class="at">  sample_split               = "70/30",</span></span>
<span id="cb6-676"><a href="#cb6-676" aria-hidden="true" tabindex="-1"></a><span class="at">  sample_ratio_policy        = "70/30",</span></span>
<span id="cb6-677"><a href="#cb6-677" aria-hidden="true" tabindex="-1"></a><span class="at">  baseline_wave              = baseline_wave,</span></span>
<span id="cb6-678"><a href="#cb6-678" aria-hidden="true" tabindex="-1"></a><span class="at">  exposure_waves             = exposure_waves,</span></span>
<span id="cb6-679"><a href="#cb6-679" aria-hidden="true" tabindex="-1"></a><span class="at">  outcome_wave               = outcome_wave,</span></span>
<span id="cb6-680"><a href="#cb6-680" aria-hidden="true" tabindex="-1"></a><span class="at">  protocol_url               = "https://osf.io/ce4t9/", # if used</span></span>
<span id="cb6-681"><a href="#cb6-681" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_timeline          = "A" # if used</span></span>
<span id="cb6-682"><a href="#cb6-682" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-683"><a href="#cb6-683" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-684"><a href="#cb6-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-685"><a href="#cb6-685" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-686"><a href="#cb6-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-687"><a href="#cb6-687" aria-hidden="true" tabindex="-1"></a><span class="do">## Introduction</span></span>
<span id="cb6-688"><a href="#cb6-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-689"><a href="#cb6-689" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span>Your place to shine here<span class="sc">**</span></span>
<span id="cb6-690"><a href="#cb6-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-691"><a href="#cb6-691" aria-hidden="true" tabindex="-1"></a><span class="do">## Method</span></span>
<span id="cb6-692"><a href="#cb6-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-693"><a href="#cb6-693" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-694"><a href="#cb6-694" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to false, copy, delete, modify, and extend text as needed</span></span>
<span id="cb6-695"><a href="#cb6-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-696"><a href="#cb6-696" aria-hidden="true" tabindex="-1"></a><span class="at"># run this code, copy and paste contents into your text</span></span>
<span id="cb6-697"><a href="#cb6-697" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb6-698"><a href="#cb6-698" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb6-699"><a href="#cb6-699" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "methods",</span></span>
<span id="cb6-700"><a href="#cb6-700" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c(</span></span>
<span id="cb6-701"><a href="#cb6-701" aria-hidden="true" tabindex="-1"></a><span class="at">      "student_sample.nzavs",</span></span>
<span id="cb6-702"><a href="#cb6-702" aria-hidden="true" tabindex="-1"></a><span class="at">      "student_target_population",</span></span>
<span id="cb6-703"><a href="#cb6-703" aria-hidden="true" tabindex="-1"></a><span class="at">      "eligibility.standard",</span></span>
<span id="cb6-704"><a href="#cb6-704" aria-hidden="true" tabindex="-1"></a><span class="at">      "causal_intervention.grf_simple_text",</span></span>
<span id="cb6-705"><a href="#cb6-705" aria-hidden="true" tabindex="-1"></a><span class="at">      "analytic_approach.general_approach_cate_long",</span></span>
<span id="cb6-706"><a href="#cb6-706" aria-hidden="true" tabindex="-1"></a><span class="at">      "exposure_indicator",</span></span>
<span id="cb6-707"><a href="#cb6-707" aria-hidden="true" tabindex="-1"></a><span class="at">      "causal_identification_criteria",</span></span>
<span id="cb6-708"><a href="#cb6-708" aria-hidden="true" tabindex="-1"></a><span class="at">      "confounding_control.vanderweele",</span></span>
<span id="cb6-709"><a href="#cb6-709" aria-hidden="true" tabindex="-1"></a><span class="at">      "statistical_models.grf_short_explanation",</span></span>
<span id="cb6-710"><a href="#cb6-710" aria-hidden="true" tabindex="-1"></a><span class="at">      "missing_data.missing_grf_simple",</span></span>
<span id="cb6-711"><a href="#cb6-711" aria-hidden="true" tabindex="-1"></a><span class="at">      "sensitivity_analysis.short_evalue"</span></span>
<span id="cb6-712"><a href="#cb6-712" aria-hidden="true" tabindex="-1"></a><span class="at">    ),</span></span>
<span id="cb6-713"><a href="#cb6-713" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb6-714"><a href="#cb6-714" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb6-715"><a href="#cb6-715" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-716"><a href="#cb6-716" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-717"><a href="#cb6-717" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-718"><a href="#cb6-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-719"><a href="#cb6-719" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-720"><a href="#cb6-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-721"><a href="#cb6-721" aria-hidden="true" tabindex="-1"></a><span class="do">## Results</span></span>
<span id="cb6-722"><a href="#cb6-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-723"><a href="#cb6-723" aria-hidden="true" tabindex="-1"></a><span class="do">### Average Treatment Effects</span></span>
<span id="cb6-724"><a href="#cb6-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-725"><a href="#cb6-725" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb6-726"><a href="#cb6-726" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-ate</span></span>
<span id="cb6-727"><a href="#cb6-727" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Average Treatment Effects on Multi-dimensional Wellbeing"</span></span>
<span id="cb6-728"><a href="#cb6-728" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb6-729"><a href="#cb6-729" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 12</span></span>
<span id="cb6-730"><a href="#cb6-730" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 8</span></span>
<span id="cb6-731"><a href="#cb6-731" aria-hidden="true" tabindex="-1"></a><span class="at">ate_results$plot</span></span>
<span id="cb6-732"><a href="#cb6-732" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-733"><a href="#cb6-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-734"><a href="#cb6-734" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-735"><a href="#cb6-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-736"><a href="#cb6-736" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb6-737"><a href="#cb6-737" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: tbl-outcomes</span></span>
<span id="cb6-738"><a href="#cb6-738" aria-hidden="true" tabindex="-1"></a><span class="at">#| tbl-cap: "Average Treatment Effects on Multi-dimensional Wellbeing"</span></span>
<span id="cb6-739"><a href="#cb6-739" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb6-740"><a href="#cb6-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-741"><a href="#cb6-741" aria-hidden="true" tabindex="-1"></a><span class="at">margot_bind_tables_markdown</span></span>
<span id="cb6-742"><a href="#cb6-742" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-743"><a href="#cb6-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-744"><a href="#cb6-744" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb6-745"><a href="#cb6-745" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true # - set to false/ copy and change </span></span>
<span id="cb6-746"><a href="#cb6-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-747"><a href="#cb6-747" aria-hidden="true" tabindex="-1"></a><span class="at"># run this line, copy and paste text into your document </span></span>
<span id="cb6-748"><a href="#cb6-748" aria-hidden="true" tabindex="-1"></a><span class="at">cat(ate_results$interpretation)</span></span>
<span id="cb6-749"><a href="#cb6-749" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-750"><a href="#cb6-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-751"><a href="#cb6-751" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-752"><a href="#cb6-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-753"><a href="#cb6-753" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;!--</span> OPTIONAL SECTION<span class="sc">:</span> PLANNED SUBGROUP COMPARISONS <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-754"><a href="#cb6-754" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> uncomment the section below <span class="cf">if</span> you performed subgroup analysis <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-755"><a href="#cb6-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-756"><a href="#cb6-756" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> <span class="do">### Planned Subgroup Comparisons --&gt;</span></span>
<span id="cb6-757"><a href="#cb6-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-758"><a href="#cb6-758" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> Based on theoretical findings we expected that the effects of {name_exposure} would vary by age...\<span class="sc">@</span>fig<span class="sc">-</span>planned<span class="sc">-</span>comparison and <span class="sc">@</span>tbl<span class="sc">-</span>planned<span class="sc">-</span>comparison <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-759"><a href="#cb6-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-760"><a href="#cb6-760" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> <span class="st">```</span><span class="at">{r} --&gt;</span></span>
<span id="cb6-761"><a href="#cb6-761" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| label: fig-planned-comparison --&gt;</span></span>
<span id="cb6-762"><a href="#cb6-762" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| fig-cap: "Planned Comparison Plot" --&gt;</span></span>
<span id="cb6-763"><a href="#cb6-763" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb6-764"><a href="#cb6-764" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| echo: false --&gt;</span></span>
<span id="cb6-765"><a href="#cb6-765" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| fig-height: 10 --&gt;</span></span>
<span id="cb6-766"><a href="#cb6-766" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| fig-width: 12 --&gt;</span></span>
<span id="cb6-767"><a href="#cb6-767" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- plots_subgroup_age_young_old --&gt;</span></span>
<span id="cb6-768"><a href="#cb6-768" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- </span><span class="st">```</span> <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-769"><a href="#cb6-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-770"><a href="#cb6-770" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> <span class="st">```</span><span class="at">{r} --&gt;</span></span>
<span id="cb6-771"><a href="#cb6-771" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| label: tbl-planned-comparison --&gt;</span></span>
<span id="cb6-772"><a href="#cb6-772" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| tbl-cap: "Planned Comparison Table" --&gt;</span></span>
<span id="cb6-773"><a href="#cb6-773" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb6-774"><a href="#cb6-774" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| echo: false --&gt;</span></span>
<span id="cb6-775"><a href="#cb6-775" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- group_comparison_age_young_old$results |&gt;  --&gt;</span></span>
<span id="cb6-776"><a href="#cb6-776" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!--   mutate(across(where(is.numeric), ~ round(., 2))) %&gt;% --&gt;</span></span>
<span id="cb6-777"><a href="#cb6-777" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!--   kbl(format = "markdown") --&gt;</span></span>
<span id="cb6-778"><a href="#cb6-778" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- </span><span class="st">```</span> <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-779"><a href="#cb6-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-780"><a href="#cb6-780" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> <span class="st">```</span><span class="at">{r, results = 'asis'} --&gt;</span></span>
<span id="cb6-781"><a href="#cb6-781" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| eval: false # copy and paste your own text --&gt;</span></span>
<span id="cb6-782"><a href="#cb6-782" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- cat(group_comparison_age_young_old$interpretation) --&gt;</span></span>
<span id="cb6-783"><a href="#cb6-783" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- </span><span class="st">```</span> <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-784"><a href="#cb6-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-785"><a href="#cb6-785" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-786"><a href="#cb6-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-787"><a href="#cb6-787" aria-hidden="true" tabindex="-1"></a><span class="do">### Heterogeneous Treatment Effects {#results-qini-curve}</span></span>
<span id="cb6-788"><a href="#cb6-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-789"><a href="#cb6-789" aria-hidden="true" tabindex="-1"></a>We begin by examining the distribution of individual treatment <span class="fu">effects</span> (τᵢ) across our sample. <span class="sc">@</span>fig<span class="sc">-</span>tau<span class="sc">-</span>distribution presents the estimated treatment effects <span class="cf">for</span> each individual, revealing substantial variability <span class="cf">in</span> how people respond to {name_exposure_lower}.</span>
<span id="cb6-790"><a href="#cb6-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-791"><a href="#cb6-791" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb6-792"><a href="#cb6-792" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-tau-distribution</span></span>
<span id="cb6-793"><a href="#cb6-793" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Distribution of Individual Treatment Effects (τᵢ) Across Outcomes"</span></span>
<span id="cb6-794"><a href="#cb6-794" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb6-795"><a href="#cb6-795" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-796"><a href="#cb6-796" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 12</span></span>
<span id="cb6-797"><a href="#cb6-797" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 10</span></span>
<span id="cb6-798"><a href="#cb6-798" aria-hidden="true" tabindex="-1"></a><span class="at">#| </span></span>
<span id="cb6-799"><a href="#cb6-799" aria-hidden="true" tabindex="-1"></a><span class="at"># create tau plots showing individual treatment effect distributions</span></span>
<span id="cb6-800"><a href="#cb6-800" aria-hidden="true" tabindex="-1"></a><span class="at">tau_plots &lt;- margot_plot_tau(</span></span>
<span id="cb6-801"><a href="#cb6-801" aria-hidden="true" tabindex="-1"></a><span class="at">  models_for_analysis, </span></span>
<span id="cb6-802"><a href="#cb6-802" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping = labels_for_analysis</span></span>
<span id="cb6-803"><a href="#cb6-803" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-804"><a href="#cb6-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-805"><a href="#cb6-805" aria-hidden="true" tabindex="-1"></a><span class="at"># display the plot</span></span>
<span id="cb6-806"><a href="#cb6-806" aria-hidden="true" tabindex="-1"></a><span class="at">tau_plots</span></span>
<span id="cb6-807"><a href="#cb6-807" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-808"><a href="#cb6-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-809"><a href="#cb6-809" aria-hidden="true" tabindex="-1"></a>The histograms above show considerable heterogeneity <span class="cf">in</span> treatment effects across individuals. To determine whether this variability is <span class="fu">systematic</span> (i.e., predictable based on individual characteristics) rather than random noise, we employ two complementary approaches<span class="sc">:</span> Qini curves to assess the reliability of heterogeneous effects, and policy trees to identify subgroups with differential treatment responses.</span>
<span id="cb6-810"><a href="#cb6-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-811"><a href="#cb6-811" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-812"><a href="#cb6-812" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false  # &lt;- copy and modify text as needed</span></span>
<span id="cb6-813"><a href="#cb6-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-814"><a href="#cb6-814" aria-hidden="true" tabindex="-1"></a><span class="at"># copy and paste into your text</span></span>
<span id="cb6-815"><a href="#cb6-815" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb6-816"><a href="#cb6-816" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb6-817"><a href="#cb6-817" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "results",</span></span>
<span id="cb6-818"><a href="#cb6-818" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c("grf.interpretation_qini"),</span></span>
<span id="cb6-819"><a href="#cb6-819" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb6-820"><a href="#cb6-820" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb6-821"><a href="#cb6-821" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-822"><a href="#cb6-822" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-823"><a href="#cb6-823" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-824"><a href="#cb6-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-825"><a href="#cb6-825" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb6-826"><a href="#cb6-826" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false  # &lt;- set to true and use if you have reliable results</span></span>
<span id="cb6-827"><a href="#cb6-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-828"><a href="#cb6-828" aria-hidden="true" tabindex="-1"></a><span class="at"># only use if you have reliable qini results</span></span>
<span id="cb6-829"><a href="#cb6-829" aria-hidden="true" tabindex="-1"></a><span class="at">if (length(reliable_ids) &gt; 0) {</span></span>
<span id="cb6-830"><a href="#cb6-830" aria-hidden="true" tabindex="-1"></a><span class="at">  cat(qini_gain$qini_explanation)</span></span>
<span id="cb6-831"><a href="#cb6-831" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-832"><a href="#cb6-832" aria-hidden="true" tabindex="-1"></a><span class="at">  cat("No significant heterogeneous treatment effects were detected using Qini curve analysis.")</span></span>
<span id="cb6-833"><a href="#cb6-833" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-834"><a href="#cb6-834" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-835"><a href="#cb6-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-836"><a href="#cb6-836" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;!--</span> only include this table <span class="cf">if</span> you have multiple qini results <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-837"><a href="#cb6-837" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb6-838"><a href="#cb6-838" aria-hidden="true" tabindex="-1"></a><span class="at">#| tbl-cap: "Qini Curve Results"</span></span>
<span id="cb6-839"><a href="#cb6-839" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true  # &lt;- set to true if you have qini results</span></span>
<span id="cb6-840"><a href="#cb6-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-841"><a href="#cb6-841" aria-hidden="true" tabindex="-1"></a><span class="at"># only use if you have multiple qini results</span></span>
<span id="cb6-842"><a href="#cb6-842" aria-hidden="true" tabindex="-1"></a><span class="at">if (length(reliable_ids) &gt; 1) {</span></span>
<span id="cb6-843"><a href="#cb6-843" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(</span></span>
<span id="cb6-844"><a href="#cb6-844" aria-hidden="true" tabindex="-1"></a><span class="at">    qini_gain$summary_table |&gt; </span></span>
<span id="cb6-845"><a href="#cb6-845" aria-hidden="true" tabindex="-1"></a><span class="at">      mutate(across(where(is.numeric), ~ round(., 2))),</span></span>
<span id="cb6-846"><a href="#cb6-846" aria-hidden="true" tabindex="-1"></a><span class="at">    format = "markdown",</span></span>
<span id="cb6-847"><a href="#cb6-847" aria-hidden="true" tabindex="-1"></a><span class="at">    caption = "Qini Curve Results"</span></span>
<span id="cb6-848"><a href="#cb6-848" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-849"><a href="#cb6-849" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-850"><a href="#cb6-850" aria-hidden="true" tabindex="-1"></a><span class="at">  cat("*Note: Qini curve table only displayed when multiple significant results are found.*")</span></span>
<span id="cb6-851"><a href="#cb6-851" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-852"><a href="#cb6-852" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-853"><a href="#cb6-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-854"><a href="#cb6-854" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;!--</span> only include figures <span class="cf">if</span> you have qini results <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-855"><a href="#cb6-855" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb6-856"><a href="#cb6-856" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-qini-combined</span></span>
<span id="cb6-857"><a href="#cb6-857" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Qini Curves for Heterogeneous Treatment Effects"</span></span>
<span id="cb6-858"><a href="#cb6-858" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true # &lt;- set to true if you have qini plots</span></span>
<span id="cb6-859"><a href="#cb6-859" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-860"><a href="#cb6-860" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 18</span></span>
<span id="cb6-861"><a href="#cb6-861" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb6-862"><a href="#cb6-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-863"><a href="#cb6-863" aria-hidden="true" tabindex="-1"></a><span class="at"># only run if you have qini plots</span></span>
<span id="cb6-864"><a href="#cb6-864" aria-hidden="true" tabindex="-1"></a><span class="at">if (length(qini_plots) &gt; 0) {</span></span>
<span id="cb6-865"><a href="#cb6-865" aria-hidden="true" tabindex="-1"></a><span class="at">  # create blank plot for spacing</span></span>
<span id="cb6-866"><a href="#cb6-866" aria-hidden="true" tabindex="-1"></a><span class="at">  blank_plot &lt;- plot_spacer()</span></span>
<span id="cb6-867"><a href="#cb6-867" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-868"><a href="#cb6-868" aria-hidden="true" tabindex="-1"></a><span class="at">  # determine grid layout (2 columns preferred)</span></span>
<span id="cb6-869"><a href="#cb6-869" aria-hidden="true" tabindex="-1"></a><span class="at">  n_plots &lt;- length(qini_plots)</span></span>
<span id="cb6-870"><a href="#cb6-870" aria-hidden="true" tabindex="-1"></a><span class="at">  n_cols &lt;- 2</span></span>
<span id="cb6-871"><a href="#cb6-871" aria-hidden="true" tabindex="-1"></a><span class="at">  n_rows &lt;- ceiling(n_plots / n_cols)</span></span>
<span id="cb6-872"><a href="#cb6-872" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-873"><a href="#cb6-873" aria-hidden="true" tabindex="-1"></a><span class="at">  # create list of plots including blank spacers for even grid</span></span>
<span id="cb6-874"><a href="#cb6-874" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_list &lt;- qini_plots</span></span>
<span id="cb6-875"><a href="#cb6-875" aria-hidden="true" tabindex="-1"></a><span class="at">  n_blanks_needed &lt;- (n_rows * n_cols) - n_plots</span></span>
<span id="cb6-876"><a href="#cb6-876" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-877"><a href="#cb6-877" aria-hidden="true" tabindex="-1"></a><span class="at">  # add blank plots to fill the grid</span></span>
<span id="cb6-878"><a href="#cb6-878" aria-hidden="true" tabindex="-1"></a><span class="at">  if (n_blanks_needed &gt; 0) {</span></span>
<span id="cb6-879"><a href="#cb6-879" aria-hidden="true" tabindex="-1"></a><span class="at">    for (i in 1:n_blanks_needed) {</span></span>
<span id="cb6-880"><a href="#cb6-880" aria-hidden="true" tabindex="-1"></a><span class="at">      plot_list &lt;- append(plot_list, list(blank_plot))</span></span>
<span id="cb6-881"><a href="#cb6-881" aria-hidden="true" tabindex="-1"></a><span class="at">    }</span></span>
<span id="cb6-882"><a href="#cb6-882" aria-hidden="true" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb6-883"><a href="#cb6-883" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-884"><a href="#cb6-884" aria-hidden="true" tabindex="-1"></a><span class="at">  # combine plots in a grid</span></span>
<span id="cb6-885"><a href="#cb6-885" aria-hidden="true" tabindex="-1"></a><span class="at">  combined_qini &lt;- wrap_plots(</span></span>
<span id="cb6-886"><a href="#cb6-886" aria-hidden="true" tabindex="-1"></a><span class="at">    plot_list,</span></span>
<span id="cb6-887"><a href="#cb6-887" aria-hidden="true" tabindex="-1"></a><span class="at">    ncol = n_cols,</span></span>
<span id="cb6-888"><a href="#cb6-888" aria-hidden="true" tabindex="-1"></a><span class="at">    nrow = n_rows</span></span>
<span id="cb6-889"><a href="#cb6-889" aria-hidden="true" tabindex="-1"></a><span class="at">  ) +</span></span>
<span id="cb6-890"><a href="#cb6-890" aria-hidden="true" tabindex="-1"></a><span class="at">    plot_layout(guides = "collect") +</span></span>
<span id="cb6-891"><a href="#cb6-891" aria-hidden="true" tabindex="-1"></a><span class="at">    plot_annotation(</span></span>
<span id="cb6-892"><a href="#cb6-892" aria-hidden="true" tabindex="-1"></a><span class="at">      title    = "Qini Curves for Reliable Heterogeneous Effects",</span></span>
<span id="cb6-893"><a href="#cb6-893" aria-hidden="true" tabindex="-1"></a><span class="at">      subtitle = paste("Models with significant treatment effect heterogeneity (n =", </span></span>
<span id="cb6-894"><a href="#cb6-894" aria-hidden="true" tabindex="-1"></a><span class="at">                       n_plots, ")")</span></span>
<span id="cb6-895"><a href="#cb6-895" aria-hidden="true" tabindex="-1"></a><span class="at">    ) &amp;</span></span>
<span id="cb6-896"><a href="#cb6-896" aria-hidden="true" tabindex="-1"></a><span class="at">    theme(</span></span>
<span id="cb6-897"><a href="#cb6-897" aria-hidden="true" tabindex="-1"></a><span class="at">      legend.position   = "bottom",</span></span>
<span id="cb6-898"><a href="#cb6-898" aria-hidden="true" tabindex="-1"></a><span class="at">      plot.title        = element_text(hjust = 0.5),</span></span>
<span id="cb6-899"><a href="#cb6-899" aria-hidden="true" tabindex="-1"></a><span class="at">      plot.subtitle     = element_text(hjust = 0.5)</span></span>
<span id="cb6-900"><a href="#cb6-900" aria-hidden="true" tabindex="-1"></a><span class="at">    )</span></span>
<span id="cb6-901"><a href="#cb6-901" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-902"><a href="#cb6-902" aria-hidden="true" tabindex="-1"></a><span class="at">  print(combined_qini)</span></span>
<span id="cb6-903"><a href="#cb6-903" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-904"><a href="#cb6-904" aria-hidden="true" tabindex="-1"></a><span class="at">  message("no qini plots to display")</span></span>
<span id="cb6-905"><a href="#cb6-905" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-906"><a href="#cb6-906" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-907"><a href="#cb6-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-908"><a href="#cb6-908" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-909"><a href="#cb6-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-910"><a href="#cb6-910" aria-hidden="true" tabindex="-1"></a><span class="do">### Decision Rules (Who is Most Sensitive to Treatment?)</span></span>
<span id="cb6-911"><a href="#cb6-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-912"><a href="#cb6-912" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-913"><a href="#cb6-913" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false  # &lt;- set to true and modify text as needed</span></span>
<span id="cb6-914"><a href="#cb6-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-915"><a href="#cb6-915" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb6-916"><a href="#cb6-916" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb6-917"><a href="#cb6-917" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "results",</span></span>
<span id="cb6-918"><a href="#cb6-918" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c("grf.interpretation_policy_tree"),</span></span>
<span id="cb6-919"><a href="#cb6-919" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb6-920"><a href="#cb6-920" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb6-921"><a href="#cb6-921" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-922"><a href="#cb6-922" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-923"><a href="#cb6-923" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-924"><a href="#cb6-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-925"><a href="#cb6-925" aria-hidden="true" tabindex="-1"></a>The following pages present policy trees <span class="cf">for</span> each outcome with reliable heterogeneous effects. Each tree shows<span class="sc">:</span> (<span class="dv">1</span>) the decision rules <span class="cf">for</span> treatment assignment, (<span class="dv">2</span>) the distribution of treatment effects across subgroups, <span class="fu">and</span> (<span class="dv">3</span>) visual representation of how covariates split the population into groups with differential treatment responses.</span>
<span id="cb6-926"><a href="#cb6-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-927"><a href="#cb6-927" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;!--</span> the following policy tree figures are optional <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-928"><a href="#cb6-928" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> only include as many as you have valid policy trees <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-929"><a href="#cb6-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-930"><a href="#cb6-930" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb6-931"><a href="#cb6-931" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-policy-trees</span></span>
<span id="cb6-932"><a href="#cb6-932" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Policy Trees for Treatment Assignment"</span></span>
<span id="cb6-933"><a href="#cb6-933" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true # &lt;- set to true if you have policy trees</span></span>
<span id="cb6-934"><a href="#cb6-934" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-935"><a href="#cb6-935" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 10</span></span>
<span id="cb6-936"><a href="#cb6-936" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb6-937"><a href="#cb6-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-938"><a href="#cb6-938" aria-hidden="true" tabindex="-1"></a><span class="at"># display policy trees if they exist - one per page</span></span>
<span id="cb6-939"><a href="#cb6-939" aria-hidden="true" tabindex="-1"></a><span class="at">if (length(policy_plots) &gt; 0) {</span></span>
<span id="cb6-940"><a href="#cb6-940" aria-hidden="true" tabindex="-1"></a><span class="at">  # iterate through each policy tree</span></span>
<span id="cb6-941"><a href="#cb6-941" aria-hidden="true" tabindex="-1"></a><span class="at">  for (i in seq_along(policy_plots)) {</span></span>
<span id="cb6-942"><a href="#cb6-942" aria-hidden="true" tabindex="-1"></a><span class="at">    # add page break before each plot except the first</span></span>
<span id="cb6-943"><a href="#cb6-943" aria-hidden="true" tabindex="-1"></a><span class="at">    if (i &gt; 1) {</span></span>
<span id="cb6-944"><a href="#cb6-944" aria-hidden="true" tabindex="-1"></a><span class="at">      cat("</span><span class="sc">\n\n</span><span class="at">{{&lt; pagebreak &gt;}}</span><span class="sc">\n\n</span><span class="at">")</span></span>
<span id="cb6-945"><a href="#cb6-945" aria-hidden="true" tabindex="-1"></a><span class="at">    }</span></span>
<span id="cb6-946"><a href="#cb6-946" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-947"><a href="#cb6-947" aria-hidden="true" tabindex="-1"></a><span class="at">    # create individual caption for each tree</span></span>
<span id="cb6-948"><a href="#cb6-948" aria-hidden="true" tabindex="-1"></a><span class="at">    cat(paste0("</span><span class="sc">\n\n</span><span class="at">#### Policy Tree ", i, ": ", qini_names[[i]], "</span><span class="sc">\n\n</span><span class="at">"))</span></span>
<span id="cb6-949"><a href="#cb6-949" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-950"><a href="#cb6-950" aria-hidden="true" tabindex="-1"></a><span class="at">    # print the policy tree</span></span>
<span id="cb6-951"><a href="#cb6-951" aria-hidden="true" tabindex="-1"></a><span class="at">    print(policy_plots[[i]])</span></span>
<span id="cb6-952"><a href="#cb6-952" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb6-953"><a href="#cb6-953" aria-hidden="true" tabindex="-1"></a><span class="at">    # add some space after</span></span>
<span id="cb6-954"><a href="#cb6-954" aria-hidden="true" tabindex="-1"></a><span class="at">    cat("</span><span class="sc">\n\n</span><span class="at">")</span></span>
<span id="cb6-955"><a href="#cb6-955" aria-hidden="true" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb6-956"><a href="#cb6-956" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-957"><a href="#cb6-957" aria-hidden="true" tabindex="-1"></a><span class="at">  message("no policy trees to display")</span></span>
<span id="cb6-958"><a href="#cb6-958" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-959"><a href="#cb6-959" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-960"><a href="#cb6-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-961"><a href="#cb6-961" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb6-962"><a href="#cb6-962" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- copy and paste text a insert jsust below graph</span></span>
<span id="cb6-963"><a href="#cb6-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-964"><a href="#cb6-964" aria-hidden="true" tabindex="-1"></a><span class="at"># use this text below your decision tree graphs</span></span>
<span id="cb6-965"><a href="#cb6-965" aria-hidden="true" tabindex="-1"></a><span class="at">if (length(reliable_ids) &gt; 0) {</span></span>
<span id="cb6-966"><a href="#cb6-966" aria-hidden="true" tabindex="-1"></a><span class="at">  cat(policy_text, "</span><span class="sc">\n</span><span class="at">")</span></span>
<span id="cb6-967"><a href="#cb6-967" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-968"><a href="#cb6-968" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-969"><a href="#cb6-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-970"><a href="#cb6-970" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-971"><a href="#cb6-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-972"><a href="#cb6-972" aria-hidden="true" tabindex="-1"></a><span class="do">## Discussion</span></span>
<span id="cb6-973"><a href="#cb6-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-974"><a href="#cb6-974" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r,  results='asis'}</span></span>
<span id="cb6-975"><a href="#cb6-975" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false  # &lt;- set to true and modify text as needed</span></span>
<span id="cb6-976"><a href="#cb6-976" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-977"><a href="#cb6-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-978"><a href="#cb6-978" aria-hidden="true" tabindex="-1"></a><span class="at">cat(boilerplate_generate_text(</span></span>
<span id="cb6-979"><a href="#cb6-979" aria-hidden="true" tabindex="-1"></a><span class="at">  category = "discussion",</span></span>
<span id="cb6-980"><a href="#cb6-980" aria-hidden="true" tabindex="-1"></a><span class="at">  sections = c(</span></span>
<span id="cb6-981"><a href="#cb6-981" aria-hidden="true" tabindex="-1"></a><span class="at">    "student_ethics",</span></span>
<span id="cb6-982"><a href="#cb6-982" aria-hidden="true" tabindex="-1"></a><span class="at">    "student_data",</span></span>
<span id="cb6-983"><a href="#cb6-983" aria-hidden="true" tabindex="-1"></a><span class="at">    "student_authors_statement"</span></span>
<span id="cb6-984"><a href="#cb6-984" aria-hidden="true" tabindex="-1"></a><span class="at">  ),</span></span>
<span id="cb6-985"><a href="#cb6-985" aria-hidden="true" tabindex="-1"></a><span class="at">  global_vars = list(</span></span>
<span id="cb6-986"><a href="#cb6-986" aria-hidden="true" tabindex="-1"></a><span class="at">    exposure_variable = name_exposure</span></span>
<span id="cb6-987"><a href="#cb6-987" aria-hidden="true" tabindex="-1"></a><span class="at">  ),</span></span>
<span id="cb6-988"><a href="#cb6-988" aria-hidden="true" tabindex="-1"></a><span class="at">  db = unified_db</span></span>
<span id="cb6-989"><a href="#cb6-989" aria-hidden="true" tabindex="-1"></a><span class="at">))</span></span>
<span id="cb6-990"><a href="#cb6-990" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-991"><a href="#cb6-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-992"><a href="#cb6-992" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-993"><a href="#cb6-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-994"><a href="#cb6-994" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix A: Measures {#appendix-measures}</span></span>
<span id="cb6-995"><a href="#cb6-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-996"><a href="#cb6-996" aria-hidden="true" tabindex="-1"></a><span class="do">### Measures</span></span>
<span id="cb6-997"><a href="#cb6-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-998"><a href="#cb6-998" aria-hidden="true" tabindex="-1"></a><span class="do">#### Baseline Covariate Measures</span></span>
<span id="cb6-999"><a href="#cb6-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1000"><a href="#cb6-1000" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-1001"><a href="#cb6-1001" aria-hidden="true" tabindex="-1"></a><span class="at">cat(baseline_measures_text)</span></span>
<span id="cb6-1002"><a href="#cb6-1002" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1003"><a href="#cb6-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1004"><a href="#cb6-1004" aria-hidden="true" tabindex="-1"></a><span class="do">#### Exposure Measures</span></span>
<span id="cb6-1005"><a href="#cb6-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1006"><a href="#cb6-1006" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-1007"><a href="#cb6-1007" aria-hidden="true" tabindex="-1"></a><span class="at">cat(exposure_measures_text)</span></span>
<span id="cb6-1008"><a href="#cb6-1008" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1009"><a href="#cb6-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1010"><a href="#cb6-1010" aria-hidden="true" tabindex="-1"></a><span class="do">#### Outcome Measures</span></span>
<span id="cb6-1011"><a href="#cb6-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1012"><a href="#cb6-1012" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-1013"><a href="#cb6-1013" aria-hidden="true" tabindex="-1"></a><span class="at">cat(outcome_measures_text)</span></span>
<span id="cb6-1014"><a href="#cb6-1014" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1015"><a href="#cb6-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1016"><a href="#cb6-1016" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-1017"><a href="#cb6-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1018"><a href="#cb6-1018" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix B: Sample Characteristics {#appendix-sample}</span></span>
<span id="cb6-1019"><a href="#cb6-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1020"><a href="#cb6-1020" aria-hidden="true" tabindex="-1"></a><span class="do">#### Sample Statistics: Baseline Covariates</span></span>
<span id="cb6-1021"><a href="#cb6-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1022"><a href="#cb6-1022" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>tbl<span class="sc">-</span>appendix<span class="sc">-</span>baseline presents sample demographic statistics.</span>
<span id="cb6-1023"><a href="#cb6-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1024"><a href="#cb6-1024" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span> {<span class="co">#tbl-appendix-baseline}</span></span>
<span id="cb6-1025"><a href="#cb6-1025" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb6-1026"><a href="#cb6-1026" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb6-1027"><a href="#cb6-1027" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: true</span></span>
<span id="cb6-1028"><a href="#cb6-1028" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-1029"><a href="#cb6-1029" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_baseline</span></span>
<span id="cb6-1030"><a href="#cb6-1030" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1031"><a href="#cb6-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1032"><a href="#cb6-1032" aria-hidden="true" tabindex="-1"></a>Demographic statistics <span class="cf">for</span> New Zealand Attitudes and Values Cohort<span class="sc">:</span> {baseline_wave_glued}.</span>
<span id="cb6-1033"><a href="#cb6-1033" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span></span>
<span id="cb6-1034"><a href="#cb6-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1035"><a href="#cb6-1035" aria-hidden="true" tabindex="-1"></a><span class="do">### Sample Statistics: Exposure Variable {#appendix-exposure}</span></span>
<span id="cb6-1036"><a href="#cb6-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1037"><a href="#cb6-1037" aria-hidden="true" tabindex="-1"></a><span class="er">:::</span> {<span class="co">#tbl-appendix-exposures}</span></span>
<span id="cb6-1038"><a href="#cb6-1038" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb6-1039"><a href="#cb6-1039" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb6-1040"><a href="#cb6-1040" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: true</span></span>
<span id="cb6-1041"><a href="#cb6-1041" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-1042"><a href="#cb6-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1043"><a href="#cb6-1043" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_exposures</span></span>
<span id="cb6-1044"><a href="#cb6-1044" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1045"><a href="#cb6-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1046"><a href="#cb6-1046" aria-hidden="true" tabindex="-1"></a>Demographic statistics <span class="cf">for</span> New Zealand Attitudes and Values Cohort waves <span class="fl">2018.</span></span>
<span id="cb6-1047"><a href="#cb6-1047" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span></span>
<span id="cb6-1048"><a href="#cb6-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1049"><a href="#cb6-1049" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-1050"><a href="#cb6-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1051"><a href="#cb6-1051" aria-hidden="true" tabindex="-1"></a><span class="do">### Sample Statistics: Outcome Variables {#appendix-outcomes}</span></span>
<span id="cb6-1052"><a href="#cb6-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1053"><a href="#cb6-1053" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span> {<span class="co">#tbl-appendix-outcomes}</span></span>
<span id="cb6-1054"><a href="#cb6-1054" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb6-1055"><a href="#cb6-1055" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb6-1056"><a href="#cb6-1056" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: true</span></span>
<span id="cb6-1057"><a href="#cb6-1057" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-1058"><a href="#cb6-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1059"><a href="#cb6-1059" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_outcomes</span></span>
<span id="cb6-1060"><a href="#cb6-1060" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1061"><a href="#cb6-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1062"><a href="#cb6-1062" aria-hidden="true" tabindex="-1"></a>Outcome variables measured at {baseline_wave_glued} and {outcome_wave}</span>
<span id="cb6-1063"><a href="#cb6-1063" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span></span>
<span id="cb6-1064"><a href="#cb6-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1065"><a href="#cb6-1065" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-1066"><a href="#cb6-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1067"><a href="#cb6-1067" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix C: Transition Matrix to Check The Positivity Assumption {#appendix-transition}</span></span>
<span id="cb6-1068"><a href="#cb6-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1069"><a href="#cb6-1069" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb6-1070"><a href="#cb6-1070" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: tbl-transition</span></span>
<span id="cb6-1071"><a href="#cb6-1071" aria-hidden="true" tabindex="-1"></a><span class="at">#| tbl-cap: "Transition Matrix Showing Change"</span></span>
<span id="cb6-1072"><a href="#cb6-1072" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb6-1073"><a href="#cb6-1073" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: true</span></span>
<span id="cb6-1074"><a href="#cb6-1074" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-1075"><a href="#cb6-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1076"><a href="#cb6-1076" aria-hidden="true" tabindex="-1"></a><span class="at">transition_tables_binary$tables[[1]]</span></span>
<span id="cb6-1077"><a href="#cb6-1077" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1078"><a href="#cb6-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1079"><a href="#cb6-1079" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb6-1080"><a href="#cb6-1080" aria-hidden="true" tabindex="-1"></a><span class="at">cat(transition_tables_binary$explanation)</span></span>
<span id="cb6-1081"><a href="#cb6-1081" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1082"><a href="#cb6-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1083"><a href="#cb6-1083" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-1084"><a href="#cb6-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1085"><a href="#cb6-1085" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix D: RATE AUTOC and RATE Qini {#appendix-rate}</span></span>
<span id="cb6-1086"><a href="#cb6-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1087"><a href="#cb6-1087" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-1088"><a href="#cb6-1088" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true and modify text as needed</span></span>
<span id="cb6-1089"><a href="#cb6-1089" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-1090"><a href="#cb6-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1091"><a href="#cb6-1091" aria-hidden="true" tabindex="-1"></a><span class="at"># select appropriate text based on whether outcomes were flipped</span></span>
<span id="cb6-1092"><a href="#cb6-1092" aria-hidden="true" tabindex="-1"></a><span class="at">if (use_flipped) {</span></span>
<span id="cb6-1093"><a href="#cb6-1093" aria-hidden="true" tabindex="-1"></a><span class="at">  cat(</span></span>
<span id="cb6-1094"><a href="#cb6-1094" aria-hidden="true" tabindex="-1"></a><span class="at">    boilerplate::boilerplate_generate_text(</span></span>
<span id="cb6-1095"><a href="#cb6-1095" aria-hidden="true" tabindex="-1"></a><span class="at">      category     = "results",</span></span>
<span id="cb6-1096"><a href="#cb6-1096" aria-hidden="true" tabindex="-1"></a><span class="at">      sections     = c("grf.interpretation_rate"),</span></span>
<span id="cb6-1097"><a href="#cb6-1097" aria-hidden="true" tabindex="-1"></a><span class="at">      global_vars  = global_vars,</span></span>
<span id="cb6-1098"><a href="#cb6-1098" aria-hidden="true" tabindex="-1"></a><span class="at">      db           = unified_db</span></span>
<span id="cb6-1099"><a href="#cb6-1099" aria-hidden="true" tabindex="-1"></a><span class="at">    )</span></span>
<span id="cb6-1100"><a href="#cb6-1100" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-1101"><a href="#cb6-1101" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-1102"><a href="#cb6-1102" aria-hidden="true" tabindex="-1"></a><span class="at">  # use no-flip version if available</span></span>
<span id="cb6-1103"><a href="#cb6-1103" aria-hidden="true" tabindex="-1"></a><span class="at">  if (!is.null(unified_db$results$grf$interpretation_rate_no_flip)) {</span></span>
<span id="cb6-1104"><a href="#cb6-1104" aria-hidden="true" tabindex="-1"></a><span class="at">    cat(unified_db$results$grf$interpretation_rate_no_flip)</span></span>
<span id="cb6-1105"><a href="#cb6-1105" aria-hidden="true" tabindex="-1"></a><span class="at">  } else {</span></span>
<span id="cb6-1106"><a href="#cb6-1106" aria-hidden="true" tabindex="-1"></a><span class="at">    cat(</span></span>
<span id="cb6-1107"><a href="#cb6-1107" aria-hidden="true" tabindex="-1"></a><span class="at">      boilerplate::boilerplate_generate_text(</span></span>
<span id="cb6-1108"><a href="#cb6-1108" aria-hidden="true" tabindex="-1"></a><span class="at">        category     = "results",</span></span>
<span id="cb6-1109"><a href="#cb6-1109" aria-hidden="true" tabindex="-1"></a><span class="at">        sections     = c("grf.interpretation_rate"),</span></span>
<span id="cb6-1110"><a href="#cb6-1110" aria-hidden="true" tabindex="-1"></a><span class="at">        global_vars  = global_vars,</span></span>
<span id="cb6-1111"><a href="#cb6-1111" aria-hidden="true" tabindex="-1"></a><span class="at">        db           = unified_db</span></span>
<span id="cb6-1112"><a href="#cb6-1112" aria-hidden="true" tabindex="-1"></a><span class="at">      )</span></span>
<span id="cb6-1113"><a href="#cb6-1113" aria-hidden="true" tabindex="-1"></a><span class="at">    )</span></span>
<span id="cb6-1114"><a href="#cb6-1114" aria-hidden="true" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb6-1115"><a href="#cb6-1115" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-1116"><a href="#cb6-1116" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1117"><a href="#cb6-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1118"><a href="#cb6-1118" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-1119"><a href="#cb6-1119" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true as needed</span></span>
<span id="cb6-1120"><a href="#cb6-1120" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-1121"><a href="#cb6-1121" aria-hidden="true" tabindex="-1"></a><span class="at">cat(rate_interp$comparison)</span></span>
<span id="cb6-1122"><a href="#cb6-1122" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1123"><a href="#cb6-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1124"><a href="#cb6-1124" aria-hidden="true" tabindex="-1"></a>Refer to [Appendix D](<span class="co">#appendix-cate-validation) for details.</span></span>
<span id="cb6-1125"><a href="#cb6-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1126"><a href="#cb6-1126" aria-hidden="true" tabindex="-1"></a><span class="do">##### RATE AUTOC RESULTS</span></span>
<span id="cb6-1127"><a href="#cb6-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1128"><a href="#cb6-1128" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb6-1129"><a href="#cb6-1129" aria-hidden="true" tabindex="-1"></a><span class="at"># only show if there are autoc results</span></span>
<span id="cb6-1130"><a href="#cb6-1130" aria-hidden="true" tabindex="-1"></a><span class="at">if (length(model_groups$autoc) &gt; 0) {</span></span>
<span id="cb6-1131"><a href="#cb6-1131" aria-hidden="true" tabindex="-1"></a><span class="at">  cat(rate_interp$autoc_results)</span></span>
<span id="cb6-1132"><a href="#cb6-1132" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-1133"><a href="#cb6-1133" aria-hidden="true" tabindex="-1"></a><span class="at">  cat("No significant RATE AUTOC results were found.")</span></span>
<span id="cb6-1134"><a href="#cb6-1134" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-1135"><a href="#cb6-1135" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1136"><a href="#cb6-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1137"><a href="#cb6-1137" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;!--</span> only include autoc plots <span class="cf">if</span> they exist <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb6-1138"><a href="#cb6-1138" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb6-1139"><a href="#cb6-1139" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-rate-autoc</span></span>
<span id="cb6-1140"><a href="#cb6-1140" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "RATE AUTOC Curves"</span></span>
<span id="cb6-1141"><a href="#cb6-1141" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true if you have autoc plots</span></span>
<span id="cb6-1142"><a href="#cb6-1142" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-1143"><a href="#cb6-1143" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 16</span></span>
<span id="cb6-1144"><a href="#cb6-1144" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb6-1145"><a href="#cb6-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1146"><a href="#cb6-1146" aria-hidden="true" tabindex="-1"></a><span class="at"># display autoc plots if they exist</span></span>
<span id="cb6-1147"><a href="#cb6-1147" aria-hidden="true" tabindex="-1"></a><span class="at">if (length(autoc_plots) &gt; 0) {</span></span>
<span id="cb6-1148"><a href="#cb6-1148" aria-hidden="true" tabindex="-1"></a><span class="at">  # create blank plot for spacing</span></span>
<span id="cb6-1149"><a href="#cb6-1149" aria-hidden="true" tabindex="-1"></a><span class="at">  blank_plot &lt;- plot_spacer()</span></span>
<span id="cb6-1150"><a href="#cb6-1150" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-1151"><a href="#cb6-1151" aria-hidden="true" tabindex="-1"></a><span class="at">  # determine grid layout (2 columns preferred)</span></span>
<span id="cb6-1152"><a href="#cb6-1152" aria-hidden="true" tabindex="-1"></a><span class="at">  n_plots &lt;- length(autoc_plots)</span></span>
<span id="cb6-1153"><a href="#cb6-1153" aria-hidden="true" tabindex="-1"></a><span class="at">  n_cols &lt;- 2</span></span>
<span id="cb6-1154"><a href="#cb6-1154" aria-hidden="true" tabindex="-1"></a><span class="at">  n_rows &lt;- ceiling(n_plots / n_cols)</span></span>
<span id="cb6-1155"><a href="#cb6-1155" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-1156"><a href="#cb6-1156" aria-hidden="true" tabindex="-1"></a><span class="at">  # create list of plots including blank spacers for even grid</span></span>
<span id="cb6-1157"><a href="#cb6-1157" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_list &lt;- autoc_plots</span></span>
<span id="cb6-1158"><a href="#cb6-1158" aria-hidden="true" tabindex="-1"></a><span class="at">  n_blanks_needed &lt;- (n_rows * n_cols) - n_plots</span></span>
<span id="cb6-1159"><a href="#cb6-1159" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-1160"><a href="#cb6-1160" aria-hidden="true" tabindex="-1"></a><span class="at">  # add blank plots to fill the grid</span></span>
<span id="cb6-1161"><a href="#cb6-1161" aria-hidden="true" tabindex="-1"></a><span class="at">  if (n_blanks_needed &gt; 0) {</span></span>
<span id="cb6-1162"><a href="#cb6-1162" aria-hidden="true" tabindex="-1"></a><span class="at">    for (i in 1:n_blanks_needed) {</span></span>
<span id="cb6-1163"><a href="#cb6-1163" aria-hidden="true" tabindex="-1"></a><span class="at">      plot_list &lt;- append(plot_list, list(blank_plot))</span></span>
<span id="cb6-1164"><a href="#cb6-1164" aria-hidden="true" tabindex="-1"></a><span class="at">    }</span></span>
<span id="cb6-1165"><a href="#cb6-1165" aria-hidden="true" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb6-1166"><a href="#cb6-1166" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-1167"><a href="#cb6-1167" aria-hidden="true" tabindex="-1"></a><span class="at">  # combine plots in a grid</span></span>
<span id="cb6-1168"><a href="#cb6-1168" aria-hidden="true" tabindex="-1"></a><span class="at">  combined_autoc &lt;- wrap_plots(</span></span>
<span id="cb6-1169"><a href="#cb6-1169" aria-hidden="true" tabindex="-1"></a><span class="at">    plot_list,</span></span>
<span id="cb6-1170"><a href="#cb6-1170" aria-hidden="true" tabindex="-1"></a><span class="at">    ncol = n_cols,</span></span>
<span id="cb6-1171"><a href="#cb6-1171" aria-hidden="true" tabindex="-1"></a><span class="at">    nrow = n_rows</span></span>
<span id="cb6-1172"><a href="#cb6-1172" aria-hidden="true" tabindex="-1"></a><span class="at">  ) +</span></span>
<span id="cb6-1173"><a href="#cb6-1173" aria-hidden="true" tabindex="-1"></a><span class="at">    plot_layout(guides = "collect") +</span></span>
<span id="cb6-1174"><a href="#cb6-1174" aria-hidden="true" tabindex="-1"></a><span class="at">    plot_annotation(</span></span>
<span id="cb6-1175"><a href="#cb6-1175" aria-hidden="true" tabindex="-1"></a><span class="at">      title    = "RATE AUTOC Curves for Heterogeneous Effects",</span></span>
<span id="cb6-1176"><a href="#cb6-1176" aria-hidden="true" tabindex="-1"></a><span class="at">      subtitle = paste("Outcomes with significant autocorrelation (n =", </span></span>
<span id="cb6-1177"><a href="#cb6-1177" aria-hidden="true" tabindex="-1"></a><span class="at">                       n_plots, ")")</span></span>
<span id="cb6-1178"><a href="#cb6-1178" aria-hidden="true" tabindex="-1"></a><span class="at">    ) &amp;</span></span>
<span id="cb6-1179"><a href="#cb6-1179" aria-hidden="true" tabindex="-1"></a><span class="at">    theme(</span></span>
<span id="cb6-1180"><a href="#cb6-1180" aria-hidden="true" tabindex="-1"></a><span class="at">      legend.position   = "bottom",</span></span>
<span id="cb6-1181"><a href="#cb6-1181" aria-hidden="true" tabindex="-1"></a><span class="at">      plot.title        = element_text(hjust = 0.5),</span></span>
<span id="cb6-1182"><a href="#cb6-1182" aria-hidden="true" tabindex="-1"></a><span class="at">      plot.subtitle     = element_text(hjust = 0.5)</span></span>
<span id="cb6-1183"><a href="#cb6-1183" aria-hidden="true" tabindex="-1"></a><span class="at">    )</span></span>
<span id="cb6-1184"><a href="#cb6-1184" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb6-1185"><a href="#cb6-1185" aria-hidden="true" tabindex="-1"></a><span class="at">  print(combined_autoc)</span></span>
<span id="cb6-1186"><a href="#cb6-1186" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb6-1187"><a href="#cb6-1187" aria-hidden="true" tabindex="-1"></a><span class="at">  message("no autoc plots to display")</span></span>
<span id="cb6-1188"><a href="#cb6-1188" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb6-1189"><a href="#cb6-1189" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1190"><a href="#cb6-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1191"><a href="#cb6-1191" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-1192"><a href="#cb6-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1193"><a href="#cb6-1193" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix E: Estimating and Interpreting Heterogeneous Treatment Effects with GRF {#appendix-explain-grf}</span></span>
<span id="cb6-1194"><a href="#cb6-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1195"><a href="#cb6-1195" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-1196"><a href="#cb6-1196" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true as needed</span></span>
<span id="cb6-1197"><a href="#cb6-1197" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb6-1198"><a href="#cb6-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1199"><a href="#cb6-1199" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb6-1200"><a href="#cb6-1200" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb6-1201"><a href="#cb6-1201" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "appendix",</span></span>
<span id="cb6-1202"><a href="#cb6-1202" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c("explain.grf_short"),</span></span>
<span id="cb6-1203"><a href="#cb6-1203" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb6-1204"><a href="#cb6-1204" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb6-1205"><a href="#cb6-1205" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-1206"><a href="#cb6-1206" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-1207"><a href="#cb6-1207" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1208"><a href="#cb6-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1209"><a href="#cb6-1209" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-1210"><a href="#cb6-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1211"><a href="#cb6-1211" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix F: Strengths and Limitations of Causal Forests {#appendix-strengths}</span></span>
<span id="cb6-1212"><a href="#cb6-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1213"><a href="#cb6-1213" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb6-1214"><a href="#cb6-1214" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true and modify text as needed</span></span>
<span id="cb6-1215"><a href="#cb6-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1216"><a href="#cb6-1216" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb6-1217"><a href="#cb6-1217" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb6-1218"><a href="#cb6-1218" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "discussion",</span></span>
<span id="cb6-1219"><a href="#cb6-1219" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c("strengths.strengths_grf_short"),</span></span>
<span id="cb6-1220"><a href="#cb6-1220" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb6-1221"><a href="#cb6-1221" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb6-1222"><a href="#cb6-1222" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb6-1223"><a href="#cb6-1223" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb6-1224"><a href="#cb6-1224" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-1225"><a href="#cb6-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1226"><a href="#cb6-1226" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb6-1227"><a href="#cb6-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1228"><a href="#cb6-1228" aria-hidden="true" tabindex="-1"></a><span class="do">## References {.appendix-refs}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="💡 Remember to customise!">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
💡 Remember to customise!
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code chunk is a <strong>template</strong>. Run it once to generate boilerplate text, then:</p>
<ol type="1">
<li><strong>Copy</strong> the printed text into your manuscript.<br>
</li>
<li><strong>Delete</strong> any sections you don’t need.<br>
</li>
<li><strong>Modify</strong> the remaining text so it fits <em>your</em> variables, sample, and research question.</li>
</ol>
</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  boilerplate<span class="sc">::</span><span class="fu">boilerplate_generate_text</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">category    =</span> <span class="st">"methods"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sections    =</span> <span class="fu">c</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"student_sample.nzavs"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"student_target_population"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"eligibility.standard"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"causal_intervention.grf_simple_text"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"analytic_approach.general_approach_cate_long"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"exposure_indicator"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">"causal_identification_criteria"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"confounding_control.vanderweele"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"statistical_models.grf_short_explanation"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"missing_data.missing_grf_simple"</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"sensitivity_analysis.short_evalue"</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">global_vars =</span> global_vars,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">db          =</span> unified_db</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="pro-tip" class="level4">
<h4 class="anchored" data-anchor-id="pro-tip">Pro Tip</h4>
<p>You can adjust figure by changing:</p>
<p><code>#| fig-height: 16</code> and <code>#| fig-width: 9</code></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-policy-6</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Decision Tree: {glued_policy_names_6}"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 16 # &lt;- change here</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9 # &lt;- change here</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>policy_plots[[<span class="dv">6</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="what-you-have-learned" class="level2">
<h2 class="anchored" data-anchor-id="what-you-have-learned">What You Have Learned</h2>
<ul>
<li><p><strong>How to create a publication quality manuscript</strong></p></li>
<li><p><strong>How to create a workflow for references</strong></p></li>
<li><p><strong>How to import results into your manuscript</strong></p></li>
<li><p><strong>How to make graphs of your results (using) <code>margot</code></strong></p></li>
<li><p><strong>How to report your results</strong></p></li>
<li><p><strong>How to interpret your results</strong></p></li>
</ul>
</section>
<section id="frequently-asked-questions" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="frequently-asked-questions">Frequently Asked Questions</h2>
<section id="do-i-need-to-use-quarto-for-making-my-report" class="level3">
<h3 class="anchored" data-anchor-id="do-i-need-to-use-quarto-for-making-my-report">Do I need to use ‘quarto’ for making my report?</h3>
<p>No.&nbsp;The suggested workflow should make your life <em>easier</em>. If, after a fair trial – <em>and</em> after asking us for help – <code>quarto</code> still feels like extra friction, switch to whatever you like (<code>rmarkdown</code>, plain <code>R</code> scripts, or even Word). The science matters more than the wrapper.</p>
<p>👉 Quick-start: <a href="https://quarto.org/docs/get-started/" class="uri">https://quarto.org/docs/get-started/</a></p>
<hr>
</section>
<section id="i-cannot-save-or-retrieve-files-from-folders" class="level3">
<h3 class="anchored" data-anchor-id="i-cannot-save-or-retrieve-files-from-folders">I cannot save or retrieve files from folders</h3>
<p>When hunting path errors, ask yourself:</p>
<ul>
<li><strong>Packages</strong> – have I updated everything, especially <strong><code>margot</code></strong> and <strong><code>here</code></strong>?<br>
</li>
<li><strong>Clean slate</strong> – did I restart R (⌘⇧F10) <em>and</em> rerun the data-prep scripts from the top?<br>
</li>
<li><strong>Project root</strong> – am I inside the correct <strong>RStudio Project</strong>? Check with <code>here::here()</code>.<br>
</li>
<li><strong>Search</strong> – have I used <em>Edit → Find in Files</em> (⌘⇧F / Ctrl⇧F) to locate the object or path?<br>
</li>
<li><strong>Data really there?</strong> – do the objects exist in my data frame?</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># waves where `variable_name` was measured</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df_nz_long, <span class="fu">table</span>(variable_name, wave))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Permissions / cloud sync</strong> – is the save folder writable <em>and</em> local? Dropbox/OneDrive may off-load files; right-click and choose <em>Make available offline</em>.</li>
</ul>
<hr>
</section>
<section id="i-cannot-run-margot_causal_forest_parallel" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="i-cannot-run-margot_causal_forest_parallel">I cannot run ‘margot_causal_forest_parallel()’</h3>
<ul>
<li><strong>Fallback</strong> – does <code>margot_causal_forest()</code> work? It is slower but prints progress.<br>
</li>
<li><strong>Formula richness</strong> – causal forests need many covariates <span class="citation" data-cites="grf2024">(<a href="#ref-grf2024" role="doc-biblioref">Tibshirani et al. 2024</a>)</span>. Include the full demographic block.<br>
</li>
<li><strong>Resources</strong> – parallel forests spawn one worker per core. Keep some RAM free.<br>
</li>
<li><strong>Reduce load</strong> – try fewer trees or a smaller variable pool:</li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-grf2024" class="csl-entry" role="listitem">
Tibshirani, Julie, Susan Athey, Erik Sverdrup, and Stefan Wager. 2024. <em>Grf: Generalized Random Forests</em>. <a href="https://github.com/grf-labs/grf">https://github.com/grf-labs/grf</a>.
</div></div><div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>grf_defaults <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed             =</span> <span class="dv">123</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stabilize.splits =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">num.trees        =</span> <span class="dv">1000</span>,  <span class="co"># fewer trees</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">top_n_vars       =</span> <span class="dv">10</span>     <span class="co"># smaller policy-tree search space</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="i-cannot-run-margot_flip_forests_parallel" class="level3">
<h3 class="anchored" data-anchor-id="i-cannot-run-margot_flip_forests_parallel">I cannot run ‘margot_flip_forests_parallel()’</h3>
<p>First test the serial version <code>margot_flip_forests()</code>. All parallel caveats above apply.</p>
<hr>
</section>
<section id="my-r-code-is-not-working" class="level3">
<h3 class="anchored" data-anchor-id="my-r-code-is-not-working">My R code is not working</h3>
<ul>
<li>Update packages (<code>pak::pak()</code> is handy).<br>
</li>
<li>Re-download the example code and run from the top.<br>
</li>
<li>Read the full error and traceback (<code>rlang::last_trace()</code>).<br>
</li>
<li>Compare with the example: what is different in <em>your</em> data or model?</li>
</ul>
<hr>
</section>
<section id="i-do-not-know-how-margot-package-functions-work" class="level3">
<h3 class="anchored" data-anchor-id="i-do-not-know-how-margot-package-functions-work">I do not know how ‘margot’ package functions work</h3>
<p>See the indexed reference: <a href="https://go-bayes.github.io/margot/reference/index.html" class="uri">https://go-bayes.github.io/margot/reference/index.html</a></p>
<hr>
</section>
<section id="what-is-the-recommended-workflow-for-investigating-heterogeneity" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-recommended-workflow-for-investigating-heterogeneity">What is the recommended workflow for investigating heterogeneity?</h3>
<ol type="1">
<li><strong>State your causal question.</strong> Statistics cannot rescue an ill-posed question.<br>
</li>
<li>Estimate the <strong>ATE</strong> for the target population.<br>
</li>
<li>Compute <strong>CATEs</strong> and evaluate gain at 20 % and 50 % budget constraints with the <strong>Qini</strong> metric.<br>
</li>
<li>For outcomes with convincing heterogeneity, fit shallow <strong>policy trees</strong> (depth = 2) to obtain transparent rules.<br>
</li>
<li>Optionally, compare pre-specified subgroups directly.<br>
</li>
<li>Report <strong>RATE–AUTOC</strong> and <strong>RATE–Qini</strong> tables in an appendix.</li>
</ol>
<p><em>Take-away:</em> - start from a clean, updated project, - use recent scripts - read errors carefully, and - ensure each step answers <em>your</em> research question.</p>
<hr>
</section>
<section id="i-cannot-create-a-quarto-document" class="level3">
<h3 class="anchored" data-anchor-id="i-cannot-create-a-quarto-document">I cannot create a ‘quarto’ document</h3>
<ul>
<li>save the file with a <code>.qmd</code> suffix <strong>inside</strong> the <code>quarto</code> folder.<br>
</li>
<li>Ensure the boilerplate directory structure exists (run Script 0 and Script 1).</li>
<li>Run the initial code block line-by-line before hitting <strong>Render</strong>.<br>
</li>
<li>Define all <code>global_vars</code> required by the boiler-plate.<br>
</li>
<li>The <code>new_initial_quarto_document.qmd</code> template should work if you remember to set this value correctly: <code>use_flipped &lt;- TRUE</code></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled" title="⚠️ IMPORTANT: flipped outcomes">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
⚠️ IMPORTANT: flipped outcomes
</div>
</div>
<div class="callout-body-container callout-body">
<p>Again, before you run the analysis, check whether you inverted any outcomes.<br>
Set:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>use_flipped <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># ← make TRUE if you flipped outcomes; FALSE otherwise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li>If you are sticking with the old template and you are are <em>not</em> flipping outcomes, stub the flip variables:</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>flipped_names <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>flip_outcomes <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>flipped_list  <span class="ot">&lt;-</span> <span class="st">""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="i-cannot-render-the-quarto-document-as-pdf" class="level3">
<h3 class="anchored" data-anchor-id="i-cannot-render-the-quarto-document-as-pdf">I cannot render the ‘quarto’ document as PDF</h3>
<p>Install <strong>TinyTeX</strong> once:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tinytex<span class="sc">::</span><span class="fu">install_tinytex</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then, in your YAML front-matter, comment out unwanted formats. For PDF-only output:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">  # docx:</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">  #   default: false</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pdf</span><span class="kw">:</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">pdf-engine</span><span class="kw">:</span><span class="at"> lualatex</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="is-it-plagiarism-to-use-the-boiler-plate-outputs-verbatim" class="level3">
<h3 class="anchored" data-anchor-id="is-it-plagiarism-to-use-the-boiler-plate-outputs-verbatim">Is it plagiarism to use the boiler-plate outputs verbatim?</h3>
<p>No—provided you clearly cite the source. The templates come from the EPIC (Bulbulia) Lab and the data are simulated from New Zealand Attitudes and Values Study. Tailor your text to match your study and give credit. To edit, set <code>eval: false</code>, render, and copy-paste the plain text blocks.</p>
<hr>
</section>
<section id="i-do-not-have-a-boiler-plate-template-used-in-the-example-script" class="level3">
<h3 class="anchored" data-anchor-id="i-do-not-have-a-boiler-plate-template-used-in-the-example-script">I do not have a boiler-plate template used in the example script</h3>
<p>Run <strong>Script 0</strong> and <strong>Script 1</strong> from the start; they refresh every template.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - Bulbulia J (2024). _margot: MARGinal Observational Treatment-effects_. doi:10.5281/zenodo.10907724 &lt;https://doi.org/10.5281/zenodo.10907724&gt;, R package version 1.0.55 Functions to obtain MARGinal Observational Treatment-effects from observational data., &lt;https://go-bayes.github.io/margot/&gt;.
  - Chang W (2023). _extrafont: Tools for Using Fonts_. doi:10.32614/CRAN.package.extrafont &lt;https://doi.org/10.32614/CRAN.package.extrafont&gt;, R package version 0.19, &lt;https://CRAN.R-project.org/package=extrafont&gt;.
  - Grolemund G, Wickham H (2011). "Dates and Times Made Easy with lubridate." _Journal of Statistical Software_, *40*(3), 1-25. &lt;https://www.jstatsoft.org/v40/i03/&gt;.
  - Müller K, Wickham H (2023). _tibble: Simple Data Frames_. doi:10.32614/CRAN.package.tibble &lt;https://doi.org/10.32614/CRAN.package.tibble&gt;, R package version 3.2.1, &lt;https://CRAN.R-project.org/package=tibble&gt;.
  - R Core Team (2025). _R: A Language and Environment for Statistical Computing_. R Foundation for Statistical Computing, Vienna, Austria. &lt;https://www.R-project.org/&gt;.
  - Wickham H (2016). _ggplot2: Elegant Graphics for Data Analysis_. Springer-Verlag New York. ISBN 978-3-319-24277-4, &lt;https://ggplot2.tidyverse.org&gt;.
  - Wickham H (2023). _forcats: Tools for Working with Categorical Variables (Factors)_. doi:10.32614/CRAN.package.forcats &lt;https://doi.org/10.32614/CRAN.package.forcats&gt;, R package version 1.0.0, &lt;https://CRAN.R-project.org/package=forcats&gt;.
  - Wickham H (2023). _stringr: Simple, Consistent Wrappers for Common String Operations_. doi:10.32614/CRAN.package.stringr &lt;https://doi.org/10.32614/CRAN.package.stringr&gt;, R package version 1.5.1, &lt;https://CRAN.R-project.org/package=stringr&gt;.
  - Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). "Welcome to the tidyverse." _Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 &lt;https://doi.org/10.21105/joss.01686&gt;.
  - Wickham H, François R, Henry L, Müller K, Vaughan D (2023). _dplyr: A Grammar of Data Manipulation_. doi:10.32614/CRAN.package.dplyr &lt;https://doi.org/10.32614/CRAN.package.dplyr&gt;, R package version 1.1.4, &lt;https://CRAN.R-project.org/package=dplyr&gt;.
  - Wickham H, Henry L (2025). _purrr: Functional Programming Tools_. doi:10.32614/CRAN.package.purrr &lt;https://doi.org/10.32614/CRAN.package.purrr&gt;, R package version 1.0.4, &lt;https://CRAN.R-project.org/package=purrr&gt;.
  - Wickham H, Hester J, Bryan J (2024). _readr: Read Rectangular Text Data_. doi:10.32614/CRAN.package.readr &lt;https://doi.org/10.32614/CRAN.package.readr&gt;, R package version 2.1.5, &lt;https://CRAN.R-project.org/package=readr&gt;.
  - Wickham H, Vaughan D, Girlich M (2024). _tidyr: Tidy Messy Data_. doi:10.32614/CRAN.package.tidyr &lt;https://doi.org/10.32614/CRAN.package.tidyr&gt;, R package version 1.3.1, &lt;https://CRAN.R-project.org/package=tidyr&gt;.
  - Xie Y (2025). _tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents_. R package version 0.57, &lt;https://github.com/rstudio/tinytex&gt;. Xie Y (2019). "TinyTeX: A lightweight, cross-platform, and easy-to-maintain LaTeX distribution based on TeX Live." _TUGboat_, *40*(1), 30-32. &lt;https://tug.org/TUGboat/Contents/contents40-1.html&gt;.</code></pre>
</div>
</div>
</section>
<section id="my-code-was-working-with-the-old-template-where-can-i-find-it" class="level3">
<h3 class="anchored" data-anchor-id="my-code-was-working-with-the-old-template-where-can-i-find-it">My code was working with the old template, where can I find it?</h3>
<p>Here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>title<span class="sc">:</span> <span class="st">"Your Title"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>abstract<span class="sc">:</span> <span class="er">|</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="er">**</span>Background<span class="sc">**</span><span class="er">:</span> (Brief few sentences)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Objectives<span class="sc">**</span><span class="er">:</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.</span> Estimate the causal effect of YOUR EXPOSURE on YOUR OUTCOMES measured one year later.</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">2.</span> Evaluate whether these effects vary across the population.</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fl">3.</span> Provide policy guidance on which individuals might benefit most.</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Method<span class="sc">**</span><span class="er">:</span> We conducted a three<span class="sc">-</span>wave retrospective cohort <span class="fu">study</span> (waves XX<span class="sc">-</span>XXX, October XXXX<span class="sc">--</span>October XXXX) using data <span class="sc">*</span>SIMULATED<span class="sc">*</span> from the New Zealand Attitudes and Values Study, a nationally representative panel. Participants were eligible <span class="cf">if</span> they participated <span class="cf">in</span> the NZAVS <span class="cf">in</span> the baseline <span class="fu">wave</span> (XXXX,...). We defined the exposure <span class="fu">as</span> (XXXX  <span class="sc">&gt;</span> NUMBER on a <span class="dv">1-7</span> Likert <span class="fu">Scale</span> (<span class="dv">1</span> <span class="ot">=</span> yes, <span class="dv">0</span> <span class="ot">=</span> no)). To address attrition, we applied inverse probability of censoring weights; to improve external validity, we applied weights to the population distribution of Age, Ethnicity, and Gender. We computed expected mean outcomes <span class="cf">for</span> the population <span class="cf">in</span> each exposure <span class="fu">condition</span> (high XXXX<span class="sc">/</span>low XXXXX). Under standard causal assumptions of unconfoundedness, the contrast provides an unbiased average treatment effect. We then used causal forests to detect heterogeneity <span class="cf">in</span> these effects and employed policy tree algorithms to identify <span class="fu">individuals</span> (<span class="st">"strong responders"</span>) likely to experience the greatest benefits.</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Results<span class="sc">**</span><span class="er">:</span>   Increasing XXXXX leads to XXXXX. Heterogeneous responses <span class="fu">to</span> (e.g. <span class="sc">*</span>Forgiveness<span class="sc">*</span>, <span class="sc">*</span>Personal Well<span class="sc">-</span>Being<span class="sc">*</span>, and <span class="sc">*</span>Life<span class="sc">-</span>Satisfaction<span class="sc">*</span>...) reveal structural variability <span class="cf">in</span> subpopulations...</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Implications<span class="sc">**</span><span class="er">:</span> (Brief few sentences)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">**</span>Keywords<span class="sc">**</span><span class="er">:</span> <span class="er">*</span>Causal Inference<span class="sc">*</span>;  <span class="sc">*</span>Cross<span class="sc">-</span>validation<span class="sc">*</span>; <span class="sc">*</span>Distress<span class="sc">*</span>; <span class="sc">*</span>Employment<span class="sc">*</span>; <span class="sc">*</span>Longitudinal<span class="sc">*</span>; <span class="sc">*</span>Machine sLearning<span class="sc">*</span>; <span class="sc">*</span>Religion<span class="sc">*</span>; <span class="sc">*</span>Semi<span class="sc">-</span>parametric<span class="sc">*</span>; <span class="sc">*</span>Targeted Learning<span class="sc">*</span>.</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>author<span class="sc">:</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span> name<span class="sc">:</span> YOUR NAME</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    affiliation<span class="sc">:</span> Victoria University of Wellington, New Zealand</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    email<span class="sc">:</span> XXXXX</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    corresponding<span class="sc">:</span> yes</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>keywords<span class="sc">:</span> [Causal Inference, Cross<span class="sc">-</span>validation,...]</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>editor_options<span class="sc">:</span> </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  chunk_output_type<span class="sc">:</span> console</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>date<span class="sc">:</span> <span class="st">"last-modified"</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>fontfamily<span class="sc">:</span> libertinus</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>bibliography<span class="sc">:</span> references.bib</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>csl<span class="sc">:</span> apa7.csl</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>format<span class="sc">:</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  docx<span class="sc">:</span> <span class="co"># comment this out if you want pdf</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    default<span class="sc">:</span> false  <span class="co"># comment this out if you want pdf</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  pdf<span class="sc">:</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    pdf<span class="sc">-</span>engine<span class="sc">:</span> lualatex</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    sanitise<span class="sc">:</span> true</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    keep<span class="sc">-</span>tex<span class="sc">:</span> true</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    link<span class="sc">-</span>citations<span class="sc">:</span> true</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    colorlinks<span class="sc">:</span> true</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    documentclass<span class="sc">:</span> article</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    classoption<span class="sc">:</span> [<span class="st">"single column"</span>]</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    lof<span class="sc">:</span> false</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    lot<span class="sc">:</span> false</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    geometry<span class="sc">:</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> top<span class="ot">=</span><span class="dv">30</span>mm</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> left<span class="ot">=</span><span class="dv">25</span>mm</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> heightrounded</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> headsep<span class="ot">=</span><span class="dv">22</span>pt</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> headheight<span class="ot">=</span><span class="dv">11</span>pt</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> footskip<span class="ot">=</span><span class="dv">33</span>pt</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> ignorehead</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> ignorefoot</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    header<span class="sc">-</span>includes<span class="sc">:</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> \let\oldtabular\tabular</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> \renewcommand{\tabular}{\small\oldtabular}</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span> \setlength{\tabcolsep}{<span class="dv">4</span>pt}  <span class="co"># adjust this value as needed</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>execute<span class="sc">:</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  echo<span class="sc">:</span> false</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  warning<span class="sc">:</span> false</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  include<span class="sc">:</span> true</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  eval<span class="sc">:</span> true</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: setup</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: false</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="at"># save this file in your project root (e.g. 'quarto/1_setup.R')</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="at"># load here to manage paths</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="at">dep &lt;- requireNamespace("here", quietly = TRUE)</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="at">if (!dep) install.packages("here")</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="at">library(here)</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a><span class="at"># create required folders (these will likely already exist)</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="at">dirs &lt;- c(</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a><span class="at">  here("quarto"),</span></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a><span class="at">  here("bibliography"),</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a><span class="at">  here("save_directory"),</span></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="at">  here("csl")</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="at">for (d in dirs) {</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="at">  if (!dir.exists(d)) dir.create(d, recursive = TRUE)</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="at"># ensure tinytex for PDF rendering</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="at">if (!requireNamespace("tinytex", quietly = TRUE)) {</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a><span class="at">  install.packages("tinytex")</span></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a><span class="at">  tinytex::install_tinytex()</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a><span class="at"># ensure pacman for package management</span></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a><span class="at">if (!requireNamespace("pacman", quietly = TRUE)) {</span></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a><span class="at">  install.packages("pacman")</span></span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a><span class="at"># min version of margot</span></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a><span class="at">if (packageVersion("margot") &lt; "1.0.54") {</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a><span class="at">  stop(</span></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a><span class="at">    "please install margot &gt;= 1.0.54 for this workflow</span><span class="sc">\n</span></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="at">       run: </span></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="at">       devtools::install_github('go-bayes/margot')</span></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="at">"</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a><span class="at"># call library</span></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="at">library("margot")</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a><span class="at"># check package version</span></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a><span class="at">packageVersion(pkg = "margot")</span></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a><span class="at"># load (and install if needed) all required packages</span></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="at">pacman::p_load(</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate, shiny, tidyverse,</span></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a><span class="at">  kableExtra, glue, patchwork, stringr,</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a><span class="at">  ggplot2, ggeffects, parameters,</span></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="at">  table1, knitr, extrafont, here, cli</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a><span class="at"># load fonts (requires prior extrafont::font_import())</span></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a><span class="at">if (requireNamespace("extrafont", quietly = TRUE)) {</span></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a><span class="at">  extrafont::loadfonts(device = "all")</span></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a><span class="at">} else {</span></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a><span class="at">  message("'extrafont' not installed; skipping font loading")</span></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a><span class="at"># reproducibility</span></span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a><span class="at">set.seed(123)</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a><span class="at"># copy CSL and BibTeX into quarto folder</span></span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a><span class="at">src_files &lt;- list(</span></span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a><span class="at">  c(here("csl", "apa7.csl"),     here("quarto", "apa7.csl")),</span></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a><span class="at">  c(here("bibliography", "references.bib"), here("quarto", "references.bib"))</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a><span class="at">for (f in src_files) {</span></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a><span class="at">  if (!file.exists(f[2]) &amp;&amp; file.exists(f[1])) {</span></span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a><span class="at">    file.copy(f[1], f[2])</span></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a><span class="at">  }</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a><span class="at"># now you're ready to import data and proceed with analysis</span></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a><span class="at"># e.g.</span></span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a><span class="at"># unified_db &lt;- boilerplate_import(data_path = here("final_boilerplate_data"))</span></span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a><span class="at"># df_grf     &lt;- margot::here_read('df_grf',   here("save_directory"))</span></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- define paths and import data ----------------------------------------</span></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a><span class="at">push_mods             &lt;- here::here("save_directory")</span></span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a><span class="at">final_boilerplate_data &lt;- here::here("final_boilerplate_data")</span></span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a><span class="at">unified_db            &lt;- boilerplate_import(data_path = final_boilerplate_data)</span></span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a><span class="at"># check paths</span></span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- inspect available boilerplate entries -------------------------------</span></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a><span class="at">cat(unified_db$methods$confounding_control$vanderweele)</span></span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a><span class="at">cat(unified_db$methods$sample$nzavs)</span></span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a><span class="at">cat(unified_db$methods$causal_intervention$grf_simple_text)</span></span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a><span class="at">cat(unified_db$appendix$explain$grf_short)</span></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- read variable definitions -------------------------------------------</span></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a><span class="at">baseline_vars           &lt;- margot::here_read("baseline_vars")</span></span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a><span class="at">exposure_var            &lt;- margot::here_read("exposure_var")</span></span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a><span class="at">outcome_vars            &lt;- margot::here_read("outcome_vars")</span></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- define study waves --------------------------------------------------</span></span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a><span class="at">baseline_wave           &lt;- margot::here_read("baseline_wave")</span></span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a><span class="at">exposure_waves          &lt;- margot::here_read("exposure_waves")</span></span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a><span class="at">outcome_wave            &lt;- margot::here_read("outcome_wave")</span></span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a><span class="at"># </span></span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a><span class="at">baseline_wave_glued &lt;- glue::glue(baseline_wave)</span></span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- define study parameters ---------------------------------------------</span></span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a><span class="at">study_years             &lt;- "2018-2021"</span></span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a><span class="at">name_exposure           &lt;- here_read("name_exposure")</span></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a><span class="at">name_outcome_variables  &lt;- "MY OUTCOME VARIABLES IN THIS STUDY"</span></span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a><span class="at">name_exposure_lower     &lt;- tolower(name_exposure)</span></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a><span class="at">name_exposure_lower</span></span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- templates and thresholds --------------------------------------------</span></span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a><span class="at">eligibility_template    &lt;- "Participants were eligible if they participated in the {baseline wave}"</span></span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a><span class="at">percent_missing_baseline &lt;- margot::here_read("percent_missing_baseline")</span></span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- read tables for manuscript ------------------------------------------</span></span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_baseline  &lt;- margot::here_read("baseline_table")</span></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_exposures &lt;- margot::here_read("exposure_table")</span></span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_outcomes  &lt;- margot::here_read("outcomes_table")</span></span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a><span class="at">margot_bind_tables_markdown &lt;- margot::here_read("margot_bind_tables_markdown")</span></span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- sample size information --------------------------------------------</span></span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a><span class="at">n_total                  &lt;- margot::here_read("n_total")</span></span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a><span class="at">n_participants           &lt;- here_read("n_participants")</span></span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- variable labels and mappings ----------------------------------------</span></span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a><span class="at">var_labels_measures      &lt;- here_read("var_labels_measures")</span></span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a><span class="at">label_mapping_all        &lt;- here_read("label_mapping_all")</span></span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- plot titles and analysis settings -----------------------------------</span></span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a><span class="at"># ate_title                &lt;- here_read("ate_title")</span></span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a><span class="at">flipped_names            &lt;- here_read("flipped_names")</span></span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a><span class="at">flip_outcomes            &lt;- here_read("flip_outcomes")</span></span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a><span class="at">flipped_list             &lt;- paste(flipped_names, collapse = ", ")</span></span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- import data for visualisation --------------------------------------</span></span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a><span class="at">original_df &lt;- margot::here_read('df_wide', push_mods)</span></span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a><span class="at">df_grf &lt;- margot::here_read('df_grf', push_mods)</span></span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a><span class="at"># co-variates</span></span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a><span class="at">E &lt;- margot::here_read('E', push_mods)</span></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a><span class="at"># select covariates and drop numeric attributes</span></span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a><span class="at">X &lt;- margot::remove_numeric_attributes(df_grf[E])</span></span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- define nice names and regimes ---------------------------------------</span></span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a><span class="at">nice_name_exposure  &lt;- stringr::str_to_sentence(name_exposure)</span></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a><span class="at">name_outcomes_lower          &lt;- "multi-dimensional wellbeing"</span></span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a><span class="at">nice_name_outcome &lt;- stringr::str_to_sentence(name_outcomes_lower)</span></span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a><span class="at"># title</span></span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a><span class="at">ate_title = glue("ATE Effects of {nice_name_exposure} on {nice_name_outcome}")</span></span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- define exposure thresholds and regimes ------------------------------</span></span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a><span class="at">lower_cut               &lt;- here_read("lower_cut")</span></span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a><span class="at">upper_cut               &lt;- here_read("upper_cut")</span></span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a><span class="at">threshold               &lt;- here_read("threshold")</span></span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a><span class="at">inverse_threshold       &lt;- here_read("inverse_threshold")</span></span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a><span class="at">scale_range             &lt;- margot::here_read("scale_range")</span></span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a><span class="at"># create and check variables</span></span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a><span class="at">value_exposure = glue::glue( threshold,"", upper_cut,", ", scale_range)</span></span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a><span class="at">value_control = glue::glue(inverse_threshold, upper_cut,", ", scale_range)</span></span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a><span class="at"># regimes</span></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a><span class="at">name_control_regime_lower &lt;- glue::glue("low {name_exposure_lower}")</span></span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a><span class="at">value_exposure_regime     &lt;- glue::glue("Set {name_exposure} {threshold} {upper_cut} {scale_range}")</span></span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a><span class="at">value_control_regime      &lt;- glue::glue("Set {name_exposure} {inverse_threshold} {upper_cut} {scale_range}")</span></span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a><span class="at">contrast_template         &lt;- "We used causal forests to estimate an average treatment effect as a contrast between *{name_control_regime_lower}* and *{name_exposure_lower}* on {name_outcomes_lower}."</span></span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a><span class="at">contrast_text             &lt;- glue(contrast_template)</span></span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a><span class="at">#check</span></span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a><span class="at">contrast_text</span></span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- import histogram of binary exposure ---------------------------------</span></span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a><span class="at">graph_cut &lt;- margot::here_read("graph_cut")</span></span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- verify assumptions (positivity) -------------------------------------</span></span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a><span class="at">transition_tables        &lt;- margot::here_read("transition_tables")</span></span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a><span class="at">transition_tables_binary &lt;- here_read("transition_tables_binary")</span></span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- generate measures text for methods section -------------------------</span></span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a><span class="at">baseline_measures_text   &lt;- boilerplate_generate_measures(</span></span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a><span class="at">  variable_heading = "Baseline Covariates",</span></span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a><span class="at">  variables        = baseline_vars,</span></span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a><span class="at">  db               = unified_db,</span></span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a><span class="at">  heading_level    = 3,</span></span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a><span class="at">  subheading_level = 4,</span></span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a><span class="at">  print_waves      = FALSE,</span></span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mappings   = var_labels_measures</span></span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a><span class="at">cat(baseline_measures_text)</span></span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a><span class="at">exposure_measures_text   &lt;- boilerplate_generate_measures(</span></span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a><span class="at">  variable_heading = "Exposure Variable",</span></span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a><span class="at">  variables        = name_exposure,</span></span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a><span class="at">  db               = unified_db,</span></span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a><span class="at">  heading_level    = 3,</span></span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a><span class="at">  subheading_level = 4,</span></span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a><span class="at">  print_waves      = FALSE,</span></span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mappings   = var_labels_measures</span></span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a><span class="at">outcome_measures_text    &lt;- boilerplate_generate_measures(</span></span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a><span class="at">  variable_heading = "Outcome Variables",</span></span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a><span class="at">  variables        = outcome_vars,</span></span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a><span class="at">  db               = unified_db,</span></span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a><span class="at">  heading_level    = 3,</span></span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a><span class="at">  subheading_level = 4,</span></span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a><span class="at">  print_waves      = FALSE,</span></span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mappings   = var_labels_measures</span></span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- exposure description from database --------------------------------</span></span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a><span class="at">measures_exposure        &lt;- glue::glue(unified_db$measures[[name_exposure]]$description)</span></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- set plot defaults for ate plots -------------------------------------</span></span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a><span class="at">base_defaults_binary     &lt;- list(</span></span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a><span class="at">  type                   = "RD",</span></span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a><span class="at">  title                  = ate_title,</span></span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a><span class="at">  e_val_bound_threshold  = 1.2,</span></span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a><span class="at">  colors                 = c(</span></span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a><span class="at">    "positive"    = "#E69F00",</span></span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a><span class="at">    "not reliable"= "grey50",</span></span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a><span class="at">    "negative"    = "#56B4E9"</span></span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a><span class="at">  ),</span></span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a><span class="at">  x_offset               = -0.25,</span></span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a><span class="at">  x_lim_lo               = -0.25,</span></span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a><span class="at">  x_lim_hi               = 0.25,</span></span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a><span class="at">  text_size              = 5,</span></span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a><span class="at">  linewidth              = 0.75,</span></span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a><span class="at">  estimate_scale         = 1,</span></span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a><span class="at">  base_size              = 20, #&lt;- change to make outcome labels bigger or smaller</span></span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a><span class="at">  point_size             = 4,</span></span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a><span class="at">  title_size             = 20,</span></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a><span class="at">  subtitle_size          = 16,</span></span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a><span class="at">  legend_text_size       = 10,</span></span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a><span class="at">  legend_title_size      = 10,</span></span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a><span class="at">  include_coefficients   = FALSE</span></span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- create plot options for outcomes -----------------------------------</span></span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a><span class="at">outcomes_options_all     &lt;- margot_plot_create_options(</span></span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a><span class="at">  title         = ate_title,</span></span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a><span class="at">  base_defaults = base_defaults_binary,</span></span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a><span class="at">  subtitle      = "",</span></span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a><span class="at">  filename_prefix = "grf"</span></span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- load and check model results ---------------------------------------</span></span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a><span class="at"># takes more time but allows you to flexibly modify plots in the quarto document</span></span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a><span class="at"># if you use the option comment out this code above</span></span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a><span class="at"># takes less time if you used the pre-processed results but a little harder to adjust</span></span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a><span class="at"># ate_results           &lt;- margot::here_read_qs("ate_results", push_mods)</span></span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a><span class="at"># margot::margot_size(ate_results)</span></span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a><span class="at">models_binary &lt;- margot::here_read_qs("models_binary", push_mods)</span></span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a><span class="at"># make ate plots ----------------------------------------------------------</span></span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a><span class="at">#   ************* NEW - CORRECTION FOR FAMILY-WISE ERROR **********</span></span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a><span class="at"># then pass to the results</span></span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a><span class="at">ate_results &lt;- margot_plot(</span></span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a><span class="at">  models_binary$combined_table, # &lt;- now pass the corrected results.</span></span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a><span class="at">  options = outcomes_options_all,</span></span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping = label_mapping_all,</span></span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a><span class="at">  include_coefficients = FALSE,</span></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a><span class="at">  save_output = FALSE,</span></span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a><span class="at">  order = "evaluebound_asc",</span></span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a><span class="at">  original_df = original_df,</span></span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a><span class="at">  e_val_bound_threshold = 1.2,</span></span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a><span class="at">  rename_ate = TRUE,</span></span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a><span class="at">  adjust = "bonferroni", #&lt;- new </span></span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a><span class="at">  alpha = 0.05 # &lt;- new </span></span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a><span class="at"># check</span></span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a><span class="at">ate_results$plot</span></span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a><span class="at"># view</span></span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a><span class="at">cat(ate_results$interpretation)</span></span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- heterogeneity analysis ---------------------------------------------</span></span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a><span class="at">models_binary_flipped_all &lt;- here_read_qs("models_binary_flipped_all", push_mods)</span></span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a><span class="at"># this is a new function requires margot 1.0.48 or higher</span></span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a><span class="at"># only useful if you flip labels outcomes -- if so replace "label_mapping_all" </span></span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a><span class="at"># with "label_mapping_all_flipped" </span></span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a><span class="at">label_mapping_all_flipped &lt;- margot_reversed_labels(label_mapping_all, </span></span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a><span class="at">                                                    flip_outcomes)</span></span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a><span class="at"># optional</span></span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a><span class="at"># could be used in an appendix</span></span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a><span class="at"># result_ominbus_hetero     &lt;- margot_omnibus_hetero_test(</span></span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a><span class="at">#   models_binary_flipped_all,</span></span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a><span class="at">#   label_mapping  = label_mapping_all_flipped,</span></span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a><span class="at">#   alpha          = 0.05,</span></span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a><span class="at">#   detail_level   = "standard",</span></span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a><span class="at">#   format         = "markdown"</span></span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a><span class="at"># )</span></span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a><span class="at"># result_ominbus_hetero$summary_table |&gt; kbl("markdown")</span></span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a><span class="at"># cat(result_ominbus_hetero$brief_interpretation)</span></span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a><span class="at"># SCRIPT:  HETEROGENEITY WORKFLOW</span></span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a><span class="at"># PURPOSE: screen outcomes for heterogeneity, plot RATE &amp; Qini curves,</span></span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a><span class="at">#          fit shallow policy trees, and produce plain-language summaries.</span></span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a><span class="at"># REQUIREMENTS:</span></span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a><span class="at">#   • margot ≥ 1.0.52</span></span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a><span class="at">#   • models_binary_flipped_all        – list returned by margot_causal_forest()</span></span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a><span class="at">#   • original_df                      – raw data frame used in the forest</span></span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a><span class="at">#   • label_mapping_all_flipped        – named vector of pretty labels</span></span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a><span class="at">#   • flipped_names                    – vector of outcomes that were flipped</span></span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a><span class="at">#   • decision_tree_defaults           – list of control parameters</span></span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a><span class="at">#   • policy_tree_defaults             – list of control parameters</span></span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a><span class="at">#   • push_mods                        – sub-folder for caches/outputs</span></span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a><span class="at">#   • use 'models_binary', </span><span class="st">`</span>label_mapping_all<span class="st">`</span><span class="at">, and set </span><span class="st">`</span>flipped_names <span class="ot">=</span> <span class="st">""`</span><span class="at"> if no outcome flipped</span></span>
<span id="cb17-383"><a href="#cb17-383" aria-hidden="true" tabindex="-1"></a><span class="at"># ──────────────────────────────────────────────────────────────────────────────</span></span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a><span class="at"># check package version early</span></span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a><span class="at">stopifnot(utils::packageVersion("margot") &gt;= "1.0.52")</span></span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a><span class="at"># helper: quick kable printer --------------------------------------------------</span></span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a><span class="at">print_rate &lt;- function(tbl) {</span></span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a><span class="at">  tbl |&gt;</span></span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a><span class="at">    mutate(across(where(is.numeric), \(x) round(x, 2))) |&gt;</span></span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a><span class="at">    kbl(format = "markdown")</span></span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a><span class="at">}</span></span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a><span class="at"># 1  SCREEN FOR HETEROGENEITY (RATE AUTOC + RATE Qini)  ----------------------</span></span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a><span class="at">rate_results &lt;- margot_rate(</span></span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a><span class="at">  models        = models_binary_flipped_all,</span></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a><span class="at">  policy        = "treat_best",</span></span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a><span class="at">  alpha         = 0.20,        # keep raw p &lt; .20</span></span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a><span class="at">  adjust        = "fdr",       # false-discovery-rate correction</span></span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping = label_mapping_all_flipped</span></span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a><span class="at">print_rate(rate_results$rate_autoc)</span></span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a><span class="at">print_rate(rate_results$rate_qini)</span></span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a><span class="at"># convert RATE numbers into plain-language text</span></span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a><span class="at">rate_interp &lt;- margot_interpret_rate(</span></span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a><span class="at">  rate_results,</span></span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a><span class="at">  flipped_outcomes      = flipped_names,</span></span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a><span class="at">  adjust_positives_only = TRUE</span></span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a><span class="at">cat(rate_interp$comparison, "</span><span class="sc">\n</span><span class="at">")</span></span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a><span class="at">cli_h2("Analysis ready for Appendix ✔")</span></span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a><span class="at"># organise model names by evidence strength</span></span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a><span class="at">model_groups &lt;- list(</span></span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a><span class="at">  autoc       = rate_interp$autoc_model_names,</span></span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a><span class="at">  qini        = rate_interp$qini_model_names,</span></span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a><span class="at">  either      = rate_interp$either_model_names,</span></span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a><span class="at">  exploratory = rate_interp$not_excluded_either</span></span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a><span class="at"># 2  PLOT RATE AUTOC CURVES ---------------------------------------------------</span></span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a><span class="at">autoc_plots &lt;- margot_plot_rate_batch(</span></span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a><span class="at">  models        = models_binary_flipped_all,</span></span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a><span class="at">  save_plots    = FALSE,  # set TRUE to store .png files</span></span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping = label_mapping_all_flipped,</span></span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a><span class="at">  model_names   = model_groups$autoc</span></span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a><span class="at"># inspect the first curve - note there may be more/none.</span></span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a><span class="at"># if none, comment out</span></span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a><span class="at">autoc_plots[[1]]</span></span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a><span class="at">autoc_name_1 &lt;- rate_results$rate_autoc$outcome[[1]]</span></span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a><span class="at"># 3  QINI CURVES + GAIN INTERPRETATION ---------------------------------------</span></span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a><span class="at">qini_results &lt;- margot_policy(</span></span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a><span class="at">  models_binary_flipped_all,</span></span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a><span class="at">  save_plots         = FALSE,</span></span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a><span class="at">  output_dir         = here::here(push_mods),</span></span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a><span class="at">  decision_tree_args = decision_tree_args,</span></span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a><span class="at">  policy_tree_args   = policy_tree_args,</span></span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a><span class="at">  model_names        = names(models_binary_flipped_all$results),</span></span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a><span class="at">  original_df        = original_df,</span></span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping      = label_mapping_all_flipped,</span></span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a><span class="at">  max_depth          = 2L,</span></span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a><span class="at">  output_objects     = c("qini_plot", "diff_gain_summaries")</span></span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a><span class="at">qini_gain &lt;- margot_interpret_qini(</span></span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_results,</span></span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping = label_mapping_all_flipped</span></span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a><span class="at">print_rate(qini_gain$summary_table)</span></span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a><span class="at">cat(qini_gain$qini_explanation, "</span><span class="sc">\n</span><span class="at">")</span></span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a><span class="at">reliable_ids &lt;- qini_gain$reliable_model_ids</span></span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a><span class="at"># (re-)compute plots only for models that passed Qini reliability</span></span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a><span class="at">qini_results_valid &lt;- margot_policy(</span></span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a><span class="at">  models_binary_flipped_all,</span></span>
<span id="cb17-466"><a href="#cb17-466" aria-hidden="true" tabindex="-1"></a><span class="at">  save_plots         = FALSE,</span></span>
<span id="cb17-467"><a href="#cb17-467" aria-hidden="true" tabindex="-1"></a><span class="at">  output_dir         = here::here(push_mods),</span></span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a><span class="at">  decision_tree_args = decision_tree_args,</span></span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a><span class="at">  policy_tree_args   = policy_tree_args,</span></span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a><span class="at">  model_names        = reliable_ids,</span></span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a><span class="at">  original_df        = original_df,</span></span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping      = label_mapping_all_flipped,</span></span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a><span class="at">  max_depth          = 2L,</span></span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a><span class="at">  output_objects     = c("qini_plot", "diff_gain_summaries")</span></span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a><span class="at">qini_plots &lt;- map(qini_results_valid, ~ .x$qini_plot)</span></span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a><span class="at"># grab pretty outcome names</span></span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a><span class="at">qini_names &lt;- margot_get_labels(reliable_ids, label_mapping_all_flipped)</span></span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a><span class="at">cli_h1("Qini curves generated ✔")</span></span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a><span class="at"># 4  POLICY TREES (max depth = 2) -------------------------------------------</span></span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- policy tree graph settings </span></span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a><span class="at">policy_tree_defaults    &lt;- list(</span></span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a><span class="at">  point_alpha            = 0.5,</span></span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a><span class="at">  title_size             = 12,</span></span>
<span id="cb17-490"><a href="#cb17-490" aria-hidden="true" tabindex="-1"></a><span class="at">  subtitle_size          = 12,</span></span>
<span id="cb17-491"><a href="#cb17-491" aria-hidden="true" tabindex="-1"></a><span class="at">  axis_title_size        = 12,</span></span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a><span class="at">  legend_title_size      = 12,</span></span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a><span class="at">  split_line_color       = "red",</span></span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a><span class="at">  split_line_alpha       = 0.8,</span></span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a><span class="at">  split_label_color      = "red",</span></span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a><span class="at">  split_label_nudge_factor = 0.007</span></span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-499"><a href="#cb17-499" aria-hidden="true" tabindex="-1"></a><span class="at">decision_tree_defaults  &lt;- list(</span></span>
<span id="cb17-500"><a href="#cb17-500" aria-hidden="true" tabindex="-1"></a><span class="at">  span_ratio         = 0.1,</span></span>
<span id="cb17-501"><a href="#cb17-501" aria-hidden="true" tabindex="-1"></a><span class="at">  text_size          = 4,</span></span>
<span id="cb17-502"><a href="#cb17-502" aria-hidden="true" tabindex="-1"></a><span class="at">  y_padding          = 0.5,</span></span>
<span id="cb17-503"><a href="#cb17-503" aria-hidden="true" tabindex="-1"></a><span class="at">  edge_label_offset  = 0.02,</span></span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a><span class="at">  border_size        = 0.01</span></span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a><span class="at">policy_results_2L &lt;- margot_policy(</span></span>
<span id="cb17-508"><a href="#cb17-508" aria-hidden="true" tabindex="-1"></a><span class="at">  models_binary_flipped_all,</span></span>
<span id="cb17-509"><a href="#cb17-509" aria-hidden="true" tabindex="-1"></a><span class="at">  save_plots         = FALSE,</span></span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a><span class="at">  output_dir         = here::here(push_mods),</span></span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a><span class="at">  decision_tree_args = decision_tree_defaults,</span></span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a><span class="at">  policy_tree_args   = policy_tree_defaults,</span></span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a><span class="at">  model_names        = reliable_ids,      # only those passing Qini</span></span>
<span id="cb17-514"><a href="#cb17-514" aria-hidden="true" tabindex="-1"></a><span class="at">  max_depth          = 2L,</span></span>
<span id="cb17-515"><a href="#cb17-515" aria-hidden="true" tabindex="-1"></a><span class="at">  original_df        = original_df,</span></span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping      = label_mapping_all_flipped,</span></span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a><span class="at">  output_objects     = c("combined_plot")</span></span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a><span class="at">policy_plots &lt;- map(policy_results_2L, ~ .x$combined_plot)</span></span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a><span class="at"># policy_plots[[1]]</span></span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a><span class="at"># ️5  PLAIN-LANGUAGE INTERPRETATION OF TREES ----------------------------------</span></span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a><span class="at">policy_text &lt;- margot_interpret_policy_batch(</span></span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a><span class="at">  models            = models_binary_flipped_all,</span></span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a><span class="at">  original_df       = original_df,</span></span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a><span class="at">  model_names       = reliable_ids,</span></span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping     = label_mapping_all_flipped,</span></span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a><span class="at">  max_depth         = 2L</span></span>
<span id="cb17-530"><a href="#cb17-530" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-531"><a href="#cb17-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a><span class="at">cat(policy_text, "</span><span class="sc">\n</span><span class="at">")</span></span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a><span class="at">cli::cli_h1("Finished: depth-2 policy trees analysed ✔")</span></span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a><span class="at"># ───────────────────────────── EOF ────────────────────────────────────────────</span></span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a><span class="at"># names of valid models</span></span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a><span class="at"># you might have fewer models </span></span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a><span class="at">glued_policy_names_1 &lt;- glue( qini_names[[1]])</span></span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a><span class="at">glued_policy_names_2 &lt;-glue( qini_names[[2]])</span></span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a><span class="at">glued_policy_names_3 &lt;- glue(qini_names[[3]])</span></span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a><span class="at">glued_policy_names_4 &lt;- glue(qini_names[[4]])</span></span>
<span id="cb17-544"><a href="#cb17-544" aria-hidden="true" tabindex="-1"></a><span class="at">glued_policy_names_5 &lt;-glue( qini_names[[5]])</span></span>
<span id="cb17-545"><a href="#cb17-545" aria-hidden="true" tabindex="-1"></a><span class="at">glued_policy_names_6 &lt;- glue(qini_names[[6]])</span></span>
<span id="cb17-546"><a href="#cb17-546" aria-hidden="true" tabindex="-1"></a><span class="at">glued_policy_names_7 &lt;-glue( qini_names[[7]])</span></span>
<span id="cb17-547"><a href="#cb17-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-548"><a href="#cb17-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-549"><a href="#cb17-549" aria-hidden="true" tabindex="-1"></a><span class="at"># cli::cli_h1("Names of Reliable HTE Models Set")</span></span>
<span id="cb17-550"><a href="#cb17-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-551"><a href="#cb17-551" aria-hidden="true" tabindex="-1"></a><span class="at"># GROUP COMPARISON EXAMPLE ------------------------------------------------</span></span>
<span id="cb17-552"><a href="#cb17-552" aria-hidden="true" tabindex="-1"></a><span class="at"># play around with these values</span></span>
<span id="cb17-553"><a href="#cb17-553" aria-hidden="true" tabindex="-1"></a><span class="at">x_offset_comp &lt;- 1.0</span></span>
<span id="cb17-554"><a href="#cb17-554" aria-hidden="true" tabindex="-1"></a><span class="at">x_lim_lo_comp &lt;- -1.0</span></span>
<span id="cb17-555"><a href="#cb17-555" aria-hidden="true" tabindex="-1"></a><span class="at">x_lim_hi_comp &lt;- 1.0 </span></span>
<span id="cb17-556"><a href="#cb17-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-557"><a href="#cb17-557" aria-hidden="true" tabindex="-1"></a><span class="at">base_defaults_comparisons &lt;- list(</span></span>
<span id="cb17-558"><a href="#cb17-558" aria-hidden="true" tabindex="-1"></a><span class="at">  type = "RD",</span></span>
<span id="cb17-559"><a href="#cb17-559" aria-hidden="true" tabindex="-1"></a><span class="at">  title = ate_title,</span></span>
<span id="cb17-560"><a href="#cb17-560" aria-hidden="true" tabindex="-1"></a><span class="at">  e_val_bound_threshold = 1.2,</span></span>
<span id="cb17-561"><a href="#cb17-561" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping = "label_mapping_all",</span></span>
<span id="cb17-562"><a href="#cb17-562" aria-hidden="true" tabindex="-1"></a><span class="at">  adjust = "bonferroni", #&lt;- new</span></span>
<span id="cb17-563"><a href="#cb17-563" aria-hidden="true" tabindex="-1"></a><span class="at">  alpha = 0.05, # &lt;- new</span></span>
<span id="cb17-564"><a href="#cb17-564" aria-hidden="true" tabindex="-1"></a><span class="at">  colors = c(</span></span>
<span id="cb17-565"><a href="#cb17-565" aria-hidden="true" tabindex="-1"></a><span class="at">    "positive" = "#E69F00",</span></span>
<span id="cb17-566"><a href="#cb17-566" aria-hidden="true" tabindex="-1"></a><span class="at">    "not reliable" = "grey50",</span></span>
<span id="cb17-567"><a href="#cb17-567" aria-hidden="true" tabindex="-1"></a><span class="at">    "negative" = "#56B4E9"</span></span>
<span id="cb17-568"><a href="#cb17-568" aria-hidden="true" tabindex="-1"></a><span class="at">  ),</span></span>
<span id="cb17-569"><a href="#cb17-569" aria-hidden="true" tabindex="-1"></a><span class="at">  x_offset = x_offset_comp,</span></span>
<span id="cb17-570"><a href="#cb17-570" aria-hidden="true" tabindex="-1"></a><span class="at">  # will be set based on type</span></span>
<span id="cb17-571"><a href="#cb17-571" aria-hidden="true" tabindex="-1"></a><span class="at">  x_lim_lo = x_lim_lo_comp,</span></span>
<span id="cb17-572"><a href="#cb17-572" aria-hidden="true" tabindex="-1"></a><span class="at">  # will be set based on type</span></span>
<span id="cb17-573"><a href="#cb17-573" aria-hidden="true" tabindex="-1"></a><span class="at">  x_lim_hi = x_lim_hi_comp,</span></span>
<span id="cb17-574"><a href="#cb17-574" aria-hidden="true" tabindex="-1"></a><span class="at">  text_size = 8,</span></span>
<span id="cb17-575"><a href="#cb17-575" aria-hidden="true" tabindex="-1"></a><span class="at">  linewidth = 0.75,</span></span>
<span id="cb17-576"><a href="#cb17-576" aria-hidden="true" tabindex="-1"></a><span class="at">  estimate_scale = 1,</span></span>
<span id="cb17-577"><a href="#cb17-577" aria-hidden="true" tabindex="-1"></a><span class="at">  base_size = 18,</span></span>
<span id="cb17-578"><a href="#cb17-578" aria-hidden="true" tabindex="-1"></a><span class="at">  point_size = 4,</span></span>
<span id="cb17-579"><a href="#cb17-579" aria-hidden="true" tabindex="-1"></a><span class="at">  title_size = 19,</span></span>
<span id="cb17-580"><a href="#cb17-580" aria-hidden="true" tabindex="-1"></a><span class="at">  subtitle_size = 16,</span></span>
<span id="cb17-581"><a href="#cb17-581" aria-hidden="true" tabindex="-1"></a><span class="at">  legend_text_size = 10,</span></span>
<span id="cb17-582"><a href="#cb17-582" aria-hidden="true" tabindex="-1"></a><span class="at">  legend_title_size = 10,</span></span>
<span id="cb17-583"><a href="#cb17-583" aria-hidden="true" tabindex="-1"></a><span class="at">  include_coefficients = FALSE</span></span>
<span id="cb17-584"><a href="#cb17-584" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-585"><a href="#cb17-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-586"><a href="#cb17-586" aria-hidden="true" tabindex="-1"></a><span class="at"># see</span></span>
<span id="cb17-587"><a href="#cb17-587" aria-hidden="true" tabindex="-1"></a><span class="at">complex_condition_age  &lt;- between(X[,"t0_age_z"], -1, 1)</span></span>
<span id="cb17-588"><a href="#cb17-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-589"><a href="#cb17-589" aria-hidden="true" tabindex="-1"></a><span class="at"># sanity‑check age bounds on the raw scale</span></span>
<span id="cb17-590"><a href="#cb17-590" aria-hidden="true" tabindex="-1"></a><span class="at">mean(original_df$t0_age) + c(-1, 1) * sd(original_df$t0_age)</span></span>
<span id="cb17-591"><a href="#cb17-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-592"><a href="#cb17-592" aria-hidden="true" tabindex="-1"></a><span class="at"># age subsets</span></span>
<span id="cb17-593"><a href="#cb17-593" aria-hidden="true" tabindex="-1"></a><span class="at">subsets_standard_age &lt;- list(</span></span>
<span id="cb17-594"><a href="#cb17-594" aria-hidden="true" tabindex="-1"></a><span class="at">  Younger = list(</span></span>
<span id="cb17-595"><a href="#cb17-595" aria-hidden="true" tabindex="-1"></a><span class="at">    var = "t0_age_z",</span></span>
<span id="cb17-596"><a href="#cb17-596" aria-hidden="true" tabindex="-1"></a><span class="at">    value = -1,</span></span>
<span id="cb17-597"><a href="#cb17-597" aria-hidden="true" tabindex="-1"></a><span class="at">    operator = "&lt;",</span></span>
<span id="cb17-598"><a href="#cb17-598" aria-hidden="true" tabindex="-1"></a><span class="at">    label = "Age &lt; 35"</span></span>
<span id="cb17-599"><a href="#cb17-599" aria-hidden="true" tabindex="-1"></a><span class="at">  ),</span></span>
<span id="cb17-600"><a href="#cb17-600" aria-hidden="true" tabindex="-1"></a><span class="at">  Middle = list(</span></span>
<span id="cb17-601"><a href="#cb17-601" aria-hidden="true" tabindex="-1"></a><span class="at">    var = "t0_age_z",</span></span>
<span id="cb17-602"><a href="#cb17-602" aria-hidden="true" tabindex="-1"></a><span class="at">    # operator = "&lt;",</span></span>
<span id="cb17-603"><a href="#cb17-603" aria-hidden="true" tabindex="-1"></a><span class="at">    subset_condition = complex_condition_age,</span></span>
<span id="cb17-604"><a href="#cb17-604" aria-hidden="true" tabindex="-1"></a><span class="at">    label = "Age 35-62"</span></span>
<span id="cb17-605"><a href="#cb17-605" aria-hidden="true" tabindex="-1"></a><span class="at">  ),</span></span>
<span id="cb17-606"><a href="#cb17-606" aria-hidden="true" tabindex="-1"></a><span class="at">  Older = list(</span></span>
<span id="cb17-607"><a href="#cb17-607" aria-hidden="true" tabindex="-1"></a><span class="at">    var = "t0_age_z",</span></span>
<span id="cb17-608"><a href="#cb17-608" aria-hidden="true" tabindex="-1"></a><span class="at">    value = 1,</span></span>
<span id="cb17-609"><a href="#cb17-609" aria-hidden="true" tabindex="-1"></a><span class="at">    operator = "&gt;",</span></span>
<span id="cb17-610"><a href="#cb17-610" aria-hidden="true" tabindex="-1"></a><span class="at">    label = "Age &gt; 62"</span></span>
<span id="cb17-611"><a href="#cb17-611" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-612"><a href="#cb17-612" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-613"><a href="#cb17-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-614"><a href="#cb17-614" aria-hidden="true" tabindex="-1"></a><span class="at"># 3. batch subgroup analysis -----------------------------------------</span></span>
<span id="cb17-615"><a href="#cb17-615" aria-hidden="true" tabindex="-1"></a><span class="at">planned_subset_results &lt;- margot_planned_subgroups_batch(</span></span>
<span id="cb17-616"><a href="#cb17-616" aria-hidden="true" tabindex="-1"></a><span class="at">  domain_models  = list(models_binary),</span></span>
<span id="cb17-617"><a href="#cb17-617" aria-hidden="true" tabindex="-1"></a><span class="at">  X              = X,</span></span>
<span id="cb17-618"><a href="#cb17-618" aria-hidden="true" tabindex="-1"></a><span class="at">  base_defaults  = base_defaults_comparisons,</span></span>
<span id="cb17-619"><a href="#cb17-619" aria-hidden="true" tabindex="-1"></a><span class="at">  subset_types   = list(cohort = subsets_standard_age),</span></span>
<span id="cb17-620"><a href="#cb17-620" aria-hidden="true" tabindex="-1"></a><span class="at">  original_df    = original_df,</span></span>
<span id="cb17-621"><a href="#cb17-621" aria-hidden="true" tabindex="-1"></a><span class="at">  label_mapping  = label_mapping_all,          # ← supply it here</span></span>
<span id="cb17-622"><a href="#cb17-622" aria-hidden="true" tabindex="-1"></a><span class="at">  domain_names   = "wellbeing",</span></span>
<span id="cb17-623"><a href="#cb17-623" aria-hidden="true" tabindex="-1"></a><span class="at">  subtitles      = "",</span></span>
<span id="cb17-624"><a href="#cb17-624" aria-hidden="true" tabindex="-1"></a><span class="at">  adjust         = "bonferroni",  # ← here</span></span>
<span id="cb17-625"><a href="#cb17-625" aria-hidden="true" tabindex="-1"></a><span class="at">  alpha          = 0.05           # ← and here</span></span>
<span id="cb17-626"><a href="#cb17-626" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-627"><a href="#cb17-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-628"><a href="#cb17-628" aria-hidden="true" tabindex="-1"></a><span class="at"># make comparison plot</span></span>
<span id="cb17-629"><a href="#cb17-629" aria-hidden="true" tabindex="-1"></a><span class="at">plots_subgroup_age_young_old&lt;- wrap_plots(</span></span>
<span id="cb17-630"><a href="#cb17-630" aria-hidden="true" tabindex="-1"></a><span class="at">  list(</span></span>
<span id="cb17-631"><a href="#cb17-631" aria-hidden="true" tabindex="-1"></a><span class="at">    planned_subset_results$wellbeing$cohort$results$</span><span class="st">`</span>Age <span class="sc">&lt;</span> <span class="dv">35</span><span class="st">`</span><span class="at">$plot,</span></span>
<span id="cb17-632"><a href="#cb17-632" aria-hidden="true" tabindex="-1"></a><span class="at">    planned_subset_results$wellbeing$cohort$results$</span><span class="st">`</span>Age <span class="sc">&gt;</span> <span class="dv">62</span><span class="st">`</span><span class="at">$plot</span></span>
<span id="cb17-633"><a href="#cb17-633" aria-hidden="true" tabindex="-1"></a><span class="at">  ), ncol = 1) +</span></span>
<span id="cb17-634"><a href="#cb17-634" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_annotation(</span></span>
<span id="cb17-635"><a href="#cb17-635" aria-hidden="true" tabindex="-1"></a><span class="at">    title = "Younger vs Older",</span></span>
<span id="cb17-636"><a href="#cb17-636" aria-hidden="true" tabindex="-1"></a><span class="at">    theme = theme(plot.title = element_text(size = 18, face = "bold"))</span></span>
<span id="cb17-637"><a href="#cb17-637" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-638"><a href="#cb17-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-639"><a href="#cb17-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-640"><a href="#cb17-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-641"><a href="#cb17-641" aria-hidden="true" tabindex="-1"></a><span class="at"># are groups different from each other? </span></span>
<span id="cb17-642"><a href="#cb17-642" aria-hidden="true" tabindex="-1"></a><span class="at"># example: young (&lt;35) vs older (&gt;62)</span></span>
<span id="cb17-643"><a href="#cb17-643" aria-hidden="true" tabindex="-1"></a><span class="at">group_comparison_age_young_old &lt;- margot_compare_groups(</span></span>
<span id="cb17-644"><a href="#cb17-644" aria-hidden="true" tabindex="-1"></a><span class="at">  group1_name = "People Under 35 Years Old",</span></span>
<span id="cb17-645"><a href="#cb17-645" aria-hidden="true" tabindex="-1"></a><span class="at">  group2_name = "People Over 62 Years Old", </span></span>
<span id="cb17-646"><a href="#cb17-646" aria-hidden="true" tabindex="-1"></a><span class="at">  planned_subset_results$wellbeing$cohort$results$</span><span class="st">`</span>Age <span class="sc">&lt;</span> <span class="dv">35</span><span class="st">`</span><span class="at">$transformed_table, # reference</span></span>
<span id="cb17-647"><a href="#cb17-647" aria-hidden="true" tabindex="-1"></a><span class="at">  planned_subset_results$wellbeing$cohort$results$</span><span class="st">`</span>Age <span class="sc">&gt;</span> <span class="dv">62</span><span class="st">`</span><span class="at">$transformed_table, # comparison</span></span>
<span id="cb17-648"><a href="#cb17-648" aria-hidden="true" tabindex="-1"></a><span class="at">  type            = "RD",          # risk‑difference scale</span></span>
<span id="cb17-649"><a href="#cb17-649" aria-hidden="true" tabindex="-1"></a><span class="at">  decimal_places  = 3</span></span>
<span id="cb17-650"><a href="#cb17-650" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-651"><a href="#cb17-651" aria-hidden="true" tabindex="-1"></a><span class="at">print(group_comparison_age_young_old$results |&gt; kbl("markdown", digits = 3))</span></span>
<span id="cb17-652"><a href="#cb17-652" aria-hidden="true" tabindex="-1"></a><span class="at">cat(group_comparison_age_young_old$interpretation)</span></span>
<span id="cb17-653"><a href="#cb17-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-654"><a href="#cb17-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-655"><a href="#cb17-655" aria-hidden="true" tabindex="-1"></a><span class="at"># ---- define global variables for text generation ------------------------</span></span>
<span id="cb17-656"><a href="#cb17-656" aria-hidden="true" tabindex="-1"></a><span class="at">global_vars &lt;- list(</span></span>
<span id="cb17-657"><a href="#cb17-657" aria-hidden="true" tabindex="-1"></a><span class="at">  name_exposure_variable     = nice_name_exposure,</span></span>
<span id="cb17-658"><a href="#cb17-658" aria-hidden="true" tabindex="-1"></a><span class="at">  n_total                    = n_total,</span></span>
<span id="cb17-659"><a href="#cb17-659" aria-hidden="true" tabindex="-1"></a><span class="at">  ate_adjustment             = "bonferroni", </span></span>
<span id="cb17-660"><a href="#cb17-660" aria-hidden="true" tabindex="-1"></a><span class="at">  ate_alpha                  = "0.05",</span></span>
<span id="cb17-661"><a href="#cb17-661" aria-hidden="true" tabindex="-1"></a><span class="at">  cate_adjustment            = "Benjamini–Hochberg false-discovery-rate adjustment",</span></span>
<span id="cb17-662"><a href="#cb17-662" aria-hidden="true" tabindex="-1"></a><span class="at">  cate_alpha                 =  "0.1",             </span></span>
<span id="cb17-663"><a href="#cb17-663" aria-hidden="true" tabindex="-1"></a><span class="at">  sample_ratio_policy        =  "70/30",</span></span>
<span id="cb17-664"><a href="#cb17-664" aria-hidden="true" tabindex="-1"></a><span class="at">  n_participants             = n_participants,</span></span>
<span id="cb17-665"><a href="#cb17-665" aria-hidden="true" tabindex="-1"></a><span class="at">  exposure_variable          = name_exposure,</span></span>
<span id="cb17-666"><a href="#cb17-666" aria-hidden="true" tabindex="-1"></a><span class="at">  name_exposure_lower        = name_exposure_lower,</span></span>
<span id="cb17-667"><a href="#cb17-667" aria-hidden="true" tabindex="-1"></a><span class="at">  name_control_regime_lower  = name_control_regime_lower,</span></span>
<span id="cb17-668"><a href="#cb17-668" aria-hidden="true" tabindex="-1"></a><span class="at">  name_outcome_variables     = "Self Esteem", # &lt;- adjust to your study, your decision</span></span>
<span id="cb17-669"><a href="#cb17-669" aria-hidden="true" tabindex="-1"></a><span class="at">  name_outcomes_lower        = name_outcomes_lower,</span></span>
<span id="cb17-670"><a href="#cb17-670" aria-hidden="true" tabindex="-1"></a><span class="at">  name_exposure_capfirst     = nice_name_exposure,</span></span>
<span id="cb17-671"><a href="#cb17-671" aria-hidden="true" tabindex="-1"></a><span class="at">  measures_exposure          = measures_exposure,</span></span>
<span id="cb17-672"><a href="#cb17-672" aria-hidden="true" tabindex="-1"></a><span class="at">  value_exposure_regime      = value_exposure_regime,</span></span>
<span id="cb17-673"><a href="#cb17-673" aria-hidden="true" tabindex="-1"></a><span class="at">  value_control_regime       = value_control_regime,</span></span>
<span id="cb17-674"><a href="#cb17-674" aria-hidden="true" tabindex="-1"></a><span class="at">  flipped_list               = flipped_list, # set flipped_list = "" if nothing flipped</span></span>
<span id="cb17-675"><a href="#cb17-675" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_explain_grf       = "E",</span></span>
<span id="cb17-676"><a href="#cb17-676" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_assumptions_grf   = "F",</span></span>
<span id="cb17-677"><a href="#cb17-677" aria-hidden="true" tabindex="-1"></a><span class="at">  name_exposure_threshold    =  "1",</span></span>
<span id="cb17-678"><a href="#cb17-678" aria-hidden="true" tabindex="-1"></a><span class="at">  name_control_threshold     =  "0",</span></span>
<span id="cb17-679"><a href="#cb17-679" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_measures          =  "A",</span></span>
<span id="cb17-680"><a href="#cb17-680" aria-hidden="true" tabindex="-1"></a><span class="at">  value_control              = value_control,     # ← named</span></span>
<span id="cb17-681"><a href="#cb17-681" aria-hidden="true" tabindex="-1"></a><span class="at">  value_exposure             = value_exposure,    # ← named</span></span>
<span id="cb17-682"><a href="#cb17-682" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_positivity        = "C",</span></span>
<span id="cb17-683"><a href="#cb17-683" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_rate              = "D",</span></span>
<span id="cb17-684"><a href="#cb17-684" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_qini_curve        = "D",</span></span>
<span id="cb17-685"><a href="#cb17-685" aria-hidden="true" tabindex="-1"></a><span class="at">  train_proportion_decision_tree = ".7",</span></span>
<span id="cb17-686"><a href="#cb17-686" aria-hidden="true" tabindex="-1"></a><span class="at">  traning_proportion         = ".7",</span></span>
<span id="cb17-687"><a href="#cb17-687" aria-hidden="true" tabindex="-1"></a><span class="at">  sample_split              = "70/30",</span></span>
<span id="cb17-688"><a href="#cb17-688" aria-hidden="true" tabindex="-1"></a><span class="at">  sample_ratio_policy        = "70/30",</span></span>
<span id="cb17-689"><a href="#cb17-689" aria-hidden="true" tabindex="-1"></a><span class="at">  baseline_wave              = baseline_wave,</span></span>
<span id="cb17-690"><a href="#cb17-690" aria-hidden="true" tabindex="-1"></a><span class="at">  exposure_waves             = exposure_waves,</span></span>
<span id="cb17-691"><a href="#cb17-691" aria-hidden="true" tabindex="-1"></a><span class="at">  outcome_wave               = outcome_wave,</span></span>
<span id="cb17-692"><a href="#cb17-692" aria-hidden="true" tabindex="-1"></a><span class="at">  protocol_url               = "https://osf.io/ce4t9/", # if used</span></span>
<span id="cb17-693"><a href="#cb17-693" aria-hidden="true" tabindex="-1"></a><span class="at">  appendix_timeline          = "A" # if used</span></span>
<span id="cb17-694"><a href="#cb17-694" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-695"><a href="#cb17-695" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-696"><a href="#cb17-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-697"><a href="#cb17-697" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-698"><a href="#cb17-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-699"><a href="#cb17-699" aria-hidden="true" tabindex="-1"></a><span class="do">## Introduction</span></span>
<span id="cb17-700"><a href="#cb17-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-701"><a href="#cb17-701" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span>Your place to shine here<span class="sc">**</span></span>
<span id="cb17-702"><a href="#cb17-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-703"><a href="#cb17-703" aria-hidden="true" tabindex="-1"></a><span class="do">## Method</span></span>
<span id="cb17-704"><a href="#cb17-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-705"><a href="#cb17-705" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-706"><a href="#cb17-706" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to false/ copy and paste text so you can modify it/change the figure</span></span>
<span id="cb17-707"><a href="#cb17-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-708"><a href="#cb17-708" aria-hidden="true" tabindex="-1"></a><span class="at"># run this code, copy and paste contents into your text</span></span>
<span id="cb17-709"><a href="#cb17-709" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb17-710"><a href="#cb17-710" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb17-711"><a href="#cb17-711" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "methods",      # ← choose the right top-level list</span></span>
<span id="cb17-712"><a href="#cb17-712" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c(</span></span>
<span id="cb17-713"><a href="#cb17-713" aria-hidden="true" tabindex="-1"></a><span class="at">      "student_sample.nzavs",</span></span>
<span id="cb17-714"><a href="#cb17-714" aria-hidden="true" tabindex="-1"></a><span class="at">      "student_target_population",</span></span>
<span id="cb17-715"><a href="#cb17-715" aria-hidden="true" tabindex="-1"></a><span class="at">      "eligibility.standard",</span></span>
<span id="cb17-716"><a href="#cb17-716" aria-hidden="true" tabindex="-1"></a><span class="at">      "causal_intervention.grf_simple_text",</span></span>
<span id="cb17-717"><a href="#cb17-717" aria-hidden="true" tabindex="-1"></a><span class="at">      "analytic_approach.general_approach_cate_long", # &lt;- new</span></span>
<span id="cb17-718"><a href="#cb17-718" aria-hidden="true" tabindex="-1"></a><span class="at">      "exposure_indicator",</span></span>
<span id="cb17-719"><a href="#cb17-719" aria-hidden="true" tabindex="-1"></a><span class="at">      "causal_identification_criteria",</span></span>
<span id="cb17-720"><a href="#cb17-720" aria-hidden="true" tabindex="-1"></a><span class="at">      "confounding_control.vanderweele",</span></span>
<span id="cb17-721"><a href="#cb17-721" aria-hidden="true" tabindex="-1"></a><span class="at">      "statistical_models.grf_short_explanation",</span></span>
<span id="cb17-722"><a href="#cb17-722" aria-hidden="true" tabindex="-1"></a><span class="at">      "missing_data.missing_grf_simple",</span></span>
<span id="cb17-723"><a href="#cb17-723" aria-hidden="true" tabindex="-1"></a><span class="at">      "sensitivity_analysis.short_evalue"</span></span>
<span id="cb17-724"><a href="#cb17-724" aria-hidden="true" tabindex="-1"></a><span class="at">    ),</span></span>
<span id="cb17-725"><a href="#cb17-725" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb17-726"><a href="#cb17-726" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb17-727"><a href="#cb17-727" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-728"><a href="#cb17-728" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-729"><a href="#cb17-729" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-730"><a href="#cb17-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-731"><a href="#cb17-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-732"><a href="#cb17-732" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-733"><a href="#cb17-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-734"><a href="#cb17-734" aria-hidden="true" tabindex="-1"></a><span class="do">## Results</span></span>
<span id="cb17-735"><a href="#cb17-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-736"><a href="#cb17-736" aria-hidden="true" tabindex="-1"></a><span class="do">### Average Treatement Effects</span></span>
<span id="cb17-737"><a href="#cb17-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-738"><a href="#cb17-738" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-739"><a href="#cb17-739" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-ate</span></span>
<span id="cb17-740"><a href="#cb17-740" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Average Treatment Effects on Multi-dimensional Wellbeing"</span></span>
<span id="cb17-741"><a href="#cb17-741" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true # |eval: false # &lt;- set to false as needed/desired for your own material</span></span>
<span id="cb17-742"><a href="#cb17-742" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 12</span></span>
<span id="cb17-743"><a href="#cb17-743" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 8</span></span>
<span id="cb17-744"><a href="#cb17-744" aria-hidden="true" tabindex="-1"></a><span class="at">ate_results$plot</span></span>
<span id="cb17-745"><a href="#cb17-745" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-746"><a href="#cb17-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-747"><a href="#cb17-747" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-748"><a href="#cb17-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-749"><a href="#cb17-749" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-750"><a href="#cb17-750" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: tbl-outcomes</span></span>
<span id="cb17-751"><a href="#cb17-751" aria-hidden="true" tabindex="-1"></a><span class="at">#| tbl-cap: "Average Treatment Effects on Multi-dimensional Wellbeing"</span></span>
<span id="cb17-752"><a href="#cb17-752" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true # |eval: false # &lt;- set to false as needed/desired for your own material</span></span>
<span id="cb17-753"><a href="#cb17-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-754"><a href="#cb17-754" aria-hidden="true" tabindex="-1"></a><span class="at"># ate_results$transformed_table|&gt; kbl("markdown")</span></span>
<span id="cb17-755"><a href="#cb17-755" aria-hidden="true" tabindex="-1"></a><span class="at">margot_bind_tables_markdown</span></span>
<span id="cb17-756"><a href="#cb17-756" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-757"><a href="#cb17-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-758"><a href="#cb17-758" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb17-759"><a href="#cb17-759" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false </span></span>
<span id="cb17-760"><a href="#cb17-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-761"><a href="#cb17-761" aria-hidden="true" tabindex="-1"></a><span class="at"># run this line, copy and paste text into your document </span></span>
<span id="cb17-762"><a href="#cb17-762" aria-hidden="true" tabindex="-1"></a><span class="at">cat(ate_results$interpretation)</span></span>
<span id="cb17-763"><a href="#cb17-763" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-764"><a href="#cb17-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-765"><a href="#cb17-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-766"><a href="#cb17-766" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-767"><a href="#cb17-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-768"><a href="#cb17-768" aria-hidden="true" tabindex="-1"></a><span class="sc">&lt;!--</span> Uncomment text below and run <span class="cf">if</span> you have performed a subgroup comparison. <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb17-769"><a href="#cb17-769" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> <span class="do">### Planned Subgroup Comparisons (Optional) --&gt;</span></span>
<span id="cb17-770"><a href="#cb17-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-771"><a href="#cb17-771" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> Based on theoretical findings we expected that the effects of {name_exposure} would vary by age...\<span class="sc">@</span>fig<span class="sc">-</span>planned<span class="sc">-</span>comparison and <span class="sc">@</span>tbl<span class="sc">-</span>planned<span class="sc">-</span>comparison <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb17-772"><a href="#cb17-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-773"><a href="#cb17-773" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> <span class="st">```</span><span class="at">{r} --&gt;</span></span>
<span id="cb17-774"><a href="#cb17-774" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| label: fig-planned-comparison --&gt;</span></span>
<span id="cb17-775"><a href="#cb17-775" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| fig-cap: "Planned Comparison Plot" --&gt;</span></span>
<span id="cb17-776"><a href="#cb17-776" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb17-777"><a href="#cb17-777" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| echo: false --&gt;</span></span>
<span id="cb17-778"><a href="#cb17-778" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| fig-height: 10 --&gt;</span></span>
<span id="cb17-779"><a href="#cb17-779" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| fig-width: 12 --&gt;</span></span>
<span id="cb17-780"><a href="#cb17-780" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- plots_subgroup_age_young_old --&gt;</span></span>
<span id="cb17-781"><a href="#cb17-781" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- </span><span class="st">```</span> <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb17-782"><a href="#cb17-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-783"><a href="#cb17-783" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> <span class="st">```</span><span class="at">{r} --&gt;</span></span>
<span id="cb17-784"><a href="#cb17-784" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| label: tbl-planned-comparison --&gt;</span></span>
<span id="cb17-785"><a href="#cb17-785" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| tbl-cap: "Planned Comparison Table" --&gt;</span></span>
<span id="cb17-786"><a href="#cb17-786" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| eval: true  # &lt;- set to false: copy and paste your own text using this material --&gt;</span></span>
<span id="cb17-787"><a href="#cb17-787" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| echo: false --&gt;</span></span>
<span id="cb17-788"><a href="#cb17-788" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- # table (only use if more than one qini gain interpretation) --&gt;</span></span>
<span id="cb17-789"><a href="#cb17-789" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- group_comparison_age_young_old$results |&gt;  --&gt;</span></span>
<span id="cb17-790"><a href="#cb17-790" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!--   mutate(across(where(is.numeric), ~ round(., 2))) %&gt;% --&gt;</span></span>
<span id="cb17-791"><a href="#cb17-791" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!--   kbl(format = "markdown") --&gt;</span></span>
<span id="cb17-792"><a href="#cb17-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-793"><a href="#cb17-793" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- </span><span class="st">```</span> <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb17-794"><a href="#cb17-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-795"><a href="#cb17-795" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> <span class="st">```</span><span class="at">{r, results = 'asis'} --&gt;</span></span>
<span id="cb17-796"><a href="#cb17-796" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- #| eval: false # copy and paste your own text --&gt;</span></span>
<span id="cb17-797"><a href="#cb17-797" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- cat(group_comparison_age_young_old$interpretation) --&gt;</span></span>
<span id="cb17-798"><a href="#cb17-798" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- </span><span class="st">```</span> <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb17-799"><a href="#cb17-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-800"><a href="#cb17-800" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-801"><a href="#cb17-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-802"><a href="#cb17-802" aria-hidden="true" tabindex="-1"></a><span class="do">### Heterogeneous Treatment Effects {#results-qini-curve}</span></span>
<span id="cb17-803"><a href="#cb17-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-804"><a href="#cb17-804" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-805"><a href="#cb17-805" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false  # &lt;- set to false: copy and paste your own text using this material</span></span>
<span id="cb17-806"><a href="#cb17-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-807"><a href="#cb17-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-808"><a href="#cb17-808" aria-hidden="true" tabindex="-1"></a><span class="at"># copy and paste into your txt</span></span>
<span id="cb17-809"><a href="#cb17-809" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb17-810"><a href="#cb17-810" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb17-811"><a href="#cb17-811" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "results",      # ← choose the right top-level list</span></span>
<span id="cb17-812"><a href="#cb17-812" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c(</span></span>
<span id="cb17-813"><a href="#cb17-813" aria-hidden="true" tabindex="-1"></a><span class="at">    "grf.interpretation_qini"</span></span>
<span id="cb17-814"><a href="#cb17-814" aria-hidden="true" tabindex="-1"></a><span class="at">    ),</span></span>
<span id="cb17-815"><a href="#cb17-815" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb17-816"><a href="#cb17-816" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb17-817"><a href="#cb17-817" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-818"><a href="#cb17-818" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-819"><a href="#cb17-819" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-820"><a href="#cb17-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-821"><a href="#cb17-821" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb17-822"><a href="#cb17-822" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false  # &lt;- set to false: copy and paste your own text using this material</span></span>
<span id="cb17-823"><a href="#cb17-823" aria-hidden="true" tabindex="-1"></a><span class="at"># only reliable results</span></span>
<span id="cb17-824"><a href="#cb17-824" aria-hidden="true" tabindex="-1"></a><span class="at">cat(qini_gain$qini_explanation) </span></span>
<span id="cb17-825"><a href="#cb17-825" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-826"><a href="#cb17-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-827"><a href="#cb17-827" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>tbl<span class="sc">-</span>qini presents results <span class="cf">for</span> our Qini curve analysis at different spend rates.</span>
<span id="cb17-828"><a href="#cb17-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-829"><a href="#cb17-829" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-830"><a href="#cb17-830" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: tbl-qini</span></span>
<span id="cb17-831"><a href="#cb17-831" aria-hidden="true" tabindex="-1"></a><span class="at">#| tbl-cap: "Qini Curve Results"</span></span>
<span id="cb17-832"><a href="#cb17-832" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false  # &lt;- set to false: copy and paste your own text using this material</span></span>
<span id="cb17-833"><a href="#cb17-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-834"><a href="#cb17-834" aria-hidden="true" tabindex="-1"></a><span class="at"># table (only use if more than one qini gain interpretation)</span></span>
<span id="cb17-835"><a href="#cb17-835" aria-hidden="true" tabindex="-1"></a><span class="at">qini_gain$summary_table |&gt; </span></span>
<span id="cb17-836"><a href="#cb17-836" aria-hidden="true" tabindex="-1"></a><span class="at">  mutate(across(where(is.numeric), ~ round(., 2))) %&gt;%</span></span>
<span id="cb17-837"><a href="#cb17-837" aria-hidden="true" tabindex="-1"></a><span class="at">  kbl(format = "markdown") #&lt;-- only if you have this, otherwise delete this code</span></span>
<span id="cb17-838"><a href="#cb17-838" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-839"><a href="#cb17-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-840"><a href="#cb17-840" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>fig<span class="sc">-</span>qini<span class="dv">-1</span> presents results <span class="cf">for</span> reliable Qini results</span>
<span id="cb17-841"><a href="#cb17-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-842"><a href="#cb17-842" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-843"><a href="#cb17-843" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-qini-1</span></span>
<span id="cb17-844"><a href="#cb17-844" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Qini Graphs"</span></span>
<span id="cb17-845"><a href="#cb17-845" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true once you have set up your graph correctly</span></span>
<span id="cb17-846"><a href="#cb17-846" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-847"><a href="#cb17-847" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 18</span></span>
<span id="cb17-848"><a href="#cb17-848" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb17-849"><a href="#cb17-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-850"><a href="#cb17-850" aria-hidden="true" tabindex="-1"></a><span class="at">library(patchwork)</span></span>
<span id="cb17-851"><a href="#cb17-851" aria-hidden="true" tabindex="-1"></a><span class="at"># combine first column of plots (4,6,7,8) and second column (9,11,12)</span></span>
<span id="cb17-852"><a href="#cb17-852" aria-hidden="true" tabindex="-1"></a><span class="at"># these showed reliable qini results</span></span>
<span id="cb17-853"><a href="#cb17-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-854"><a href="#cb17-854" aria-hidden="true" tabindex="-1"></a><span class="at"># THIS WILL NEED TO BE MODIFED TO SUIT YOUR STUDY</span></span>
<span id="cb17-855"><a href="#cb17-855" aria-hidden="true" tabindex="-1"></a><span class="at"># Once you get the right arrangement </span></span>
<span id="cb17-856"><a href="#cb17-856" aria-hidden="true" tabindex="-1"></a><span class="at">combined_qini &lt;- (</span></span>
<span id="cb17-857"><a href="#cb17-857" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_plots[[1]] /</span></span>
<span id="cb17-858"><a href="#cb17-858" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_plots[[2]] /</span></span>
<span id="cb17-859"><a href="#cb17-859" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_plots[[3]] /</span></span>
<span id="cb17-860"><a href="#cb17-860" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_plots[[4]]</span></span>
<span id="cb17-861"><a href="#cb17-861" aria-hidden="true" tabindex="-1"></a><span class="at">) | (</span></span>
<span id="cb17-862"><a href="#cb17-862" aria-hidden="true" tabindex="-1"></a><span class="at">  # remove this block if you don't have plots 9,11,12</span></span>
<span id="cb17-863"><a href="#cb17-863" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_plots[[5]] /</span></span>
<span id="cb17-864"><a href="#cb17-864" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_plots[[6]] /</span></span>
<span id="cb17-865"><a href="#cb17-865" aria-hidden="true" tabindex="-1"></a><span class="at">  qini_plots[[7]]</span></span>
<span id="cb17-866"><a href="#cb17-866" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb17-867"><a href="#cb17-867" aria-hidden="true" tabindex="-1"></a><span class="at">  # collect all legends into one shared guide</span></span>
<span id="cb17-868"><a href="#cb17-868" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_layout(guides = "collect") +</span></span>
<span id="cb17-869"><a href="#cb17-869" aria-hidden="true" tabindex="-1"></a><span class="at">  # add title (and optionally subtitle)</span></span>
<span id="cb17-870"><a href="#cb17-870" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_annotation(</span></span>
<span id="cb17-871"><a href="#cb17-871" aria-hidden="true" tabindex="-1"></a><span class="at">    title    = "Combined Qini Plots",</span></span>
<span id="cb17-872"><a href="#cb17-872" aria-hidden="true" tabindex="-1"></a><span class="at">    subtitle = "Panels arranged with shared legend"</span></span>
<span id="cb17-873"><a href="#cb17-873" aria-hidden="true" tabindex="-1"></a><span class="at">  ) &amp;</span></span>
<span id="cb17-874"><a href="#cb17-874" aria-hidden="true" tabindex="-1"></a><span class="at">  # apply theme modifications to all subplots</span></span>
<span id="cb17-875"><a href="#cb17-875" aria-hidden="true" tabindex="-1"></a><span class="at">  theme(</span></span>
<span id="cb17-876"><a href="#cb17-876" aria-hidden="true" tabindex="-1"></a><span class="at">    legend.position   = "bottom",           # place legend below</span></span>
<span id="cb17-877"><a href="#cb17-877" aria-hidden="true" tabindex="-1"></a><span class="at">    plot.title        = element_text(hjust = 0.5),  # centre title</span></span>
<span id="cb17-878"><a href="#cb17-878" aria-hidden="true" tabindex="-1"></a><span class="at">    plot.subtitle     = element_text(hjust = 0.5)   # centre subtitle</span></span>
<span id="cb17-879"><a href="#cb17-879" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-880"><a href="#cb17-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-881"><a href="#cb17-881" aria-hidden="true" tabindex="-1"></a><span class="at"># draw it</span></span>
<span id="cb17-882"><a href="#cb17-882" aria-hidden="true" tabindex="-1"></a><span class="at">print(combined_qini)</span></span>
<span id="cb17-883"><a href="#cb17-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-884"><a href="#cb17-884" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-885"><a href="#cb17-885" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-886"><a href="#cb17-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-887"><a href="#cb17-887" aria-hidden="true" tabindex="-1"></a><span class="do">### Decision Rules (Who is Most Sensitive to Treatment?)</span></span>
<span id="cb17-888"><a href="#cb17-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-889"><a href="#cb17-889" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-890"><a href="#cb17-890" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false  # &lt;- set to false: copy and paste your own text using this material</span></span>
<span id="cb17-891"><a href="#cb17-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-892"><a href="#cb17-892" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb17-893"><a href="#cb17-893" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb17-894"><a href="#cb17-894" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "results",      # ← choose the right top-level list</span></span>
<span id="cb17-895"><a href="#cb17-895" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c(</span></span>
<span id="cb17-896"><a href="#cb17-896" aria-hidden="true" tabindex="-1"></a><span class="at">    "grf.interpretation_policy_tree"</span></span>
<span id="cb17-897"><a href="#cb17-897" aria-hidden="true" tabindex="-1"></a><span class="at">    ),</span></span>
<span id="cb17-898"><a href="#cb17-898" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb17-899"><a href="#cb17-899" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb17-900"><a href="#cb17-900" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-901"><a href="#cb17-901" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-902"><a href="#cb17-902" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-903"><a href="#cb17-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-904"><a href="#cb17-904" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-905"><a href="#cb17-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-906"><a href="#cb17-906" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-907"><a href="#cb17-907" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-policy-1</span></span>
<span id="cb17-908"><a href="#cb17-908" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Decision Tree: {glued_policy_names_1}"</span></span>
<span id="cb17-909"><a href="#cb17-909" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true once you have set up your graph correctly / if you have no qini graph delete skip this</span></span>
<span id="cb17-910"><a href="#cb17-910" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-911"><a href="#cb17-911" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 10</span></span>
<span id="cb17-912"><a href="#cb17-912" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb17-913"><a href="#cb17-913" aria-hidden="true" tabindex="-1"></a><span class="at"># plot 1</span></span>
<span id="cb17-914"><a href="#cb17-914" aria-hidden="true" tabindex="-1"></a><span class="at">policy_plots[[1]]</span></span>
<span id="cb17-915"><a href="#cb17-915" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-916"><a href="#cb17-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-917"><a href="#cb17-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-918"><a href="#cb17-918" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-919"><a href="#cb17-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-920"><a href="#cb17-920" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-921"><a href="#cb17-921" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-policy-2</span></span>
<span id="cb17-922"><a href="#cb17-922" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Decision Tree: {glued_policy_names_2}"</span></span>
<span id="cb17-923"><a href="#cb17-923" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true once you have set up your graph correctly / if you have no policy graph delete skip this</span></span>
<span id="cb17-924"><a href="#cb17-924" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 10</span></span>
<span id="cb17-925"><a href="#cb17-925" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb17-926"><a href="#cb17-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-927"><a href="#cb17-927" aria-hidden="true" tabindex="-1"></a><span class="at">policy_plots[[2]]</span></span>
<span id="cb17-928"><a href="#cb17-928" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-929"><a href="#cb17-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-930"><a href="#cb17-930" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-931"><a href="#cb17-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-932"><a href="#cb17-932" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-933"><a href="#cb17-933" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-policy-3</span></span>
<span id="cb17-934"><a href="#cb17-934" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Decision Tree: {glued_policy_names_3}"</span></span>
<span id="cb17-935"><a href="#cb17-935" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true once you have set up your graph correctly / if you have no policy graph delete skip this</span></span>
<span id="cb17-936"><a href="#cb17-936" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-937"><a href="#cb17-937" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 10</span></span>
<span id="cb17-938"><a href="#cb17-938" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb17-939"><a href="#cb17-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-940"><a href="#cb17-940" aria-hidden="true" tabindex="-1"></a><span class="at">policy_plots[[3]]</span></span>
<span id="cb17-941"><a href="#cb17-941" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-942"><a href="#cb17-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-943"><a href="#cb17-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-944"><a href="#cb17-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-945"><a href="#cb17-945" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-946"><a href="#cb17-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-947"><a href="#cb17-947" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-948"><a href="#cb17-948" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-policy-4</span></span>
<span id="cb17-949"><a href="#cb17-949" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Decision Tree: {glued_policy_names_4}"</span></span>
<span id="cb17-950"><a href="#cb17-950" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true once you have set up your graph correctly / if you have no policy graph delete skip this</span></span>
<span id="cb17-951"><a href="#cb17-951" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 10</span></span>
<span id="cb17-952"><a href="#cb17-952" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb17-953"><a href="#cb17-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-954"><a href="#cb17-954" aria-hidden="true" tabindex="-1"></a><span class="at">policy_plots[[4]]</span></span>
<span id="cb17-955"><a href="#cb17-955" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-956"><a href="#cb17-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-957"><a href="#cb17-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-958"><a href="#cb17-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-959"><a href="#cb17-959" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-960"><a href="#cb17-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-961"><a href="#cb17-961" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-962"><a href="#cb17-962" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-policy-5</span></span>
<span id="cb17-963"><a href="#cb17-963" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Decision Tree: {glued_policy_names_5}"</span></span>
<span id="cb17-964"><a href="#cb17-964" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true once you have set up your graph correctly / if you have no policy graph delete skip this</span></span>
<span id="cb17-965"><a href="#cb17-965" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 10</span></span>
<span id="cb17-966"><a href="#cb17-966" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 10</span></span>
<span id="cb17-967"><a href="#cb17-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-968"><a href="#cb17-968" aria-hidden="true" tabindex="-1"></a><span class="at">policy_plots[[5]]</span></span>
<span id="cb17-969"><a href="#cb17-969" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-970"><a href="#cb17-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-971"><a href="#cb17-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-972"><a href="#cb17-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-973"><a href="#cb17-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-974"><a href="#cb17-974" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-975"><a href="#cb17-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-976"><a href="#cb17-976" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-977"><a href="#cb17-977" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-policy-6</span></span>
<span id="cb17-978"><a href="#cb17-978" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Decision Tree: {glued_policy_names_6}"</span></span>
<span id="cb17-979"><a href="#cb17-979" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true once you have set up your graph correctly / if you have no policy graph delete skip this</span></span>
<span id="cb17-980"><a href="#cb17-980" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 10</span></span>
<span id="cb17-981"><a href="#cb17-981" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb17-982"><a href="#cb17-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-983"><a href="#cb17-983" aria-hidden="true" tabindex="-1"></a><span class="at">policy_plots[[6]]</span></span>
<span id="cb17-984"><a href="#cb17-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-985"><a href="#cb17-985" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-986"><a href="#cb17-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-987"><a href="#cb17-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-988"><a href="#cb17-988" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-989"><a href="#cb17-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-990"><a href="#cb17-990" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-991"><a href="#cb17-991" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-policy-7</span></span>
<span id="cb17-992"><a href="#cb17-992" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "Decision Tree: {glued_policy_names_7}"</span></span>
<span id="cb17-993"><a href="#cb17-993" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true once you have set up your graph correctly / if you have no policy graph delete skip this</span></span>
<span id="cb17-994"><a href="#cb17-994" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-995"><a href="#cb17-995" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 10</span></span>
<span id="cb17-996"><a href="#cb17-996" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb17-997"><a href="#cb17-997" aria-hidden="true" tabindex="-1"></a><span class="at">policy_plots[[7]]</span></span>
<span id="cb17-998"><a href="#cb17-998" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-999"><a href="#cb17-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1000"><a href="#cb17-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1001"><a href="#cb17-1001" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1002"><a href="#cb17-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1003"><a href="#cb17-1003" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb17-1004"><a href="#cb17-1004" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to false if you want to copy and paste your own text</span></span>
<span id="cb17-1005"><a href="#cb17-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1006"><a href="#cb17-1006" aria-hidden="true" tabindex="-1"></a><span class="at"># use this text to copy and paste below your decision tree graphs</span></span>
<span id="cb17-1007"><a href="#cb17-1007" aria-hidden="true" tabindex="-1"></a><span class="at">cat(policy_text, "</span><span class="sc">\n</span><span class="at">")</span></span>
<span id="cb17-1008"><a href="#cb17-1008" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1009"><a href="#cb17-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1010"><a href="#cb17-1010" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1011"><a href="#cb17-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1012"><a href="#cb17-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1013"><a href="#cb17-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1014"><a href="#cb17-1014" aria-hidden="true" tabindex="-1"></a><span class="do">## Discussion</span></span>
<span id="cb17-1015"><a href="#cb17-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1016"><a href="#cb17-1016" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r,  results='asis'}</span></span>
<span id="cb17-1017"><a href="#cb17-1017" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false  # &lt;- set to false: copy and paste your own text using this material</span></span>
<span id="cb17-1018"><a href="#cb17-1018" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-1019"><a href="#cb17-1019" aria-hidden="true" tabindex="-1"></a><span class="at">cat(boilerplate_generate_text(</span></span>
<span id="cb17-1020"><a href="#cb17-1020" aria-hidden="true" tabindex="-1"></a><span class="at">  category = "discussion",</span></span>
<span id="cb17-1021"><a href="#cb17-1021" aria-hidden="true" tabindex="-1"></a><span class="at">  sections = c(</span></span>
<span id="cb17-1022"><a href="#cb17-1022" aria-hidden="true" tabindex="-1"></a><span class="at">    "student_ethics",</span></span>
<span id="cb17-1023"><a href="#cb17-1023" aria-hidden="true" tabindex="-1"></a><span class="at">    "student_data",</span></span>
<span id="cb17-1024"><a href="#cb17-1024" aria-hidden="true" tabindex="-1"></a><span class="at">    "student_authors_statement"  ),</span></span>
<span id="cb17-1025"><a href="#cb17-1025" aria-hidden="true" tabindex="-1"></a><span class="at">  global_vars = list(</span></span>
<span id="cb17-1026"><a href="#cb17-1026" aria-hidden="true" tabindex="-1"></a><span class="at">    exposure_variable = name_exposure</span></span>
<span id="cb17-1027"><a href="#cb17-1027" aria-hidden="true" tabindex="-1"></a><span class="at">  ),</span></span>
<span id="cb17-1028"><a href="#cb17-1028" aria-hidden="true" tabindex="-1"></a><span class="at">  db = unified_db</span></span>
<span id="cb17-1029"><a href="#cb17-1029" aria-hidden="true" tabindex="-1"></a><span class="at">))</span></span>
<span id="cb17-1030"><a href="#cb17-1030" aria-hidden="true" tabindex="-1"></a><span class="at">unified_db$discussion$student_authors_statement</span></span>
<span id="cb17-1031"><a href="#cb17-1031" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1032"><a href="#cb17-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1033"><a href="#cb17-1033" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1034"><a href="#cb17-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1035"><a href="#cb17-1035" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix A: Measures {#appendix-measures}</span></span>
<span id="cb17-1036"><a href="#cb17-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1037"><a href="#cb17-1037" aria-hidden="true" tabindex="-1"></a><span class="do">### Measures</span></span>
<span id="cb17-1038"><a href="#cb17-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1039"><a href="#cb17-1039" aria-hidden="true" tabindex="-1"></a><span class="do">#### Baseline Covariate Measures</span></span>
<span id="cb17-1040"><a href="#cb17-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1041"><a href="#cb17-1041" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-1042"><a href="#cb17-1042" aria-hidden="true" tabindex="-1"></a><span class="at">cat(baseline_measures_text)</span></span>
<span id="cb17-1043"><a href="#cb17-1043" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1044"><a href="#cb17-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1045"><a href="#cb17-1045" aria-hidden="true" tabindex="-1"></a><span class="do">#### Exposure Measures</span></span>
<span id="cb17-1046"><a href="#cb17-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1047"><a href="#cb17-1047" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-1048"><a href="#cb17-1048" aria-hidden="true" tabindex="-1"></a><span class="at">cat(exposure_measures_text)</span></span>
<span id="cb17-1049"><a href="#cb17-1049" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1050"><a href="#cb17-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1051"><a href="#cb17-1051" aria-hidden="true" tabindex="-1"></a><span class="do">#### Outcome Measures</span></span>
<span id="cb17-1052"><a href="#cb17-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1053"><a href="#cb17-1053" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-1054"><a href="#cb17-1054" aria-hidden="true" tabindex="-1"></a><span class="at">cat(outcome_measures_text)</span></span>
<span id="cb17-1055"><a href="#cb17-1055" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1056"><a href="#cb17-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1057"><a href="#cb17-1057" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1058"><a href="#cb17-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1059"><a href="#cb17-1059" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix B: Sample Characteristics {#appendix-sample}</span></span>
<span id="cb17-1060"><a href="#cb17-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1061"><a href="#cb17-1061" aria-hidden="true" tabindex="-1"></a><span class="do">#### Sample Statistics: Baseline Covariates</span></span>
<span id="cb17-1062"><a href="#cb17-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1063"><a href="#cb17-1063" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>tbl<span class="sc">-</span>appendix<span class="sc">-</span>baseline presents sample demographic statistics.</span>
<span id="cb17-1064"><a href="#cb17-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1065"><a href="#cb17-1065" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span> {<span class="co">#tbl-appendix-baseline}</span></span>
<span id="cb17-1066"><a href="#cb17-1066" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb17-1067"><a href="#cb17-1067" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb17-1068"><a href="#cb17-1068" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: true</span></span>
<span id="cb17-1069"><a href="#cb17-1069" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-1070"><a href="#cb17-1070" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_baseline</span></span>
<span id="cb17-1071"><a href="#cb17-1071" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1072"><a href="#cb17-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1073"><a href="#cb17-1073" aria-hidden="true" tabindex="-1"></a>Demographic statistics <span class="cf">for</span> New Zealand Attitudes and Values Cohort<span class="sc">:</span> {baseline_wave_glued}.</span>
<span id="cb17-1074"><a href="#cb17-1074" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span></span>
<span id="cb17-1075"><a href="#cb17-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1076"><a href="#cb17-1076" aria-hidden="true" tabindex="-1"></a><span class="do">### Sample Statistics: Exposure Variable {#appendix-exposure}</span></span>
<span id="cb17-1077"><a href="#cb17-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1078"><a href="#cb17-1078" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span><span class="sc">!--</span> <span class="er">@</span>tbl<span class="sc">-</span>sample<span class="sc">-</span>exposures presents sample statistics <span class="cf">for</span> the exposure variable, religious service attendance, during the baseline and exposure waves. This variable was not measured <span class="cf">in</span> part of NZAVS time <span class="dv">12</span> (years <span class="dv">2020-2021</span>) and part of NZAVS time <span class="dv">13</span> (years <span class="dv">2021-2022</span>). To address missingness, <span class="cf">if</span> a value was observed after NZAVS time <span class="dv">14</span>, we carried the previous observation forward and created and <span class="cn">NA</span> indicator. If there was no future observation, the participant was treated as censored, and inverse probability of censoring weights were applied, following our standard method <span class="cf">for</span> handling missing <span class="fu">observations</span> (see mansucript <span class="sc">**</span>Method<span class="sc">**</span><span class="er">/**</span>Handling of Missing Data<span class="sc">**</span>). Here, our carry<span class="sc">-</span>forward imputation approach may result <span class="cf">in</span> conservative causal effect estimation because it introduces measurement error. However, this approach would not generally bias causal effect estimation away from the null because the measurement error is unsystematic and random and unrelated to the outcomes. <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb17-1079"><a href="#cb17-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1080"><a href="#cb17-1080" aria-hidden="true" tabindex="-1"></a><span class="er">:::</span> {<span class="co">#tbl-appendix-exposures}</span></span>
<span id="cb17-1081"><a href="#cb17-1081" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb17-1082"><a href="#cb17-1082" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb17-1083"><a href="#cb17-1083" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: true</span></span>
<span id="cb17-1084"><a href="#cb17-1084" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-1085"><a href="#cb17-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1086"><a href="#cb17-1086" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_exposures</span></span>
<span id="cb17-1087"><a href="#cb17-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1088"><a href="#cb17-1088" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1089"><a href="#cb17-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1090"><a href="#cb17-1090" aria-hidden="true" tabindex="-1"></a>Demographic statistics <span class="cf">for</span> New Zealand Attitudes and Values Cohort waves <span class="fl">2018.</span></span>
<span id="cb17-1091"><a href="#cb17-1091" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span></span>
<span id="cb17-1092"><a href="#cb17-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1093"><a href="#cb17-1093" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1094"><a href="#cb17-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1095"><a href="#cb17-1095" aria-hidden="true" tabindex="-1"></a><span class="do">### Sample Statistics: Outcome Variables {#appendix-outcomes}</span></span>
<span id="cb17-1096"><a href="#cb17-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1097"><a href="#cb17-1097" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span> {<span class="co">#tbl-appendix-outcomes}</span></span>
<span id="cb17-1098"><a href="#cb17-1098" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb17-1099"><a href="#cb17-1099" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb17-1100"><a href="#cb17-1100" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: true</span></span>
<span id="cb17-1101"><a href="#cb17-1101" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-1102"><a href="#cb17-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1103"><a href="#cb17-1103" aria-hidden="true" tabindex="-1"></a><span class="at">markdown_table_outcomes</span></span>
<span id="cb17-1104"><a href="#cb17-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1105"><a href="#cb17-1105" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1106"><a href="#cb17-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1107"><a href="#cb17-1107" aria-hidden="true" tabindex="-1"></a>Outcome variables measured at {baseline_wave_glued} and {outcome_wave}</span>
<span id="cb17-1108"><a href="#cb17-1108" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span></span>
<span id="cb17-1109"><a href="#cb17-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1110"><a href="#cb17-1110" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1111"><a href="#cb17-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1112"><a href="#cb17-1112" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix C: Transition Matrix to Check The Positivity Assumption {#appendix-transition}</span></span>
<span id="cb17-1113"><a href="#cb17-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1114"><a href="#cb17-1114" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb17-1115"><a href="#cb17-1115" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: tbl-transition</span></span>
<span id="cb17-1116"><a href="#cb17-1116" aria-hidden="true" tabindex="-1"></a><span class="at">#| tbl-cap: "Transition Matrix Showing Change"</span></span>
<span id="cb17-1117"><a href="#cb17-1117" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: true</span></span>
<span id="cb17-1118"><a href="#cb17-1118" aria-hidden="true" tabindex="-1"></a><span class="at">#| include: true</span></span>
<span id="cb17-1119"><a href="#cb17-1119" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-1120"><a href="#cb17-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1121"><a href="#cb17-1121" aria-hidden="true" tabindex="-1"></a><span class="at">transition_tables_binary$tables[[1]]</span></span>
<span id="cb17-1122"><a href="#cb17-1122" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1123"><a href="#cb17-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1124"><a href="#cb17-1124" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb17-1125"><a href="#cb17-1125" aria-hidden="true" tabindex="-1"></a><span class="at">cat(transition_tables_binary$explanation)</span></span>
<span id="cb17-1126"><a href="#cb17-1126" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1127"><a href="#cb17-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1128"><a href="#cb17-1128" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1129"><a href="#cb17-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1130"><a href="#cb17-1130" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix D: RATE AUTOC and RATE Qini {#appendix-rate}</span></span>
<span id="cb17-1131"><a href="#cb17-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1132"><a href="#cb17-1132" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-1133"><a href="#cb17-1133" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true as needed/desired</span></span>
<span id="cb17-1134"><a href="#cb17-1134" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-1135"><a href="#cb17-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1136"><a href="#cb17-1136" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb17-1137"><a href="#cb17-1137" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb17-1138"><a href="#cb17-1138" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "results",</span></span>
<span id="cb17-1139"><a href="#cb17-1139" aria-hidden="true" tabindex="-1"></a><span class="at">    # ← choose the right top-level list</span></span>
<span id="cb17-1140"><a href="#cb17-1140" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c("grf.interpretation_rate"),</span></span>
<span id="cb17-1141"><a href="#cb17-1141" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb17-1142"><a href="#cb17-1142" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb17-1143"><a href="#cb17-1143" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-1144"><a href="#cb17-1144" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-1145"><a href="#cb17-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1146"><a href="#cb17-1146" aria-hidden="true" tabindex="-1"></a><span class="at"># if you did not flip, use this cat(unified_db$results$grf$interpretation_rate_no_flip)</span></span>
<span id="cb17-1147"><a href="#cb17-1147" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1148"><a href="#cb17-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1149"><a href="#cb17-1149" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-1150"><a href="#cb17-1150" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true as needed/desired</span></span>
<span id="cb17-1151"><a href="#cb17-1151" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-1152"><a href="#cb17-1152" aria-hidden="true" tabindex="-1"></a><span class="at">cat(rate_interp$comparison)</span></span>
<span id="cb17-1153"><a href="#cb17-1153" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1154"><a href="#cb17-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1155"><a href="#cb17-1155" aria-hidden="true" tabindex="-1"></a>Refer to [Appendix D](<span class="co">#appendix-cate-validation) for details.</span></span>
<span id="cb17-1156"><a href="#cb17-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1157"><a href="#cb17-1157" aria-hidden="true" tabindex="-1"></a><span class="do">##### RATE AUTOC RESULTS</span></span>
<span id="cb17-1158"><a href="#cb17-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1159"><a href="#cb17-1159" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results = 'asis'}</span></span>
<span id="cb17-1160"><a href="#cb17-1160" aria-hidden="true" tabindex="-1"></a><span class="at"># only reliable results</span></span>
<span id="cb17-1161"><a href="#cb17-1161" aria-hidden="true" tabindex="-1"></a><span class="at">cat(rate_interp$autoc_results)</span></span>
<span id="cb17-1162"><a href="#cb17-1162" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1163"><a href="#cb17-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1164"><a href="#cb17-1164" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r}</span></span>
<span id="cb17-1165"><a href="#cb17-1165" aria-hidden="true" tabindex="-1"></a><span class="at">#| label: fig-rate-1</span></span>
<span id="cb17-1166"><a href="#cb17-1166" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-cap: "RATE AUTOC Graphs"</span></span>
<span id="cb17-1167"><a href="#cb17-1167" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true as needed/desired</span></span>
<span id="cb17-1168"><a href="#cb17-1168" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-1169"><a href="#cb17-1169" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-height: 10</span></span>
<span id="cb17-1170"><a href="#cb17-1170" aria-hidden="true" tabindex="-1"></a><span class="at">#| fig-width: 12</span></span>
<span id="cb17-1171"><a href="#cb17-1171" aria-hidden="true" tabindex="-1"></a><span class="at">autoc_plots[[1]]</span></span>
<span id="cb17-1172"><a href="#cb17-1172" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1173"><a href="#cb17-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1174"><a href="#cb17-1174" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>fig<span class="sc">-</span>rate<span class="dv">-1</span> presents the RATE AUTOC curve <span class="cf">for</span> <span class="st">`</span><span class="at">r autoc_name_1</span><span class="st">`</span></span>
<span id="cb17-1175"><a href="#cb17-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1176"><a href="#cb17-1176" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1177"><a href="#cb17-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1178"><a href="#cb17-1178" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix E. Estimating and Interpreting Heterogeneous Treatment Effects with GRF {#appendix-explain-grf}</span></span>
<span id="cb17-1179"><a href="#cb17-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1180"><a href="#cb17-1180" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-1181"><a href="#cb17-1181" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false</span></span>
<span id="cb17-1182"><a href="#cb17-1182" aria-hidden="true" tabindex="-1"></a><span class="at">#| echo: false</span></span>
<span id="cb17-1183"><a href="#cb17-1183" aria-hidden="true" tabindex="-1"></a><span class="at">library(boilerplate)</span></span>
<span id="cb17-1184"><a href="#cb17-1184" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb17-1185"><a href="#cb17-1185" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb17-1186"><a href="#cb17-1186" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "appendix",</span></span>
<span id="cb17-1187"><a href="#cb17-1187" aria-hidden="true" tabindex="-1"></a><span class="at">    # ← choose the right top-level list</span></span>
<span id="cb17-1188"><a href="#cb17-1188" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c("explain.grf_short"),</span></span>
<span id="cb17-1189"><a href="#cb17-1189" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb17-1190"><a href="#cb17-1190" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb17-1191"><a href="#cb17-1191" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-1192"><a href="#cb17-1192" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-1193"><a href="#cb17-1193" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1194"><a href="#cb17-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1195"><a href="#cb17-1195" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1196"><a href="#cb17-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1197"><a href="#cb17-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1198"><a href="#cb17-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1199"><a href="#cb17-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1200"><a href="#cb17-1200" aria-hidden="true" tabindex="-1"></a><span class="do">## Appendix F: Strengths and Limitations of Causal Forests  {#appendix-rate}</span></span>
<span id="cb17-1201"><a href="#cb17-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1202"><a href="#cb17-1202" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r, results='asis'}</span></span>
<span id="cb17-1203"><a href="#cb17-1203" aria-hidden="true" tabindex="-1"></a><span class="at">#| eval: false # &lt;- set to true as needed/desired or copy and paste text</span></span>
<span id="cb17-1204"><a href="#cb17-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1205"><a href="#cb17-1205" aria-hidden="true" tabindex="-1"></a><span class="at">cat(</span></span>
<span id="cb17-1206"><a href="#cb17-1206" aria-hidden="true" tabindex="-1"></a><span class="at">  boilerplate::boilerplate_generate_text(</span></span>
<span id="cb17-1207"><a href="#cb17-1207" aria-hidden="true" tabindex="-1"></a><span class="at">    category     = "discussion",</span></span>
<span id="cb17-1208"><a href="#cb17-1208" aria-hidden="true" tabindex="-1"></a><span class="at">    # ← choose the right top-level list</span></span>
<span id="cb17-1209"><a href="#cb17-1209" aria-hidden="true" tabindex="-1"></a><span class="at">    sections     = c("strengths.strengths_grf_short"),</span></span>
<span id="cb17-1210"><a href="#cb17-1210" aria-hidden="true" tabindex="-1"></a><span class="at">    global_vars  = global_vars,</span></span>
<span id="cb17-1211"><a href="#cb17-1211" aria-hidden="true" tabindex="-1"></a><span class="at">    db           = unified_db</span></span>
<span id="cb17-1212"><a href="#cb17-1212" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb17-1213"><a href="#cb17-1213" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb17-1214"><a href="#cb17-1214" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb17-1215"><a href="#cb17-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1216"><a href="#cb17-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1217"><a href="#cb17-1217" aria-hidden="true" tabindex="-1"></a>{{<span class="sc">&lt;</span> pagebreak <span class="sc">&gt;</span>}}</span>
<span id="cb17-1218"><a href="#cb17-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1219"><a href="#cb17-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1220"><a href="#cb17-1220" aria-hidden="true" tabindex="-1"></a><span class="do">## References {.appendix-refs}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, be careful to use ‘models_binary’ and ‘labels_mapped_all’ in place of <code>models_binary_flipped</code> and <code>labels_mapped_all_flipped</code> throughout if you did not flip your models. I would rather advise that you use your the new code.</p>


<!-- -->


</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb18" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Hands On Working With Quarto Manuscript"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-MAY-13"</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> /Users/joseph/GIT/templates/bib/references.bib</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">    warnings: FALSE</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">    error: FALSE</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">    messages: FALSE</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: Ayu</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools:</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: FALSE</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="an">html-math-method:</span><span class="co"> katex</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="an">citation-location:</span><span class="co"> margin</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="an">code-block-border-left:</span><span class="co"> true</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1: Quarto manuscripts</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co">#read libraries</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"all"</span>)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>**Required**</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>Download Quarto here: </span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use the <span class="in">`prelease`</span> version: https://quarto.org/docs/download/</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>**Optional**</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@Bulbulia2024PracticalGuide</span><span class="co">] [link]</span>(https://osf.io/preprints/psyarxiv/uyg3d)</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@hoffman2023</span><span class="co">] [link]</span>(https://arxiv.org/pdf/2304.09460.pdf)</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key concepts</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Entering bibliographic details</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Writing up your manuscript</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a><span class="fu"># Code review: YOUR analysis</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>Create a new Rstudio project</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>Modify *these* scripts</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>::: {.callout-note-script-0}</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Download full lab scripts 0</span><span class="co">](../laboratory/lab-10/00-setup-L10.R)</span></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>::: {.callout-note-script-1}</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Download full lab scripts 1</span><span class="co">](../laboratory/ ../laboratory/lab-10/01-init-L10.R)</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>::: {.callout-note-script-2}</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Download full lab scripts 2</span><span class="co">]( ../laboratory/lab-10/02-make-wide-L10.R)</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>::: {.callout-note-script-3}</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Download full lab scripts 3</span><span class="co">](../laboratory/lab-10/03-models-L10-v3.R)</span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a><span class="fu">#  Quarto with `boilerplate`</span></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>::: {.callout-quarto-manuscript-template}</span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Download Quarto Template</span><span class="co">](../quarto/new_initial_quarto_document.qmd)</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a><span class="fu">## Script 0: Set up your library/</span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>Note -- rerun this script if you are missing updated templates, as they have been updated 23 May 2025</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| file: ../laboratory/lab-11/00-boilerplate-setup.R</span></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>Type <span class="in">`y`</span> when R asks whether to overwrite the boilerplate files; this replaces them with the latest versions.</span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>Press <span class="in">`n`</span> (or just hit Enter) to keep what you already have.</span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>Your own edits—such as custom rows in the measures table -- are stored elsewhere, so they will not be overwritten. One tap, no tears.</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>Take-away: <span class="in">`y`</span> refreshes the templates; <span class="in">`n`</span> preserves the status quo.</span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>This is how the the printout in your R console should look (depending on how recently you've run your script):</span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># save imported data -------------------------------------------------------</span></span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">boilerplate_save</span>(</span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   student_unified_db,</span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data_path     =</span> path_data,</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">create_backup =</span> <span class="cn">FALSE</span></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a>ℹ preparing to save <span class="dv">6</span> databases</span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>ℹ processing measures <span class="fu">database</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> measures database</span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>ℹ saving measures database to <span class="sc">/</span>Users<span class="sc">/</span>your_machine_path<span class="sc">-</span><span class="er">/</span>example_boilerplate_data<span class="sc">/</span>measures_db.rds</span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>✔ saved measures database</span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>ℹ processing methods <span class="fu">database</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">1</span> new entries will be added<span class="sc">:</span></span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">+</span> student_target_population</span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span> <span class="dv">2</span> entries will be removed<span class="sc">:</span></span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>   <span class="sc">-</span> target_population</span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>   <span class="sc">-</span> sample</span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a>Save methods database with these changes? [y<span class="sc">/</span>n]<span class="sc">:</span> y</span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>ℹ saving methods database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>methods_db.rds</span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>✔ saved methods database</span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>ℹ processing results <span class="fu">database</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> results database</span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>ℹ saving results database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>results_db.rds</span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>✔ saved results database</span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>ℹ processing discussion <span class="fu">database</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">2</span> existing entries will be modified<span class="sc">:</span></span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">~</span> student_authors_statement</span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">~</span> student_ethics</span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>Save discussion database with these changes? [y<span class="sc">/</span>n]<span class="sc">:</span> y</span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>ℹ saving discussion database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>discussion_db.rds</span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>✔ saved discussion database</span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>ℹ processing appendix <span class="fu">database</span> (<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> appendix database</span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a>ℹ saving appendix database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>appendix_db.rds</span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a>✔ saved appendix database</span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a>ℹ processing template <span class="fu">database</span> (<span class="dv">6</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> template database</span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a>ℹ saving template database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>example_boilerplate_data<span class="sc">/</span>template_db.rds</span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a>✔ saved template database</span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a>✔ successfully saved all <span class="dv">6</span> databases</span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Script 1: Adding/Revising Measures</span></span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a>Note -- rerun this script if you are missing updated templates, as they have been updated 23 May 2025</span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| file: ../laboratory/lab-11/01-add-revise-measures.R</span></span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>remember to type 'y' to save changes</span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a>When re-running your scripts, the printout should allow you to save to your working database folder. </span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a>When saving tick 'y'</span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-179"><a href="#cb18-179" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># save a copy to avoid overwriting original --------------------------------</span></span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">boilerplate_save</span>(</span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   unified_db,</span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">data_path   =</span> path_final,</span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="at">output_file =</span> <span class="st">"unified_db"</span></span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> )</span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true" tabindex="-1"></a>ℹ preparing to save <span class="dv">6</span> databases</span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true" tabindex="-1"></a>ℹ processing measures <span class="fu">database</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> measures database</span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true" tabindex="-1"></a>ℹ saving measures database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>measures_db.rds</span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true" tabindex="-1"></a>✔ saved measures database</span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true" tabindex="-1"></a>ℹ processing methods <span class="fu">database</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">1</span> new entries will be added<span class="sc">:</span></span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">+</span> student_target_population</span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span> <span class="dv">2</span> entries will be removed<span class="sc">:</span></span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>   <span class="sc">-</span> target_population</span>
<span id="cb18-196"><a href="#cb18-196" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>   <span class="sc">-</span> sample</span>
<span id="cb18-197"><a href="#cb18-197" aria-hidden="true" tabindex="-1"></a>Save methods database with these changes? [y<span class="sc">/</span>n]<span class="sc">:</span> y</span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true" tabindex="-1"></a>ℹ created backup at<span class="sc">:</span> <span class="er">/</span>Users<span class="sc">/</span>your_path<span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>methods_db.rds<span class="fl">.20250523</span>_131930.bak</span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true" tabindex="-1"></a>ℹ saving methods database to  <span class="sc">/</span>Users<span class="sc">/</span>your_path<span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>methods_db.rds</span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true" tabindex="-1"></a>✔ saved methods database</span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true" tabindex="-1"></a>ℹ processing results <span class="fu">database</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> results database</span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true" tabindex="-1"></a>ℹ saving results database to  <span class="sc">/</span>Users<span class="sc">/</span>your_path<span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>results_db.rds</span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true" tabindex="-1"></a>✔ saved results database</span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true" tabindex="-1"></a>ℹ processing discussion <span class="fu">database</span> (<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">2</span> existing entries will be modified<span class="sc">:</span></span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">~</span> student_authors_statement</span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true" tabindex="-1"></a>ℹ   <span class="sc">~</span> student_ethics</span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true" tabindex="-1"></a>Save discussion database with these changes? [y<span class="sc">/</span>n]<span class="sc">:</span> y</span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true" tabindex="-1"></a>ℹ created backup at<span class="sc">:</span> <span class="er">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>discussion_db.rds<span class="fl">.20250523</span>_131933.bak</span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true" tabindex="-1"></a>ℹ saving discussion database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>discussion_db.rds</span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true" tabindex="-1"></a>✔ saved discussion database</span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true" tabindex="-1"></a>ℹ processing appendix <span class="fu">database</span> (<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> appendix database</span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true" tabindex="-1"></a>ℹ saving appendix database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>appendix_db.rds</span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true" tabindex="-1"></a>✔ saved appendix database</span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true" tabindex="-1"></a>ℹ processing template <span class="fu">database</span> (<span class="dv">6</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true" tabindex="-1"></a>ℹ no changes detected <span class="cf">in</span> template database</span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true" tabindex="-1"></a>ℹ saving template database to <span class="sc">/</span>Users<span class="sc">/</span>joseph<span class="sc">/</span>GIT<span class="sc">/</span>psych<span class="dv">-434-2025</span><span class="sc">/</span>final_boilerplate_data<span class="sc">/</span>template_db.rds</span>
<span id="cb18-220"><a href="#cb18-220" aria-hidden="true" tabindex="-1"></a>✔ saved template database</span>
<span id="cb18-221"><a href="#cb18-221" aria-hidden="true" tabindex="-1"></a>✔ successfully saved all <span class="dv">6</span> databases</span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-225"><a href="#cb18-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-226"><a href="#cb18-226" aria-hidden="true" tabindex="-1"></a><span class="fu">## Script 3: Setting Up Your Manuscript Document</span></span>
<span id="cb18-227"><a href="#cb18-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-228"><a href="#cb18-228" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb18-229"><a href="#cb18-229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>save this document as a <span class="in">`.qmd`</span> file in a directory called 'quarto' (in your rstudio project)</span>
<span id="cb18-230"><a href="#cb18-230" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>please run the code line-by-line (ctr/cmd + ENTER) before rendering</span>
<span id="cb18-231"><a href="#cb18-231" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>to render a document click 'Render'</span>
<span id="cb18-232"><a href="#cb18-232" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-233"><a href="#cb18-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-234"><a href="#cb18-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-235"><a href="#cb18-235" aria-hidden="true" tabindex="-1"></a>::: {.callout-important title="⚠️ IMPORTANT: flipped outcomes"}</span>
<span id="cb18-236"><a href="#cb18-236" aria-hidden="true" tabindex="-1"></a>Before you run the analysis, check whether you inverted any outcomes.  </span>
<span id="cb18-237"><a href="#cb18-237" aria-hidden="true" tabindex="-1"></a>Set:</span>
<span id="cb18-238"><a href="#cb18-238" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb18-239"><a href="#cb18-239" aria-hidden="true" tabindex="-1"></a>use_flipped <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># ← make TRUE if you flipped outcomes; FALSE otherwise</span></span>
<span id="cb18-240"><a href="#cb18-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-241"><a href="#cb18-241" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-242"><a href="#cb18-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-243"><a href="#cb18-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-244"><a href="#cb18-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-245"><a href="#cb18-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-246"><a href="#cb18-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-249"><a href="#cb18-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-250"><a href="#cb18-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb18-251"><a href="#cb18-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb18-252"><a href="#cb18-252" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb18-253"><a href="#cb18-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| file: ../quarto/new_initial_quarto_document.qmd</span></span>
<span id="cb18-254"><a href="#cb18-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-255"><a href="#cb18-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-256"><a href="#cb18-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-257"><a href="#cb18-257" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="💡 Remember to customise!"}</span>
<span id="cb18-258"><a href="#cb18-258" aria-hidden="true" tabindex="-1"></a>This code chunk is a **template**. Run it once to generate boilerplate text, then:</span>
<span id="cb18-259"><a href="#cb18-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-260"><a href="#cb18-260" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Copy** the printed text into your manuscript.  </span>
<span id="cb18-261"><a href="#cb18-261" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Delete** any sections you don’t need.  </span>
<span id="cb18-262"><a href="#cb18-262" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Modify** the remaining text so it fits _your_ variables, sample, and research question.</span>
<span id="cb18-263"><a href="#cb18-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-264"><a href="#cb18-264" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-265"><a href="#cb18-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-266"><a href="#cb18-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results='asis'}</span></span>
<span id="cb18-267"><a href="#cb18-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false # ← set to `FALSE`, run once, then copy, delete, modify, extend as needed</span></span>
<span id="cb18-268"><a href="#cb18-268" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb18-269"><a href="#cb18-269" aria-hidden="true" tabindex="-1"></a>  boilerplate<span class="sc">::</span><span class="fu">boilerplate_generate_text</span>(</span>
<span id="cb18-270"><a href="#cb18-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">category    =</span> <span class="st">"methods"</span>,</span>
<span id="cb18-271"><a href="#cb18-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">sections    =</span> <span class="fu">c</span>(</span>
<span id="cb18-272"><a href="#cb18-272" aria-hidden="true" tabindex="-1"></a>      <span class="st">"student_sample.nzavs"</span>,</span>
<span id="cb18-273"><a href="#cb18-273" aria-hidden="true" tabindex="-1"></a>      <span class="st">"student_target_population"</span>,</span>
<span id="cb18-274"><a href="#cb18-274" aria-hidden="true" tabindex="-1"></a>      <span class="st">"eligibility.standard"</span>,</span>
<span id="cb18-275"><a href="#cb18-275" aria-hidden="true" tabindex="-1"></a>      <span class="st">"causal_intervention.grf_simple_text"</span>,</span>
<span id="cb18-276"><a href="#cb18-276" aria-hidden="true" tabindex="-1"></a>      <span class="st">"analytic_approach.general_approach_cate_long"</span>,</span>
<span id="cb18-277"><a href="#cb18-277" aria-hidden="true" tabindex="-1"></a>      <span class="st">"exposure_indicator"</span>,</span>
<span id="cb18-278"><a href="#cb18-278" aria-hidden="true" tabindex="-1"></a>      <span class="st">"causal_identification_criteria"</span>,</span>
<span id="cb18-279"><a href="#cb18-279" aria-hidden="true" tabindex="-1"></a>      <span class="st">"confounding_control.vanderweele"</span>,</span>
<span id="cb18-280"><a href="#cb18-280" aria-hidden="true" tabindex="-1"></a>      <span class="st">"statistical_models.grf_short_explanation"</span>,</span>
<span id="cb18-281"><a href="#cb18-281" aria-hidden="true" tabindex="-1"></a>      <span class="st">"missing_data.missing_grf_simple"</span>,</span>
<span id="cb18-282"><a href="#cb18-282" aria-hidden="true" tabindex="-1"></a>      <span class="st">"sensitivity_analysis.short_evalue"</span></span>
<span id="cb18-283"><a href="#cb18-283" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-284"><a href="#cb18-284" aria-hidden="true" tabindex="-1"></a>    <span class="at">global_vars =</span> global_vars,</span>
<span id="cb18-285"><a href="#cb18-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">db          =</span> unified_db</span>
<span id="cb18-286"><a href="#cb18-286" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-287"><a href="#cb18-287" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-288"><a href="#cb18-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb18-289"><a href="#cb18-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-290"><a href="#cb18-290" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pro Tip</span></span>
<span id="cb18-291"><a href="#cb18-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-292"><a href="#cb18-292" aria-hidden="true" tabindex="-1"></a>You can adjust figure by changing:</span>
<span id="cb18-293"><a href="#cb18-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-294"><a href="#cb18-294" aria-hidden="true" tabindex="-1"></a><span class="in">`#| fig-height: 16`</span> and <span class="in">`#| fig-width: 9`</span></span>
<span id="cb18-295"><a href="#cb18-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-296"><a href="#cb18-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-297"><a href="#cb18-297" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb18-298"><a href="#cb18-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-policy-6</span></span>
<span id="cb18-299"><a href="#cb18-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Decision Tree: {glued_policy_names_6}"</span></span>
<span id="cb18-300"><a href="#cb18-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb18-301"><a href="#cb18-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 16 # &lt;- change here</span></span>
<span id="cb18-302"><a href="#cb18-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9 # &lt;- change here</span></span>
<span id="cb18-303"><a href="#cb18-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-304"><a href="#cb18-304" aria-hidden="true" tabindex="-1"></a>policy_plots[[<span class="dv">6</span>]]</span>
<span id="cb18-305"><a href="#cb18-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-306"><a href="#cb18-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-307"><a href="#cb18-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-308"><a href="#cb18-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-309"><a href="#cb18-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-310"><a href="#cb18-310" aria-hidden="true" tabindex="-1"></a><span class="fu">## What You Have Learned </span></span>
<span id="cb18-311"><a href="#cb18-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-312"><a href="#cb18-312" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**How to create a publication quality manuscript** </span>
<span id="cb18-313"><a href="#cb18-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-314"><a href="#cb18-314" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**How to create a workflow for references** </span>
<span id="cb18-315"><a href="#cb18-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-316"><a href="#cb18-316" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**How to import results into your manuscript** </span>
<span id="cb18-317"><a href="#cb18-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-318"><a href="#cb18-318" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**How to make graphs of your results (using) `margot`** </span>
<span id="cb18-319"><a href="#cb18-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-320"><a href="#cb18-320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**How to report your results**</span>
<span id="cb18-321"><a href="#cb18-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-322"><a href="#cb18-322" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**How to interpret your results**</span>
<span id="cb18-323"><a href="#cb18-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-324"><a href="#cb18-324" aria-hidden="true" tabindex="-1"></a><span class="fu">## Frequently Asked Questions</span></span>
<span id="cb18-325"><a href="#cb18-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-326"><a href="#cb18-326" aria-hidden="true" tabindex="-1"></a><span class="fu">### Do I need to use 'quarto' for making my report?</span></span>
<span id="cb18-327"><a href="#cb18-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-328"><a href="#cb18-328" aria-hidden="true" tabindex="-1"></a>No. The suggested workflow should make your life *easier*. If, after a fair trial -- *and* after asking us for help -- <span class="in">`quarto`</span> still feels like extra friction, switch to whatever you like (<span class="in">`rmarkdown`</span>, plain <span class="in">`R`</span> scripts, or even Word). The science matters more than the wrapper. </span>
<span id="cb18-329"><a href="#cb18-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-330"><a href="#cb18-330" aria-hidden="true" tabindex="-1"></a>👉 Quick-start: <span class="ot">&lt;https://quarto.org/docs/get-started/&gt;</span></span>
<span id="cb18-331"><a href="#cb18-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-332"><a href="#cb18-332" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-333"><a href="#cb18-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-334"><a href="#cb18-334" aria-hidden="true" tabindex="-1"></a><span class="fu">### I cannot save or retrieve files from folders</span></span>
<span id="cb18-335"><a href="#cb18-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-336"><a href="#cb18-336" aria-hidden="true" tabindex="-1"></a>When hunting path errors, ask yourself:</span>
<span id="cb18-337"><a href="#cb18-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-338"><a href="#cb18-338" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Packages** – have I updated everything, especially **`margot`** and **`here`**?  </span>
<span id="cb18-339"><a href="#cb18-339" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Clean slate** – did I restart R (⌘⇧F10) *and* rerun the data-prep scripts from the top?  </span>
<span id="cb18-340"><a href="#cb18-340" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Project root** – am I inside the correct **RStudio Project**? Check with <span class="in">`here::here()`</span>.  </span>
<span id="cb18-341"><a href="#cb18-341" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Search** – have I used *Edit → Find in Files* (⌘⇧F / Ctrl⇧F) to locate the object or path?  </span>
<span id="cb18-342"><a href="#cb18-342" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Data really there?** – do the objects exist in my data frame?</span>
<span id="cb18-343"><a href="#cb18-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-344"><a href="#cb18-344" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb18-345"><a href="#cb18-345" aria-hidden="true" tabindex="-1"></a><span class="co"># waves where `variable_name` was measured</span></span>
<span id="cb18-346"><a href="#cb18-346" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(df_nz_long, <span class="fu">table</span>(variable_name, wave))</span>
<span id="cb18-347"><a href="#cb18-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-348"><a href="#cb18-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-349"><a href="#cb18-349" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Permissions / cloud sync** – is the save folder writable *and* local? Dropbox/OneDrive may off-load files; right-click and choose *Make available offline*.</span>
<span id="cb18-350"><a href="#cb18-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-351"><a href="#cb18-351" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-352"><a href="#cb18-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-353"><a href="#cb18-353" aria-hidden="true" tabindex="-1"></a><span class="fu">### I cannot run 'margot_causal_forest_parallel()'</span></span>
<span id="cb18-354"><a href="#cb18-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-355"><a href="#cb18-355" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Fallback** – does <span class="in">`margot_causal_forest()`</span> work? It is slower but prints progress.  </span>
<span id="cb18-356"><a href="#cb18-356" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Formula richness** – causal forests need many covariates <span class="co">[</span><span class="ot">@grf2024</span><span class="co">]</span>. Include the full demographic block.  </span>
<span id="cb18-357"><a href="#cb18-357" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Resources** – parallel forests spawn one worker per core. Keep some RAM free.  </span>
<span id="cb18-358"><a href="#cb18-358" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Reduce load** – try fewer trees or a smaller variable pool:</span>
<span id="cb18-359"><a href="#cb18-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-360"><a href="#cb18-360" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb18-361"><a href="#cb18-361" aria-hidden="true" tabindex="-1"></a>grf_defaults <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb18-362"><a href="#cb18-362" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed             =</span> <span class="dv">123</span>,</span>
<span id="cb18-363"><a href="#cb18-363" aria-hidden="true" tabindex="-1"></a>  <span class="at">stabilize.splits =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-364"><a href="#cb18-364" aria-hidden="true" tabindex="-1"></a>  <span class="at">num.trees        =</span> <span class="dv">1000</span>,  <span class="co"># fewer trees</span></span>
<span id="cb18-365"><a href="#cb18-365" aria-hidden="true" tabindex="-1"></a>  <span class="at">top_n_vars       =</span> <span class="dv">10</span>     <span class="co"># smaller policy-tree search space</span></span>
<span id="cb18-366"><a href="#cb18-366" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-367"><a href="#cb18-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-368"><a href="#cb18-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-369"><a href="#cb18-369" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-370"><a href="#cb18-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-371"><a href="#cb18-371" aria-hidden="true" tabindex="-1"></a><span class="fu">### I cannot run 'margot_flip_forests_parallel()'</span></span>
<span id="cb18-372"><a href="#cb18-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-373"><a href="#cb18-373" aria-hidden="true" tabindex="-1"></a>First test the serial version <span class="in">`margot_flip_forests()`</span>. All parallel caveats above apply.</span>
<span id="cb18-374"><a href="#cb18-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-375"><a href="#cb18-375" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-376"><a href="#cb18-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-377"><a href="#cb18-377" aria-hidden="true" tabindex="-1"></a><span class="fu">### My R code is not working</span></span>
<span id="cb18-378"><a href="#cb18-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-379"><a href="#cb18-379" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Update packages (<span class="in">`pak::pak()`</span> is handy).  </span>
<span id="cb18-380"><a href="#cb18-380" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Re-download the example code and run from the top.  </span>
<span id="cb18-381"><a href="#cb18-381" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Read the full error and traceback (<span class="in">`rlang::last_trace()`</span>).  </span>
<span id="cb18-382"><a href="#cb18-382" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare with the example: what is different in *your* data or model?</span>
<span id="cb18-383"><a href="#cb18-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-384"><a href="#cb18-384" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-385"><a href="#cb18-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-386"><a href="#cb18-386" aria-hidden="true" tabindex="-1"></a><span class="fu">### I do not know how 'margot' package functions work</span></span>
<span id="cb18-387"><a href="#cb18-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-388"><a href="#cb18-388" aria-hidden="true" tabindex="-1"></a>See the indexed reference: <span class="ot">&lt;https://go-bayes.github.io/margot/reference/index.html&gt;</span></span>
<span id="cb18-389"><a href="#cb18-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-390"><a href="#cb18-390" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-391"><a href="#cb18-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-392"><a href="#cb18-392" aria-hidden="true" tabindex="-1"></a><span class="fu">### What is the recommended workflow for investigating heterogeneity?</span></span>
<span id="cb18-393"><a href="#cb18-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-394"><a href="#cb18-394" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**State your causal question.** Statistics cannot rescue an ill-posed question.  </span>
<span id="cb18-395"><a href="#cb18-395" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Estimate the **ATE** for the target population.  </span>
<span id="cb18-396"><a href="#cb18-396" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Compute **CATEs** and evaluate gain at 20 % and 50 % budget constraints with the **Qini** metric.  </span>
<span id="cb18-397"><a href="#cb18-397" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>For outcomes with convincing heterogeneity, fit shallow **policy trees** (depth = 2) to obtain transparent rules.  </span>
<span id="cb18-398"><a href="#cb18-398" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Optionally, compare pre-specified subgroups directly.  </span>
<span id="cb18-399"><a href="#cb18-399" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Report **RATE–AUTOC** and **RATE–Qini** tables in an appendix.  </span>
<span id="cb18-400"><a href="#cb18-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-401"><a href="#cb18-401" aria-hidden="true" tabindex="-1"></a>*Take-away:* </span>
<span id="cb18-402"><a href="#cb18-402" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>start from a clean, updated project, </span>
<span id="cb18-403"><a href="#cb18-403" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>use recent scripts</span>
<span id="cb18-404"><a href="#cb18-404" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>read errors carefully, and </span>
<span id="cb18-405"><a href="#cb18-405" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ensure each step answers *your* research question.</span>
<span id="cb18-406"><a href="#cb18-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-407"><a href="#cb18-407" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-408"><a href="#cb18-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-409"><a href="#cb18-409" aria-hidden="true" tabindex="-1"></a><span class="fu">### I cannot create a 'quarto' document</span></span>
<span id="cb18-410"><a href="#cb18-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-411"><a href="#cb18-411" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>save the file with a <span class="in">`.qmd`</span> suffix **inside** the <span class="in">`quarto`</span> folder.  </span>
<span id="cb18-412"><a href="#cb18-412" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ensure the boilerplate directory structure exists (run Script 0 and Script 1).</span>
<span id="cb18-413"><a href="#cb18-413" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Run the initial code block line-by-line before hitting **Render**.  </span>
<span id="cb18-414"><a href="#cb18-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Define all <span class="in">`global_vars`</span> required by the boiler-plate.  </span>
<span id="cb18-415"><a href="#cb18-415" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The <span class="in">`new_initial_quarto_document.qmd`</span> template should work if you remember to set this value correctly: <span class="in">`use_flipped &lt;- TRUE`</span></span>
<span id="cb18-416"><a href="#cb18-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-417"><a href="#cb18-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-418"><a href="#cb18-418" aria-hidden="true" tabindex="-1"></a>::: {.callout-important title="⚠️ IMPORTANT: flipped outcomes"}</span>
<span id="cb18-419"><a href="#cb18-419" aria-hidden="true" tabindex="-1"></a>Again, before you run the analysis, check whether you inverted any outcomes.  </span>
<span id="cb18-420"><a href="#cb18-420" aria-hidden="true" tabindex="-1"></a>Set:</span>
<span id="cb18-421"><a href="#cb18-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-422"><a href="#cb18-422" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb18-423"><a href="#cb18-423" aria-hidden="true" tabindex="-1"></a>use_flipped <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># ← make TRUE if you flipped outcomes; FALSE otherwise</span></span>
<span id="cb18-424"><a href="#cb18-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-425"><a href="#cb18-425" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb18-426"><a href="#cb18-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-427"><a href="#cb18-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-428"><a href="#cb18-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-429"><a href="#cb18-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-430"><a href="#cb18-430" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If you are sticking with the old template and you are are *not* flipping outcomes, stub the flip variables:</span>
<span id="cb18-431"><a href="#cb18-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-432"><a href="#cb18-432" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb18-433"><a href="#cb18-433" aria-hidden="true" tabindex="-1"></a>flipped_names <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb18-434"><a href="#cb18-434" aria-hidden="true" tabindex="-1"></a>flip_outcomes <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb18-435"><a href="#cb18-435" aria-hidden="true" tabindex="-1"></a>flipped_list  <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb18-436"><a href="#cb18-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-437"><a href="#cb18-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-438"><a href="#cb18-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-439"><a href="#cb18-439" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-440"><a href="#cb18-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-441"><a href="#cb18-441" aria-hidden="true" tabindex="-1"></a><span class="fu">### I cannot render the 'quarto' document as PDF</span></span>
<span id="cb18-442"><a href="#cb18-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-443"><a href="#cb18-443" aria-hidden="true" tabindex="-1"></a>Install **TinyTeX** once:</span>
<span id="cb18-444"><a href="#cb18-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-445"><a href="#cb18-445" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb18-446"><a href="#cb18-446" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb18-447"><a href="#cb18-447" aria-hidden="true" tabindex="-1"></a>tinytex<span class="sc">::</span><span class="fu">install_tinytex</span>()</span>
<span id="cb18-448"><a href="#cb18-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-449"><a href="#cb18-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-450"><a href="#cb18-450" aria-hidden="true" tabindex="-1"></a>Then, in your YAML front-matter, comment out unwanted formats. For PDF-only output:</span>
<span id="cb18-451"><a href="#cb18-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-452"><a href="#cb18-452" aria-hidden="true" tabindex="-1"></a><span class="in">```yaml</span></span>
<span id="cb18-453"><a href="#cb18-453" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb18-454"><a href="#cb18-454" aria-hidden="true" tabindex="-1"></a><span class="co">  # docx:</span></span>
<span id="cb18-455"><a href="#cb18-455" aria-hidden="true" tabindex="-1"></a><span class="co">  #   default: false</span></span>
<span id="cb18-456"><a href="#cb18-456" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pdf</span><span class="kw">:</span></span>
<span id="cb18-457"><a href="#cb18-457" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">pdf-engine</span><span class="kw">:</span><span class="at"> lualatex</span></span>
<span id="cb18-458"><a href="#cb18-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-459"><a href="#cb18-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-460"><a href="#cb18-460" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-461"><a href="#cb18-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-462"><a href="#cb18-462" aria-hidden="true" tabindex="-1"></a><span class="fu">### Is it plagiarism to use the boiler-plate outputs verbatim?</span></span>
<span id="cb18-463"><a href="#cb18-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-464"><a href="#cb18-464" aria-hidden="true" tabindex="-1"></a>No—provided you clearly cite the source. The templates come from the  EPIC (Bulbulia) Lab and the data are simulated from New Zealand Attitudes and Values Study. Tailor your text to match your study and give credit. To edit, set <span class="in">`eval: false`</span>, render, and copy-paste the plain text blocks.</span>
<span id="cb18-465"><a href="#cb18-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-466"><a href="#cb18-466" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb18-467"><a href="#cb18-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-468"><a href="#cb18-468" aria-hidden="true" tabindex="-1"></a><span class="fu">### I do not have a boiler-plate template used in the example script</span></span>
<span id="cb18-469"><a href="#cb18-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-470"><a href="#cb18-470" aria-hidden="true" tabindex="-1"></a>Run **Script 0** and **Script 1** from the start; they refresh every template.</span>
<span id="cb18-471"><a href="#cb18-471" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-472"><a href="#cb18-472" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-475"><a href="#cb18-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-476"><a href="#cb18-476" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span>
<span id="cb18-477"><a href="#cb18-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-478"><a href="#cb18-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-479"><a href="#cb18-479" aria-hidden="true" tabindex="-1"></a><span class="fu">### My code was working with the old template, where can I find it? </span></span>
<span id="cb18-480"><a href="#cb18-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-481"><a href="#cb18-481" aria-hidden="true" tabindex="-1"></a>Here:</span>
<span id="cb18-482"><a href="#cb18-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-485"><a href="#cb18-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-486"><a href="#cb18-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb18-487"><a href="#cb18-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb18-488"><a href="#cb18-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| file: ../quarto/initial_quarto_document.qmd</span></span>
<span id="cb18-489"><a href="#cb18-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-490"><a href="#cb18-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-491"><a href="#cb18-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-492"><a href="#cb18-492" aria-hidden="true" tabindex="-1"></a> However, be careful to use 'models_binary' and 'labels_mapped_all' in place of <span class="in">`models_binary_flipped`</span> and <span class="in">`labels_mapped_all_flipped`</span> throughout if you did not flip your models.  I would rather advise that you use your the new code. </span>
<span id="cb18-493"><a href="#cb18-493" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>