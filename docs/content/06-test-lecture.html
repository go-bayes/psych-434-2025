<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.20">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph Bulbulia">
<meta name="dcterms.date" content="2025-04-01">

<title>Causal Inference: Effect Modification, Interaction, and Conditional Average Treatment Effects – PSYC 434 Conducting Research Across Cultures: Trimester 1, 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-94df807a54b4aea56b59f6b1a3567e79.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d5a3029baa3e394e88f18ffb9b51a21b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 434 Conducting Research Across Cultures: Trimester 1, 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../content/course-outline.html"> 
<span class="menu-text">Course Outline</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-content" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Content</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-content">    
        <li>
    <a class="dropdown-item" href="../content/glossary.pdf">
 <span class="dropdown-text">Glossary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/course-outline.html">
 <span class="dropdown-text">Course Outline</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/01-content.html">
 <span class="dropdown-text">Week 1: Course Introduction - R (installing packages)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/02-content.html">
 <span class="dropdown-text">Week 2: Causal Diagrams - Elementary Structures and Rules - R (using the interface)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/03-content.html">
 <span class="dropdown-text">Week 3: Causal Diagrams - Confounding Bias - R (regression/simulation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/04-content.html">
 <span class="dropdown-text">Week 4: Causal Diagrams - Interaction, Measurement Bias, Selection Bias - R (regression/simulation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/05-content.html">
 <span class="dropdown-text">Week 5: Causal Inference - Average Treatment Effects - R (regression/simulation: ATE)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/06-content.html">
 <span class="dropdown-text">Week 6: Conditional Average Treatment Effects (CATE) - R (regression/simulation: ATE)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/07-quiz.html">
 <span class="dropdown-text">Week 7: In Class Test</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/08-content.html">
 <span class="dropdown-text">Week 8: Causal Inference - Estimation of ATE and CATE - R and LaTeX</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/09-content.html">
 <span class="dropdown-text">Week 9: Hands On: A Full Study Analysis in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/10-content.html">
 <span class="dropdown-text">Week 10: Hands On: Writing Up Your Analysis: Quarto Documents</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/11-content.html">
 <span class="dropdown-text">Week 11: Measurement: Factor Analysis, CFA, MultiGroup CFA, Partial Invariance/ And How These Approaches Fail</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/12-content.html">
 <span class="dropdown-text">Week 12: Student Presentations</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Causal Inference: Effect Modification, Interaction, and Conditional Average Treatment Effects</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Joseph Bulbulia <a href="mailto:joseph.bulbulia@vuw.ac.nz" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-5861-2056" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Victoria University of Wellington, New Zealand
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 1, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#if-you-learn-nothing-else-from-this-course" id="toc-if-you-learn-nothing-else-from-this-course" class="nav-link active" data-scroll-target="#if-you-learn-nothing-else-from-this-course">If you learn nothing else from this course…</a></li>
  <li><a href="#causal-inference-begins-by-stating-a-counterfactual-contrast" id="toc-causal-inference-begins-by-stating-a-counterfactual-contrast" class="nav-link" data-scroll-target="#causal-inference-begins-by-stating-a-counterfactual-contrast">Causal inference begins by stating a counterfactual contrast</a></li>
  <li><a href="#in-causal-inference-what-do-interaction-and-effect-modification-mean" id="toc-in-causal-inference-what-do-interaction-and-effect-modification-mean" class="nav-link" data-scroll-target="#in-causal-inference-what-do-interaction-and-effect-modification-mean">In Causal Inference, What do ‘Interaction’ and ‘Effect Modification’ mean?</a></li>
  <li><a href="#interaction-the-effect-of-joint-interventions" id="toc-interaction-the-effect-of-joint-interventions" class="nav-link" data-scroll-target="#interaction-the-effect-of-joint-interventions">Interaction: The Effect of Joint Interventions</a>
  <ul class="collapse">
  <li><a href="#defining-interaction-with-a-counterfactual-contrast" id="toc-defining-interaction-with-a-counterfactual-contrast" class="nav-link" data-scroll-target="#defining-interaction-with-a-counterfactual-contrast">Defining Interaction with a Counterfactual Contrast</a></li>
  </ul></li>
  <li><a href="#effect-modification-variation-in-a-single-effect" id="toc-effect-modification-variation-in-a-single-effect" class="nav-link" data-scroll-target="#effect-modification-variation-in-a-single-effect">Effect Modification: Variation in a Single Effect</a>
  <ul class="collapse">
  <li><a href="#heterogeneous-treatment-effects-hte-the-phenomenon-of-variability" id="toc-heterogeneous-treatment-effects-hte-the-phenomenon-of-variability" class="nav-link" data-scroll-target="#heterogeneous-treatment-effects-hte-the-phenomenon-of-variability">Heterogeneous Treatment Effects (HTE): The Phenomenon of Variability</a></li>
  <li><a href="#conditional-average-treatment-effect-cate-a-specific-measure-taux" id="toc-conditional-average-treatment-effect-cate-a-specific-measure-taux" class="nav-link" data-scroll-target="#conditional-average-treatment-effect-cate-a-specific-measure-taux">Conditional Average Treatment Effect (CATE): A Specific Measure <span class="math inline">\tau(x)</span></a></li>
  <li><a href="#comparing-effect-heterogeneity-across-groups" id="toc-comparing-effect-heterogeneity-across-groups" class="nav-link" data-scroll-target="#comparing-effect-heterogeneity-across-groups">Comparing Effect Heterogeneity Across Groups</a></li>
  </ul></li>
  <li><a href="#estimating-conditional-average-treatment-effects-hattaux" id="toc-estimating-conditional-average-treatment-effects-hattaux" class="nav-link" data-scroll-target="#estimating-conditional-average-treatment-effects-hattaux">Estimating Conditional Average Treatment Effects: <span class="math inline">\hat{\tau}(X)</span></a>
  <ul class="collapse">
  <li><a href="#clarifying-individualised-treatment-effects-vs.-individual-effects" id="toc-clarifying-individualised-treatment-effects-vs.-individual-effects" class="nav-link" data-scroll-target="#clarifying-individualised-treatment-effects-vs.-individual-effects">Clarifying “Individualised” Treatment Effects vs.&nbsp;Individual Effects</a></li>
  <li><a href="#the-multidimensional-nature-of-individual-characteristics" id="toc-the-multidimensional-nature-of-individual-characteristics" class="nav-link" data-scroll-target="#the-multidimensional-nature-of-individual-characteristics">The Multidimensional Nature of Individual Characteristics</a></li>
  <li><a href="#why-estimate-cates-hattaux" id="toc-why-estimate-cates-hattaux" class="nav-link" data-scroll-target="#why-estimate-cates-hattaux">Why Estimate CATEs (<span class="math inline">\hat{\tau}(X)</span>)?</a></li>
  <li><a href="#methods-for-estimation-introducing-grf" id="toc-methods-for-estimation-introducing-grf" class="nav-link" data-scroll-target="#methods-for-estimation-introducing-grf">Methods for Estimation: Introducing <code>grf</code></a></li>
  <li><a href="#summary-key-distinctions" id="toc-summary-key-distinctions" class="nav-link" data-scroll-target="#summary-key-distinctions">Summary: Key Distinctions</a></li>
  </ul></li>
  <li><a href="#course-review-so-far" id="toc-course-review-so-far" class="nav-link" data-scroll-target="#course-review-so-far">Course Review So Far</a>
  <ul class="collapse">
  <li><a href="#the-core-idea-what-if" id="toc-the-core-idea-what-if" class="nav-link" data-scroll-target="#the-core-idea-what-if">The Core Idea: What If?</a></li>
  <li><a href="#this-lecture-interaction-vs.-effect-modification-vs.-individualised-treatment-effects" id="toc-this-lecture-interaction-vs.-effect-modification-vs.-individualised-treatment-effects" class="nav-link" data-scroll-target="#this-lecture-interaction-vs.-effect-modification-vs.-individualised-treatment-effects">This Lecture: Interaction vs.&nbsp;Effect Modification vs.&nbsp;Individualised Treatment Effects</a></li>
  </ul></li>
  <li><a href="#appendix-simplification-of-additive-interaction-formula" id="toc-appendix-simplification-of-additive-interaction-formula" class="nav-link" data-scroll-target="#appendix-simplification-of-additive-interaction-formula">Appendix: Simplification of Additive Interaction Formula</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<style>
  .boxedblue {
      border: 2px solid blue;
      border-radius: 4px; /* slight roundness */
      padding: 3px 6px; /* vertical | horizontal */
      display: inline-block;
      color: blue;
   }
  .circleblue {
      border: 2px dashed blue;
      border-radius: 50%;
      padding: 3px 6px;
      display: inline-block;
      color: blue;
   }
</style>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Required Reading</strong> - <span class="citation" data-cites="hernan2024WHATIF">(<a href="#ref-hernan2024WHATIF" role="doc-biblioref">Hernan and Robins 2020</a>)</span> Chapters 4-5 <a href="https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&amp;dl=0">link</a></p>
<p><strong>Optional Reading</strong> - <span class="citation" data-cites="vanderweele2007FOURTYPESOFEFFECT">(<a href="#ref-vanderweele2007FOURTYPESOFEFFECT" role="doc-biblioref">Tyler J. VanderWeele and Robins 2007</a>)</span> <a href="https://www.dropbox.com/scl/fi/drytp2ui2b8o9jplh4bm9/four_types_of_effect_modification__a.6.pdf?rlkey=mb9nl599v93m6kyyo69iv5nz1&amp;dl=0">link</a> - <span class="citation" data-cites="vanderweele2009distinction">(<a href="#ref-vanderweele2009distinction" role="doc-biblioref">Tyler J. VanderWeele 2009</a>)</span> <a href="https://www.dropbox.com/scl/fi/srpynr0dvjcndveplcydn/OutcomeWide_StatisticalScience.pdf?rlkey=h4fv32oyjegdfl3jq9u1fifc3&amp;dl=0">link</a></p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="ref-vanderweele2009distinction" class="csl-entry" role="listitem">
VanderWeele, Tyler J. 2009. <span>“On the Distinction Between Interaction and Effect Modification.”</span> <em>Epidemiology</em>, 863–71.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-vanderweele2007FOURTYPESOFEFFECT" class="csl-entry" role="listitem">
VanderWeele, Tyler J., and James M. Robins. 2007. <span>“Four types of effect modification: a classification based on directed acyclic graphs.”</span> <em>Epidemiology (Cambridge, Mass.)</em> 18 (5): 561–68. <a href="https://doi.org/10.1097/EDE.0b013e318127181b">https://doi.org/10.1097/EDE.0b013e318127181b</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-hernan2024WHATIF" class="csl-entry" role="listitem">
Hernan, M. A., and J. M. Robins. 2020. <em>Causal Inference: What If?</em> Chapman &amp; Hall/CRC Monographs on Statistics &amp; Applied Probab. Taylor &amp; Francis. <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/</a>.
</div></div><div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Concepts for Assessment
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Causal Estimand</li>
<li>Statistical Estimand</li>
<li>Interaction</li>
<li>Effect Modification</li>
<li>Heterogeneous Treatment Effects (HTE)</li>
<li>Conditional Average Treatment Effect (CATE) <span class="math inline">\tau(x)</span></li>
<li>Estimated Conditional Average Treatment Effect <span class="math inline">\hat{\tau}(X)</span> # Added estimator for clarity</li>
</ul>
</div>
</div>
<section id="if-you-learn-nothing-else-from-this-course" class="level2">
<h2 class="anchored" data-anchor-id="if-you-learn-nothing-else-from-this-course">If you learn nothing else from this course…</h2>
<p>To answer a psychological question scientifically, we must first state it precisely. Causal inference provides the framework for doing so.</p>
</section>
<section id="causal-inference-begins-by-stating-a-counterfactual-contrast" class="level2">
<h2 class="anchored" data-anchor-id="causal-inference-begins-by-stating-a-counterfactual-contrast">Causal inference begins by stating a counterfactual contrast</h2>
<p>In the simplest case, we define a contrast between potential outcomes under two or more alternative conditions, often called “treatments” or “exposures” (denoted <span class="math inline">A</span>). For an outcome <span class="math inline">Y</span>, we might compare the potential outcome if everyone received treatment level <span class="math inline">a^*</span> versus if everyone received treatment level <span class="math inline">a</span>. The average difference in the population is the Average Treatment Effect (ATE):</p>
<p><span class="math display">
\text{ATE} = \mathbb{E}[Y(a^*) - Y(a)]
</span></p>
<p>Understanding causal inference involves comparing what actually happened with what <em>could have happened</em> (counterfactuals) on average, under different specified conditions, within a defined target population. A crucial part of this process involves identifying and accounting for factors (confounders) that could distort the comparison and lead to incorrect conclusions about the causal question asked.</p>
</section>
<section id="in-causal-inference-what-do-interaction-and-effect-modification-mean" class="level2">
<h2 class="anchored" data-anchor-id="in-causal-inference-what-do-interaction-and-effect-modification-mean">In Causal Inference, What do ‘Interaction’ and ‘Effect Modification’ mean?</h2>
<p>We often encounter terms like ‘moderation’ and ‘interaction’ used loosely in psychological science. Causal inference demands greater precision. We will set aside the ambiguous term ‘moderation’ and focus on clearly distinguishing two specific concepts using the counterfactual framework:</p>
<ol type="1">
<li><strong>Interaction</strong></li>
<li><strong>Effect Modification</strong></li>
</ol>
</section>
<section id="interaction-the-effect-of-joint-interventions" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="interaction-the-effect-of-joint-interventions">Interaction: The Effect of Joint Interventions</h2>
<p>In the framework of causal inference, <strong>interaction</strong> specifically relates to evaluating a <strong>joint intervention</strong>. We are interested in the combined causal effect when we simultaneously intervene on <em>two (or more) distinct treatments</em> or exposures.</p>
<p>Let these distinct treatments be <span class="math inline">A</span> and <span class="math inline">B</span>, and the outcome be <span class="math inline">Y</span>.</p>
<p>Recall the potential outcome under a single intervention setting <span class="math inline">A</span> to level <span class="math inline">\tilde{a}</span> is <span class="math inline">Y(\tilde{a})</span>. We typically aim to identify this from observational data using assumptions such as consistency (<span class="math inline">Y_i(\tilde{a}) = (Y_i |A_i = \tilde{a})</span> for individual <span class="math inline">i</span>) and conditional exchangeability (no unmeasured confounding) given a set of measured covariates <span class="math inline">L</span>: <span class="math inline">Y(\tilde{a}) \perp\kern-5pt\perp A | L</span>. The set <span class="math inline">L</span> must be sufficient to block all non-causal (backdoor) paths between <span class="math inline">A</span> and <span class="math inline">Y</span>.</p>
<p>When considering a joint intervention on both <span class="math inline">A</span> and <span class="math inline">B</span>, we extend the notation to <span class="math inline">Y(\tilde{a}, \tilde{b})</span>. This represents the potential outcome if treatment <span class="math inline">A</span> were set to <span class="math inline">\tilde{a}</span> <em>and</em> treatment <span class="math inline">B</span> were set to <span class="math inline">\tilde{b}</span> for an individual or population.</p>
<p>Identification of <span class="math inline">Y(\tilde{a}, \tilde{b})</span> requires analogous assumptions for both interventions. In addition to needing <span class="math inline">L</span> for the <span class="math inline">A \to Y</span> relationship (<span class="math inline">Y(\tilde{a}) \perp\kern-5pt\perp A | L</span>), we also need a set of covariates <span class="math inline">Q</span> sufficient to ensure conditional exchangeability for the <span class="math inline">B \to Y</span> relationship: <span class="math inline">Y(\tilde{b}) \perp\kern-5pt\perp B | Q</span>. Consistency must also hold for <span class="math inline">B</span>.</p>
<p>The sets of required covariates <span class="math inline">L</span> and <span class="math inline">Q</span> may overlap (<span class="math inline">L \cap Q \not\equiv \emptyset</span>). Critically, identifying causal interaction requires sufficient data to control for <em>all</em> variables in the union of these sets, <span class="math inline">L \cup Q</span>.</p>
<section id="defining-interaction-with-a-counterfactual-contrast" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="defining-interaction-with-a-counterfactual-contrast">Defining Interaction with a Counterfactual Contrast</h3>
<p>Let’s use an educational example. Consider the effect of a new teaching method (treatment <span class="math inline">A</span>: 1=New, 0=Old) on student test scores (outcome <span class="math inline">Y</span>). Suppose we are also interested in the effect of providing extra tutoring (treatment <span class="math inline">B</span>: 1=Yes, 0=No). We want to assess the individual and combined effects of <span class="math inline">A</span> and <span class="math inline">B</span> on test scores, perhaps on the difference scale (additive scale).</p>
<p>Using counterfactuals, we define <strong>causal interaction on the additive scale</strong> as occurring when the effect of intervening on both <span class="math inline">A</span> and <span class="math inline">B</span> simultaneously differs from the sum of the effects of intervening on each one individually (always relative to a common baseline, usually <span class="math inline">A=0, B=0</span>). The interaction is non-zero if:</p>
<p><span class="math display">
\bigg(\underbrace{\mathbb{E}[Y(1,1)]}_{\text{joint intervention}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither intervention}}\bigg) - \bigg[ \bigg(\underbrace{\mathbb{E}[Y(1,0)]}_{\text{only A intervention}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither intervention}}\bigg) + \bigg(\underbrace{\mathbb{E}[Y(0,1)]}_{\text{only B intervention}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither intervention}} \bigg)\bigg] \neq 0
</span></p>
<p>This expression simplifies to the standard definition of additive interaction (see appendix):</p>
<p><span class="math display">
\underbrace{\mathbb{E}[Y(1,1)]}_{\text{joint}} - \underbrace{\mathbb{E}[Y(1,0)]}_{\text{only A}} - \underbrace{\mathbb{E}[Y(0,1)]}_{\text{only B}} + \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither}} \neq 0
</span></p>
<p>This specific quantity is the causal estimand for additive interaction. It captures the extent to which the joint effect deviates from additivity. A positive value implies synergy (superadditivity); a negative value implies antagonism (subadditivity). Note the definition is symmetric regarding <span class="math inline">A</span> and <span class="math inline">B</span>: <span class="math inline">Y(\tilde{a}, \tilde{b}) \equiv Y(\tilde{b}, \tilde{a})</span>.</p>
<p><em>(Other scales, like the multiplicative/ratio scale, can define interaction, potentially leading to different conclusions. The choice of scale should always be justified.)</em></p>
<section id="identification-of-causal-interaction" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="identification-of-causal-interaction">Identification of Causal Interaction</h4>
<p>To estimate this causal interaction from data, we must identify all four potential outcome means: <span class="math inline">\mathbb{E}[Y(0,0)]</span>, <span class="math inline">\mathbb{E}[Y(1,0)]</span>, <span class="math inline">\mathbb{E}[Y(0,1)]</span>, and <span class="math inline">\mathbb{E}[Y(1,1)]</span>. This requires controlling for confounding factors for <em>both</em> the <span class="math inline">A \to Y</span> relationship and the <span class="math inline">B \to Y</span> relationship. The causal diagram in <a href="#fig-dag-interaction" class="quarto-xref">Figure&nbsp;1</a> illustrates this requirement.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-interaction" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-test-lecture_files/figure-html/fig-dag-interaction-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Diagram illustrating causal interaction. Assessing the joint effect of two interventions, A (e.g., teaching method) and B (e.g., tutoring), on outcome Y (e.g., test score). L represents confounders of the A-Y relationship, and Q represents confounders of the B-Y relationship. Red arrows indicate biasing backdoor paths requiring adjustment. Assumes A and B are decided independently here.
</figcaption>
</figure>
</div>
</div>
</div>
<p>As shown in <a href="#fig-dag-interaction-solved" class="quarto-xref">Figure&nbsp;2</a>, identifying the causal interaction requires conditioning on (adjusting for) <em>both</em> sets of confounders, <span class="math inline">L_0</span> and <span class="math inline">Q_0</span>, blocking the backdoor paths.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-interaction-solved" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-interaction-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-test-lecture_files/figure-html/fig-dag-interaction-solved-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-interaction-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Identification of causal interaction requires adjusting for all confounders of A-Y (L) and B-Y (Q). Boxes around L and Q indicate conditioning, closing backdoor paths.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In our education example: <strong>L (confounders of Teaching Method -&gt; Score):</strong> Prior student achievement, student motivation, socioeconomic status (SES), school resources, teacher experience/quality (if method not randomly assigned across teachers).</p>
<p><strong>Q (confounders of Tutoring -&gt; Score):</strong> Prior student achievement, student motivation, parental involvement/SES (influencing access/payment for tutoring), student time availability, specific learning needs.</p>
<p>Here, <span class="math inline">L \cap Q</span> clearly includes prior achievement and student motivation. Therefore, <span class="math inline">L \cup Q</span> is a potentially large set of variables requiring measurement and adjustment. Failure to adequately control for <span class="math inline">L \cup Q</span> leads to biased estimates of causal interaction.</p>
</section>
</section>
</section>
<section id="effect-modification-variation-in-a-single-effect" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="effect-modification-variation-in-a-single-effect">Effect Modification: Variation in a Single Effect</h2>
<p>Distinct from <strong>interaction</strong> (which involves joint interventions), <strong>effect modification</strong> examines whether the causal effect of a <em>single</em> intervention (<span class="math inline">A</span>) on an outcome (<span class="math inline">Y</span>) differs across subgroups within a population. These subgroups are typically defined by baseline characteristics (<span class="math inline">G</span> or <span class="math inline">X</span>), which may or may not be modifiable themselves. Understanding effect modification helps identify for whom an intervention is most (or least) effective. We explore this potential variability using concepts like Heterogeneous Treatment Effects (HTE) and Conditional Average Treatment Effects (CATE).</p>
<section id="heterogeneous-treatment-effects-hte-the-phenomenon-of-variability" class="level3">
<h3 class="anchored" data-anchor-id="heterogeneous-treatment-effects-hte-the-phenomenon-of-variability">Heterogeneous Treatment Effects (HTE): The Phenomenon of Variability</h3>
<p><strong>Heterogeneous Treatment Effects (HTE)</strong> refers to the <em>phenomenon</em> where the causal effect of an intervention (<span class="math inline">A</span> on <span class="math inline">Y</span>) is not constant across all individuals or subgroups. This <em>is</em> effect modification. The variability might stem from differences in observed characteristics (like age, sex, or prior conditions captured in measured covariates <span class="math inline">X</span>) or unobserved factors (like genetics, unmeasured environmental factors, or personal history). HTE reflects the reality that interventions rarely affect everyone identically.</p>
<p>Identifying the full extent of HTE, especially variation due to unobserved factors, is challenging because individual causal effects are generally not point identifiable.</p>
</section>
<section id="conditional-average-treatment-effect-cate-a-specific-measure-taux" class="level3">
<h3 class="anchored" data-anchor-id="conditional-average-treatment-effect-cate-a-specific-measure-taux">Conditional Average Treatment Effect (CATE): A Specific Measure <span class="math inline">\tau(x)</span></h3>
<p>To investigate HTE using observable data, we focus on estimating the <strong>Conditional Average Treatment Effect (CATE)</strong>. CATE is a specific causal <em>estimand</em>: the average treatment effect <em>conditional on observed covariates</em> <span class="math inline">X</span> taking a specific value or set of values <span class="math inline">x</span>.</p>
<p><span class="math display">
\tau(x) = \text{CATE}(x) = \mathbb{E}[Y(1) - Y(0) | X = x]
</span></p>
<p>Estimating <span class="math inline">\text{CATE}(x)</span> (denoted <span class="math inline">\tau(x)</span>) for different values of <span class="math inline">x</span> allows us to quantify effect modification by the <em>measured</em> characteristics <span class="math inline">X</span>. It is a primary tool for studying the broader HTE phenomenon, answering: How does the average effect of <span class="math inline">A</span> differ for individuals with specific observed characteristics <span class="math inline">X=x</span>?</p>
</section>
<section id="comparing-effect-heterogeneity-across-groups" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="comparing-effect-heterogeneity-across-groups">Comparing Effect Heterogeneity Across Groups</h3>
<p>A direct way to assess effect modification by a categorical variable <span class="math inline">G</span> (e.g., comparing effects between males and females, or across different study sites) is to compare the average treatment effect (ATE) estimated <em>within</em> each level of <span class="math inline">G</span>. This involves comparing CATEs where the conditioning variable <span class="math inline">X</span> is simply the group indicator <span class="math inline">G</span>.</p>
<p>We define the causal estimand that compares two conditional average treatment effects between levels <span class="math inline">g</span> and <span class="math inline">g'</span> of variable <span class="math inline">G</span>:</p>
<p><span class="math display">
{\gamma} = \overbrace{\big( \mathbb{E}[Y(a^*)|G=g] - \mathbb{E}[Y(a)|G=g] \big)}^{{\delta_g=\text{CATE}(G=g)}} - \overbrace{\big(\mathbb{E}[Y(a^*)|G=g^{\prime}]- \mathbb{E}[Y(a)|G=g']\big)}^{{\delta_{g^{\prime}}=\text{CATE}(G=g')}}
</span></p>
<p>Let <span class="math inline">A</span> be the treatment (e.g., <span class="math inline">a=0</span> to <span class="math inline">a^*=1</span>), <span class="math inline">G</span> the potential effect-modifier (e.g., sex: <span class="math inline">g=</span>female, <span class="math inline">g'=</span>male), and <span class="math inline">Y</span> the outcome. The analysis assesses whether <span class="math inline">\delta</span>, the effect of <span class="math inline">A</span> on <span class="math inline">Y</span>, differs across levels of <span class="math inline">G</span>.</p>
<p>For example, comparing the causal effect of an intervention for females (<span class="math inline">G=g_1</span>) versus males (<span class="math inline">G=g_2</span>):</p>
<ol type="1">
<li><p><strong>Causal effect within females (<span class="math inline">G=g_1</span>):</strong> <span class="math display">
\delta_{g_1} = \mathbb{E}[Y(1)|G= g_1] - \mathbb{E}[Y(0)|G = g_1]
</span></p></li>
<li><p><strong>Causal effect within males (<span class="math inline">G=g_2</span>):</strong> <span class="math display">
\delta_{g_2} = \mathbb{E}[Y(1)|G=g_2] - \mathbb{E}[Y(0)|G=g_2]
</span></p></li>
<li><p><strong>Comparing causal effects across groups:</strong> <span class="math display">
{\gamma} = {\delta}_{g_1} - {\delta}_{g_2}
</span> A non-zero estimate <span class="math inline">\hat{\gamma}</span> indicates effect modification by <span class="math inline">G</span>. The intervention’s effect differs between females and males. Note that <span class="math inline">\hat{\gamma} \neq 0</span> can occur even if one group’s effect (<span class="math inline">\hat{\delta}_{g_1}</span> or <span class="math inline">\hat{\delta}_{g_2}</span>) is near zero.</p></li>
</ol>
<section id="identification-of-effect-modification" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="identification-of-effect-modification">Identification of Effect Modification</h4>
<p>To identify group-specific effects (<span class="math inline">\delta_g, \delta_{g'}</span>) and their difference (<span class="math inline">\gamma</span>), we need to ensure exchangeability for <span class="math inline">A</span> holds <em>within</em> each stratum defined by <span class="math inline">G</span>. That is, we must control for confounders (<span class="math inline">L</span>) of the <span class="math inline">A \to Y</span> relationship, potentially allowing <span class="math inline">L</span> itself to be associated with <span class="math inline">G</span>. Crucially, since <span class="math inline">G</span> defines the subpopulations of interest and is not (usually) the intervention itself, we do <em>not</em> necessarily need to control for factors (<span class="math inline">Q</span>) that cause <span class="math inline">G</span>, unless those factors also confound the <span class="math inline">A \to Y</span> relationship (i.e., if <span class="math inline">Q \subseteq L</span>).</p>
<p>Referencing <a href="#fig-dag-effect-modification" class="quarto-xref">Figure&nbsp;3</a>: To estimate the <span class="math inline">A \to Y</span> effect within levels of <span class="math inline">G</span>, we must adjust for <span class="math inline">L_0</span>. Adjusting for <span class="math inline">Q</span> (causes of G) is necessary only if <span class="math inline">Q</span> is also in <span class="math inline">L_0</span>.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-effect-modification" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-effect-modification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-test-lecture_files/figure-html/fig-dag-effect-modification-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-effect-modification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Imagine A is an experiment. How shall we investigate effect modification of A on Y by Z? Can you see why regression coefficients will not work?
</figcaption>
</figure>
</div>
</div>
</div>
<p>The primary identification challenge for effect modification lies in adequately controlling for the <span class="math inline">A \to Y</span> confounders (<span class="math inline">L</span>) within each subgroup defined by <span class="math inline">G</span> or <span class="math inline">X</span>. Next week, we turn our focus to statistical estimation.</p>
</section>
</section>
</section>
<section id="estimating-conditional-average-treatment-effects-hattaux" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="estimating-conditional-average-treatment-effects-hattaux">Estimating Conditional Average Treatment Effects: <span class="math inline">\hat{\tau}(X)</span></h2>
<p>In the previous section, we defined the Conditional Average Treatment Effect (CATE), <span class="math inline">\tau(x)</span>, as a key causal estimand for understanding effect modification by observed covariates <span class="math inline">X</span>:</p>
<p><span class="math display">
\tau(x) = \mathbb{E}[Y(1) - Y(0) | X = x]
</span></p>
<p>This represents the <em>true</em> average treatment effect within the specific subpopulation where individuals share the covariate profile <span class="math inline">X=x</span>. It quantifies how the average effect of intervention <span class="math inline">A</span> varies according to baseline characteristics <span class="math inline">X</span>.</p>
<p>Our focus now shifts to <em>estimating</em> this CATE function from observed data. We denote the statistical estimate, derived from our sample, as <span class="math inline">\hat{\tau}(X)</span>. For any individual <span class="math inline">i</span> in our study with observed baseline covariates <span class="math inline">X_i</span>, the value <span class="math inline">\hat{\tau}(X_i)</span> represents our data-driven prediction of the average treatment effect <em>for the subgroup of individuals possessing characteristics like <span class="math inline">X_i</span></em>.</p>
<section id="clarifying-individualised-treatment-effects-vs.-individual-effects" class="level3">
<h3 class="anchored" data-anchor-id="clarifying-individualised-treatment-effects-vs.-individual-effects">Clarifying “Individualised” Treatment Effects vs.&nbsp;Individual Effects</h3>
<p>You might recall our earlier discussion highlighting that <em>true individual causal effects</em>—the effect of treatment for a single specific person, <span class="math inline">Y_i(1) - Y_i(0)</span>—are generally impossible to identify from data. This might seem contradictory to the goal of estimating “individualised” treatment effects.</p>
<p>The essential distinction lies in the interpretation:</p>
<ul>
<li><p><strong>Individual Causal Effect (Unobservable):</strong> <span class="math inline">Y_i(1) - Y_i(0)</span> is the precise effect for person <span class="math inline">i</span>. We cannot observe both potential outcomes for the same person simultaneously.</p></li>
<li><p><strong>Estimated Conditional Average Treatment Effect (CATE estimate):</strong> <span class="math inline">\hat{\tau}(X_i)</span> is an estimate of the <em>average</em> effect <span class="math inline">\mathbb{E}[Y(1) - Y(0) | X = X_i]</span> within the stratum, or subgroup, of the population who share the observable characteristics <span class="math inline">X_i</span>.</p></li>
</ul>
<p>The term “individualised” or “personalised” treatment effect, in this context, acknowledges that our <em>prediction</em> <span class="math inline">\hat{\tau}(X_i)</span> is tailored to the <em>specific covariate profile <span class="math inline">X_i</span></em> of an individual. However, it crucially represents an <strong>estimated average effect for a subgroup</strong>, not the unique causal effect for that one person. It is our best estimate of the average response for the <em>type</em> of individual defined by <span class="math inline">X_i</span>, based on the observed data and the chosen model.</p>
</section>
<section id="the-multidimensional-nature-of-individual-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="the-multidimensional-nature-of-individual-characteristics">The Multidimensional Nature of Individual Characteristics</h3>
<p>An important reality is that individuals do not belong to just one group; they simultaneously belong to many overlapping groups defined by their multidimensional characteristics. For example, a student might be:</p>
<ul>
<li>Female (gender)</li>
<li>14 years old (age)</li>
<li>From a low-income household (socioeconomic status)</li>
<li>High-achieving in previous assessments (prior performance)</li>
<li>Attending a rural school (location)</li>
<li>Highly motivated (psychological trait)</li>
</ul>
<p>Each of these characteristics, and their combinations, might influence how the student responds to an intervention. The challenge becomes estimating treatment effects that account for this multidimensional reality.</p>
<p>Traditional approaches using regression with manually specified interaction terms quickly become unwieldy when trying to model all relevant combinations (e.g., <code>A*gender*age*income*prior_performance*location*motivation</code>). With even a modest number of covariates, we face problems including:</p>
<ul>
<li>Insufficient data within many specific covariate combinations (strata).</li>
<li>Inflated risks of false positives due to multiple testing.</li>
<li>Difficulties in model specification, complexity, and interpretation.</li>
<li>An inability to discover unexpected interaction patterns without pre-specifying them.</li>
</ul>
<p>Modern methods like causal forests address this challenge by:</p>
<ol type="1">
<li><p><strong>Considering the full covariate space simultaneously:</strong> Instead of requiring researchers to pre-specify interaction terms, causal forests automatically search for patterns of effect heterogeneity across the multidimensional covariate space (<span class="math inline">X</span>).</p></li>
<li><p><strong>Adaptive complexity:</strong> The algorithm adapts to the data, splitting on variables and combinations that best differentiate treatment effects, while using regularisation techniques to avoid overfitting.</p></li>
<li><p><strong>Local averaging:</strong> Causal forests effectively perform a weighted local averaging. For each individual <span class="math inline">i</span>, the estimate <span class="math inline">\hat{\tau}(X_i)</span> is derived by considering the outcomes of similar individuals (i.e., “neighbours” in the covariate space <span class="math inline">X</span>).</p></li>
<li><p><strong>Honest estimation:</strong> By employing techniques like sample splitting (using separate parts of the data for building the tree structure and estimating the effects within the leaves) or out-of-bag estimation, causal forests aim to provide statistically valid (“honest”) estimates with appropriate confidence intervals.</p></li>
</ol>
<p>The result is that for each individual <span class="math inline">i</span> with covariates <span class="math inline">X_i</span>, we obtain an estimate <span class="math inline">\hat{\tau}(X_i)</span> reflecting the predicted treatment effect given their particular combination of characteristics. While still not a true individual causal effect, this approach acknowledges and leverages the multidimensional nature of individual differences.</p>
</section>
<section id="why-estimate-cates-hattaux" class="level3">
<h3 class="anchored" data-anchor-id="why-estimate-cates-hattaux">Why Estimate CATEs (<span class="math inline">\hat{\tau}(X)</span>)?</h3>
<p>Estimating the CATE function <span class="math inline">\hat{\tau}(X)</span> is the primary statistical approach for investigating the phenomenon of Heterogeneous Treatment Effects (HTE) using measured baseline variables <span class="math inline">X</span>. By examining how the estimated effect <span class="math inline">\hat{\tau}(X)</span> changes across different covariate profiles <span class="math inline">X</span>, we aim to:</p>
<ol type="1">
<li><p><strong>Explore Effect Heterogeneity:</strong> Move beyond the single summary statistic of the Average Treatment Effect (ATE) to understand if, how, and potentially by which observed factors the intervention’s impact varies across the population.</p></li>
<li><p><strong>Identify Potential Subgroups:</strong> Discover if specific subgroups, defined by their baseline characteristics <span class="math inline">X</span>, experience substantially different benefits (or harms) from the intervention.</p></li>
<li><p><strong>Inform Potential Targeting:</strong> Use the predictions <span class="math inline">\hat{\tau}(X_i)</span> as a basis for exploring whether tailoring treatment decisions could lead to better overall outcomes. This involves evaluating whether strategies based on <span class="math inline">\hat{\tau}(X_i)</span> outperform uniform treatment approaches, assessed using tools like RATE and Qini curves (discussed later).</p></li>
</ol>
</section>
<section id="methods-for-estimation-introducing-grf" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="methods-for-estimation-introducing-grf">Methods for Estimation: Introducing <code>grf</code></h3>
<p>While traditional regression models incorporating interaction terms (e.g., <code>lm(Y ~ A * X1 + A * X2)</code>) can estimate CATEs under specific assumptions (like linearity and correct model specification), they often struggle with complex scenarios involving many potential effect modifiers (<span class="math inline">X</span>) or non-linear relationships.</p>
<p>Modern machine learning methods, particularly <strong>causal forests</strong> as implemented in the R package <code>grf</code> <span class="citation" data-cites="grf2024">(<a href="#ref-grf2024" role="doc-biblioref">Tibshirani et al. 2024</a>)</span>, are specifically designed for estimating CATEs (<span class="math inline">\hat{\tau}(X)</span>) flexibly and robustly. Causal forests adapt the random forest algorithm for causal inference. Instead of building trees simply to predict the outcome <span class="math inline">Y</span>, they construct trees that explicitly maximise the heterogeneity in estimated treatment effects between leaves. This design allows them to:</p>
<div class="no-row-height column-margin column-container"><div id="ref-grf2024" class="csl-entry" role="listitem">
Tibshirani, Julie, Susan Athey, Erik Sverdrup, and Stefan Wager. 2024. <em>Grf: Generalized Random Forests</em>. <a href="https://github.com/grf-labs/grf">https://github.com/grf-labs/grf</a>.
</div></div><ul>
<li>Handle a large number of potential covariates (<span class="math inline">X</span>) simultaneously.</li>
<li>Capture complex, non-linear interactions between covariates and the treatment effect without pre-specification.</li>
<li>Avoid strong parametric assumptions about the functional form of <span class="math inline">\tau(X)</span>.</li>
</ul>
<p>The output of a causal forest is typically a prediction <span class="math inline">\hat{\tau}(X_i)</span> for each individual <span class="math inline">i</span> in the dataset (ideally, an evaluation dataset distinct from the training data to prevent overfitting). We will demonstrate these methods after the mid-term break and clarify how they facilitate the development of treatment prioritisation rules. Such rules, often assuming fixed budgets, help determine policy regarding whether and when assigning treatment based on pre-treatment covariates is advantageous.</p>
</section>
<section id="summary-key-distinctions" class="level3">
<h3 class="anchored" data-anchor-id="summary-key-distinctions">Summary: Key Distinctions</h3>
<p>This lecture has introduced several interconnected but distinct concepts:</p>
<ul>
<li><p><strong>Interaction:</strong> Concerns the <em>joint causal effect</em> of <em>two or more distinct interventions</em> (<span class="math inline">A</span> and <span class="math inline">B</span>) on an outcome (<span class="math inline">Y</span>). It asks if the effect of intervening on both differs from the sum of their individual intervention effects. The estimand involves joint potential outcomes like <span class="math inline">\mathbb{E}[Y(a,b)]</span>. Identification requires controlling confounders for <em>all</em> involved interventions (<span class="math inline">L \cup Q</span>).</p></li>
<li><p><strong>Effect Modification:</strong> Concerns how the causal effect of a <em>single intervention</em> (<span class="math inline">A</span>) on an outcome (<span class="math inline">Y</span>) <em>varies</em> across subgroups defined by a baseline characteristic (<span class="math inline">G</span> or <span class="math inline">X</span>). It asks if the effect, <span class="math inline">\mathbb{E}[Y(1) - Y(0)]</span>, changes depending on the level of <span class="math inline">G</span> or <span class="math inline">X</span>.</p></li>
<li><p><strong>HTE</strong> is the general <em>phenomenon</em> of such effect variability.</p></li>
<li><p><strong>CATE</strong> (<span class="math inline">\tau(x) = \mathbb{E}[Y(1) - Y(0) | X=x]</span>) is the specific <em>causal estimand</em> used to <em>quantify</em> this variability based on <em>observed</em> covariates <span class="math inline">X</span>. Comparing CATEs across levels of <span class="math inline">G</span> or <span class="math inline">X</span> assesses effect modification by measured factors.</p></li>
<li><p><strong>Estimated Individualised Treatment Effects (<span class="math inline">\hat{\tau}(X_i)</span>):</strong> Refers to our data-derived <em>estimates</em> of treatment effects tailored to individuals’ specific combinations of observed characteristics (<span class="math inline">X_i</span>).</p>
<ul>
<li>These are <strong>not</strong> true individual causal effects (<span class="math inline">Y_i(1) - Y_i(0)</span>), which remain fundamentally unobservable. They estimate the CATE for the subgroup defined by <span class="math inline">X = X_i</span>.</li>
<li>Modern methods like causal forests generate these predictions <span class="math inline">\hat{\tau}(X_i)</span> by considering the multidimensional covariate profile <span class="math inline">X_i</span> without requiring pre-specification of effect modifiers.</li>
<li>These estimates acknowledge that individuals exist at the intersection of many characteristics simultaneously.</li>
<li>They form the basis for evaluating whether personalised treatment strategies might outperform uniform approaches (using RATE, Qini curves, etc.).</li>
</ul></li>
</ul>
<p>Clearly distinguishing between these concepts is vital for precisely formulating research questions (defining causal estimands) and selecting valid methods for identification and estimation. In future lectures, we will explore the practical implementation of these methods in R using <code>grf</code> and related packages.</p>
</section>
</section>
<section id="course-review-so-far" class="level2">
<h2 class="anchored" data-anchor-id="course-review-so-far">Course Review So Far</h2>
<p>Imagine you are trying to determine if something causes something else. For example, does a new teaching method (let’s call it ‘treatment A’) actually cause better test scores (the ‘outcome Y’)? Causal inference provides the set of tools researchers use to answer these kinds of questions rigorously.</p>
<section id="the-core-idea-what-if" class="level3">
<h3 class="anchored" data-anchor-id="the-core-idea-what-if">The Core Idea: What If?</h3>
<p>At its heart, causal inference compares what actually happened to what <em>would have happened</em> under different circumstances. This “what if” scenario is called a counterfactual.</p>
<p>What would a student’s score <span class="math inline">(Y)</span> be if they received the new teaching method <span class="math inline">(A=1)</span>? We write this potential outcome as <span class="math inline">Y(1)</span>.</p>
<p>What would that same student’s score <span class="math inline">(Y)</span> be if they received the old method <span class="math inline">(A=0)</span>? We write this potential outcome as <span class="math inline">Y(0)</span>.</p>
<p>The Average Treatment Effect (ATE) is the average difference between these “what if” scenarios across a whole population or group: <span class="math inline">\text{ATE} = \mathbb{E}[Y(1) - Y(0)]</span>. This tells us, on average, how much the new teaching method changes the score.</p>
</section>
<section id="this-lecture-interaction-vs.-effect-modification-vs.-individualised-treatment-effects" class="level3">
<h3 class="anchored" data-anchor-id="this-lecture-interaction-vs.-effect-modification-vs.-individualised-treatment-effects">This Lecture: Interaction vs.&nbsp;Effect Modification vs.&nbsp;Individualised Treatment Effects</h3>
<section id="interaction-think-teamwork-effects" class="level4">
<h4 class="anchored" data-anchor-id="interaction-think-teamwork-effects">Interaction (Think: Teamwork Effects)</h4>
<p><strong>What it is:</strong> Interaction is about whether the combined effect of <em>two different interventions</em> (say, treatment A and treatment B) is different from simply adding up their individual effects. <strong>Example:</strong> Does using the new teaching method (A) <em>and</em> having extra tutoring (B) improve scores (Y) more (or less) than you would expect by combining the improvement from only teaching method A and only extra tutoring B? <strong>How it’s defined:</strong> We use counterfactuals: Is the outcome with both A and B, <span class="math inline">\mathbb{E}[Y(1, 1)]</span>, different from what you would predict based on having neither <span class="math inline">\mathbb{E}[Y(0, 0)]</span>, only A <span class="math inline">\mathbb{E}[Y(1, 0)]</span>, and only B <span class="math inline">\mathbb{E}[Y(0, 1)]</span>? Specifically, if <span class="math inline">[\mathbb{E}[Y(1,1)] - \mathbb{E}[Y(1,0)] - \mathbb{E}[Y(0,1)] + \mathbb{E}[Y(0,0)]] \neq 0</span>, then there is interaction on the additive scale. <strong>Challenge:</strong> To study interaction properly, you need to control for confounding factors for <em>both</em> intervention A and intervention B (confounders <span class="math inline">L</span> for A-Y and <span class="math inline">Q</span> for B-Y).</p>
</section>
<section id="effect-modification-think-different-effects-for-different-groups" class="level4">
<h4 class="anchored" data-anchor-id="effect-modification-think-different-effects-for-different-groups">Effect Modification (Think: Different Effects for Different Groups)</h4>
<p><strong>What it is:</strong> Effect modification is about whether the effect of <em>one intervention</em> (A) differs depending on some pre-existing <em>characteristic</em> (G or X) of the individuals. This characteristic is observed, not intervened upon. <strong>Example:</strong> Does the new teaching method (A) improve scores (Y) more for students who already have high prior grades (Group G=high) compared to students with low prior grades (Group G=low)? Here, G (prior grades) is the “effect modifier”. This phenomenon is called Heterogeneous Treatment Effects (HTE). <strong>How it’s defined:</strong> You compare the treatment effect (A’s effect on Y) across different groups defined by G or X. The Conditional Average Treatment Effect (CATE) quantifies this: <span class="math inline">\tau(x) = \mathbb{E}[Y(1) - Y(0) | X=x]</span>. If <span class="math inline">\tau(x)</span> varies for different values of <span class="math inline">x</span>, then <span class="math inline">X</span> modifies the effect of <span class="math inline">A</span>. <strong>Challenge:</strong> To study effect modification, you need to control for confounding factors (<span class="math inline">L</span>) of the relationship between the single intervention A and the outcome Y, potentially within each subgroup G or X.</p>
</section>
<section id="estimated-individualised-treatment-effects-think-personal-profiles-matter" class="level4">
<h4 class="anchored" data-anchor-id="estimated-individualised-treatment-effects-think-personal-profiles-matter">Estimated Individualised Treatment Effects (Think: Personal Profiles Matter)</h4>
<p><strong>What it is:</strong> In reality, people belong to many groups simultaneously based on multiple characteristics (age, gender, prior performance, motivation, etc.). “Individualised treatment effects” typically refer to the <em>estimated</em> CATE, <span class="math inline">\hat{\tau}(X_i)</span>, which predicts the average treatment response based on an individual’s complex combination of characteristics <span class="math inline">X_i</span>.</p>
<p><strong>Example:</strong> We want to predict whether the new teaching method will help a specific student who is female, 14 years old, from a low-income background, with high prior achievement and high motivation. We use all this information (<span class="math inline">X_i</span>) for the prediction <span class="math inline">\hat{\tau}(X_i)</span>.</p>
<p><strong>How it’s estimated:</strong> Modern methods like causal forests process all characteristics (<span class="math inline">X</span>) simultaneously to generate predictions <span class="math inline">\hat{\tau}(X_i)</span> for each individual. These are <strong>not</strong> true individual causal effects (which remain unobservable) but are our best estimates of the <em>average effect for people like individual i</em>, given the available data.</p>
<p><strong>Why it matters:</strong> These predictions <span class="math inline">\hat{\tau}(X_i)</span> allow us to explore whether tailoring treatments based on individual profiles (<span class="math inline">X_i</span>) could be more effective than treating everyone uniformly. This involves further evaluation (e.g., using RATE, Qini curves).</p>
<p><strong>In Simple Terms:</strong></p>
<ul>
<li><strong>Interaction:</strong> Do two treatments work together synergistically or antagonistically? (Requires analysing effects of <span class="math inline">A</span>, <span class="math inline">B</span>, and <span class="math inline">A+B</span>).</li>
<li><strong>Effect Modification (HTE/CATE):</strong> Does a single treatment’s effect change depending on who receives it (based on their characteristics <span class="math inline">X</span>)? (Requires analysing effect of <span class="math inline">A</span> within levels of <span class="math inline">X</span>).</li>
<li><strong>Estimated Individualised Effects (<span class="math inline">\hat{\tau}(X_i)</span>):</strong> How can we <em>predict</em> treatment responses based on the complex combination of an individual’s characteristics <span class="math inline">X_i</span>? (Requires flexible models like causal forests trained on <span class="math inline">A</span>, <span class="math inline">Y</span>, and <span class="math inline">X</span>).</li>
</ul>
<p>Understanding these distinctions helps formulate precise research questions, choose appropriate methods, and potentially develop more effective intervention strategies that acknowledge individual differences.</p>
</section>
</section>
</section>
<section id="appendix-simplification-of-additive-interaction-formula" class="level2">
<h2 class="anchored" data-anchor-id="appendix-simplification-of-additive-interaction-formula">Appendix: Simplification of Additive Interaction Formula</h2>
<p>We start with the definition of additive interaction based on comparing the joint effect relative to baseline versus the sum of individual effects relative to baseline:</p>
<p><span class="math display">
\Big(\mathbb{E}[Y(1,1)] - \mathbb{E}[Y(0,0)]\Big) - \Big[\Big(\mathbb{E}[Y(1,0)] - \mathbb{E}[Y(0,0)]\Big) + \Big(\mathbb{E}[Y(0,1)] - \mathbb{E}[Y(0,0)]\Big)\Big]
</span></p>
<p>First, distribute the negative sign across the terms within the square brackets:</p>
<p><span class="math display">
\mathbb{E}[Y(1,1)] - \mathbb{E}[Y(0,0)] - \Big(\mathbb{E}[Y(1,0)] - \mathbb{E}[Y(0,0)]\Big) - \Big(\mathbb{E}[Y(0,1)] - \mathbb{E}[Y(0,0)]\Big)
</span></p>
<p>Now remove the parentheses, flipping the signs inside them where preceded by a minus sign:</p>
<p><span class="math display">
\mathbb{E}[Y(1,1)] - \mathbb{E}[Y(0,0)] - \mathbb{E}[Y(1,0)] + \mathbb{E}[Y(0,0)] - \mathbb{E}[Y(0,1)] + \mathbb{E}[Y(0,0)]
</span></p>
<p>Next, combine the <span class="math inline">\mathbb{E}[Y(0,0)]</span> terms:</p>
<ul>
<li>We have <span class="math inline">-\mathbb{E}[Y(0,0)]</span></li>
<li>Then <span class="math inline">+\mathbb{E}[Y(0,0)]</span> (these two cancel each other out)</li>
<li>And another <span class="math inline">+\mathbb{E}[Y(0,0)]</span> remains.</li>
</ul>
<p>The expression simplifies to:</p>
<p><span class="math display">
\mathbb{E}[Y(1,1)] - \mathbb{E}[Y(1,0)] - \mathbb{E}[Y(0,1)] + \mathbb{E}[Y(0,0)]
</span></p>
<p>This is the standard definition of additive interaction, often called the interaction contrast. If this expression equals zero, there is no additive interaction; a non-zero value indicates an interaction effect.</p>
<p><strong>This shows clearly that interaction is measured as the deviation of the joint effect from the sum of the separate effects, adjusted for the baseline.</strong></p>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Causal Inference: Effect Modification, Interaction, and Conditional Average Treatment Effects"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-APR-01"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> /Users/joseph/GIT/templates/bib/references.bib</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    warnings: FALSE</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    error: FALSE</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">    messages: FALSE</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: kate</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools:</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: FALSE</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="an">html-math-method:</span><span class="co"> katex</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="an">citation-location:</span><span class="co"> margin</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="an">code-block-border-left:</span><span class="co"> true</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="in">  .boxedblue {</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="in">      border: 2px solid blue;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="in">      border-radius: 4px; /* slight roundness */</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="in">      padding: 3px 6px; /* vertical | horizontal */</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="in">      display: inline-block;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="in">      color: blue;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="in">   }</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="in">  .circleblue {</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="in">      border: 2px dashed blue;</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="in">      border-radius: 50%;</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="in">      padding: 3px 6px;</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="in">      display: inline-block;</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="in">      color: blue;</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="in">   }</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries and functions</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure necessary packages like tinytex, extrafont might be loaded if needed globally or per-project.</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># library("tinytex")</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co"># library(extrafont)</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co"># loadfonts(device = "win") # Adjust device based on OS if using extrafont</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># read functions if any external functions are used</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># source("/Users/joseph/GIT/templates/functions/funs.R") </span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>**Required Reading**</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@hernan2024WHATIF</span><span class="co">]</span> Chapters 4-5 <span class="co">[</span><span class="ot">link</span><span class="co">](https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&amp;dl=0)</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>**Optional Reading**</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@vanderweele2007FOURTYPESOFEFFECT</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/drytp2ui2b8o9jplh4bm9/four_types_of_effect_modification__a.6.pdf?rlkey=mb9nl599v93m6kyyo69iv5nz1&amp;dl=0)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@vanderweele2009distinction</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/srpynr0dvjcndveplcydn/OutcomeWide_StatisticalScience.pdf?rlkey=h4fv32oyjegdfl3jq9u1fifc3&amp;dl=0)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Concepts for Assessment</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Causal Estimand</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Statistical Estimand</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Interaction</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Effect Modification</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Heterogeneous Treatment Effects (HTE)</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Conditional Average Treatment Effect (CATE) $\tau(x)$</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Estimated Conditional Average Treatment Effect $\hat{\tau}(X)$ # Added estimator for clarity</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## If you learn nothing else from this course...</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>To answer a psychological question scientifically, we must first state it precisely. Causal inference provides the framework for doing so.</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Causal inference begins by stating a counterfactual contrast</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>In the simplest case, we define a contrast between potential outcomes under two or more alternative conditions, often called "treatments" or "exposures" (denoted $A$). For an outcome $Y$, we might compare the potential outcome if everyone received treatment level $a^*$ versus if everyone received treatment level $a$. The average difference in the population is the Average Treatment Effect (ATE):</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>\text{ATE} = \mathbb{E}<span class="co">[</span><span class="ot">Y(a^*) - Y(a)</span><span class="co">]</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>Understanding causal inference involves comparing what actually happened with what *could have happened* (counterfactuals) on average, under different specified conditions, within a defined target population. A crucial part of this process involves identifying and accounting for factors (confounders) that could distort the comparison and lead to incorrect conclusions about the causal question asked.</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="fu">## In Causal Inference, What do 'Interaction' and 'Effect Modification' mean? </span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>We often encounter terms like 'moderation' and 'interaction' used loosely in psychological science. Causal inference demands greater precision. We will set aside the ambiguous term 'moderation' and focus on clearly distinguishing two specific concepts using the counterfactual framework: </span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Interaction**</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Effect Modification**</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interaction: The Effect of Joint Interventions</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>In the framework of causal inference, **interaction** specifically relates to evaluating a **joint intervention**. We are interested in the combined causal effect when we simultaneously intervene on *two (or more) distinct treatments* or exposures.</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>Let these distinct treatments be $A$ and $B$, and the outcome be $Y$.</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>Recall the potential outcome under a single intervention setting $A$ to level $\tilde{a}$ is $Y(\tilde{a})$. We typically aim to identify this from observational data using assumptions such as consistency ($Y_i(\tilde{a}) = (Y_i |A_i = \tilde{a})$ for individual $i$) and conditional exchangeability (no unmeasured confounding) given a set of measured covariates $L$: $Y(\tilde{a}) \perp\kern-5pt\perp A | L$. The set $L$ must be sufficient to block all non-causal (backdoor) paths between $A$ and $Y$.</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>When considering a joint intervention on both $A$ and $B$, we extend the notation to $Y(\tilde{a}, \tilde{b})$. This represents the potential outcome if treatment $A$ were set to $\tilde{a}$ *and* treatment $B$ were set to $\tilde{b}$ for an individual or population.</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>Identification of $Y(\tilde{a}, \tilde{b})$ requires analogous assumptions for both interventions. In addition to needing $L$ for the $A \to Y$ relationship ($Y(\tilde{a}) \perp\kern-5pt\perp A | L$), we also need a set of covariates $Q$ sufficient to ensure conditional exchangeability for the $B \to Y$ relationship: $Y(\tilde{b}) \perp\kern-5pt\perp B | Q$. Consistency must also hold for $B$.</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>The sets of required covariates $L$ and $Q$ may overlap ($L \cap Q \not\equiv \emptyset$). Critically, identifying causal interaction requires sufficient data to control for *all* variables in the union of these sets, $L \cup Q$.</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="fu">### Defining Interaction with a Counterfactual Contrast</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>Let's use an educational example. Consider the effect of a new teaching method (treatment $A$: 1=New, 0=Old) on student test scores (outcome $Y$). Suppose we are also interested in the effect of providing extra tutoring (treatment $B$: 1=Yes, 0=No). We want to assess the individual and combined effects of $A$ and $B$ on test scores, perhaps on the difference scale (additive scale).</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>Using counterfactuals, we define **causal interaction on the additive scale** as occurring when the effect of intervening on both $A$ and $B$ simultaneously differs from the sum of the effects of intervening on each one individually (always relative to a common baseline, usually $A=0, B=0$). The interaction is non-zero if:</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>\bigg(\underbrace{\mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span>}_{\text{joint intervention}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither intervention}}\bigg) - \bigg[ \bigg(\underbrace{\mathbb{E}[Y(1,0)]}_{\text{only A intervention}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither intervention}}\bigg) + \bigg(\underbrace{\mathbb{E}[Y(0,1)]}_{\text{only B intervention}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither intervention}} \bigg)\bigg] \neq 0</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>This expression simplifies to the standard definition of additive interaction (see appendix):</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>\underbrace{\mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span>}_{\text{joint}} - \underbrace{\mathbb{E}[Y(1,0)]}_{\text{only A}} - \underbrace{\mathbb{E}[Y(0,1)]}_{\text{only B}} + \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither}} \neq 0</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>This specific quantity is the causal estimand for additive interaction. It captures the extent to which the joint effect deviates from additivity. A positive value implies synergy (superadditivity); a negative value implies antagonism (subadditivity). Note the definition is symmetric regarding $A$ and $B$: $Y(\tilde{a}, \tilde{b}) \equiv Y(\tilde{b}, \tilde{a})$.</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>*(Other scales, like the multiplicative/ratio scale, can define interaction, potentially leading to different conclusions. The choice of scale should always be justified.)*</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Identification of Causal Interaction</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>To estimate this causal interaction from data, we must identify all four potential outcome means: $\mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span>$, $\mathbb{E}<span class="co">[</span><span class="ot">Y(1,0)</span><span class="co">]</span>$, $\mathbb{E}<span class="co">[</span><span class="ot">Y(0,1)</span><span class="co">]</span>$, and $\mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span>$. This requires controlling for confounding factors for *both* the $A \to Y$ relationship and the $B \to Y$ relationship. The causal diagram in @fig-dag-interaction illustrates this requirement.</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-interaction</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Diagram illustrating causal interaction. Assessing the joint effect of two interventions, A (e.g., teaching method) and B (e.g., tutoring), on outcome Y (e.g., test score). L represents confounders of the A-Y relationship, and Q represents confounders of the B-Y relationship. Red arrows indicate biasing backdoor paths requiring adjustment. Assumes A and B are decided independently here."</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning, shapes.geometric, arrows, decorations}</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (LA) at (0, .5) {$L_{0}$};</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (LB) at (0, -.5) {$Q_{0}$};</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (2, .5) {$A_{1}$};</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (B) at (2, -.5) {$B_{1}$};</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (5, 0) {$Y_{2}$};</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (LA) to (A);</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (LB) to (B);</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red, bend left] (LA) to (Y);</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red, bend right] (LB) to (Y);</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (A) to (Y); </span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (B) to (Y); </span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>As shown in @fig-dag-interaction-solved, identifying the causal interaction requires conditioning on (adjusting for) *both* sets of confounders, $L_0$ and $Q_0$, blocking the backdoor paths.</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-interaction-solved</span></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Identification of causal interaction requires adjusting for all confounders of A-Y (L) and B-Y (Q). Boxes around L and Q indicate conditioning, closing backdoor paths."</span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning, shapes.geometric, arrows, decorations}</span></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (LA) at (0, .5) {$L_{0}$}; </span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (LB) at (0, -.5) {$Q_{0}$}; </span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (2, .5) {$A_{1}$};</span></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (B) at (2, -.5) {$B_{1}$};</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (5, 0) {$Y_{2}$};</span></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (LA) to (A);</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (LB) to (B);</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, bend left] (LA) to (Y);</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, bend right] (LB) to (Y);</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (B) to (Y);</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>In our education example:</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>**L (confounders of Teaching Method -&gt; Score):** Prior student achievement, student motivation, socioeconomic status (SES), school resources, teacher experience/quality (if method not randomly assigned across teachers).</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>**Q (confounders of Tutoring -&gt; Score):** Prior student achievement, student motivation, parental</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>involvement/SES (influencing access/payment for tutoring), student time availability, specific learning needs.</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>Here, $L \cap Q$ clearly includes prior achievement and student motivation. Therefore, $L \cup Q$ is a potentially large set of variables requiring measurement and adjustment. Failure to adequately control for $L \cup Q$ leads to biased estimates of causal interaction.</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effect Modification: Variation in a Single Effect</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>Distinct from **interaction** (which involves joint interventions), **effect modification** examines whether the causal effect of a *single* intervention ($A$) on an outcome ($Y$) differs across subgroups within a population. These subgroups are typically defined by baseline characteristics ($G$ or $X$), which may or may not be modifiable themselves. Understanding effect modification helps identify for whom an intervention is most (or least) effective. We explore this potential variability using concepts like Heterogeneous Treatment Effects (HTE) and Conditional Average Treatment Effects (CATE).</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a><span class="fu">### Heterogeneous Treatment Effects (HTE): The Phenomenon of Variability</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>**Heterogeneous Treatment Effects (HTE)** refers to the *phenomenon* where the causal effect of an intervention ($A$ on $Y$) is not constant across all individuals or subgroups. This *is* effect modification. The variability might stem from differences in observed characteristics (like age, sex, or prior conditions captured in measured covariates $X$) or unobserved factors (like genetics, unmeasured environmental factors, or personal history). HTE reflects the reality that interventions rarely affect everyone identically.</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>Identifying the full extent of HTE, especially variation due to unobserved factors, is challenging because individual causal effects are generally not point identifiable.</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional Average Treatment Effect (CATE): A Specific Measure $\tau(x)$</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>To investigate HTE using observable data, we focus on estimating the **Conditional Average Treatment Effect (CATE)**. CATE is a specific causal *estimand*: the average treatment effect *conditional on observed covariates* $X$ taking a specific value or set of values $x$.</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>\tau(x) = \text{CATE}(x) = \mathbb{E}<span class="co">[</span><span class="ot">Y(1) - Y(0) | X = x</span><span class="co">]</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>Estimating $\text{CATE}(x)$ (denoted $\tau(x)$) for different values of $x$ allows us to quantify effect modification by the *measured* characteristics $X$. It is a primary tool for studying the broader HTE phenomenon, answering: How does the average effect of $A$ differ for individuals with specific observed characteristics $X=x$?</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing Effect Heterogeneity Across Groups</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>A direct way to assess effect modification by a categorical variable $G$ (e.g., comparing effects between males and females, or across different study sites) is to compare the average treatment effect (ATE) estimated *within* each level of $G$. This involves comparing CATEs where the conditioning variable $X$ is simply the group indicator $G$.</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>We define the causal estimand that compares two conditional average treatment effects between levels $g$ and $g'$ of variable $G$:</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>{\gamma} = \overbrace{\big( \mathbb{E}<span class="co">[</span><span class="ot">Y(a^*)|G=g</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(a)|G=g</span><span class="co">]</span> \big)}^{{\delta_g=\text{CATE}(G=g)}} - \overbrace{\big(\mathbb{E}<span class="co">[</span><span class="ot">Y(a^*)|G=g^{\prime}</span><span class="co">]</span>- \mathbb{E}<span class="co">[</span><span class="ot">Y(a)|G=g'</span><span class="co">]</span>\big)}^{{\delta_{g^{\prime}}=\text{CATE}(G=g')}}</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>Let $A$ be the treatment (e.g., $a=0$ to $a^*=1$), $G$ the potential effect-modifier (e.g., sex: $g=$female, $g'=$male), and $Y$ the outcome. The analysis assesses whether $\delta$, the effect of $A$ on $Y$, differs across levels of $G$.</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>For example, comparing the causal effect of an intervention for females ($G=g_1$) versus males ($G=g_2$):</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Causal effect within females ($G=g_1$):**</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>    \delta_{g_1} = \mathbb{E}<span class="co">[</span><span class="ot">Y(1)|G= g_1</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0)|G = g_1</span><span class="co">]</span></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>    $$ </span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Causal effect within males ($G=g_2$):**</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>    \delta_{g_2} = \mathbb{E}<span class="co">[</span><span class="ot">Y(1)|G=g_2</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0)|G=g_2</span><span class="co">]</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Comparing causal effects across groups:**</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    $$</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>    {\gamma} = {\delta}_{g_1} - {\delta}_{g_2}</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>    $$ </span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>    A non-zero estimate $\hat{\gamma}$ indicates effect modification by $G$. The intervention's effect differs between females and males. Note that $\hat{\gamma} \neq 0$ can occur even if one group's effect ($\hat{\delta}_{g_1}$ or $\hat{\delta}_{g_2}$) is near zero.</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Identification of Effect Modification</span></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>To identify group-specific effects ($\delta_g, \delta_{g'}$) and their difference ($\gamma$), we need to ensure exchangeability for $A$ holds *within* each stratum defined by $G$. That is, we must control for confounders ($L$) of the $A \to Y$ relationship, potentially allowing $L$ itself to be associated with $G$. Crucially, since $G$ defines the subpopulations of interest and is not (usually) the intervention itself, we do *not* necessarily need to control for factors ($Q$) that cause $G$, unless those factors also confound the $A \to Y$ relationship (i.e., if $Q \subseteq L$).</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>Referencing @fig-dag-effect-modification: To estimate the $A \to Y$ effect within levels of $G$, we must adjust for $L_0$. Adjusting for $Q$ (causes of G) is necessary only if $Q$ is also in $L_0$.</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-effect-modification</span></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Imagine A is an experiment. How shall we investigate effect modification of A on Y by Z? Can you see why regression coefficients will not work?"</span></span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning, shapes.geometric, arrows.meta, decorations.pathmorphing}</span></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{</span></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a><span class="in">  Arrow/.style={-&gt;, &gt;=latex, line width=0.4pt},  % Defines a generic arrow style</span></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a><span class="in">  emod/.style={rectangle, fill=blue!10, draw=blue, thick, minimum size=6mm},</span></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a><span class="in">  emoddot/.style={circle, fill=blue!10, draw=blue, dotted, thick, minimum size=6mm}</span></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}</span></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white, thick] (Q) at (-4,0) {Q};</span></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a><span class="in">\node [black] (G) at (-2,0) {G};</span></span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black,thick] (L) at (0,0) {L$_{0}$};</span></span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white, thick] (A) at (2,0) {A$_{1}$};</span></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emoddot] (Z) at (0, -1) {Z};</span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white, thick] (Y) at (4,0) {Y$_{2}$};</span></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black] (Q) to (G);</span></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black] (G) to (L);</span></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black] (L) to (A);</span></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black, bend left = 30] (L) to (Y);</span></span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black, bend right = 40] (Q) to (Y);</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[-{Circle[open, fill=none]}, line width=0.25pt, draw=blue, bend right = 10] (Z) to (Y); Circle-ended arrow</span></span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>The primary identification challenge for effect modification lies in adequately controlling for the $A \to Y$ confounders ($L$) within each subgroup defined by $G$ or $X$. Next week, we turn our focus to statistical estimation.</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating Conditional Average Treatment Effects: $\hat{\tau}(X)$</span></span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>In the previous section, we defined the Conditional Average Treatment Effect (CATE), $\tau(x)$, as a key causal estimand for understanding effect modification by observed covariates $X$:</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>\tau(x) = \mathbb{E}<span class="co">[</span><span class="ot">Y(1) - Y(0) | X = x</span><span class="co">]</span></span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>This represents the *true* average treatment effect within the specific subpopulation where individuals share the covariate profile $X=x$. It quantifies how the average effect of intervention $A$ varies according to baseline characteristics $X$.</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>Our focus now shifts to *estimating* this CATE function from observed data. We denote the statistical estimate, derived from our sample, as $\hat{\tau}(X)$. For any individual $i$ in our study with observed baseline covariates $X_i$, the value $\hat{\tau}(X_i)$ represents our data-driven prediction of the average treatment effect *for the subgroup of individuals possessing characteristics like $X_i$*.</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a><span class="fu">### Clarifying "Individualised" Treatment Effects vs. Individual Effects</span></span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>You might recall our earlier discussion highlighting that *true individual causal effects*—the effect of treatment for a single specific person, $Y_i(1) - Y_i(0)$—are generally impossible to identify from data. This might seem contradictory to the goal of estimating "individualised" treatment effects.</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>The essential distinction lies in the interpretation:</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Individual Causal Effect (Unobservable):** $Y_i(1) - Y_i(0)$ is the precise effect for person $i$. We cannot observe both potential outcomes for the same person simultaneously.</span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Estimated Conditional Average Treatment Effect (CATE estimate):** $\hat{\tau}(X_i)$ is an estimate of the *average* effect $\mathbb{E}<span class="co">[</span><span class="ot">Y(1) - Y(0) | X = X_i</span><span class="co">]</span>$ within the stratum, or subgroup, of the population who share the observable characteristics $X_i$.</span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>The term "individualised" or "personalised" treatment effect, in this context, acknowledges that our *prediction* $\hat{\tau}(X_i)$ is tailored to the *specific covariate profile $X_i$* of an individual. However, it crucially represents an **estimated average effect for a subgroup**, not the unique causal effect for that one person. It is our best estimate of the average response for the *type* of individual defined by $X_i$, based on the observed data and the chosen model.</span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Multidimensional Nature of Individual Characteristics</span></span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>An important reality is that individuals do not belong to just one group; they simultaneously belong to many overlapping groups defined by their multidimensional characteristics. For example, a student might be:</span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Female (gender)</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>14 years old (age)</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>From a low-income household (socioeconomic status)</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>High-achieving in previous assessments (prior performance)</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Attending a rural school (location)</span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Highly motivated (psychological trait)</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>Each of these characteristics, and their combinations, might influence how the student responds to an intervention. The challenge becomes estimating treatment effects that account for this multidimensional reality.</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>Traditional approaches using regression with manually specified interaction terms quickly become unwieldy when trying to model all relevant combinations (e.g., <span class="in">`A*gender*age*income*prior_performance*location*motivation`</span>). With even a modest number of covariates, we face problems including:</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Insufficient data within many specific covariate combinations (strata).</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Inflated risks of false positives due to multiple testing.</span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Difficulties in model specification, complexity, and interpretation.</span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>An inability to discover unexpected interaction patterns without pre-specifying them.</span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>Modern methods like causal forests address this challenge by:</span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Considering the full covariate space simultaneously:** Instead of requiring researchers to pre-specify interaction terms, causal forests automatically search for patterns of effect heterogeneity across the multidimensional covariate space ($X$).</span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Adaptive complexity:** The algorithm adapts to the data, splitting on variables and combinations that best differentiate treatment effects, while using regularisation techniques to avoid overfitting.</span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Local averaging:** Causal forests effectively perform a weighted local averaging. For each individual $i$, the estimate $\hat{\tau}(X_i)$ is derived by considering the outcomes of similar individuals (i.e., "neighbours" in the covariate space $X$).</span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Honest estimation:** By employing techniques like sample splitting (using separate parts of the data for building the tree structure and estimating the effects within the leaves) or out-of-bag estimation, causal forests aim to provide statistically valid ("honest") estimates with appropriate confidence intervals.</span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a>The result is that for each individual $i$ with covariates $X_i$, we obtain an estimate $\hat{\tau}(X_i)$ reflecting the predicted treatment effect given their particular combination of characteristics. While still not a true individual causal effect, this approach acknowledges and leverages the multidimensional nature of individual differences.</span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why Estimate CATEs ($\hat{\tau}(X)$)?</span></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>Estimating the CATE function $\hat{\tau}(X)$ is the primary statistical approach for investigating the phenomenon of Heterogeneous Treatment Effects (HTE) using measured baseline variables $X$. By examining how the estimated effect $\hat{\tau}(X)$ changes across different covariate profiles $X$, we aim to:</span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Explore Effect Heterogeneity:** Move beyond the single summary statistic of the Average Treatment Effect (ATE) to understand if, how, and potentially by which observed factors the intervention's impact varies across the population.</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Identify Potential Subgroups:** Discover if specific subgroups, defined by their baseline characteristics $X$, experience substantially different benefits (or harms) from the intervention.</span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Inform Potential Targeting:** Use the predictions $\hat{\tau}(X_i)$ as a basis for exploring whether tailoring treatment decisions could lead to better overall outcomes. This involves evaluating whether strategies based on $\hat{\tau}(X_i)$ outperform uniform treatment approaches, assessed using tools like RATE and Qini curves (discussed later).</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a><span class="fu">### Methods for Estimation: Introducing `grf`</span></span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>While traditional regression models incorporating interaction terms (e.g., <span class="in">`lm(Y ~ A * X1 + A * X2)`</span>) can estimate CATEs under specific assumptions (like linearity and correct model specification), they often struggle with complex scenarios involving many potential effect modifiers ($X$) or non-linear relationships.</span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>Modern machine learning methods, particularly **causal forests** as implemented in the R package <span class="in">`grf`</span> <span class="co">[</span><span class="ot">@grf2024</span><span class="co">]</span>, are specifically designed for estimating CATEs ($\hat{\tau}(X)$) flexibly and robustly. Causal forests adapt the random forest algorithm for causal inference. Instead of building trees simply to predict the outcome $Y$, they construct trees that explicitly maximise the heterogeneity in estimated treatment effects between leaves. This design allows them to:</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Handle a large number of potential covariates ($X$) simultaneously.</span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Capture complex, non-linear interactions between covariates and the treatment effect without pre-specification.</span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Avoid strong parametric assumptions about the functional form of $\tau(X)$.</span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>The output of a causal forest is typically a prediction $\hat{\tau}(X_i)$ for each individual $i$ in the dataset (ideally, an evaluation dataset distinct from the training data to prevent overfitting). We will demonstrate these methods after the mid-term break and clarify how they facilitate the development of treatment prioritisation rules. Such rules, often assuming fixed budgets, help determine policy regarding whether and when assigning treatment based on pre-treatment covariates is advantageous.</span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary: Key Distinctions</span></span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>This lecture has introduced several interconnected but distinct concepts:</span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Interaction:** Concerns the *joint causal effect* of *two or more distinct interventions* ($A$ and $B$) on an outcome ($Y$). It asks if the effect of intervening on both differs from the sum of their individual intervention effects. The estimand involves joint potential outcomes like $\mathbb{E}[Y(a,b)]$. Identification requires controlling confounders for *all* involved interventions ($L \cup Q$).</span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Effect Modification:** Concerns how the causal effect of a *single intervention* ($A$) on an outcome ($Y$) *varies* across subgroups defined by a baseline characteristic ($G$ or $X$). It asks if the effect, $\mathbb{E}<span class="co">[</span><span class="ot">Y(1) - Y(0)</span><span class="co">]</span>$, changes depending on the level of $G$ or $X$.</span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>**HTE** is the general *phenomenon* of such effect variability.</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>**CATE** ($\tau(x) = \mathbb{E}<span class="co">[</span><span class="ot">Y(1) - Y(0) | X=x</span><span class="co">]</span>$) is the specific *causal estimand* used to *quantify* this variability based on *observed* covariates $X$. Comparing CATEs across levels of $G$ or $X$ assesses effect modification by measured factors.</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Estimated Individualised Treatment Effects ($\hat{\tau}(X_i)$):** Refers to our data-derived *estimates* of treatment effects tailored to individuals' specific combinations of observed characteristics ($X_i$).</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>These are **not** true individual causal effects ($Y_i(1) - Y_i(0)$), which remain fundamentally unobservable. They estimate the CATE for the subgroup defined by $X = X_i$.</span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Modern methods like causal forests generate these predictions $\hat{\tau}(X_i)$ by considering the multidimensional covariate profile $X_i$ without requiring pre-specification of effect modifiers.</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>These estimates acknowledge that individuals exist at the intersection of many characteristics simultaneously.</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>They form the basis for evaluating whether personalised treatment strategies might outperform uniform approaches (using RATE, Qini curves, etc.).</span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>Clearly distinguishing between these concepts is vital for precisely formulating research questions (defining causal estimands) and selecting valid methods for identification and estimation. In future lectures, we will explore the practical implementation of these methods in R using <span class="in">`grf`</span> and related packages.</span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a><span class="fu">## Course Review So Far</span></span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>Imagine you are trying to determine if something causes something else. For example, does a new teaching method (let's call it 'treatment A') actually cause better test scores (the 'outcome Y')? Causal inference provides the set of tools researchers use to answer these kinds of questions rigorously.</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Core Idea: What If?</span></span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>At its heart, causal inference compares what actually happened to what *would have happened* under different circumstances. This "what if" scenario is called a counterfactual.</span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>What would a student's score $(Y)$ be if they received the new teaching method $(A=1)$? </span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a>We write this potential outcome as $Y(1)$.</span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>What would that same student's score $(Y)$ be if they received the old method $(A=0)$? </span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>We write this potential outcome as $Y(0)$.</span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>The Average Treatment Effect (ATE) is the average difference between these "what if" scenarios across a whole population or group: $\text{ATE} = \mathbb{E}<span class="co">[</span><span class="ot">Y(1) - Y(0)</span><span class="co">]</span>$. This tells us, on average, how much the new teaching method changes the score.</span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a><span class="fu">### This Lecture: Interaction vs. Effect Modification vs. Individualised Treatment Effects</span></span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interaction (Think: Teamwork Effects)</span></span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>**What it is:** Interaction is about whether the combined effect of *two different interventions* (say, treatment A and treatment B) is different from simply adding up their individual effects.</span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>**Example:** Does using the new teaching method (A) *and* having extra tutoring (B) improve scores (Y) more (or less) than you would expect by combining the improvement from only teaching method A and only extra tutoring B?</span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>**How it's defined:** We use counterfactuals: Is the outcome with both A and B, $\mathbb{E}<span class="co">[</span><span class="ot">Y(1, 1)</span><span class="co">]</span>$, different from what you would predict based on having neither $\mathbb{E}<span class="co">[</span><span class="ot">Y(0, 0)</span><span class="co">]</span>$, only A $\mathbb{E}<span class="co">[</span><span class="ot">Y(1, 0)</span><span class="co">]</span>$, and only B $\mathbb{E}<span class="co">[</span><span class="ot">Y(0, 1)</span><span class="co">]</span>$? Specifically, if $<span class="co">[</span><span class="ot">\mathbb{E}[Y(1,1)] - \mathbb{E}[Y(1,0)] - \mathbb{E}[Y(0,1)] + \mathbb{E}[Y(0,0)]</span><span class="co">]</span> \neq 0$, then there is interaction on the additive scale.</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>**Challenge:** To study interaction properly, you need to control for confounding factors for *both* intervention A and intervention B (confounders $L$ for A-Y and $Q$ for B-Y).</span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Effect Modification (Think: Different Effects for Different Groups)</span></span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>**What it is:** Effect modification is about whether the effect of *one intervention* (A) differs depending on some pre-existing *characteristic* (G or X) of the individuals. This characteristic is observed, not intervened upon.</span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>**Example:** Does the new teaching method (A) improve scores (Y) more for students who already have high prior grades (Group G=high) compared to students with low prior grades (Group G=low)? Here, G (prior grades) is the "effect modifier". This phenomenon is called Heterogeneous Treatment Effects (HTE).</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a>**How it's defined:** You compare the treatment effect (A's effect on Y) across different groups defined by G or X. The Conditional Average Treatment Effect (CATE) quantifies this: $\tau(x) = \mathbb{E}<span class="co">[</span><span class="ot">Y(1) - Y(0) | X=x</span><span class="co">]</span>$. If $\tau(x)$ varies for different values of $x$, then $X$ modifies the effect of $A$.</span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>**Challenge:** To study effect modification, you need to control for confounding factors ($L$) of the relationship between the single intervention A and the outcome Y, potentially within each subgroup G or X.</span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Estimated Individualised Treatment Effects (Think: Personal Profiles Matter)</span></span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>**What it is:** In reality, people belong to many groups simultaneously based on multiple characteristics (age, gender, prior performance, motivation, etc.). "Individualised treatment effects" typically refer to the *estimated* CATE, $\hat{\tau}(X_i)$, which predicts the average treatment response based on an individual's complex combination of characteristics $X_i$.</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a>**Example:** We want to predict whether the new teaching method will help a specific student who is female, 14 years old, from a low-income background, with high prior achievement and high motivation. We use all this information ($X_i$) for the prediction $\hat{\tau}(X_i)$.</span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a>**How it's estimated:** Modern methods like causal forests process all characteristics ($X$) simultaneously to generate predictions $\hat{\tau}(X_i)$ for each individual. These are **not** true individual causal effects (which remain unobservable) but are our best estimates of the *average effect for people like individual i*, given the available data.</span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>**Why it matters:** These predictions $\hat{\tau}(X_i)$ allow us to explore whether tailoring treatments based on individual profiles ($X_i$) could be more effective than treating everyone uniformly. This involves further evaluation (e.g., using RATE, Qini curves).</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>**In Simple Terms:**</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Interaction:** Do two treatments work together synergistically or antagonistically? (Requires analysing effects of $A$, $B$, and $A+B$).</span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Effect Modification (HTE/CATE):** Does a single treatment's effect change depending on who receives it (based on their characteristics $X$)? (Requires analysing effect of $A$ within levels of $X$).</span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Estimated Individualised Effects ($\hat{\tau}(X_i)$):** How can we *predict* treatment responses based on the complex combination of an individual's characteristics $X_i$? (Requires flexible models like causal forests trained on $A$, $Y$, and $X$).</span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a>Understanding these distinctions helps formulate precise research questions, choose appropriate methods, and potentially develop more effective intervention strategies that acknowledge individual differences.</span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix: Simplification of Additive Interaction Formula</span></span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>We start with the definition of additive interaction based on comparing the joint effect relative to baseline versus the sum of individual effects relative to baseline:</span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a>\Big(\mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span>\Big) - \Big<span class="co">[</span><span class="ot">\Big(\mathbb{E}[Y(1,0)] - \mathbb{E}[Y(0,0)]\Big) + \Big(\mathbb{E}[Y(0,1)] - \mathbb{E}[Y(0,0)]\Big)\Big</span><span class="co">]</span></span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>First, distribute the negative sign across the terms within the square brackets:</span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span> - \Big(\mathbb{E}<span class="co">[</span><span class="ot">Y(1,0)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span>\Big) - \Big(\mathbb{E}<span class="co">[</span><span class="ot">Y(0,1)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span>\Big)</span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a>Now remove the parentheses, flipping the signs inside them where preceded by a minus sign:</span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(1,0)</span><span class="co">]</span> + \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,1)</span><span class="co">]</span> + \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span></span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a>Next, combine the $\mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span>$ terms:</span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>We have $-\mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span>$</span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Then $+\mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span>$ (these two cancel each other out)</span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>And another $+\mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span>$ remains.</span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a>The expression simplifies to:</span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a>\mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(1,0)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,1)</span><span class="co">]</span> + \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span></span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a>This is the standard definition of additive interaction, often called the interaction contrast. If this expression equals zero, there is no additive interaction; a non-zero value indicates an interaction effect.</span>
<span id="cb1-488"><a href="#cb1-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-489"><a href="#cb1-489" aria-hidden="true" tabindex="-1"></a>**This shows clearly that interaction is measured as the deviation of the joint effect from the sum of the separate effects, adjusted for the baseline.**</span>
<span id="cb1-490"><a href="#cb1-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-491"><a href="#cb1-491" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>