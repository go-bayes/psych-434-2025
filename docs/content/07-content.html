<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.5">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph Bulbulia">
<meta name="dcterms.date" content="2024-04-22">

<title>Causal Inference: Effect-Modification and Interaction – PSYC 434 Conducting Research Across Cultures: Trimester 1, 2024</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-cb64309e6bcb4fe4e8f7b1d812ed84fe.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ebb6838dc08a669b2ff582ce1331d571.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/table1-1.0/table1_defaults.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 434 Conducting Research Across Cultures: Trimester 1, 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../content/course-outline.html"> 
<span class="menu-text">Course Outline</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-content" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Content</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-content">    
        <li>
    <a class="dropdown-item" href="../content/glossary.pdf">
 <span class="dropdown-text">Glossary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/course-outline.html">
 <span class="dropdown-text">Course Outline</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/01-content.html">
 <span class="dropdown-text">Week 1: Course Introduction - R (installing packages)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/02-content.html">
 <span class="dropdown-text">Week 2: Causal Diagrams - Elementary Structures and Rules - R (using the interface)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/03-content.html">
 <span class="dropdown-text">Week 3: Causal Diagrams - Confounding Bias - R (regression/simulation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/04-content.html">
 <span class="dropdown-text">Week 4: Causal Diagrams - Interaction, Measurement Bias, Selection Bias - R (regression/simulation)</span></a>
  </li>  
        <li class="dropdown-header">Week 5: Quiz - R (regression/simulation/reporting)</li>
        <li>
    <a class="dropdown-item" href="../content/06-content.html">
 <span class="dropdown-text">Week 6: Causal Inference - Key Concepts ATE - R (regression/simulation: ATE)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/07-content.html">
 <span class="dropdown-text">Week 7: Causal Inference - Key Concept CATE - R (regression/simulation: ATE)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/08-content.html">
 <span class="dropdown-text">Week 8: Causal Inference - Estimation of ATE and CATE - R and LaTeX</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/09-content.html">
 <span class="dropdown-text">Week 9: Hands On: Full Analysis in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/10-content.html">
 <span class="dropdown-text">Week 10: Working with Quarto Documents</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/11-content.html">
 <span class="dropdown-text">Week 11: Measurement: Factor Analysis, CFA, MultiGroup CFA, Partial Invariance</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/12-content.html">
 <span class="dropdown-text">Week 12: Measurement: Conceptual Problems</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Causal Inference: Effect-Modification and Interaction</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Joseph Bulbulia <a href="mailto:joseph.bulbulia@vuw.ac.nz" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-5861-2056" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Victoria University of Wellington, New Zealand
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 22, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#if-you-learning-nothing-else-from-this-course" id="toc-if-you-learning-nothing-else-from-this-course" class="nav-link active" data-scroll-target="#if-you-learning-nothing-else-from-this-course">If you learning nothing else from this course…</a></li>
  <li><a href="#causal-inference-begins-by-stating-a-counterfactual-contrast" id="toc-causal-inference-begins-by-stating-a-counterfactual-contrast" class="nav-link" data-scroll-target="#causal-inference-begins-by-stating-a-counterfactual-contrast">Causal inference begins by stating a counterfactual contrast</a>
  <ul class="collapse">
  <li><a href="#after-stating-the-causal-interest-we-state-the-conditions-needed-for-identifying-this-effect-from-data" id="toc-after-stating-the-causal-interest-we-state-the-conditions-needed-for-identifying-this-effect-from-data" class="nav-link" data-scroll-target="#after-stating-the-causal-interest-we-state-the-conditions-needed-for-identifying-this-effect-from-data">After Stating the Causal Interest, We State the Conditions Needed for Identifying This Effect from Data</a></li>
  <li><a href="#so-in-the-simplest-possible-terms" id="toc-so-in-the-simplest-possible-terms" class="nav-link" data-scroll-target="#so-in-the-simplest-possible-terms">So, in the simplest possible terms</a></li>
  </ul></li>
  <li><a href="#what-do-the-words-moderation-and-interaction-mean" id="toc-what-do-the-words-moderation-and-interaction-mean" class="nav-link" data-scroll-target="#what-do-the-words-moderation-and-interaction-mean">What do the words “Moderation” and “Interaction” mean?</a></li>
  <li><a href="#interaction" id="toc-interaction" class="nav-link" data-scroll-target="#interaction">Interaction</a>
  <ul class="collapse">
  <li><a href="#how-do-we-define-such-a-contrast-between-two-interventions-of-equal-status-in-our-model" id="toc-how-do-we-define-such-a-contrast-between-two-interventions-of-equal-status-in-our-model" class="nav-link" data-scroll-target="#how-do-we-define-such-a-contrast-between-two-interventions-of-equal-status-in-our-model">How do we define such a contrast between two interventions of equal status in our model?</a></li>
  </ul></li>
  <li><a href="#effect-modification" id="toc-effect-modification" class="nav-link" data-scroll-target="#effect-modification">Effect Modification</a>
  <ul class="collapse">
  <li><a href="#heterogeneous-treatment-effects-a-broad-concept-of-effect-modification" id="toc-heterogeneous-treatment-effects-a-broad-concept-of-effect-modification" class="nav-link" data-scroll-target="#heterogeneous-treatment-effects-a-broad-concept-of-effect-modification">Heterogeneous Treatment Effects – a broad concept of effect-modification</a></li>
  <li><a href="#conditional-average-treatment-effect-cate-a-narrower-concept-of-effect-modification." id="toc-conditional-average-treatment-effect-cate-a-narrower-concept-of-effect-modification." class="nav-link" data-scroll-target="#conditional-average-treatment-effect-cate-a-narrower-concept-of-effect-modification.">Conditional Average Treatment Effect (CATE) – a narrower concept of effect-modification.</a></li>
  <li><a href="#comparing-effect-heterogenity-in-groups." id="toc-comparing-effect-heterogenity-in-groups." class="nav-link" data-scroll-target="#comparing-effect-heterogenity-in-groups.">Comparing Effect Heterogenity in Groups.</a></li>
  <li><a href="#summary-of-what-we-learned" id="toc-summary-of-what-we-learned" class="nav-link" data-scroll-target="#summary-of-what-we-learned">Summary of what we learned</a></li>
  </ul></li>
  <li><a href="#lab-part-1-setting-up-your-data" id="toc-lab-part-1-setting-up-your-data" class="nav-link" data-scroll-target="#lab-part-1-setting-up-your-data">Lab Part 1: Setting up your data</a>
  <ul class="collapse">
  <li><a href="#set-up-your-libraries" id="toc-set-up-your-libraries" class="nav-link" data-scroll-target="#set-up-your-libraries">Set up your libraries</a></li>
  <li><a href="#set-up-a-path-to-a-folder-in-your-directory" id="toc-set-up-a-path-to-a-folder-in-your-directory" class="nav-link" data-scroll-target="#set-up-a-path-to-a-folder-in-your-directory">Set up a path to a folder in your directory</a></li>
  <li><a href="#initial-data-wrangling-to-select-the-study-sample" id="toc-initial-data-wrangling-to-select-the-study-sample" class="nav-link" data-scroll-target="#initial-data-wrangling-to-select-the-study-sample">Initial Data Wrangling to select the study sample</a></li>
  <li><a href="#define-your-baseline-covariates-treatment-exposure-and-outcome" id="toc-define-your-baseline-covariates-treatment-exposure-and-outcome" class="nav-link" data-scroll-target="#define-your-baseline-covariates-treatment-exposure-and-outcome">Define your baseline covariates, treatment (exposure), and outcome</a></li>
  <li><a href="#make-your-baseline-table" id="toc-make-your-baseline-table" class="nav-link" data-scroll-target="#make-your-baseline-table">Make your baseline table</a></li>
  <li><a href="#make-exposure-wave-table" id="toc-make-exposure-wave-table" class="nav-link" data-scroll-target="#make-exposure-wave-table">Make exposure wave table</a></li>
  <li><a href="#table-for-the-outcome" id="toc-table-for-the-outcome" class="nav-link" data-scroll-target="#table-for-the-outcome">Table for the outcome</a></li>
  <li><a href="#inspect-the-distribution-of-the-exposure-in-treatment-wave" id="toc-inspect-the-distribution-of-the-exposure-in-treatment-wave" class="nav-link" data-scroll-target="#inspect-the-distribution-of-the-exposure-in-treatment-wave">Inspect the distribution of the exposure in treatment wave</a></li>
  <li><a href="#another-graph-shift-interventions-up" id="toc-another-graph-shift-interventions-up" class="nav-link" data-scroll-target="#another-graph-shift-interventions-up">Another Graph: Shift Interventions Up</a></li>
  <li><a href="#check-for-change-in-the-treatment-positivity" id="toc-check-for-change-in-the-treatment-positivity" class="nav-link" data-scroll-target="#check-for-change-in-the-treatment-positivity">Check for change in the treatment (Positivity )</a></li>
  <li><a href="#explanation-for-the-table" id="toc-explanation-for-the-table" class="nav-link" data-scroll-target="#explanation-for-the-table">Explanation for the table</a></li>
  </ul></li>
  <li><a href="#lab-part-2-simulation-to-clarify-why-the-distribution-of-effect-modifiers-matter-for-estimating-treatment-effects" id="toc-lab-part-2-simulation-to-clarify-why-the-distribution-of-effect-modifiers-matter-for-estimating-treatment-effects" class="nav-link" data-scroll-target="#lab-part-2-simulation-to-clarify-why-the-distribution-of-effect-modifiers-matter-for-estimating-treatment-effects">Lab Part 2: Simulation to Clarify Why The Distribution of Effect Modifiers Matter For Estimating Treatment Effects</a></li>
  <li><a href="#lessons-from-lab-2" id="toc-lessons-from-lab-2" class="nav-link" data-scroll-target="#lessons-from-lab-2">Lessons from Lab 2</a></li>
  <li><a href="#appendix-a" id="toc-appendix-a" class="nav-link" data-scroll-target="#appendix-a">Appendix A</a>
  <ul class="collapse">
  <li><a href="#evidence-for-effect-modification-is-relative-to-inclusion-of-other-variables-in-the-model" id="toc-evidence-for-effect-modification-is-relative-to-inclusion-of-other-variables-in-the-model" class="nav-link" data-scroll-target="#evidence-for-effect-modification-is-relative-to-inclusion-of-other-variables-in-the-model">Evidence for effect-modification is relative to inclusion of other variables in the model</a></li>
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<style>
  .boxedblue {
      border: 2px solid blue;
      border-radius: 4px; /* slight roundness */
      padding: 3px 6px; /* vertical | horizontal */
      display: inline-block;
      color: blue;
  }
  .circleblue {
      border: 2px dashed blue;
      border-radius: 50%;
      padding: 3px 6px;
      display: inline-block;
      color: blue;
  }
</style>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Required</strong> - <span class="citation" data-cites="hernan2024WHATIF">(<a href="#ref-hernan2024WHATIF" role="doc-biblioref">Hernan and Robins 2024</a>)</span> Chapters 4-5 <a href="https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&amp;dl=0">link</a></p>
<p><strong>Optional</strong> - <span class="citation" data-cites="vanderweele2007FOURTYPESOFEFFECT">(<a href="#ref-vanderweele2007FOURTYPESOFEFFECT" role="doc-biblioref">Tyler J. VanderWeele and Robins 2007a</a>)</span> <a href="https://www.dropbox.com/scl/fi/drytp2ui2b8o9jplh4bm9/four_types_of_effect_modification__a.6.pdf?rlkey=mb9nl599v93m6kyyo69iv5nz1&amp;dl=0">link</a> - <span class="citation" data-cites="vanderweele2009distinction">(<a href="#ref-vanderweele2009distinction" role="doc-biblioref">Tyler J. VanderWeele 2009</a>)</span> <a href="https://www.dropbox.com/scl/fi/srpynr0dvjcndveplcydn/OutcomeWide_StatisticalScience.pdf?rlkey=h4fv32oyjegdfl3jq9u1fifc3&amp;dl=0">link</a></p>
</div>
</div>
<div class="no-row-height column-margin column-container"></div><div class="no-row-height column-margin column-container"><div id="ref-vanderweele2007FOURTYPESOFEFFECT" class="csl-entry" role="listitem">
———. 2007a. <span>“Four types of effect modification: a classification based on directed acyclic graphs.”</span> <em>Epidemiology (Cambridge, Mass.)</em> 18 (5): 561–68. <a href="https://doi.org/10.1097/EDE.0b013e318127181b">https://doi.org/10.1097/EDE.0b013e318127181b</a>.
</div></div><div class="no-row-height column-margin column-container"><div id="ref-hernan2024WHATIF" class="csl-entry" role="listitem">
Hernan, M. A., and J. M. Robins. 2024. <em>Causal Inference: What If?</em> Chapman &amp; Hall/CRC Monographs on Statistics &amp; Applied Probab. Taylor &amp; Francis. <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/</a>.
</div></div><div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts for the test(s):
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Causal Estimand</strong></li>
<li><strong>Statistical Estimand</strong></li>
<li><strong>Interaction/Moderation</strong></li>
<li><strong>Heterogeneous Treatment Effects</strong></li>
<li><strong>Conditional Average Treatment Effect</strong></li>
<li><strong>Effect Modification</strong></li>
</ul>
</div>
</div>
<section id="if-you-learning-nothing-else-from-this-course" class="level2">
<h2 class="anchored" data-anchor-id="if-you-learning-nothing-else-from-this-course">If you learning nothing else from this course…</h2>
<p>To answer a psychological question we must first ask it.</p>
</section>
<section id="causal-inference-begins-by-stating-a-counterfactual-contrast" class="level2">
<h2 class="anchored" data-anchor-id="causal-inference-begins-by-stating-a-counterfactual-contrast">Causal inference begins by stating a counterfactual contrast</h2>
<p>In the simpliest case, we calculate the contrast between two or more “treatments” or equivalently “exposures”:</p>
<p><span class="math display">
\text{Average Treatment Effect} = \mathbb{E}[Y(a^*) -Y(a)]
</span></p>
<section id="after-stating-the-causal-interest-we-state-the-conditions-needed-for-identifying-this-effect-from-data" class="level3">
<h3 class="anchored" data-anchor-id="after-stating-the-causal-interest-we-state-the-conditions-needed-for-identifying-this-effect-from-data">After Stating the Causal Interest, We State the Conditions Needed for Identifying This Effect from Data</h3>
<p>In observational studies, the next step is to identify this effect by controlling for common causes of both the treatment and outcome (or proxies of such common causes). The regression standardization formula is:</p>
<p><span class="math display">
\widehat{\text{ATE}} = \int \left( \mathbb{E}[Y(a^*) \mid L] - \mathbb{E}[Y(a) \mid L] \right) dP(L)
</span></p>
<p>Where:</p>
<ul>
<li><strong>Statistical Estimand</strong>: <span class="math inline">\widehat{\text{ATE}}</span>, is the estimated average treatment effect.</li>
<li><strong><span class="math inline">\mathbb{E}[Y(a^*) \mid L]</span></strong>: is the expected value (mean) of the outcome variable <span class="math inline">Y</span> when the treatment <span class="math inline">a^*</span> is applied, given the confounders <span class="math inline">L</span>.</li>
<li><strong><span class="math inline">\mathbb{E}[Y(a) \mid L]</span></strong>: is the expected value of <span class="math inline">Y</span> when the treatment <span class="math inline">a</span> is applied, given <span class="math inline">L</span>.</li>
<li><strong><span class="math inline">\mathbb{E}[Y(a^*) \mid L] - \mathbb{E}[Y(a) \mid L]</span></strong>: is the difference in the expected treatments, controlling for <span class="math inline">L</span>.</li>
<li><strong><span class="math inline">\int (...) dP(L)</span></strong>: <span class="math inline">dP(L)</span> is an integral (remember high school math?). Integrals give us areas under curves. Here the area is a distribution of probabilities. To obtain valid inference, the treatment effect is computed over all the probability distribution of <span class="math inline">L</span> in the population.</li>
</ul>
</section>
<section id="so-in-the-simplest-possible-terms" class="level3">
<h3 class="anchored" data-anchor-id="so-in-the-simplest-possible-terms">So, in the simplest possible terms</h3>
<p>Understanding causal inference is fundamentally about comparing what happened with what could have happened <em>an average</em> under different conditions or treatments <em>in some population</em>, while carefully accounting for factors that might confound or distort the comparison that interests us (i.e.&nbsp;that might give a false answer to the question we asked).</p>
</section>
</section>
<section id="what-do-the-words-moderation-and-interaction-mean" class="level2">
<h2 class="anchored" data-anchor-id="what-do-the-words-moderation-and-interaction-mean">What do the words “Moderation” and “Interaction” mean?</h2>
<p>We here these words used freely in psychology. What do they mean? Causal inference allows us to be precise.</p>
<p>Let’s set the term <em>moderation</em> to the side, and in its place consider “effect-modification.” Our task today is to use counterfactual notation to distinguish between two concepts:</p>
<ol type="1">
<li>Interaction</li>
<li>Effect-modification</li>
</ol>
</section>
<section id="interaction" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="interaction">Interaction</h2>
<p>An interaction is a <strong>joint intervention</strong></p>
<p>When assessing “interaction” we are interested in the combined effect of two interventions (two “treatments” or “exposures”).</p>
<p>Call these treatments, <span class="math inline">A</span> and <span class="math inline">B</span>. Call the outcome <span class="math inline">Y</span>.</p>
<p>Recall that in potential outcomes terminology, we defined the potential outcome under treatment <span class="math inline">A = \tilde{a}</span>:</p>
<p><span class="math display">
Y(\tilde{a})
</span></p>
<p>And we identify <span class="math inline">Y(\tilde{a})</span> from data using the consistency assumption: <span class="math inline">Y_i(\tilde{a}) = (Y_i |A_i = \tilde{a})</span>, assuming that <span class="math inline">Y_i(\tilde{a})\coprod A|L</span>, where, again, <span class="math inline">L</span> donotes a set of measured covariates sufficient to insure no confounding (no common causes), or equivalently, no open backdoor path between <span class="math inline">A</span> and <span class="math inline">Y</span>.</p>
<p>A joint intervention of two treatments, call them <span class="math inline">A</span> and <span class="math inline">B</span>, which may act on <span class="math inline">Y</span>, requires that we extend our notation:</p>
<p><span class="math display">
Y(\tilde{a}, \tilde{b})
</span> This is the effect on <span class="math inline">Y</span> when <span class="math inline">A</span> is set to <span class="math inline">\tilde{a}</span> amd <span class="math inline">B</span> is set to <span class="math inline">\tilde{b}</span>.</p>
<p>In addition to requiring <span class="math inline">Y_i(\tilde{a}) = (Y_i \mid A_i = \tilde{a})</span>, assuming that <span class="math inline">Y_i(\tilde{a}) \coprod A \mid L</span>, we require that for all <span class="math inline">i \in 1\dots N</span> individuals in the target population, both <span class="math inline">Y_i(\tilde{b}) = (Y_i \mid B_i = \tilde{b})</span>, and that <span class="math inline">Y_i(\tilde{b}) \coprod B \mid Q</span>, where <span class="math inline">Q</span> denotes a set of confounders sufficient to ensure no confounding for the effect of <span class="math inline">B</span> on <span class="math inline">Y</span>.</p>
<p>Notably, the sets <span class="math inline">L</span> and <span class="math inline">Q</span> may have overlapping variables, which in set notation we write:</p>
<p><span class="math display">
L \cap Q \not\equiv \emptyset
</span></p>
<p>That is the union of <span class="math inline">L</span> and <span class="math inline">Q</span> does not imply the empty set, which implies that identification may be harder when there are interactions. Statistical estimation is more difficult too, but we’ll ignore that.</p>
<section id="how-do-we-define-such-a-contrast-between-two-interventions-of-equal-status-in-our-model" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="how-do-we-define-such-a-contrast-between-two-interventions-of-equal-status-in-our-model">How do we define such a contrast between two interventions of equal status in our model?</h3>
<p>Consider the effect of beliefs in Big Gods (treatment, denoted <span class="math inline">A</span>) on social complexity (outcome, denoted<span class="math inline">Y</span>), potentially influenced by a culture’s monumental architecture (treatment, denoted <span class="math inline">B</span>). Suppose we wish to assess the individual and combined effects of <span class="math inline">A</span> and <span class="math inline">B</span> on the difference scale. Let assume the treatments are binary variables.</p>
<p>In the counterfactual framework, we say there is evidence for interaction only if the following inequality were to hold:</p>
<p><span class="math display">\bigg(\underbrace{\mathbb{E}[Y(1,1)]}_{\text{joint exposure}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither exposed}}\bigg) - \bigg[ \bigg(\underbrace{\mathbb{E}[Y(1,0)]}_{\text{only A exposed}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither exposed}}\bigg) + \bigg(\underbrace{\mathbb{E}[Y(0,1)]}_{\text{only B exposed}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither exposed}} \bigg)\bigg] \neq 0 </span></p>
<p>Expanding the terms inside the brackets:</p>
<p><span class="math display"> \mathbb{E}[Y(1,1)] - \mathbb{E}[Y(0,0)] - \mathbb{E}[Y(1,0)] + \mathbb{E}[Y(0,0)] - \mathbb{E}[Y(0,1)] + \mathbb{E}[Y(0,0)] </span></p>
<p>And cancelling <span class="math inline">\mathbb{E}[Y(0,0)]</span>, which appears three times, once with a minus sign and twice with a plus sign, simplifies to:</p>
<p><span class="math display"> \mathbb{E}[Y(1,1)] - \mathbb{E}[Y(1,0)] - \mathbb{E}[Y(0,1)] + \mathbb{E}[Y(0,0)] </span></p>
<p>And we define interaction on the additive scale:</p>
<p><span class="math display"> \underbrace{\mathbb{E}[Y(1,1)]}_{\text{joint exposure}} - \underbrace{\mathbb{E}[Y(1,0)]}_{\text{only A exposed}} - \underbrace{\mathbb{E}[Y(0,1)]}_{\text{only B exposed}} + \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither exposed}} \neq 0 </span></p>
<p>The estimand is net interaction effect, after accounting for the individual effects of <span class="math inline">A</span> and <span class="math inline">B</span>, as well as the baseline where neither treatment <span class="math inline">A</span> nor treatment <span class="math inline">B</span> is given.</p>
<p>A positive value would indicate evidence for additive interaction. A negative value would indicate evidence for sub-additive interaction. A value near zero would imply no reliable evidence for interaction.</p>
<p>Note that the order of the terms does not matter:</p>
<p><span class="math display">
Y(\tilde{a}, \tilde{b})\equiv Y(\tilde{b}, \tilde{a})
</span></p>
<section id="having-defined-the-causal-estimand-we-next-consider-what-would-be-needed-to-identify-it-using-data" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="having-defined-the-causal-estimand-we-next-consider-what-would-be-needed-to-identify-it-using-data">Having defined the causal estimand, we next consider what would be needed to identify it using data?</h4>
<p>For this we can write our causal diagram. <a href="#fig-dag-interaction" class="quarto-xref">Figure&nbsp;1</a> describes the structure of the identification problem:</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-interaction" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-content_files/figure-html/fig-dag-interaction-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This diagram presents the individual and joint effects of two exposures, A and B, on outcome Y. We assume that A and B are causally independent. If either exposure affects the other, then we may conduct effect-modification analysis or mediation analysis, but we should avoid causal interaction analysis. The diagram includes confounders L and W. Control for these confounders is necessary to close the backdoor paths that relate each exposure, A and B, to the outcome. Each exposure has equal status in our model: Y(a,b) = Y(b,a). The red path denotes paths of confounding.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here, <a href="#fig-dag-interaction" class="quarto-xref">Figure&nbsp;1</a> clarifies the need to evaluate two sources of counfounding, one for each intervention (<span class="math inline">A</span> and <span class="math inline">B</span>).</p>
<p>By adjusting for <span class="math inline">L_{0}</span> we obtain an unbiased estimate of the <span class="math inline">A\to Y</span> path.</p>
<p>By adjusting for <span class="math inline">Q_{0}</span> we obtain an unbiased estimate of the <span class="math inline">B\to Y</span> path. As indicated in <a href="#fig-dag-interaction-solved" class="quarto-xref">Figure&nbsp;2</a>, we must condition on both <span class="math inline">L_{0}</span> and <span class="math inline">Q_{0}</span> to identify causal interaction conceived as a joint interaction.</p>
<!-- [^noteinteraction] -->
<!--  [^noteinteraction]: An important complication is that evidence for causal interaction may differ depending on the measurement scale one chooses to assess it [@vanderweele2014; @vanderweele2012; @vanderweele2014]. For most applications in psychological science we would use the the causal difference scale (refer to @vanderweele2014 for discussion).  We set this complication to the side, noting that investigators must state the scale of causal contrast on which there study focusses.  -->
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-interaction-solved" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-interaction-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-content_files/figure-html/fig-dag-interaction-solved-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-interaction-solved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: We adjust for confounding in causal interaction analysis by adjusting for all confounders of the A to Y path as well as all for the B to Y path. The box over the confounders indicates the biasing paths are closed.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Consider the following set of plausible confounders:</p>
<p><strong>L</strong>: variables in <span class="math inline">L</span> that might confound the relationship between beliefs in Big Gods and social complexity:</p>
<ol type="1">
<li><strong>General religiosity</strong>: prevalence of religion might influence both the belief in Big Gods and social complexity.</li>
<li><strong>Cultural norms and values</strong>: ingrained social norms and values, not any part of religion.</li>
<li><strong>Historical path dependent events</strong>: e.g.&nbsp;conquest.</li>
<li><strong>Education</strong>: affects religious beliefs and the complexity.</li>
<li><strong>Economic development</strong>: economic conditions might whether people prefer religious practices or resource intensive hobbies and also, social complexity.</li>
<li><strong>Political stability</strong>: stable governance can influence both the proliferation of religious practices and the development of complex social structures</li>
<li><strong>Political complexity in the past</strong>: huge confounder, must be adjusted for.</li>
<li><strong>Beliefs in big gods in the past</strong>: huge confounder, must be adjusted for.</li>
</ol>
<p><strong>Q</strong>: variables in <span class="math inline">Q</span> that that might confound the relationship between monumental architecture and social complexity:</p>
<ol type="1">
<li><strong>Technology</strong>: for constructing of monumental architecture and managing social complexity.</li>
<li><strong>Economic resources</strong>: as above (overlap)</li>
<li><strong>Historical path dependent events</strong>: e.g.&nbsp;conquestm as above</li>
<li><strong>Labour</strong>: the availability of builders, slaves, etc.</li>
<li><strong>Geography</strong>: natural resources can affect a society’s ability to build monumental structures and its social development.</li>
<li><strong>Cultural norms and values</strong>: ingrained social norms and values, not any part of religion.</li>
<li><strong>Political complexity in the past</strong>: huge confounder, must be adjusted for.</li>
<li><strong>Beliefs in big gods in the past</strong>: huge confounder, must be adjusted for.</li>
</ol>
<p>As we see:</p>
<p><span class="math display">
L \cap Q \not\equiv \emptyset
</span></p>
<p>However, the set of control variables are larger, and note, we are assuming that monumental architecture and big God beliefs do not affect each other.</p>
</section>
</section>
</section>
<section id="effect-modification" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="effect-modification">Effect Modification</h2>
<p><strong>It is often scientifically interesting to consider whether treatment effects vary over levels of other variable without imagining a double intervention.</strong> Broadly, we will think of “effect-modification” as a set of related and overlapping concepts pertaining to the understanding variability of a single effect within a population.</p>
<section id="heterogeneous-treatment-effects-a-broad-concept-of-effect-modification" class="level3">
<h3 class="anchored" data-anchor-id="heterogeneous-treatment-effects-a-broad-concept-of-effect-modification">Heterogeneous Treatment Effects – a broad concept of effect-modification</h3>
<p>Heterogeneous Treatment Effects (HTE) refer to settings where treatment effects vary across individuals or subgroups within a study population. This variability can arise from differences in baseline characteristics, environmental conditions, histories, …. much of which is unmeasured.</p>
<p><strong>Appendix A</strong> discusses the challenges in identifying HTE from data, but we already know that individual causal effects are not typically identifiable, and so heteroeneous treatment effects, at the limit of individual causal effects, are elusive.</p>
</section>
<section id="conditional-average-treatment-effect-cate-a-narrower-concept-of-effect-modification." class="level3">
<h3 class="anchored" data-anchor-id="conditional-average-treatment-effect-cate-a-narrower-concept-of-effect-modification.">Conditional Average Treatment Effect (CATE) – a narrower concept of effect-modification.</h3>
<p>We might be interested estimating average treatment effects within specific levels of measured covariates</p>
<p>When our focus is estimation of the average treatment effect conditional on a specific level of a covariate or set of covariates. Our causal estimand is often written:</p>
<p><span class="math display">\text{CATE}(x) = E[Y(1) - Y(0) | X = x]</span></p>
<p>where <span class="math inline">X = x</span>, where <span class="math inline">X</span> denotes the level of a measured covariate or covariates of interest.</p>
<p>The question: how does a causal effect vary within the population defined by levels of stratum <span class="math inline">X=x</span></p>
</section>
<section id="comparing-effect-heterogenity-in-groups." class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="comparing-effect-heterogenity-in-groups.">Comparing Effect Heterogenity in Groups.</h3>
<p>We might be interested in the following causal quantity (estimand), which compares two conditional average treatment effects between levels defined by <span class="math inline">G = \tilde{g}</span>:</p>
<p><span class="math display">{\gamma} = \overbrace{\big( \mathbb{E}[Y(a^*)|G=g] - \mathbb{E}[Y(a)|G=g] \big)}^{{\delta_g}} - \overbrace{\big(\mathbb{E}[Y(a^*)|G=g^{\prime}]- \mathbb{E}[Y(a)|G=g']\big)}^{{\delta_{g^{\prime}}}}</span></p>
<p>Suppose <span class="math inline">A</span> is the treatment, <span class="math inline">G</span> is the effect-modifier, and <span class="math inline">Y</span> is the outcome. The analysis of effect-modification assesses whether the effect of <span class="math inline">A</span> on <span class="math inline">Y</span> is different across levels of <span class="math inline">G</span> (i.e., whether the effect of <span class="math inline">A</span> on <span class="math inline">Y</span> is different when <span class="math inline">G = g_1</span> compared to when <span class="math inline">G = g_2</span>).</p>
<p>What do we need to identify such effects? Note that <span class="math inline">G</span> here is not an intervention variable. It might not be coherent to imagine that <span class="math inline">G</span> <em>can</em> be intervened upon.</p>
<p><a href="#fig-dag-effect-modification" class="quarto-xref">Figure&nbsp;3</a> is a causal diagram. Imagine we are intereste in whether the effect of <span class="math inline">A</span> on <span class="math inline">Y</span> differs across levels of <span class="math inline">G</span>. Because we are not interested in the causal effect of <span class="math inline">G</span> as such, but rather, how the effect of <span class="math inline">A</span> varies across <span class="math inline">G</span>, we need <em>not</em> adjust by <span class="math inline">Q</span>. However, which variables shall we include in our model? What will happen if we assess the <span class="math inline">G</span> by examining a regression coefficient? Suppose <span class="math inline">L</span> were not a confounder of <span class="math inline">A</span> to <span class="math inline">Y</span>. How then should we interpret our model?</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-effect-modification" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-effect-modification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-content_files/figure-html/fig-dag-effect-modification-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-effect-modification-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Imagine A is an experiment. How shall we investigate effect modification of A on Y by Z? Can you see why regression coefficients will not work?
</figcaption>
</figure>
</div>
</div>
</div>
<p>Often, it is useful to obtain causal effects by restricting to one level of a population. Where <span class="math inline">G</span> denotes a society, consider:</p>
<ol type="1">
<li><strong>Causal effect within North American societies (</strong><span class="math inline">G=1</span>): <span class="math display">\delta_{g_1} = \mathbb{E}[Y(1)|G= g_1] - \mathbb{E}[Y(0)|G = g_1]</span></li>
</ol>
<p>Here, <span class="math inline">\delta_{g_2}</span> represents the estimated causal effect of changing the exposure from <span class="math inline">A = 0</span> to <span class="math inline">A = 1</span> within the North American societies.</p>
<ol start="2" type="1">
<li><p><strong>Causal effect within Continental societies (</strong><span class="math inline">G=g_2</span>):</p>
<p><span class="math display">\delta_{g2} = \mathbb{E}[Y(1)|G=g_2] - \mathbb{E}[Y(0)|G=g_2]</span></p>
<p>Similarly, <span class="math inline">{\delta}_{g_2}</span> denotes the estimated causal effect for the Continental societies.</p></li>
<li><p><strong>Comparing causal effects across groups</strong>:</p>
<p><span class="math display">{\gamma} = {\delta}_{g_1} - {\delta}_{g_2}</span></p></li>
</ol>
<p>The quantity <span class="math inline">{\gamma}</span> defines the difference in the causal estimands between the two groups. A nonzero <span class="math inline">\hat{\gamma}</span> indicates effect-modification, suggesting that the effect of changing the exposure differs between the two groups. If we were to observe that <span class="math inline">\hat{\gamma} \neq 0</span>, this would provide evidence for variability in the effect of the exposure on the outcome in different groups. Note that the causal effect for one group might be indistinguishable from zero, and yet we might nevertheless find evidence for effect-modification if the comparison group exhibits reliably different responses from the contrast group that is indistinguishable from zero.</p>
<p>That’s it, we now know our causal quantity of interest. Next week, we’ll develop our statistical estimands, estimators, and begin evaluating effect-modification by groups.</p>
</section>
<section id="summary-of-what-we-learned" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-what-we-learned">Summary of what we learned</h3>
<ul>
<li>Interaction targets a joint intervention in a population</li>
<li>Effect modificiation targets how a single intervention varies by groups within a population</li>
</ul>
<p>Note, to obtain the group-wise contrasts, we must be able to imagine the groups as belonging to a larger population. When thinking of people, we all belong Later we shall consider how measurement complicates this assumption, even if all humans belong to the same species…</p>
</section>
</section>
<section id="lab-part-1-setting-up-your-data" class="level2">
<h2 class="anchored" data-anchor-id="lab-part-1-setting-up-your-data">Lab Part 1: Setting up your data</h2>
<section id="set-up-your-libraries" class="level3">
<h3 class="anchored" data-anchor-id="set-up-your-libraries">Set up your libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"skimr"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(gtsummary)) <span class="fu">install.packages</span>(<span class="st">"gtsummary"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(janitor)) <span class="fu">install.packages</span>(<span class="st">"janitor"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># if you need to update the margot package, uncomment and do this</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("go-bayes/margot")</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("go-bayes/margot")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-up-a-path-to-a-folder-in-your-directory" class="level3">
<h3 class="anchored" data-anchor-id="set-up-a-path-to-a-folder-in-your-directory">Set up a path to a folder in your directory</h3>
<p>This will allow you to save the outputs of models and other information, which will be handy when you are producing your manuscript. Call this <code>push_mods</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Set up a path to a folder in your directory </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create a folder called saved and make a path like this</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>push_mods <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">'/Users/joseph/Library/CloudStorage/Dropbox-v-project/data/saved'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># view it (will be different for you)</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>push_mods</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/joseph/Library/CloudStorage/Dropbox-v-project/data/saved"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># another option</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(object, here::here(push_mods, "object"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="initial-data-wrangling-to-select-the-study-sample" class="level3">
<h3 class="anchored" data-anchor-id="initial-data-wrangling-to-select-the-study-sample">Initial Data Wrangling to select the study sample</h3>
<section id="where-to-find-variable-names-information" class="level4">
<h4 class="anchored" data-anchor-id="where-to-find-variable-names-information">Where to find variable names information</h4>
<p>Find it the data directory here: <a href="https://osf.io/75snb/" class="uri">https://osf.io/75snb/</a></p>
<p>Also see here: <a href="https://github.com/go-bayes/templates/tree/main/method" class="uri">https://github.com/go-bayes/templates/tree/main/method</a></p>
</section>
<section id="think-what-are-my-eligibility-criteria" class="level4">
<h4 class="anchored" data-anchor-id="think-what-are-my-eligibility-criteria">Think, what are my eligibility criteria?</h4>
<ul>
<li>Participated in at baseline</li>
<li>Participated at treatment wave</li>
<li>May have been lost to follow up at the end of the study</li>
<li>Full information on the treatment variable (think about this…)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># eliminate haven labels</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df_nz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df_nz)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df_nz <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">zap_formats</span>(df_nz)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>df_nz <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">zap_label</span>(df_nz)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>df_nz <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">zap_widths</span>(df_nz)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># name output folder</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>push_mods <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"outputs"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># set exposure name</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>name_exposure <span class="ot">&lt;-</span>  <span class="st">"perfectionism"</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain ids for individuals who participated in 2018 and have no missing baseline exposure</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>ids_2018 <span class="ot">&lt;-</span> df_nz <span class="sc">%&gt;%</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(year_measured <span class="sc">==</span> <span class="dv">1</span>, wave <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(name_exposure))) <span class="sc">|&gt;</span> <span class="co"># criteria, no missing</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain ids for individuals who participated in 2019</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>ids_2019 <span class="ot">&lt;-</span> df_nz <span class="sc">%&gt;%</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(year_measured <span class="sc">==</span> <span class="dv">1</span>, wave <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(name_exposure))) <span class="sc">|&gt;</span> <span class="co"># criteria, no missing</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># intersect IDs from 2018 and 2019 to ensure participation in both years</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>ids_2018_2019 <span class="ot">&lt;-</span> <span class="fu">intersect</span>(ids_2018, ids_2019)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(id <span class="sc">%in%</span> ids_2018_2019 <span class="sc">&amp;</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>                  wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, wave) <span class="sc">|&gt;</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"id"</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"wave"</span>,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"year_measured"</span>,</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"age"</span>,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"male"</span>,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"born_nz"</span>,</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"eth_cat"</span>,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">#factor(EthCat, labels = c("Euro", "Maori", "Pacific", "Asian")),</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"employed"</span>,</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Are you currently employed? (this includes self-employment or casual work)</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"edu"</span>,</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "gen_cohort",</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"household_inc"</span>,</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"partner"</span>,</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 0 = no, 1 = yes</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"parent"</span>,</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">"alert_level_combined_lead"</span>, <span class="co"># see bibliography</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 0 = no, 1 = yes</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"political_conservative"</span>, <span class="co"># see nzavs sheet</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hours_exercise"</span>, <span class="co"># see nzavs sheet</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"agreeableness"</span>, </span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mini-IPIP6 Agreeableness (also modelled as empathy facet)</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sympathize with others' feelings.</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am not interested in other people's problems.</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Feel others' emotions.</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am not really interested in others.</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">"conscientiousness"</span>,</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># see mini ipip6</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get chores done right away.</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Like order.</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make a mess of things.</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Often forget to put things back in their proper place.</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">"extraversion"</span>,</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mini-IPIP6 Extraversion</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am the life of the party.</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Don't talk a lot.</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep in the background.</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Talk to a lot of different people at parties.</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">"honesty_humility"</span>,</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># see mini ipip6</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Would like to be seen driving around in a very expensive car.</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Would get a lot of pleasure from owning expensive luxury goods.</span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Feel entitled to more of everything.</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Deserve more things in life.</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">"openness"</span>,</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># see mini ipip6</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Have a vivid imagination.</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Have difficulty understanding abstract ideas.</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Do not have a good imagination.</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am not interested in abstract ideas.</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">"neuroticism"</span>,</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># see mini ipip6</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Have frequent mood swings.</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am relaxed most of the time.</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get upset easily.</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Seldom feel blue.</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">"modesty"</span>,</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # see mini ipip6</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # I want people to know that I am an important person of high status,</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # I am an ordinary person who is no better than others.</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # I wouldn’t want people to treat me as though I were superior to them.</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # I think that I am entitled to more respect than the average person is</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>    <span class="co">#"w_gend_age_ethnic",</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sample_weights"</span>, <span class="co"># see nzavs sheet</span></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">"neighbourhood_community"</span>,</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># #I feel a sense of community with others in my local neighbourhood.</span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">"belong"</span>, <span class="co"># see nzavs sheet</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rural_gch_2018_l"</span>,<span class="co"># see nzavs sheet</span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">"support"</span>,</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "support_help",</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # 'There are people I can depend on to help me if I really need it.</span></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "support_turnto",</span></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # There is no one I can turn to for guidance in times of stress.</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "support_rnoguidance",</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>    <span class="co">#There is no one I can turn to for guidance in times of stress.</span></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">"perfectionism"</span>,</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>    <span class="st">"religion_religious"</span>,</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kessler_latent_depression"</span>,</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kessler_latent_anxiety"</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>    <span class="co">#initialize 'censored'</span></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">censored =</span> <span class="fu">ifelse</span>(<span class="fu">lead</span>(year_measured) <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify 'censored' based on the condition; no need to check for NA here as 'censored' is already defined in the previous step</span></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">censored =</span>  <span class="fu">ifelse</span>(<span class="fu">is.na</span>(censored) <span class="sc">&amp;</span></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>                         year_measured <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, censored)</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>year_measured) <span class="sc">|&gt;</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rescale these variables, to get all variables on a similar scale</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>    <span class="co"># otherwise your models can blow up, or become uninterpretable. </span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">household_inc_log =</span> <span class="fu">log</span>(household_inc <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">hours_exercise_log =</span> <span class="fu">log</span>(hours_exercise <span class="sc">+</span> <span class="dv">1</span>)  ) <span class="sc">|&gt;</span></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a>      household_inc,</span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>      hours_exercise)</span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::rename(sample_weights = w_gend_age_ethnic,</span></span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>  <span class="co">#               sample_origin =  sample_origin_names_combined) |&gt;</span></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, wave) <span class="sc">|&gt;</span></span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>  <span class="at">rural_gch_2018_l =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(rural_gch_2018_l)),</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   parent = as.numeric(as.character(parent)),</span></span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">partner =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(partner)),</span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">born_nz =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(born_nz)),</span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">censored =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(censored)),</span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">employed =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(employed))</span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, wave) <span class="sc">|&gt;</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a><span class="co"># check n in this sample</span></span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>n_participants <span class="ot">&lt;-</span> skimr<span class="sc">::</span><span class="fu">n_unique</span>(dat_long<span class="sc">$</span>id)</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a><span class="co"># make number pretty</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>n_participants<span class="ot">&lt;-</span> <span class="fu">prettyNum</span>(n_participants,<span class="at">big.mark=</span><span class="st">","</span>)</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a><span class="co"># save this so that you can use it in your manuscript</span></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>margot<span class="sc">::</span><span class="fu">here_save</span>(n_participants, <span class="st">"n_participants"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object saved to: /Users/joseph/GIT/psych-434-2025/outputs/n_participants.rds
Object size: 0.00 MB
👍 Save operation completed successfully!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># try reading </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n_participants_did_it_work_question_mark <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">here_read</span>(<span class="st">"n_participants"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object read from: /Users/joseph/GIT/psych-434-2025/outputs/n_participants.rds
Object size: 0.00 MB
👍 Read operation completed successfully!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># n_participants_did_it_work_question_mark</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are N = 14,439 participants.</p>
</section>
</section>
<section id="define-your-baseline-covariates-treatment-exposure-and-outcome" class="level3">
<h3 class="anchored" data-anchor-id="define-your-baseline-covariates-treatment-exposure-and-outcome">Define your baseline covariates, treatment (exposure), and outcome</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for example </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>baseline_vars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"male"</span>, <span class="st">"edu"</span>, <span class="st">"eth_cat"</span>, <span class="st">"partner"</span>, <span class="st">"employed"</span>, <span class="st">"born_nz"</span>, <span class="st">"neighbourhood_community"</span>, <span class="st">"household_inc_log"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">"parent"</span>, <span class="st">"religion_religious"</span>, <span class="st">"rural_gch_2018_l"</span>,<span class="st">"sample_weights"</span>, <span class="st">"employed"</span>, <span class="st">"alert_level_combined_lead"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># treatment</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>exposure_var <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"perfectionism"</span>, <span class="st">"censored"</span>) <span class="co"># we will use the censored variable later</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># outcome, can be many</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>outcome_vars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"kessler_latent_anxiety"</span>, <span class="st">"kessler_latent_depression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="make-your-baseline-table" class="level3">
<h3 class="anchored" data-anchor-id="make-your-baseline-table">Make your baseline table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the setdiff command allows us to remove names from the baseline vars list that we do not want</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>base_var <span class="ot">&lt;-</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(baseline_vars, <span class="fu">c</span>(<span class="st">"censored"</span>, <span class="st">"sample_weights"</span>, <span class="st">"alert_level_combined_lead"</span>, outcome_vars))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  we only want the data at baseline </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># select only baseline wave</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>dt_18 <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># get only the baseline variables for the table</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>selected_base_cols <span class="ot">&lt;-</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  dt_18 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">all_of</span>(base_var))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#check</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>colnames_use <span class="ot">&lt;-</span> <span class="fu">colnames</span>(selected_base_cols)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>colnames_use</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "age"                     "male"                   
 [3] "edu"                     "eth_cat"                
 [5] "partner"                 "employed"               
 [7] "born_nz"                 "neighbourhood_community"
 [9] "household_inc_log"       "parent"                 
[11] "religion_religious"      "rural_gch_2018_l"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # aside to get different names in lists</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># everything_better_cols &lt;- c(colnames_use, "inkuk")</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># everything_better_cols</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # get rid of name</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># everything_worse_cols &lt;- setdiff(everything_better_cols, "inkuk")</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># baseline table</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># this is just a demo of another package, which can be useful for quick tables, less for your manuscripts</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>no_miss_df <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">table1</span>( <span class="sc">~</span> perfectionism  <span class="sc">|</span> wave <span class="sc">*</span> eth_cat ,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> no_miss_df,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">overall =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="Rtable1">
<table class="Rtable1 table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th class="grouplabel" data-quarto-table-cell-role="th"></th>
<th colspan="4" class="grouplabel" data-quarto-table-cell-role="th"><div>
2018
</div></th>
<th colspan="4" class="grouplabel" data-quarto-table-cell-role="th"><div>
2020
</div></th>
</tr>
<tr class="even">
<th class="rowlabel firstrow lastrow" data-quarto-table-cell-role="th"></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">euro<br>
<span class="stratn">(N=6165)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">maori<br>
<span class="stratn">(N=717)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">pacific<br>
<span class="stratn">(N=156)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">asian<br>
<span class="stratn">(N=305)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">euro<br>
<span class="stratn">(N=4690)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">maori<br>
<span class="stratn">(N=493)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">pacific<br>
<span class="stratn">(N=95)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">asian<br>
<span class="stratn">(N=226)</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowlabel firstrow">perfectionism</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>3.06 (1.32)</td>
<td>3.15 (1.34)</td>
<td>3.22 (1.31)</td>
<td>3.47 (1.26)</td>
<td>2.94 (1.33)</td>
<td>3.12 (1.44)</td>
<td>3.20 (1.34)</td>
<td>3.36 (1.37)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">2.97 [1.00, 7.00]</td>
<td class="lastrow">3.00 [1.00, 7.00]</td>
<td class="lastrow">3.04 [1.00, 6.97]</td>
<td class="lastrow">3.35 [1.00, 7.00]</td>
<td class="lastrow">2.69 [1.00, 7.00]</td>
<td class="lastrow">2.98 [1.00, 7.00]</td>
<td class="lastrow">3.00 [1.00, 6.69]</td>
<td class="lastrow">3.34 [1.00, 6.64]</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>table_baseline <span class="ot">&lt;-</span> selected_base_cols <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>(<span class="at">case =</span> <span class="st">"title"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing =</span> <span class="st">"ifany"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"column"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="fu">c</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"{mean} ({sd})"</span>, <span class="co"># Mean and SD</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"{min}, {max}"</span>, <span class="co"># Range (Min, Max)</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"{p25}, {p75}"</span> <span class="co"># IQR (25th percentile, 75th percentile)</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"continuous2"</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Exposure + Demographic Variables**"</span>) <span class="sc">|&gt;</span> <span class="co"># update the column header</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># baseline</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>table_baseline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="cuigkvngdp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cuigkvngdp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cuigkvngdp thead, #cuigkvngdp tbody, #cuigkvngdp tfoot, #cuigkvngdp tr, #cuigkvngdp td, #cuigkvngdp th {
  border-style: none;
}

#cuigkvngdp p {
  margin: 0;
  padding: 0;
}

#cuigkvngdp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cuigkvngdp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cuigkvngdp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cuigkvngdp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cuigkvngdp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cuigkvngdp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cuigkvngdp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cuigkvngdp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cuigkvngdp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cuigkvngdp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cuigkvngdp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cuigkvngdp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cuigkvngdp .gt_spanner_row {
  border-bottom-style: hidden;
}

#cuigkvngdp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cuigkvngdp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cuigkvngdp .gt_from_md > :first-child {
  margin-top: 0;
}

#cuigkvngdp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cuigkvngdp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cuigkvngdp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cuigkvngdp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cuigkvngdp .gt_row_group_first td {
  border-top-width: 2px;
}

#cuigkvngdp .gt_row_group_first th {
  border-top-width: 2px;
}

#cuigkvngdp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cuigkvngdp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cuigkvngdp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cuigkvngdp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cuigkvngdp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cuigkvngdp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cuigkvngdp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cuigkvngdp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cuigkvngdp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cuigkvngdp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cuigkvngdp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cuigkvngdp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cuigkvngdp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cuigkvngdp .gt_left {
  text-align: left;
}

#cuigkvngdp .gt_center {
  text-align: center;
}

#cuigkvngdp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cuigkvngdp .gt_font_normal {
  font-weight: normal;
}

#cuigkvngdp .gt_font_bold {
  font-weight: bold;
}

#cuigkvngdp .gt_font_italic {
  font-style: italic;
}

#cuigkvngdp .gt_super {
  font-size: 65%;
}

#cuigkvngdp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cuigkvngdp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cuigkvngdp .gt_indent_1 {
  text-indent: 5px;
}

#cuigkvngdp .gt_indent_2 {
  text-indent: 10px;
}

#cuigkvngdp .gt_indent_3 {
  text-indent: 15px;
}

#cuigkvngdp .gt_indent_4 {
  text-indent: 20px;
}

#cuigkvngdp .gt_indent_5 {
  text-indent: 25px;
}

#cuigkvngdp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cuigkvngdp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Exposure + Demographic Variables</strong></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 14,439</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Age</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="stat_0">50 (14)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="stat_0">18, 94</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Q1, Q3</td>
<td class="gt_row gt_center" headers="stat_0">41, 61</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Male</td>
<td class="gt_row gt_center" headers="stat_0">5,238 (36%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Edu</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="stat_0">5.38 (2.72)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="stat_0">0.00, 10.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Q1, Q3</td>
<td class="gt_row gt_center" headers="stat_0">3.00, 7.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">110</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Eth Cat</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;euro</td>
<td class="gt_row gt_center" headers="stat_0">11,835 (83%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;maori</td>
<td class="gt_row gt_center" headers="stat_0">1,526 (11%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;pacific</td>
<td class="gt_row gt_center" headers="stat_0">314 (2.2%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;asian</td>
<td class="gt_row gt_center" headers="stat_0">655 (4.6%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">109</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Partner</td>
<td class="gt_row gt_center" headers="stat_0">10,661 (76%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">399</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Employed</td>
<td class="gt_row gt_center" headers="stat_0">11,466 (80%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">22</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Born Nz</td>
<td class="gt_row gt_center" headers="stat_0">11,398 (79%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">25</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Neighbourhood Community</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="stat_0">4.23 (1.66)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="stat_0">1.00, 7.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Q1, Q3</td>
<td class="gt_row gt_center" headers="stat_0">2.99, 5.95</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">73</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Household Inc log</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td class="gt_row gt_center" headers="stat_0">11.41 (0.74)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Min, Max</td>
<td class="gt_row gt_center" headers="stat_0">0.71, 14.40</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Q1, Q3</td>
<td class="gt_row gt_center" headers="stat_0">11.00, 11.92</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">655</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Parent</td>
<td class="gt_row gt_center" headers="stat_0">10,350 (72%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Religion Religious</td>
<td class="gt_row gt_center" headers="stat_0">5,218 (36%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">19</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Rural Gch 2018 l</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_0">8,822 (62%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_0">2,784 (19%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="stat_0">1,740 (12%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="stat_0">820 (5.7%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;5</td>
<td class="gt_row gt_center" headers="stat_0">170 (1.2%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_0">103</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save your baseline table</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>margot<span class="sc">::</span><span class="fu">here_save</span>(table_baseline, <span class="st">"table_baseline"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object saved to: /Users/joseph/GIT/psych-434-2025/outputs/table_baseline.rds
Object size: 0.00 MB
👍 Save operation completed successfully!</code></pre>
</div>
</div>
</section>
<section id="make-exposure-wave-table" class="level3">
<h3 class="anchored" data-anchor-id="make-exposure-wave-table">Make exposure wave table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get first and second wave</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>dt_18_19 <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span> <span class="sc">|</span> wave <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we need to drop unused levels of the wave</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get vars.</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>selected_exposure_cols <span class="ot">&lt;-</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  dt_18_19 <span class="sc">%&gt;%</span> <span class="fu">select</span>(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">"perfectionism"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"wave"</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#str(selected_exposure_cols)</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>table_exposures <span class="ot">&lt;-</span> selected_exposure_cols <span class="sc">%&gt;%</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>(<span class="at">case =</span> <span class="st">"title"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  labelled<span class="sc">::</span><span class="fu">to_factor</span>() <span class="sc">%&gt;%</span>  <span class="co"># ensure consistent use of pipe operator</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"Wave"</span>,  <span class="co">#specify the grouping variable. Adjust "Wave" to match the cleaned column name</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing =</span> <span class="st">"always"</span>, </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"column"</span>,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># statistic = list(all_continuous() ~ "{mean} ({sd})")  # Uncomment and adjust if needed for continuous variables</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  add_n() %&gt;%  # Add column with total number of non-missing observations</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Exposure Variables by Wave**"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Update the column header</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>()</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>table_exposures</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="ttfwnbazze" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ttfwnbazze table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ttfwnbazze thead, #ttfwnbazze tbody, #ttfwnbazze tfoot, #ttfwnbazze tr, #ttfwnbazze td, #ttfwnbazze th {
  border-style: none;
}

#ttfwnbazze p {
  margin: 0;
  padding: 0;
}

#ttfwnbazze .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ttfwnbazze .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ttfwnbazze .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ttfwnbazze .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ttfwnbazze .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ttfwnbazze .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ttfwnbazze .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ttfwnbazze .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ttfwnbazze .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ttfwnbazze .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ttfwnbazze .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ttfwnbazze .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ttfwnbazze .gt_spanner_row {
  border-bottom-style: hidden;
}

#ttfwnbazze .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ttfwnbazze .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ttfwnbazze .gt_from_md > :first-child {
  margin-top: 0;
}

#ttfwnbazze .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ttfwnbazze .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ttfwnbazze .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ttfwnbazze .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ttfwnbazze .gt_row_group_first td {
  border-top-width: 2px;
}

#ttfwnbazze .gt_row_group_first th {
  border-top-width: 2px;
}

#ttfwnbazze .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ttfwnbazze .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ttfwnbazze .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ttfwnbazze .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ttfwnbazze .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ttfwnbazze .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ttfwnbazze .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ttfwnbazze .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ttfwnbazze .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ttfwnbazze .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ttfwnbazze .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ttfwnbazze .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ttfwnbazze .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ttfwnbazze .gt_left {
  text-align: left;
}

#ttfwnbazze .gt_center {
  text-align: center;
}

#ttfwnbazze .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ttfwnbazze .gt_font_normal {
  font-weight: normal;
}

#ttfwnbazze .gt_font_bold {
  font-weight: bold;
}

#ttfwnbazze .gt_font_italic {
  font-style: italic;
}

#ttfwnbazze .gt_super {
  font-size: 65%;
}

#ttfwnbazze .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ttfwnbazze .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ttfwnbazze .gt_indent_1 {
  text-indent: 5px;
}

#ttfwnbazze .gt_indent_2 {
  text-indent: 10px;
}

#ttfwnbazze .gt_indent_3 {
  text-indent: 15px;
}

#ttfwnbazze .gt_indent_4 {
  text-indent: 20px;
}

#ttfwnbazze .gt_indent_5 {
  text-indent: 25px;
}

#ttfwnbazze .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ttfwnbazze div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Exposure Variables by Wave</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2018</strong><br> N = 14,439<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2019</strong><br> N = 14,439<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Perfectionism</td>
<td class="gt_row gt_center" headers="stat_1">3.00 (2.01, 4.02)</td>
<td class="gt_row gt_center" headers="stat_2">2.99 (2.00, 4.02)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">0</td>
<td class="gt_row gt_center" headers="stat_2">0</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3)</td>
</tr>
</tfoot>

</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save baseline</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">here_save</span>(table_exposures, <span class="st">"table_exposures"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object saved to: /Users/joseph/GIT/psych-434-2025/outputs/table_exposures.rds
Object size: 0.00 MB
👍 Save operation completed successfully!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>table_exposures</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="vzumyzhiiw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vzumyzhiiw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vzumyzhiiw thead, #vzumyzhiiw tbody, #vzumyzhiiw tfoot, #vzumyzhiiw tr, #vzumyzhiiw td, #vzumyzhiiw th {
  border-style: none;
}

#vzumyzhiiw p {
  margin: 0;
  padding: 0;
}

#vzumyzhiiw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vzumyzhiiw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vzumyzhiiw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vzumyzhiiw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vzumyzhiiw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vzumyzhiiw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vzumyzhiiw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vzumyzhiiw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vzumyzhiiw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vzumyzhiiw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vzumyzhiiw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vzumyzhiiw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vzumyzhiiw .gt_spanner_row {
  border-bottom-style: hidden;
}

#vzumyzhiiw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vzumyzhiiw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vzumyzhiiw .gt_from_md > :first-child {
  margin-top: 0;
}

#vzumyzhiiw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vzumyzhiiw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vzumyzhiiw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vzumyzhiiw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vzumyzhiiw .gt_row_group_first td {
  border-top-width: 2px;
}

#vzumyzhiiw .gt_row_group_first th {
  border-top-width: 2px;
}

#vzumyzhiiw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vzumyzhiiw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vzumyzhiiw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vzumyzhiiw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vzumyzhiiw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vzumyzhiiw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vzumyzhiiw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vzumyzhiiw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vzumyzhiiw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vzumyzhiiw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vzumyzhiiw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vzumyzhiiw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vzumyzhiiw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vzumyzhiiw .gt_left {
  text-align: left;
}

#vzumyzhiiw .gt_center {
  text-align: center;
}

#vzumyzhiiw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vzumyzhiiw .gt_font_normal {
  font-weight: normal;
}

#vzumyzhiiw .gt_font_bold {
  font-weight: bold;
}

#vzumyzhiiw .gt_font_italic {
  font-style: italic;
}

#vzumyzhiiw .gt_super {
  font-size: 65%;
}

#vzumyzhiiw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vzumyzhiiw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vzumyzhiiw .gt_indent_1 {
  text-indent: 5px;
}

#vzumyzhiiw .gt_indent_2 {
  text-indent: 10px;
}

#vzumyzhiiw .gt_indent_3 {
  text-indent: 15px;
}

#vzumyzhiiw .gt_indent_4 {
  text-indent: 20px;
}

#vzumyzhiiw .gt_indent_5 {
  text-indent: 25px;
}

#vzumyzhiiw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vzumyzhiiw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Exposure Variables by Wave</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2018</strong><br> N = 14,439<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2019</strong><br> N = 14,439<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Perfectionism</td>
<td class="gt_row gt_center" headers="stat_1">3.00 (2.01, 4.02)</td>
<td class="gt_row gt_center" headers="stat_2">2.99 (2.00, 4.02)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">0</td>
<td class="gt_row gt_center" headers="stat_2">0</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="table-for-the-outcome" class="level3">
<h3 class="anchored" data-anchor-id="table-for-the-outcome">Table for the outcome</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># outcome table -----------------------------------------------------------</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>dt_18_20 <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span> <span class="sc">|</span> wave <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>names_outcomes_tab <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(outcome_vars, dt_18_20)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>names_outcomes_sorted <span class="ot">&lt;-</span> <span class="fu">sort</span>(names_outcomes_tab)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>names_outcomes_final <span class="ot">&lt;-</span> names_outcomes_sorted <span class="co"># consistent workflow</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># better names if desirable</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>selected_outcome_cols <span class="ot">&lt;-</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  dt_18_20 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(names_outcomes_final),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                      wave) </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># |&gt; # example if you want to rename your variables for the table</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     Social_belonging = belong,</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     Annual_charity = charity_donate,</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     Volunteering_hours = hours_charity,</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     Community_gives_money_binary = community_money_binary,</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     Community_gives_time_binary = community_time_binary,</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     Family_gives_money_binary = family_money_binary,</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     Family_gives_time_binary = family_time_binary,</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     Friends_give_money_binary = friends_money_binary,</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     Friends_give_time = friends_time_binary,</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     Social_support = support,</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     Sense_neighbourhood_community = neighbourhood_community</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="co"># order names correctly</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>selected_outcome_cols <span class="ot">&lt;-</span> selected_outcome_cols <span class="sc">%&gt;%</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">sort</span>(<span class="fu">names</span>(selected_outcome_cols)))</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co"># checks</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># str(selected_outcome_cols)</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(selected_outcome_cols)</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>table_outcomes <span class="ot">&lt;-</span> selected_outcome_cols <span class="sc">%&gt;%</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>(<span class="at">case =</span> <span class="st">"title"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  labelled<span class="sc">::</span><span class="fu">to_factor</span>() <span class="sc">%&gt;%</span>  <span class="co"># ensure consistent use of pipe operator</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"Wave"</span>,  <span class="co">#specify the grouping variable. Adjust "Wave" to match the cleaned column name</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing =</span> <span class="st">"always"</span>, </span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"column"</span>,</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># statistic = list(all_continuous() ~ "{mean} ({sd})")  # Uncomment and adjust if needed for continuous variables</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  add_n() %&gt;%  # Add column with total number of non-missing observations</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Outcome Variables by Wave**"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Update the column header</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>()</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="co"># save</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>margot<span class="sc">::</span><span class="fu">here_save</span>(table_outcomes, <span class="st">"table_outcomes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object saved to: /Users/joseph/GIT/psych-434-2025/outputs/table_outcomes.rds
Object size: 0.00 MB
👍 Save operation completed successfully!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read if needed</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>table_outcomes <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">here_read</span>(<span class="st">"table_outcomes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object read from: /Users/joseph/GIT/psych-434-2025/outputs/table_outcomes.rds
Object size: 1.44 MB
👍 Read operation completed successfully!</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>table_outcomes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="xmucaonnsn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xmucaonnsn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xmucaonnsn thead, #xmucaonnsn tbody, #xmucaonnsn tfoot, #xmucaonnsn tr, #xmucaonnsn td, #xmucaonnsn th {
  border-style: none;
}

#xmucaonnsn p {
  margin: 0;
  padding: 0;
}

#xmucaonnsn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xmucaonnsn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xmucaonnsn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xmucaonnsn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xmucaonnsn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xmucaonnsn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xmucaonnsn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xmucaonnsn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xmucaonnsn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xmucaonnsn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xmucaonnsn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xmucaonnsn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xmucaonnsn .gt_spanner_row {
  border-bottom-style: hidden;
}

#xmucaonnsn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xmucaonnsn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xmucaonnsn .gt_from_md > :first-child {
  margin-top: 0;
}

#xmucaonnsn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xmucaonnsn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xmucaonnsn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xmucaonnsn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xmucaonnsn .gt_row_group_first td {
  border-top-width: 2px;
}

#xmucaonnsn .gt_row_group_first th {
  border-top-width: 2px;
}

#xmucaonnsn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmucaonnsn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xmucaonnsn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xmucaonnsn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xmucaonnsn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmucaonnsn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xmucaonnsn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xmucaonnsn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xmucaonnsn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xmucaonnsn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xmucaonnsn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmucaonnsn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xmucaonnsn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmucaonnsn .gt_left {
  text-align: left;
}

#xmucaonnsn .gt_center {
  text-align: center;
}

#xmucaonnsn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xmucaonnsn .gt_font_normal {
  font-weight: normal;
}

#xmucaonnsn .gt_font_bold {
  font-weight: bold;
}

#xmucaonnsn .gt_font_italic {
  font-style: italic;
}

#xmucaonnsn .gt_super {
  font-size: 65%;
}

#xmucaonnsn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xmucaonnsn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xmucaonnsn .gt_indent_1 {
  text-indent: 5px;
}

#xmucaonnsn .gt_indent_2 {
  text-indent: 10px;
}

#xmucaonnsn .gt_indent_3 {
  text-indent: 15px;
}

#xmucaonnsn .gt_indent_4 {
  text-indent: 20px;
}

#xmucaonnsn .gt_indent_5 {
  text-indent: 25px;
}

#xmucaonnsn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xmucaonnsn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Outcome Variables by Wave</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2018</strong><br> N = 14,439<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>2020</strong><br> N = 14,439<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Kessler Latent Anxiety</td>
<td class="gt_row gt_center" headers="stat_1">1.04 (0.65, 1.67)</td>
<td class="gt_row gt_center" headers="stat_2">1.03 (0.65, 1.67)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">148</td>
<td class="gt_row gt_center" headers="stat_2">2,893</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Kessler Latent Depression</td>
<td class="gt_row gt_center" headers="stat_1">0.31 (0.01, 0.96)</td>
<td class="gt_row gt_center" headers="stat_2">0.31 (0.01, 0.96)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Unknown</td>
<td class="gt_row gt_center" headers="stat_1">152</td>
<td class="gt_row gt_center" headers="stat_2">2,890</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Median (Q1, Q3)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="inspect-the-distribution-of-the-exposure-in-treatment-wave" class="level3">
<h3 class="anchored" data-anchor-id="inspect-the-distribution-of-the-exposure-in-treatment-wave">Inspect the distribution of the exposure in treatment wave</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select 2019 wave</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>dt_19 <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2019</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mean</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>mean_exposure <span class="ot">&lt;-</span><span class="fu">mean</span>(dt_19<span class="sc">$</span>perfectionism, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># median</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>median_exposure <span class="ot">&lt;-</span><span class="fu">median</span>(dt_19<span class="sc">$</span>perfectionism, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># check if you like</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># median_exposure</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_exposure</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # generate bar plot</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>graph_density_of_exposure_up <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">coloured_histogram_shift</span>(</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  dt_19,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">shift =</span> <span class="st">"up"</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_name =</span> <span class="st">"perfectionism"</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> .<span class="dv">25</span>, </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">range_highlight =</span> <span class="fu">c</span>(<span class="dv">0</span>,mean_exposure)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>graph_density_of_exposure_up</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-content_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#margot::here_save(graph_density_of_exposure_up, "graph_density_of_exposure_up")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="another-graph-shift-interventions-up" class="level3">
<h3 class="anchored" data-anchor-id="another-graph-shift-interventions-up">Another Graph: Shift Interventions Up</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>margot<span class="sc">::</span><span class="fu">coloured_histogram</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  dt_19,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_name =</span> <span class="st">"perfectionism"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> .<span class="dv">25</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">unit_of_change =</span> <span class="dv">1</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale_min =</span> <span class="dv">1</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale_max =</span> <span class="dv">7</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight_range =</span> <span class="st">"both"</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-content_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="check-for-change-in-the-treatment-positivity" class="level3">
<h3 class="anchored" data-anchor-id="check-for-change-in-the-treatment-positivity">Check for change in the treatment (Positivity )</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  select data from wave 18 and 19 </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dt_18_19_positivity <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span> <span class="sc">|</span> wave <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perfectionism_round =</span> <span class="fu">round</span>(perfectionism, <span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(perfectionism_round, id, wave) <span class="sc">|&gt;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span>margot<span class="sc">::</span><span class="fu">create_transition_matrix</span>(<span class="at">data =</span> dt_18_19_positivity, <span class="at">state_var =</span> <span class="st">"perfectionism_round"</span>, <span class="at">id_var =</span> <span class="st">"id"</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># t_tab_2_labels &lt;- c("&lt; weekly", "&gt;= weekly")</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># transition table</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>transition_table  <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">transition_table</span>(out)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># for import later</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># margot::here_save(transition_table, "transition_table")</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(transition_table<span class="sc">$</span>table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

|  From   | State 1 | State 2  | State 3  | State 4  | State 5 | State 6 | State 7 |
|:-------:|:-------:|:--------:|:--------:|:--------:|:-------:|:-------:|:-------:|
| State 1 | **893** |   484    |   194    |    40    |   16    |    3    |    2    |
| State 2 |   657   | **1737** |   904    |   283    |   78    |    9    |    1    |
| State 3 |   237   |   1073   | **1368** |   768    |   245   |   40    |    5    |
| State 4 |   66    |   335    |   803    | **1076** |   523   |   108   |   10    |
| State 5 |   24    |    77    |   253    |   531    | **579** |   223   |   26    |
| State 6 |    7    |    9     |    38    |   106    |   205   | **216** |   53    |
| State 7 |    2    |    1     |    5     |    8     |   25    |   45    | **48**  |</code></pre>
</div>
</div>
</section>
<section id="explanation-for-the-table" class="level3">
<h3 class="anchored" data-anchor-id="explanation-for-the-table">Explanation for the table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>transition_table<span class="sc">$</span>explanation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "This transition matrix captures shifts in states across across the treatment intervals. Each cell in the matrix represents the count of individuals transitioning from one state to another. The rows correspond to the treatment at baseline (From), and the columns correspond to the state at the following wave (To). **Diagonal entries** (in **bold**) correspond to the number of individuals who remained in their initial state across both waves. **Off-diagonal entries** correspond to the transitions of individuals from their baseline state to a different state in the treatment wave.\nA higher number on the diagonal relative to the off-diagonal entries in the same row indicates greater stability in a state. Conversely, higher off-diagonal numbers suggest more frequent shifts from the baseline state to other states."</code></pre>
</div>
</div>
</section>
</section>
<section id="lab-part-2-simulation-to-clarify-why-the-distribution-of-effect-modifiers-matter-for-estimating-treatment-effects" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="lab-part-2-simulation-to-clarify-why-the-distribution-of-effect-modifiers-matter-for-estimating-treatment-effects">Lab Part 2: Simulation to Clarify Why The Distribution of Effect Modifiers Matter For Estimating Treatment Effects</h2>
<p>First, we load the <code>stdReg</code> library, which obtains marginal effect estimates by simulating counterfactuals under different levels of treatment <span class="citation" data-cites="sjölander2016">(<a href="#ref-sjölander2016" role="doc-biblioref">Sjölander 2016</a>)</span>. If a treatment is continuous, the levels can be specified.</p>
<div class="no-row-height column-margin column-container"><div id="ref-sjölander2016" class="csl-entry" role="listitem">
Sjölander, Arvid. 2016. <span>“Regression Standardization with the R Package stdReg.”</span> <em>European Journal of Epidemiology</em> 31 (6): 563–74. <a href="https://doi.org/10.1007/s10654-016-0157-3">https://doi.org/10.1007/s10654-016-0157-3</a>.
</div><div id="ref-parameters2020" class="csl-entry" role="listitem">
Lüdecke, Daniel, Mattan S. Ben-Shachar, Indrajeet Patil, and Dominique Makowski. 2020. <span>“Extracting, Computing and Exploring the Parameters of Statistical Models Using <span>R</span>.”</span> <em>Journal of Open Source Software</em> 5 (53): 2445. <a href="https://doi.org/10.21105/joss.02445">https://doi.org/10.21105/joss.02445</a>.
</div></div><p>We also load the <code>parameters</code> library, which creates nice tables <span class="citation" data-cites="parameters2020">(<a href="#ref-parameters2020" role="doc-biblioref">Lüdecke et al. 2020</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to obtain marginal effects</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stdReg)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to create nice tables</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we write a function to simulate data for the sample and and target populations.</p>
<p>We assume the treatment effect is the same in the sample and target population. We will assume that the coefficient for the effect-modifier and the coefficient for interaction are the same. We assume no unmeasured confounding throughout the study. We assume only selective attrition of one effect modifier such that the baseline population differs from the sample population at the end of the study.</p>
<p>That is: <strong>the distribution of effect modifiers is the only respect in which the sample will differ from the target population.</strong></p>
<p>This function will generate data under a range of scenarios.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;See documentation in the <code>margot</code> package: <span class="citation" data-cites="margot2024">Bulbulia (<a href="#ref-margot2024" role="doc-biblioref">2024</a>)</span></p><div id="ref-margot2024" class="csl-entry" role="listitem">
Bulbulia, J. A. 2024. <em>Margot: MARGinal Observational Treatment-Effects</em>. <a href="https://doi.org/10.5281/zenodo.10907724">https://doi.org/10.5281/zenodo.10907724</a>.
</div></div></div><div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to generate data for the sample and population, </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># along with precise sample weights for the population, there are differences </span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># in the distribution of the true effect modifier but no differences in the treatment effect </span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># or the effect modification.all that differs between the sample and the population is </span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the distribution of effect-modifiers.</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducability</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data -- you can use different parameters</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">simulate_ate_data_with_weights</span>(</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_sample =</span> <span class="dv">10000</span>,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_population =</span> <span class="dv">100000</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_z_sample =</span> <span class="fl">0.1</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_z_population =</span> <span class="fl">0.5</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_a =</span> <span class="dv">1</span>,</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_z =</span> <span class="fl">2.5</span>,</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">noise_sd =</span> <span class="fl">0.5</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<table class="table table-sm table-striped small">

<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">100000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">Data summary</div><p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sample_data.y_sample</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">-1.71</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">5.21</td>
<td style="text-align: left;">▂▇▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">sample_data.a_sample</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sample_data.z_sample</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">sample_data.weights</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">population_data.y_population</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.88</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">-2.09</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">3.26</td>
<td style="text-align: right;">6.01</td>
<td style="text-align: left;">▁▇▆▆▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">population_data.a_population</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">population_data.z_population</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Ok, we have generated both sample and population data.</p>
<p>Next, we verify that the distributions of effect modifiers differ in the sample and in the target population:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain the generated data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> data<span class="sc">$</span>sample_data</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>population_data <span class="ot">&lt;-</span> data<span class="sc">$</span>population_data</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># check imbalance</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sample_data<span class="sc">$</span>z_sample) <span class="co"># type 1 is rare</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   0    1 
9055  945 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(population_data<span class="sc">$</span>z_population) <span class="co"># type 1 is common</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    0     1 
49916 50084 </code></pre>
</div>
</div>
<p>Good, the distributions differ. The simulation is working as intended.</p>
<p>Next, consider the question: “What are the differences in the coefficients that we obtain from the study population at the end of study, as compared with the target population?”</p>
<p>First, we obtain the coefficients for the sample. They are as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model coefficients sample</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>model_sample  <span class="ot">&lt;-</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(y_sample <span class="sc">~</span> a_sample <span class="sc">*</span> z_sample, <span class="at">data =</span> sample_data)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(model_sample, <span class="at">ci_method =</span> <span class="st">"wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter           | Coefficient |       SE |        95% CI | t(9996) |      p
-------------------------------------------------------------------------------
(Intercept)         |   -6.89e-03 | 7.38e-03 | [-0.02, 0.01] |   -0.93 | 0.350 
a sample            |        1.01 |     0.01 | [ 0.99, 1.03] |   95.84 | &lt; .001
z sample            |        2.47 |     0.02 | [ 2.43, 2.52] |  104.09 | &lt; .001
a sample × z sample |        0.51 |     0.03 | [ 0.44, 0.57] |   14.82 | &lt; .001</code></pre>
</div>
</div>
<p>Ok, let’s obtain the coefficients for the weighted regression of the sample. Notice that the coefficients are virtually the same:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model the sample weighted to the population, again note that these coefficients are similar </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>model_weighted_sample <span class="ot">&lt;-</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(y_sample <span class="sc">~</span>  a_sample  <span class="sc">*</span> z_sample,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> sample_data,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> weights)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(parameters<span class="sc">::</span><span class="fu">model_parameters</span>(model_weighted_sample, <span class="at">ci_method =</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"wald"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter           | Coefficient |        95% CI |      p
----------------------------------------------------------
(Intercept)         |   -6.89e-03 | [-0.03, 0.01] | 0.480 
a sample            |        1.01 | [ 0.98, 1.04] | &lt; .001
z sample            |        2.47 | [ 2.45, 2.50] | &lt; .001
a sample × z sample |        0.51 | [ 0.47, 0.55] | &lt; .001

Model: y_sample ~ a_sample * z_sample (10000 Observations)
Sigma: 0.494 (df = 9996)</code></pre>
</div>
</div>
<p>We might be tempted to infer that weighting wasn’t relevant to the analysis. However, we’ll see that such an interpretation would be a mistake.</p>
<p>Next, let us obtain model coefficients for the population. Note again there is no difference – only narrower errors owing to the large sample size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model coefficients population -- note that these coefficients are very similar. </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>model_population <span class="ot">&lt;-</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(y_population <span class="sc">~</span> a_population <span class="sc">*</span> z_population, <span class="at">data =</span> population_data)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(model_population, <span class="at">ci_method =</span> <span class="st">"wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                   | Coefficient |       SE |        95% CI | t(99996) |      p
----------------------------------------------------------------------------------------
(Intercept)                 |    2.49e-03 | 3.18e-03 | [ 0.00, 0.01] |     0.78 | 0.434 
a population                |        1.00 | 4.49e-03 | [ 0.99, 1.01] |   222.35 | &lt; .001
z population                |        2.50 | 4.49e-03 | [ 2.49, 2.51] |   556.80 | &lt; .001
a population × z population |        0.50 | 6.35e-03 | [ 0.49, 0.51] |    78.80 | &lt; .001</code></pre>
</div>
</div>
<p>Again, there is no difference. That is, we find that all model coefficients are practically equivalent. The different distribution of effect modifiers does not result in different coefficient values for the treatment effect, the effect-modifier “effect,” or the interaction of effect modifier and treatment.</p>
<p>Consider why this is the case: in a large sample where the causal effects are invariant – as we have simulated them to be – we will have good replication in the effect modifiers within the sample, so our statistical model can recover the <em>coefficients</em> for the population – no problem.</p>
<p>However, <strong>in causal inference, we are interested in obtaining the marginal effect of the treatment</strong>. That is, we seek an estimate for the counterfactual contrast in which everyone in a pre-specified population was subject to one level of treatment compared with a counterfactual condition in which everyone in a population was subject to another level of the same treatment. <strong>When the sample population differs in the distribution of effect modifiers from the target population effect, the marginal effect estimates will typically differ.</strong></p>
<p>To see this, we use the <code>stdReg</code> package to recover marginal effect estimates, comparing (1) the sample ATE, (2) the true oracle ATE for the population, and (3) the weighted sample ATE. We will use the outputs of the same models above. The only difference is that we will calculate marginal effects from these outputs. We will contrast a difference from an intervention in which everyone receives treatment = 0 with one in which everyone receives treatment = 1, however, this choice is arbitrary, and the general lessons apply irrespective of the estimand.</p>
<p>First, consider this ATE for the sample population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What inference do we draw?  We cannot say the models are unbiased for the marginal effect estimates. </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># regression standardisation </span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stdReg) <span class="co"># to obtain marginal effects </span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain sample ate</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>fit_std_sample <span class="ot">&lt;-</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  stdReg<span class="sc">::</span><span class="fu">stdGlm</span>(model_sample, <span class="at">data =</span> sample_data, <span class="at">X =</span> <span class="st">"a_sample"</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_std_sample,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">contrast =</span> <span class="st">"difference"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">reference =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: y_sample ~ a_sample * z_sample
Family: gaussian 
Link function: identity 
Exposure:  a_sample 
Reference level:  a_sample = 0 
Contrast:  difference 

  Estimate Std. Error lower 0.95 upper 0.95
0     0.00     0.0000       0.00       0.00
1     1.06     0.0101       1.04       1.08</code></pre>
</div>
</div>
<p>The treatment effect is given as a 1.06 unit change in the outcome across the sample population, with a confidence interval from 1.04 to 1.08.</p>
<p>Next, we obtain the true (oracle) treatment effect for the population under the same intervention.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## note the population effect is different</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#obtain true ate</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>fit_std_population <span class="ot">&lt;-</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  stdReg<span class="sc">::</span><span class="fu">stdGlm</span>(model_population, <span class="at">data =</span> population_data, <span class="at">X =</span> <span class="st">"a_population"</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_std_population,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">contrast =</span> <span class="st">"difference"</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">reference =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: y_population ~ a_population * z_population
Family: gaussian 
Link function: identity 
Exposure:  a_population 
Reference level:  a_population = 0 
Contrast:  difference 

  Estimate Std. Error lower 0.95 upper 0.95
0     0.00    0.00000       0.00       0.00
1     1.25    0.00327       1.24       1.26</code></pre>
</div>
</div>
<p>Note, the true treatment effect is a 1.25 unit change in the population, with a confidence bound between 1.24 and 1.26. This is well outside the ATE that we obtain from the sample population!</p>
<p>Next, consider the ATE in the weighted regression, where the sample was weighted to the target population’s true distribution of effect modifiers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## next try weights adjusted ate where we correctly assign population weights to the sample</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>fit_std_weighted_sample_weights <span class="ot">&lt;-</span> stdReg<span class="sc">::</span><span class="fu">stdGlm</span>( model_weighted_sample, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> sample_data, </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> <span class="st">"a_sample"</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># this gives us the right answer</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_std_weighted_sample_weights, </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrast =</span> <span class="st">"difference"</span>, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">reference =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: y_sample ~ a_sample * z_sample
Family: gaussian 
Link function: identity 
Exposure:  a_sample 
Reference level:  a_sample = 0 
Contrast:  difference 

  Estimate Std. Error lower 0.95 upper 0.95
0     0.00     0.0000       0.00       0.00
1     1.25     0.0172       1.22       1.29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moral of the story. When we marginalise over the entire sample we need to weight estimates to the target population. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We find that we obtain the population-level causal effect estimate with accurate coverage by weighting the sample to the target population. So with appropriate weights, our results generalise from the sample to the target population.</p>
</section>
<section id="lessons-from-lab-2" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="lessons-from-lab-2">Lessons from Lab 2</h2>
<ul>
<li>Regression coefficients do not clarify the problem of sample/target population mismatch – or selection bias as discussed in this manuscript.</li>
<li>The correct advice to investigators is that they should not rely on regression coefficients when evaluating the biases that arise from sample attrition. This advice applies to both methods that the authors use to investigate threats of bias. That is, to implement this advice, the authors must first take it.</li>
<li>Generally, observed data are insufficient for assessing threats. Observed data do not clarify structural sources of bias, nor do they clarify effect-modification in the full counterfactual data condition in which all receive the treatment and all do not receive the treatment (at the same level).</li>
<li>To properly assess bias, one would need access to the counterfactual outcome—what would have happened to the missing participants had they not been lost to follow-up or had they responded. Again, the join distributions over “full data” are inherently unobservable <span class="citation" data-cites="vanderlaan2011">(<a href="#ref-vanderlaan2011" role="doc-biblioref">Van Der Laan and Rose 2011</a>)</span>.</li>
<li>In simple settings like the one we just simulated, we may address the gap between the sample and target population using methods such as modelling the censoring (e.g., censoring weighting). However, we never know what setting we are in or whether it is simple—such modelling must be handled with care. There is a large and growing epidemiology literature on this topic (see, for example, <span class="citation" data-cites="li2023non">Li, Miao, and Tchetgen Tchetgen (<a href="#ref-li2023non" role="doc-biblioref">2023</a>)</span>). <!-- - Matters become more complex when there is confounding and selection bias because the problem is not merely one of external validity but also internal validity (i.e. obtaining valid causal effect estimates for the baseline sample). See for example @scharfstein1999adjusting; @laan2003unified; @howe2016selection (note that @howe2016selection, "selection" bias is defined as collider stratification bias, a variety of confounding bias and not simple sample and target population mismatch.)   --></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-vanderlaan2011" class="csl-entry" role="listitem">
Van Der Laan, Mark J., and Sherri Rose. 2011. <em>Targeted Learning: Causal Inference for Observational and Experimental Data</em>. Springer Series in Statistics. New York, NY: Springer. <a href="https://link.springer.com/10.1007/978-1-4419-9782-1">https://link.springer.com/10.1007/978-1-4419-9782-1</a>.
</div><div id="ref-li2023non" class="csl-entry" role="listitem">
Li, Wei, Wang Miao, and Eric Tchetgen Tchetgen. 2023. <span>“Non-Parametric Inference about Mean Functionals of Non-Ignorable Non-Response Data Without Identifying the Joint Distribution.”</span> <em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em> 85 (3): 913–35.
</div></div></section>
<section id="appendix-a" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="appendix-a">Appendix A</h2>
<section id="evidence-for-effect-modification-is-relative-to-inclusion-of-other-variables-in-the-model" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="evidence-for-effect-modification-is-relative-to-inclusion-of-other-variables-in-the-model">Evidence for effect-modification is relative to inclusion of other variables in the model</h3>
<p>The ‘sharp-null hypothesis’ states there is no effect of the exposure on the outcome for any unit in the target population. Unless the ‘sharp-null hypothesis’ is false, there may be effect-modification. For any study worth conducting, we cannot evaluate whether the sharp-null hypothesis is false. If we could the experiment would be otiose. Therefore, we must assume the possibility of effect-modification. Notably, whether a variable is an effect-modifier also depends on which other variables are included in the model. That is, just as for the concept of a ‘confounder’, where a variable is an ‘effect-modifier’ cannot be stated without reference to an assumed causal order and an explicit statement about which other variables will be included in the model <span class="citation" data-cites="vanderweele2012">(<a href="#ref-vanderweele2012" role="doc-biblioref">Tyler J. VanderWeele 2012</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-vanderweele2012" class="csl-entry" role="listitem">
VanderWeele, Tyler J. 2012. <span>“Confounding and Effect Modification: Distribution and Measure.”</span> <em>Epidemiologic Methods</em> 1 (1): 55–82. <a href="https://doi.org/10.1515/2161-962X.1004">https://doi.org/10.1515/2161-962X.1004</a>.
</div></div><p>As illustrated in <a href="#fig-eff-mod-rel" class="quarto-xref">Figure&nbsp;4</a>, the marginal association between <span class="math inline">A</span> and <span class="math inline">Y</span> is unbiased. Here, exposure <span class="math inline">A</span> is unconditionally associated with <span class="math inline">Y</span>. Recall our convention <svg width="40px" height="40px"><circle cx="20" cy="20" r="18" fill="none" stroke="blue" stroke-width="2"></circle><text x="20" y="20" alignment-baseline="middle" text-anchor="middle" fill="blue" font-size="16">G</text></svg> denotes effect-modification with conditioning and <svg width="40px" height="40px"><circle cx="20" cy="20" r="18" fill="none" stroke="blue" stroke-width="2" stroke-dasharray="4,4"></circle><text x="20" y="20" alignment-baseline="middle" text-anchor="middle" fill="blue" font-size="16">Z</text></svg> indicates effect-modification without conditioning.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-eff-mod-rel" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-eff-mod-rel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-content_files/figure-html/fig-eff-mod-rel-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-eff-mod-rel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Consider a randomised experiment. There is no confounding. Here, the marginal association between A and Y provides an unbiased estimate for the causal effect of A on Y. Does the conditional association of A on Y vary within levels of G? The causal diagram allows for a classification of G as an effect modifier of A on Y by proxy. G modifies A’s effect on Y in virtue of G’s relationship to Z, which, according to this graph, is a direct effect modifier for the effect of A on Y.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-dag-effect-modificationb" class="quarto-xref">Figure&nbsp;5</a> presents the same a randomised experiment as in the previous causal diagram. We again assume that there is no confounding of the marginal association between the exposure, <span class="math inline">A</span>, and the outcome, <span class="math inline">Y</span>. However, suppose we were to adjust for <span class="math inline">Z</span> and ask, does the conditional association of <span class="math inline">A</span> on <span class="math inline">Y</span> vary within levels of <span class="math inline">G</span>, after adjusting for <span class="math inline">Z</span>? That is, does <span class="math inline">G</span> remain an effect-modifier of the exposure on the outcome? <span class="citation" data-cites="vanderweele2007">Tyler J. VanderWeele and Robins (<a href="#ref-vanderweele2007" role="doc-biblioref">2007b</a>)</span> proved that for effect-modification to occur, at least one other arrow besides the treatment must enter into the outcome. According to <a href="#fig-dag-effect-modificationb" class="quarto-xref">Figure&nbsp;5</a> the only arrow into <span class="math inline">Y</span> other than <span class="math inline">A</span> arrives from <span class="math inline">Z</span>. Because <span class="math inline">Y</span> is independent of <span class="math inline">G</span> conditional on <span class="math inline">Z</span> we may infer that <span class="math inline">G</span> is no longer an effect modifier for the effect of <span class="math inline">A</span> on <span class="math inline">Y</span>. Viewed another way, <span class="math inline">G</span> no longer co-varies with <span class="math inline">Y</span> conditional on <span class="math inline">Z</span> and so cannot act as an effect-modifier.</p>
<div class="no-row-height column-margin column-container"></div><div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-effect-modificationb" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-effect-modificationb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-content_files/figure-html/fig-dag-effect-modificationb-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-effect-modificationb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Conditioning on Z renders G independent of Y. G is no longer an effect modifier after conditioning on Z because G is independent of Y. Although Z is an unconditional effect modifier, G is not.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-dag-effect-modificationc" class="quarto-xref">Figure&nbsp;6</a> presents the same a randomised experiment as in the previous graph. We assume a true effect of <span class="math inline">A \rightarrow Y</span>. If we do not condition on <span class="math inline">B</span>, then <span class="math inline">G</span> will not modify the effect of <span class="math inline">A  \rightarrow Y</span> because <span class="math inline">G</span> will not be associated with <span class="math inline">Y</span>. However, if we were to condition on <span class="math inline">B</span>, then both <span class="math inline">B</span> (an effect modifier by proxy) and <span class="math inline">G</span> may become effect-modifiers for the causal effect of <span class="math inline">A</span> on <span class="math inline">Y</span>. In this setting, both <span class="math inline">B</span> and <span class="math inline">G</span> are conditional effect-modifiers.</p>
<p>Note that casual graphs help us to evaluate classifications of conditional and unconditional effect modifiers. They may also help to clarify conditions in which conditioning on unconditional effect-modifiers may remove conditional effect-modification. However we cannot not tell from a causal diagram whether the ancestors of an unconditional effect-modifier will be conditional effect-modifiers for the effect of the exposure on the outcome; see: <span class="citation" data-cites="vanderweele2007">Tyler J. VanderWeele and Robins (<a href="#ref-vanderweele2007" role="doc-biblioref">2007b</a>)</span>, also <span class="citation" data-cites="suzuki2013counterfactual">Suzuki et al. (<a href="#ref-suzuki2013counterfactual" role="doc-biblioref">2013</a>)</span>. Causal diagrams express non-parametric relations. I have adopted an off-label colouring convention to denote instances of effect-modification to highlight possible pathways for effect-modification, which may be relative to other variables in a model.</p>
<div class="no-row-height column-margin column-container"><div id="ref-vanderweele2007" class="csl-entry" role="listitem">
VanderWeele, Tyler J., and James M. Robins. 2007b. <span>“Four types of effect modification: a classification based on directed acyclic graphs.”</span> <em>Epidemiology (Cambridge, Mass.)</em> 18 (5): 561–68. <a href="https://doi.org/10.1097/EDE.0b013e318127181b">https://doi.org/10.1097/EDE.0b013e318127181b</a>.
</div></div><div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-effect-modificationc" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-effect-modificationc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-content_files/figure-html/fig-dag-effect-modificationc-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-effect-modificationc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Blue path denotes effect-modification for G by conditioning on B. Both B and G are conditional effect modifiers.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-dag-effect-modificationd" class="quarto-xref">Figure&nbsp;7</a> reveals the relativity of effect-modification. If investigators do not condition on <span class="math inline">B</span>, then <span class="math inline">G</span> cannot be a conditional effect-modifier because <span class="math inline">G</span> would then be independent of <span class="math inline">Z</span> because <span class="math inline">B</span> is a collider. However, as we observed in <a href="#fig-dag-effect-modificationc" class="quarto-xref">Figure&nbsp;6</a>, conditioning on <span class="math inline">B</span>, a collider, may open a path for effect-modification of <span class="math inline">G</span> by <span class="math inline">Z</span>. Both <span class="math inline">B</span> and <span class="math inline">G</span> are conditional effect modifiers.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-effect-modificationd" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-effect-modificationd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-content_files/figure-html/fig-dag-effect-modificationd-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-effect-modificationd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Blue path denotes effect-modification. Here G is not an effect modifier because B, a common effect (collider) of G and Z, is not conditioned on. Any conditional effect modification for G would require conditioning on B, and not-conditioning on G. Otherwise G will be d-separated from Y.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-effect-modification5c" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-effect-modification5c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-content_files/figure-html/fig-dag-effect-modification5c-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-effect-modification5c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Blue path denotes effect-modification. Neither, G nor B are unconditional effect-modifiers for the effect of A on Y after Z is conditioned upon. If investigators condition on Z, the causal diagram implies they will not find evidence for effect-modification by B or G, which are conditionally independent of Y once Z is conditioned upon.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-dag-effect-modification5c" class="quarto-xref">Figure&nbsp;8</a> considers the implications of conditioning on <span class="math inline">Z</span>, which is the only unconditional effect-modifier on the graph. If <span class="math inline">Z</span> is measured, conditioning on <span class="math inline">Z</span> will remove effect-modification for <span class="math inline">B</span> and <span class="math inline">G</span> because <span class="math inline">B,G\coprod Y |Z</span>. This examples again reveals the context dependency of effect-modification. Here, causal diagrams are useful for clarifying features of dependent and independent effect modification. For further discussion, see: <span class="citation" data-cites="suzuki2013counterfactual">Suzuki et al. (<a href="#ref-suzuki2013counterfactual" role="doc-biblioref">2013</a>)</span>; <span class="citation" data-cites="vanderweele2009distinction">Tyler J. VanderWeele (<a href="#ref-vanderweele2009distinction" role="doc-biblioref">2009</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-suzuki2013counterfactual" class="csl-entry" role="listitem">
Suzuki, Etsuji, Toshiharu Mitsuhashi, Toshihide Tsuda, and Eiji Yamamoto. 2013. <span>“A Counterfactual Approach to Bias and Effect Modification in Terms of Response Types.”</span> <em>BMC Medical Research Methodology</em> 13 (1): 1–17.
</div><div id="ref-vanderweele2009distinction" class="csl-entry" role="listitem">
VanderWeele, Tyler J. 2009. <span>“On the Distinction Between Interaction and Effect Modification.”</span> <em>Epidemiology</em>, 863–71.
</div></div></section>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - Bulbulia J (2024). _margot: MARGinal Observational Treatment-effects_. doi:10.5281/zenodo.10907724 &lt;https://doi.org/10.5281/zenodo.10907724&gt;, R package version 0.3.1.1 Functions to obtain MARGinal Observational Treatment-effects from observational data., &lt;https://go-bayes.github.io/margot/&gt;.
  - Chang W (2023). _extrafont: Tools for Using Fonts_. R package version 0.19, &lt;https://CRAN.R-project.org/package=extrafont&gt;.
  - Firke S (2024). _janitor: Simple Tools for Examining and Cleaning Dirty Data_. R package version 2.2.1, &lt;https://CRAN.R-project.org/package=janitor&gt;.
  - Grolemund G, Wickham H (2011). "Dates and Times Made Easy with lubridate." _Journal of Statistical Software_, *40*(3), 1-25. &lt;https://www.jstatsoft.org/v40/i03/&gt;.
  - Lüdecke D, Ben-Shachar M, Patil I, Makowski D (2020). "Extracting, Computing and Exploring the Parameters of Statistical Models using R." _Journal of Open Source Software_, *5*(53), 2445. doi:10.21105/joss.02445 &lt;https://doi.org/10.21105/joss.02445&gt;.
  - Müller K (2020). _here: A Simpler Way to Find Your Files_. R package version 1.0.1, &lt;https://CRAN.R-project.org/package=here&gt;.
  - Müller K, Wickham H (2023). _tibble: Simple Data Frames_. R package version 3.2.1, &lt;https://CRAN.R-project.org/package=tibble&gt;.
  - R Core Team (2024). _R: A Language and Environment for Statistical Computing_. R Foundation for Statistical Computing, Vienna, Austria. &lt;https://www.R-project.org/&gt;.
  - Sjoberg D, Whiting K, Curry M, Lavery J, Larmarange J (2021). "Reproducible Summary Tables with the gtsummary Package." _The R Journal_, *13*, 570-580. doi:10.32614/RJ-2021-053 &lt;https://doi.org/10.32614/RJ-2021-053&gt;, &lt;https://doi.org/10.32614/RJ-2021-053&gt;.
  - Sjolander A, Dahlqwist E (2021). _stdReg: Regression Standardization_. R package version 3.4.1, &lt;https://CRAN.R-project.org/package=stdReg&gt;.
  - Waring E, Quinn M, McNamara A, Arino de la Rubia E, Zhu H, Ellis S (2022). _skimr: Compact and Flexible Summaries of Data_. R package version 2.1.5, &lt;https://CRAN.R-project.org/package=skimr&gt;.
  - Wickham H (2016). _ggplot2: Elegant Graphics for Data Analysis_. Springer-Verlag New York. ISBN 978-3-319-24277-4, &lt;https://ggplot2.tidyverse.org&gt;.
  - Wickham H (2023). _forcats: Tools for Working with Categorical Variables (Factors)_. R package version 1.0.0, &lt;https://CRAN.R-project.org/package=forcats&gt;.
  - Wickham H (2023). _stringr: Simple, Consistent Wrappers for Common String Operations_. R package version 1.5.1, &lt;https://CRAN.R-project.org/package=stringr&gt;.
  - Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). "Welcome to the tidyverse." _Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 &lt;https://doi.org/10.21105/joss.01686&gt;.
  - Wickham H, François R, Henry L, Müller K, Vaughan D (2023). _dplyr: A Grammar of Data Manipulation_. R package version 1.1.4, &lt;https://CRAN.R-project.org/package=dplyr&gt;.
  - Wickham H, Henry L (2025). _purrr: Functional Programming Tools_. R package version 1.0.4, &lt;https://CRAN.R-project.org/package=purrr&gt;.
  - Wickham H, Hester J, Bryan J (2024). _readr: Read Rectangular Text Data_. R package version 2.1.5, &lt;https://CRAN.R-project.org/package=readr&gt;.
  - Wickham H, Vaughan D, Girlich M (2024). _tidyr: Tidy Messy Data_. R package version 1.3.1, &lt;https://CRAN.R-project.org/package=tidyr&gt;.
  - Xie Y (2024). _tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents_. R package version 0.54, &lt;https://github.com/rstudio/tinytex&gt;. Xie Y (2019). "TinyTeX: A lightweight, cross-platform, and easy-to-maintain LaTeX distribution based on TeX Live." _TUGboat_, *40*(1), 30-32. &lt;https://tug.org/TUGboat/Contents/contents40-1.html&gt;.</code></pre>
</div>
</div>


<!-- -->


</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb54" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Causal Inference: Effect-Modification and Interaction"</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-APR-22"</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> /Users/joseph/GIT/templates/bib/references.bib</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co">    warnings: FALSE</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co">    error: FALSE</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co">    messages: FALSE</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: kate</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools:</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: FALSE</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="an">html-math-method:</span><span class="co"> katex</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="an">citation-location:</span><span class="co"> margin</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="an">code-block-border-left:</span><span class="co"> true</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="in">  .boxedblue {</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="in">      border: 2px solid blue;</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="in">      border-radius: 4px; /* slight roundness */</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="in">      padding: 3px 6px; /* vertical | horizontal */</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="in">      display: inline-block;</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="in">      color: blue;</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="in">  .circleblue {</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a><span class="in">      border: 2px dashed blue;</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a><span class="in">      border-radius: 50%;</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a><span class="in">      padding: 3px 6px;</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a><span class="in">      display: inline-block;</span></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a><span class="in">      color: blue;</span></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a><span class="co"># for information about this template: https://github.com/mikemahoney218/quarto-arxiv/blob/main/template.qmd</span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="co">#libraries and functions</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a><span class="co"># read libraries</span></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"win"</span>)</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a><span class="co"># fix G = 1</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="co"># fix hats</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="co"># fix examples</span></span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a><span class="co"># read functions</span></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/funs.R")</span></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a>**Required**</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@hernan2024WHATIF</span><span class="co">]</span> Chapters 4-5 <span class="co">[</span><span class="ot">link</span><span class="co">](https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&amp;dl=0)</span></span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a>**Optional**</span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@vanderweele2007FOURTYPESOFEFFECT</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/drytp2ui2b8o9jplh4bm9/four_types_of_effect_modification__a.6.pdf?rlkey=mb9nl599v93m6kyyo69iv5nz1&amp;dl=0)</span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@vanderweele2009distinction</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/srpynr0dvjcndveplcydn/OutcomeWide_StatisticalScience.pdf?rlkey=h4fv32oyjegdfl3jq9u1fifc3&amp;dl=0)</span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key concepts for the test(s):</span></span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Causal Estimand**</span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Statistical Estimand**</span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Interaction/Moderation**</span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Heterogeneous Treatment Effects**</span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Conditional Average Treatment Effect**</span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Effect Modification**</span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a><span class="fu">## If you learning nothing else from this course...</span></span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a>To answer a psychological question we must first ask it.</span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-90"><a href="#cb54-90" aria-hidden="true" tabindex="-1"></a><span class="fu">## Causal inference begins by stating a counterfactual contrast</span></span>
<span id="cb54-91"><a href="#cb54-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-93"><a href="#cb54-93" aria-hidden="true" tabindex="-1"></a>In the simpliest case, we calculate the contrast between two or more "treatments" or equivalently "exposures":</span>
<span id="cb54-94"><a href="#cb54-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-95"><a href="#cb54-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-96"><a href="#cb54-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-97"><a href="#cb54-97" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-98"><a href="#cb54-98" aria-hidden="true" tabindex="-1"></a>\text{Average Treatment Effect} = \mathbb{E}<span class="co">[</span><span class="ot">Y(a^*) -Y(a)</span><span class="co">]</span></span>
<span id="cb54-99"><a href="#cb54-99" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-100"><a href="#cb54-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-101"><a href="#cb54-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-102"><a href="#cb54-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-103"><a href="#cb54-103" aria-hidden="true" tabindex="-1"></a><span class="fu">### After Stating the Causal Interest, We State the Conditions Needed for Identifying This Effect from Data</span></span>
<span id="cb54-104"><a href="#cb54-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-105"><a href="#cb54-105" aria-hidden="true" tabindex="-1"></a>In observational studies, the next step is to identify this effect by controlling for common causes of both the treatment and outcome (or proxies of such common causes). The regression standardization formula is:</span>
<span id="cb54-106"><a href="#cb54-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-107"><a href="#cb54-107" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-108"><a href="#cb54-108" aria-hidden="true" tabindex="-1"></a>\widehat{\text{ATE}} = \int \left( \mathbb{E}<span class="co">[</span><span class="ot">Y(a^*) \mid L</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(a) \mid L</span><span class="co">]</span> \right) dP(L)</span>
<span id="cb54-109"><a href="#cb54-109" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-110"><a href="#cb54-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-111"><a href="#cb54-111" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb54-112"><a href="#cb54-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-113"><a href="#cb54-113" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Statistical Estimand**: $\widehat{\text{ATE}}$, is the estimated average treatment effect.</span>
<span id="cb54-114"><a href="#cb54-114" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\mathbb{E}[Y(a^*) \mid L]$**: is the expected value (mean) of the outcome variable $Y$ when the treatment $a^*$ is applied, given the confounders $L$.</span>
<span id="cb54-115"><a href="#cb54-115" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\mathbb{E}[Y(a) \mid L]$**: is the expected value of $Y$ when the treatment $a$ is applied, given $L$.</span>
<span id="cb54-116"><a href="#cb54-116" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\mathbb{E}[Y(a^*) \mid L] - \mathbb{E}[Y(a) \mid L]$**: is the difference in the expected treatments, controlling for $L$.</span>
<span id="cb54-117"><a href="#cb54-117" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\int (...) dP(L)$**: $dP(L)$ is an integral (remember high school math?). Integrals give us areas under curves. Here the area is a distribution of probabilities. To obtain valid inference, the treatment effect is computed over all the probability distribution of $L$ in the population.</span>
<span id="cb54-118"><a href="#cb54-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-119"><a href="#cb54-119" aria-hidden="true" tabindex="-1"></a><span class="fu">### So, in the simplest possible terms</span></span>
<span id="cb54-120"><a href="#cb54-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-121"><a href="#cb54-121" aria-hidden="true" tabindex="-1"></a>Understanding causal inference is fundamentally about comparing what happened with what could have happened *an average* under different conditions or treatments *in some population*, while carefully accounting for factors that might confound or distort the comparison that interests us (i.e. that might give a false answer to the question we asked).</span>
<span id="cb54-122"><a href="#cb54-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-123"><a href="#cb54-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-124"><a href="#cb54-124" aria-hidden="true" tabindex="-1"></a><span class="fu">##  What do the words "Moderation" and "Interaction" mean? </span></span>
<span id="cb54-125"><a href="#cb54-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-126"><a href="#cb54-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-127"><a href="#cb54-127" aria-hidden="true" tabindex="-1"></a>We here these words used freely in psychology.  What do they mean?   Causal inference allows us to be precise. </span>
<span id="cb54-128"><a href="#cb54-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-129"><a href="#cb54-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-130"><a href="#cb54-130" aria-hidden="true" tabindex="-1"></a>Let's set the term *moderation* to the side, and in its place consider "effect-modification." Our task today is to use counterfactual notation to distinguish between two concepts: </span>
<span id="cb54-131"><a href="#cb54-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-132"><a href="#cb54-132" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Interaction</span>
<span id="cb54-133"><a href="#cb54-133" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Effect-modification</span>
<span id="cb54-134"><a href="#cb54-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-135"><a href="#cb54-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-136"><a href="#cb54-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-137"><a href="#cb54-137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interaction</span></span>
<span id="cb54-138"><a href="#cb54-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-139"><a href="#cb54-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-140"><a href="#cb54-140" aria-hidden="true" tabindex="-1"></a>An interaction is a **joint intervention**</span>
<span id="cb54-141"><a href="#cb54-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-142"><a href="#cb54-142" aria-hidden="true" tabindex="-1"></a>When assessing "interaction" we are interested in  the combined effect of two interventions (two "treatments" or "exposures").  </span>
<span id="cb54-143"><a href="#cb54-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-144"><a href="#cb54-144" aria-hidden="true" tabindex="-1"></a>Call these treatments, $A$ and $B$.  Call the outcome $Y$.</span>
<span id="cb54-145"><a href="#cb54-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-146"><a href="#cb54-146" aria-hidden="true" tabindex="-1"></a>Recall that in potential outcomes terminology, we defined the potential outcome under treatment $A = \tilde{a}$:</span>
<span id="cb54-147"><a href="#cb54-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-148"><a href="#cb54-148" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-149"><a href="#cb54-149" aria-hidden="true" tabindex="-1"></a>Y(\tilde{a})</span>
<span id="cb54-150"><a href="#cb54-150" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-151"><a href="#cb54-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-152"><a href="#cb54-152" aria-hidden="true" tabindex="-1"></a>And we identify $Y(\tilde{a})$ from data using the consistency assumption: $Y_i(\tilde{a}) = (Y_i |A_i = \tilde{a})$, assuming that $Y_i(\tilde{a})\coprod A|L$, where, again, $L$ donotes a set of measured covariates sufficient to insure no confounding (no common causes), or equivalently, no open backdoor path between $A$ and $Y$.</span>
<span id="cb54-153"><a href="#cb54-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-154"><a href="#cb54-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-155"><a href="#cb54-155" aria-hidden="true" tabindex="-1"></a>A joint intervention of two treatments, call them $A$ and $B$, which may act on $Y$, requires that we extend our notation:</span>
<span id="cb54-156"><a href="#cb54-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-157"><a href="#cb54-157" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-158"><a href="#cb54-158" aria-hidden="true" tabindex="-1"></a>Y(\tilde{a}, \tilde{b})</span>
<span id="cb54-159"><a href="#cb54-159" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-160"><a href="#cb54-160" aria-hidden="true" tabindex="-1"></a>This is the effect on $Y$ when $A$ is set to $\tilde{a}$ amd $B$ is set to $\tilde{b}$.</span>
<span id="cb54-161"><a href="#cb54-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-162"><a href="#cb54-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-163"><a href="#cb54-163" aria-hidden="true" tabindex="-1"></a>In addition to requiring $Y_i(\tilde{a}) = (Y_i \mid A_i = \tilde{a})$, assuming that $Y_i(\tilde{a}) \coprod A \mid L$, we require that for all $i \in 1\dots N$ individuals in the target population, both $Y_i(\tilde{b}) = (Y_i \mid B_i = \tilde{b})$, and that $Y_i(\tilde{b}) \coprod B \mid Q$, where $Q$ denotes a set of confounders sufficient to ensure no confounding for the effect of $B$ on $Y$. </span>
<span id="cb54-164"><a href="#cb54-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-165"><a href="#cb54-165" aria-hidden="true" tabindex="-1"></a>Notably, the sets $L$ and $Q$ may have overlapping variables, which in set notation we write: </span>
<span id="cb54-166"><a href="#cb54-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-167"><a href="#cb54-167" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-168"><a href="#cb54-168" aria-hidden="true" tabindex="-1"></a>L \cap Q \not\equiv \emptyset</span>
<span id="cb54-169"><a href="#cb54-169" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-170"><a href="#cb54-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-171"><a href="#cb54-171" aria-hidden="true" tabindex="-1"></a>That is the union of $L$ and $Q$ does not imply the empty set,  which implies that identification may be harder when there are interactions.  Statistical estimation is more difficult too, but we'll ignore that. </span>
<span id="cb54-172"><a href="#cb54-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-173"><a href="#cb54-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-174"><a href="#cb54-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-175"><a href="#cb54-175" aria-hidden="true" tabindex="-1"></a><span class="fu">### How do we define such a contrast between two interventions of equal status in our model? </span></span>
<span id="cb54-176"><a href="#cb54-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-177"><a href="#cb54-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-178"><a href="#cb54-178" aria-hidden="true" tabindex="-1"></a>Consider the effect of beliefs in Big Gods (treatment, denoted  $A$) on social complexity (outcome, denoted$Y$), potentially influenced by a culture's monumental architecture (treatment, denoted $B$). Suppose we wish to assess the individual and combined effects of $A$ and $B$ on the difference scale.  Let assume the treatments are binary variables.</span>
<span id="cb54-179"><a href="#cb54-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-180"><a href="#cb54-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-181"><a href="#cb54-181" aria-hidden="true" tabindex="-1"></a>In the counterfactual framework, we say there is evidence for interaction only if the following inequality were to hold:</span>
<span id="cb54-182"><a href="#cb54-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-183"><a href="#cb54-183" aria-hidden="true" tabindex="-1"></a>$$\bigg(\underbrace{\mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span>}_{\text{joint exposure}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither exposed}}\bigg) - \bigg[ \bigg(\underbrace{\mathbb{E}[Y(1,0)]}_{\text{only A exposed}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither exposed}}\bigg) + \bigg(\underbrace{\mathbb{E}[Y(0,1)]}_{\text{only B exposed}} - \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither exposed}} \bigg)\bigg] \neq 0 $$</span>
<span id="cb54-184"><a href="#cb54-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-185"><a href="#cb54-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-186"><a href="#cb54-186" aria-hidden="true" tabindex="-1"></a>Expanding the terms inside the brackets:</span>
<span id="cb54-187"><a href="#cb54-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-188"><a href="#cb54-188" aria-hidden="true" tabindex="-1"></a>   $$ \mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(1,0)</span><span class="co">]</span> + \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,1)</span><span class="co">]</span> + \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span> $$</span>
<span id="cb54-189"><a href="#cb54-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-190"><a href="#cb54-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-191"><a href="#cb54-191" aria-hidden="true" tabindex="-1"></a>And cancelling $\mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span>$, which appears three times, once with a minus sign and twice with a plus sign, simplifies to:</span>
<span id="cb54-192"><a href="#cb54-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-193"><a href="#cb54-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-194"><a href="#cb54-194" aria-hidden="true" tabindex="-1"></a>   $$ \mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(1,0)</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0,1)</span><span class="co">]</span> + \mathbb{E}<span class="co">[</span><span class="ot">Y(0,0)</span><span class="co">]</span> $$</span>
<span id="cb54-195"><a href="#cb54-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-196"><a href="#cb54-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-197"><a href="#cb54-197" aria-hidden="true" tabindex="-1"></a>And we define interaction on the additive scale:</span>
<span id="cb54-198"><a href="#cb54-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-199"><a href="#cb54-199" aria-hidden="true" tabindex="-1"></a>$$ \underbrace{\mathbb{E}<span class="co">[</span><span class="ot">Y(1,1)</span><span class="co">]</span>}_{\text{joint exposure}} - \underbrace{\mathbb{E}[Y(1,0)]}_{\text{only A exposed}} - \underbrace{\mathbb{E}[Y(0,1)]}_{\text{only B exposed}} + \underbrace{\mathbb{E}[Y(0,0)]}_{\text{neither exposed}} \neq 0 $$</span>
<span id="cb54-200"><a href="#cb54-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-201"><a href="#cb54-201" aria-hidden="true" tabindex="-1"></a>The estimand is net interaction effect, after accounting for the individual effects of $A$ and $B$, as well as the baseline where neither treatment $A$ nor treatment $B$ is given.</span>
<span id="cb54-202"><a href="#cb54-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-203"><a href="#cb54-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-204"><a href="#cb54-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-205"><a href="#cb54-205" aria-hidden="true" tabindex="-1"></a>A positive value would indicate evidence for additive interaction. A negative value would indicate evidence for sub-additive interaction. A value near zero would imply no reliable evidence for interaction.</span>
<span id="cb54-206"><a href="#cb54-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-207"><a href="#cb54-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-208"><a href="#cb54-208" aria-hidden="true" tabindex="-1"></a>Note that the order of the terms does not matter: </span>
<span id="cb54-209"><a href="#cb54-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-210"><a href="#cb54-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-211"><a href="#cb54-211" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-212"><a href="#cb54-212" aria-hidden="true" tabindex="-1"></a>Y(\tilde{a}, \tilde{b})\equiv Y(\tilde{b}, \tilde{a})</span>
<span id="cb54-213"><a href="#cb54-213" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-214"><a href="#cb54-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-215"><a href="#cb54-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-216"><a href="#cb54-216" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Having defined the causal estimand, we next consider what would be needed to identify it using data?</span></span>
<span id="cb54-217"><a href="#cb54-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-218"><a href="#cb54-218" aria-hidden="true" tabindex="-1"></a>For this we can write our causal diagram. @fig-dag-interaction describes the structure of the identification problem:</span>
<span id="cb54-219"><a href="#cb54-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-222"><a href="#cb54-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb54-223"><a href="#cb54-223" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-interaction</span></span>
<span id="cb54-224"><a href="#cb54-224" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "This diagram presents the individual and joint effects of two exposures, A and B, on outcome Y. We assume that A and B are causally independent. If either exposure affects the other, then we may conduct effect-modification analysis or mediation analysis, but we should avoid causal interaction analysis. The diagram includes confounders L and W. Control for these confounders is necessary to close the backdoor paths that relate each exposure, A and B, to the outcome. Each exposure has equal status in our model: Y(a,b) = Y(b,a). The red path denotes paths of confounding."</span></span>
<span id="cb54-225"><a href="#cb54-225" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb54-226"><a href="#cb54-226" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb54-227"><a href="#cb54-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-228"><a href="#cb54-228" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb54-229"><a href="#cb54-229" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb54-230"><a href="#cb54-230" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb54-231"><a href="#cb54-231" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb54-232"><a href="#cb54-232" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb54-233"><a href="#cb54-233" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb54-234"><a href="#cb54-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-235"><a href="#cb54-235" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb54-236"><a href="#cb54-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-237"><a href="#cb54-237" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (LA) at (0, .5) {L$_{0}$};</span></span>
<span id="cb54-238"><a href="#cb54-238" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (LB) at (0, -.5) {Q$_{0}$};</span></span>
<span id="cb54-239"><a href="#cb54-239" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (2, .5) {A$_{1}$};</span></span>
<span id="cb54-240"><a href="#cb54-240" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (B) at (2, -.5) {B$_{1}$};</span></span>
<span id="cb54-241"><a href="#cb54-241" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (5, 0) {Y$_{2}$};</span></span>
<span id="cb54-242"><a href="#cb54-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-243"><a href="#cb54-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-244"><a href="#cb54-244" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (LA) to (A);</span></span>
<span id="cb54-245"><a href="#cb54-245" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (LB) to (B);</span></span>
<span id="cb54-246"><a href="#cb54-246" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red, bend left] (LA) to (Y);</span></span>
<span id="cb54-247"><a href="#cb54-247" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red, bend right] (LB) to (Y);</span></span>
<span id="cb54-248"><a href="#cb54-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-249"><a href="#cb54-249" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb54-250"><a href="#cb54-250" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, draw=black] (B) to (Y);</span></span>
<span id="cb54-251"><a href="#cb54-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-252"><a href="#cb54-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-253"><a href="#cb54-253" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb54-254"><a href="#cb54-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-255"><a href="#cb54-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-256"><a href="#cb54-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-257"><a href="#cb54-257" aria-hidden="true" tabindex="-1"></a>Here, @fig-dag-interaction clarifies the need to evaluate two sources of counfounding, one for each intervention ($A$ and $B$).</span>
<span id="cb54-258"><a href="#cb54-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-259"><a href="#cb54-259" aria-hidden="true" tabindex="-1"></a>By adjusting for $L_{0}$ we obtain an unbiased estimate of the $A\to Y$ path. </span>
<span id="cb54-260"><a href="#cb54-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-261"><a href="#cb54-261" aria-hidden="true" tabindex="-1"></a>By adjusting for $Q_{0}$ we obtain an unbiased estimate of the $B\to Y$ path. As indicated in @fig-dag-interaction-solved, we must condition on both $L_{0}$ and $Q_{0}$ to identify causal interaction conceived as a joint interaction. </span>
<span id="cb54-262"><a href="#cb54-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-263"><a href="#cb54-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-264"><a href="#cb54-264" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- [^noteinteraction] --&gt;</span></span>
<span id="cb54-265"><a href="#cb54-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-266"><a href="#cb54-266" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--  [^noteinteraction]: An important complication is that evidence for causal interaction may differ depending on the measurement scale one chooses to assess it [@vanderweele2014; @vanderweele2012; @vanderweele2014]. For most applications in psychological science we would use the the causal difference scale (refer to @vanderweele2014 for discussion).  We set this complication to the side, noting that investigators must state the scale of causal contrast on which there study focusses.  --&gt;</span></span>
<span id="cb54-267"><a href="#cb54-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-268"><a href="#cb54-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-269"><a href="#cb54-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-272"><a href="#cb54-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb54-273"><a href="#cb54-273" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-interaction-solved</span></span>
<span id="cb54-274"><a href="#cb54-274" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "We adjust for confounding in causal interaction analysis by adjusting for all confounders of the A to Y path as well as all for the B to Y path. The box over the confounders indicates the biasing paths are closed."</span></span>
<span id="cb54-275"><a href="#cb54-275" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb54-276"><a href="#cb54-276" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb54-277"><a href="#cb54-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-278"><a href="#cb54-278" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb54-279"><a href="#cb54-279" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb54-280"><a href="#cb54-280" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb54-281"><a href="#cb54-281" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb54-282"><a href="#cb54-282" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb54-283"><a href="#cb54-283" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb54-284"><a href="#cb54-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-285"><a href="#cb54-285" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb54-286"><a href="#cb54-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-287"><a href="#cb54-287" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (LA) at (0, .5) {L$_{0}$};</span></span>
<span id="cb54-288"><a href="#cb54-288" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (LB) at (0, -.5) {Q$_{0}$};</span></span>
<span id="cb54-289"><a href="#cb54-289" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (2, .5) {A$_{1}$};</span></span>
<span id="cb54-290"><a href="#cb54-290" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (B) at (2, -.5) {B$_{1}$};</span></span>
<span id="cb54-291"><a href="#cb54-291" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (5, 0) {Y$_{2}$};</span></span>
<span id="cb54-292"><a href="#cb54-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-293"><a href="#cb54-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-294"><a href="#cb54-294" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (LA) to (A);</span></span>
<span id="cb54-295"><a href="#cb54-295" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (LB) to (B);</span></span>
<span id="cb54-296"><a href="#cb54-296" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, bend left] (LA) to (Y);</span></span>
<span id="cb54-297"><a href="#cb54-297" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, bend right] (LB) to (Y);</span></span>
<span id="cb54-298"><a href="#cb54-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-299"><a href="#cb54-299" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb54-300"><a href="#cb54-300" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, draw=black] (B) to (Y);</span></span>
<span id="cb54-301"><a href="#cb54-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-302"><a href="#cb54-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-303"><a href="#cb54-303" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb54-304"><a href="#cb54-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-305"><a href="#cb54-305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-306"><a href="#cb54-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-307"><a href="#cb54-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-308"><a href="#cb54-308" aria-hidden="true" tabindex="-1"></a>Consider the following set of plausible confounders:</span>
<span id="cb54-309"><a href="#cb54-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-310"><a href="#cb54-310" aria-hidden="true" tabindex="-1"></a>**L**: variables in $L$ that might confound the relationship between beliefs in Big Gods and social complexity:</span>
<span id="cb54-311"><a href="#cb54-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-312"><a href="#cb54-312" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**General religiosity**: prevalence of religion might influence both the belief in Big Gods and social complexity.</span>
<span id="cb54-313"><a href="#cb54-313" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Cultural norms and values**: ingrained social norms and values, not any part of religion.</span>
<span id="cb54-314"><a href="#cb54-314" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Historical path dependent events**: e.g. conquest.</span>
<span id="cb54-315"><a href="#cb54-315" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Education**: affects religious beliefs and the complexity.</span>
<span id="cb54-316"><a href="#cb54-316" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Economic development**: economic conditions might whether people prefer religious practices or resource intensive hobbies and also, social complexity.</span>
<span id="cb54-317"><a href="#cb54-317" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Political stability**: stable governance can influence both the proliferation of religious practices and the development of complex social structures</span>
<span id="cb54-318"><a href="#cb54-318" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**Political complexity in the past**:  huge confounder, must be adjusted for.</span>
<span id="cb54-319"><a href="#cb54-319" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>**Beliefs in big gods in the past**: huge confounder, must be adjusted for.</span>
<span id="cb54-320"><a href="#cb54-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-321"><a href="#cb54-321" aria-hidden="true" tabindex="-1"></a>**Q**: variables in $Q$ that that might confound the relationship between monumental architecture and social complexity:</span>
<span id="cb54-322"><a href="#cb54-322" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb54-323"><a href="#cb54-323" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Technology**: for constructing of monumental architecture and managing social complexity.</span>
<span id="cb54-324"><a href="#cb54-324" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Economic resources**: as above (overlap)</span>
<span id="cb54-325"><a href="#cb54-325" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Historical path dependent events**: e.g. conquestm as above</span>
<span id="cb54-326"><a href="#cb54-326" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Labour**: the availability of builders, slaves, etc.</span>
<span id="cb54-327"><a href="#cb54-327" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Geography**: natural resources can affect a society's ability to build monumental structures and its social development.</span>
<span id="cb54-328"><a href="#cb54-328" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Cultural norms and values**: ingrained social norms and values, not any part of religion.</span>
<span id="cb54-329"><a href="#cb54-329" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**Political complexity in the past**:  huge confounder, must be adjusted for.</span>
<span id="cb54-330"><a href="#cb54-330" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>**Beliefs in big gods in the past**: huge confounder, must be adjusted for.</span>
<span id="cb54-331"><a href="#cb54-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-332"><a href="#cb54-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-333"><a href="#cb54-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-334"><a href="#cb54-334" aria-hidden="true" tabindex="-1"></a>As we see:</span>
<span id="cb54-335"><a href="#cb54-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-336"><a href="#cb54-336" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-337"><a href="#cb54-337" aria-hidden="true" tabindex="-1"></a>L \cap Q \not\equiv \emptyset</span>
<span id="cb54-338"><a href="#cb54-338" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb54-339"><a href="#cb54-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-340"><a href="#cb54-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-341"><a href="#cb54-341" aria-hidden="true" tabindex="-1"></a>However, the set of control variables are larger, and note, we are assuming that monumental architecture and big God beliefs do not affect each other. </span>
<span id="cb54-342"><a href="#cb54-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-343"><a href="#cb54-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-344"><a href="#cb54-344" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effect Modification</span></span>
<span id="cb54-345"><a href="#cb54-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-346"><a href="#cb54-346" aria-hidden="true" tabindex="-1"></a>**It is often scientifically interesting to consider whether treatment effects vary over levels of other variable without imagining a double intervention.** </span>
<span id="cb54-347"><a href="#cb54-347" aria-hidden="true" tabindex="-1"></a>Broadly, we will think of "effect-modification" as a set of related and overlapping concepts pertaining to the understanding variability of a single effect within a population.  </span>
<span id="cb54-348"><a href="#cb54-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-349"><a href="#cb54-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-350"><a href="#cb54-350" aria-hidden="true" tabindex="-1"></a><span class="fu">### Heterogeneous Treatment Effects -- a broad concept of effect-modification</span></span>
<span id="cb54-351"><a href="#cb54-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-352"><a href="#cb54-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-353"><a href="#cb54-353" aria-hidden="true" tabindex="-1"></a>Heterogeneous Treatment Effects (HTE) refer to settings where treatment effects vary across individuals or subgroups within a study population. This variability can arise from differences in baseline characteristics, environmental conditions, histories, .... much of which is unmeasured. </span>
<span id="cb54-354"><a href="#cb54-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-355"><a href="#cb54-355" aria-hidden="true" tabindex="-1"></a>**Appendix A** discusses the challenges in identifying HTE from data, but we already know that individual causal effects are not typically identifiable, and so heteroeneous treatment effects, at the limit of individual causal effects, are elusive. </span>
<span id="cb54-356"><a href="#cb54-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-357"><a href="#cb54-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-358"><a href="#cb54-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-359"><a href="#cb54-359" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional Average Treatment Effect (CATE) -- a narrower concept of effect-modification.</span></span>
<span id="cb54-360"><a href="#cb54-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-361"><a href="#cb54-361" aria-hidden="true" tabindex="-1"></a>We might be interested estimating average treatment effects within specific levels of measured covariates</span>
<span id="cb54-362"><a href="#cb54-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-363"><a href="#cb54-363" aria-hidden="true" tabindex="-1"></a>When our focus is estimation of the average treatment effect conditional on a specific level of a covariate or set of covariates. Our causal estimand is often written:</span>
<span id="cb54-364"><a href="#cb54-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-365"><a href="#cb54-365" aria-hidden="true" tabindex="-1"></a> $$\text{CATE}(x) = E<span class="co">[</span><span class="ot">Y(1) - Y(0) | X = x</span><span class="co">]</span>$$ </span>
<span id="cb54-366"><a href="#cb54-366" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb54-367"><a href="#cb54-367" aria-hidden="true" tabindex="-1"></a> where $X = x$, where $X$ denotes the level of a measured covariate or covariates of interest. </span>
<span id="cb54-368"><a href="#cb54-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-369"><a href="#cb54-369" aria-hidden="true" tabindex="-1"></a>The question: how does a causal effect vary within the population defined by levels of stratum $X=x$ </span>
<span id="cb54-370"><a href="#cb54-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-371"><a href="#cb54-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-372"><a href="#cb54-372" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing Effect Heterogenity in Groups. </span></span>
<span id="cb54-373"><a href="#cb54-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-374"><a href="#cb54-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-375"><a href="#cb54-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-376"><a href="#cb54-376" aria-hidden="true" tabindex="-1"></a>We might be interested in the following causal quantity (estimand), which compares two conditional average treatment effects between levels defined by $G = \tilde{g}$:</span>
<span id="cb54-377"><a href="#cb54-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-378"><a href="#cb54-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-379"><a href="#cb54-379" aria-hidden="true" tabindex="-1"></a>$${\gamma} = \overbrace{\big( \mathbb{E}<span class="co">[</span><span class="ot">Y(a^*)|G=g</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(a)|G=g</span><span class="co">]</span> \big)}^{{\delta_g}} - \overbrace{\big(\mathbb{E}<span class="co">[</span><span class="ot">Y(a^*)|G=g^{\prime}</span><span class="co">]</span>- \mathbb{E}<span class="co">[</span><span class="ot">Y(a)|G=g'</span><span class="co">]</span>\big)}^{{\delta_{g^{\prime}}}}$$</span>
<span id="cb54-380"><a href="#cb54-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-381"><a href="#cb54-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-382"><a href="#cb54-382" aria-hidden="true" tabindex="-1"></a>Suppose $A$ is the treatment, $G$ is the effect-modifier, and $Y$ is the outcome. The analysis of effect-modification assesses whether the effect of $A$ on $Y$ is different across levels of $G$ (i.e., whether the effect of $A$ on $Y$ is different when $G = g_1$ compared to when $G = g_2$).</span>
<span id="cb54-383"><a href="#cb54-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-384"><a href="#cb54-384" aria-hidden="true" tabindex="-1"></a>What do we need to identify such effects?  Note that $G$ here is not an intervention variable. It might not be coherent to imagine that $G$ *can* be intervened upon. </span>
<span id="cb54-385"><a href="#cb54-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-386"><a href="#cb54-386" aria-hidden="true" tabindex="-1"></a>@fig-dag-effect-modification is a causal diagram. Imagine we are intereste in whether the effect of $A$ on $Y$ differs across levels of $G$. Because we are not interested in the causal effect of $G$ as such, but rather, how the effect of $A$ varies across $G$, we need *not* adjust by $Q$.  However, which variables shall we include in our model?  What will happen if we assess the $G$ by examining a regression coefficient?  Suppose $L$ were not a confounder of $A$ to $Y$.  How then should we interpret our model?  </span>
<span id="cb54-387"><a href="#cb54-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-388"><a href="#cb54-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-389"><a href="#cb54-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-392"><a href="#cb54-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb54-393"><a href="#cb54-393" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-effect-modification</span></span>
<span id="cb54-394"><a href="#cb54-394" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Imagine A is an experiment. How shall we investigate effect modification of A on Y by Z? Can you see why regression coefficients will not work?"</span></span>
<span id="cb54-395"><a href="#cb54-395" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb54-396"><a href="#cb54-396" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb54-397"><a href="#cb54-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-398"><a href="#cb54-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-399"><a href="#cb54-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-400"><a href="#cb54-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-401"><a href="#cb54-401" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning, shapes.geometric, arrows.meta, decorations.pathmorphing}</span></span>
<span id="cb54-402"><a href="#cb54-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-403"><a href="#cb54-403" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{</span></span>
<span id="cb54-404"><a href="#cb54-404" aria-hidden="true" tabindex="-1"></a><span class="in">  Arrow/.style={-&gt;, &gt;=latex, line width=0.4pt},  % Defines a generic arrow style</span></span>
<span id="cb54-405"><a href="#cb54-405" aria-hidden="true" tabindex="-1"></a><span class="in">  emod/.style={rectangle, fill=blue!10, draw=blue, thick, minimum size=6mm},</span></span>
<span id="cb54-406"><a href="#cb54-406" aria-hidden="true" tabindex="-1"></a><span class="in">  emoddot/.style={circle, fill=blue!10, draw=blue, dotted, thick, minimum size=6mm}</span></span>
<span id="cb54-407"><a href="#cb54-407" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb54-408"><a href="#cb54-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-409"><a href="#cb54-409" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}</span></span>
<span id="cb54-410"><a href="#cb54-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-411"><a href="#cb54-411" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white, thick] (Q) at (-4,0) {Q};</span></span>
<span id="cb54-412"><a href="#cb54-412" aria-hidden="true" tabindex="-1"></a><span class="in">\node [black] (G) at (-2,0) {G};</span></span>
<span id="cb54-413"><a href="#cb54-413" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black,thick] (L) at (0,0) {L$_{0}$};</span></span>
<span id="cb54-414"><a href="#cb54-414" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white, thick] (A) at (2,0) {A$_{1}$};</span></span>
<span id="cb54-415"><a href="#cb54-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-416"><a href="#cb54-416" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emoddot] (Z) at (0, -1) {Z};</span></span>
<span id="cb54-417"><a href="#cb54-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-418"><a href="#cb54-418" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white, thick] (Y) at (4,0) {Y$_{2}$};</span></span>
<span id="cb54-419"><a href="#cb54-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-420"><a href="#cb54-420" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black] (Q) to (G);</span></span>
<span id="cb54-421"><a href="#cb54-421" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black] (G) to (L);</span></span>
<span id="cb54-422"><a href="#cb54-422" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black] (L) to (A);</span></span>
<span id="cb54-423"><a href="#cb54-423" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black, bend left = 30] (L) to (Y);</span></span>
<span id="cb54-424"><a href="#cb54-424" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[Arrow, draw=black, bend right = 40] (Q) to (Y);</span></span>
<span id="cb54-425"><a href="#cb54-425" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb54-426"><a href="#cb54-426" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[-{Circle[open, fill=none]}, line width=0.25pt, draw=blue, bend right = 10] (Z) to (Y); Circle-ended arrow</span></span>
<span id="cb54-427"><a href="#cb54-427" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb54-428"><a href="#cb54-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-429"><a href="#cb54-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-430"><a href="#cb54-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-431"><a href="#cb54-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-432"><a href="#cb54-432" aria-hidden="true" tabindex="-1"></a>Often, it is useful to obtain causal effects by restricting to one level of a population. Where $G$ denotes a society, consider:</span>
<span id="cb54-433"><a href="#cb54-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-434"><a href="#cb54-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-435"><a href="#cb54-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-436"><a href="#cb54-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-437"><a href="#cb54-437" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Causal effect within North American societies (**$G=1$):</span>
<span id="cb54-438"><a href="#cb54-438" aria-hidden="true" tabindex="-1"></a>    $$\delta_{g_1} = \mathbb{E}<span class="co">[</span><span class="ot">Y(1)|G= g_1</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0)|G = g_1</span><span class="co">]</span>$$ </span>
<span id="cb54-439"><a href="#cb54-439" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-440"><a href="#cb54-440" aria-hidden="true" tabindex="-1"></a>Here, $\delta_{g_2}$ represents the estimated causal effect of changing the exposure from $A = 0$ to $A = 1$ within the North American societies.</span>
<span id="cb54-441"><a href="#cb54-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-442"><a href="#cb54-442" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Causal effect within Continental societies (**$G=g_2$):</span>
<span id="cb54-443"><a href="#cb54-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-444"><a href="#cb54-444" aria-hidden="true" tabindex="-1"></a>    $$\delta_{g2} = \mathbb{E}<span class="co">[</span><span class="ot">Y(1)|G=g_2</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y(0)|G=g_2</span><span class="co">]</span>$$</span>
<span id="cb54-445"><a href="#cb54-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-446"><a href="#cb54-446" aria-hidden="true" tabindex="-1"></a>    Similarly, ${\delta}_{g_2}$ denotes the estimated causal effect for the Continental societies.</span>
<span id="cb54-447"><a href="#cb54-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-448"><a href="#cb54-448" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Comparing causal effects across groups**:</span>
<span id="cb54-449"><a href="#cb54-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-450"><a href="#cb54-450" aria-hidden="true" tabindex="-1"></a>    $${\gamma} = {\delta}_{g_1} - {\delta}_{g_2}$$ </span>
<span id="cb54-451"><a href="#cb54-451" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-452"><a href="#cb54-452" aria-hidden="true" tabindex="-1"></a>The quantity ${\gamma}$ defines the difference in the causal estimands between the two groups. A nonzero $\hat{\gamma}$ indicates effect-modification, suggesting that the effect of changing the exposure differs between the two groups. If we were to observe that $\hat{\gamma} \neq 0$, this would provide evidence for variability in the effect of the exposure on the outcome in different groups. Note that the causal effect for one group might be indistinguishable from zero, and yet we might nevertheless find evidence for effect-modification if the comparison group exhibits reliably different responses from the contrast group that is indistinguishable from zero.</span>
<span id="cb54-453"><a href="#cb54-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-454"><a href="#cb54-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-455"><a href="#cb54-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-456"><a href="#cb54-456" aria-hidden="true" tabindex="-1"></a>That's it, we now know our causal quantity of interest.  Next week, we'll develop our statistical estimands, estimators, and begin evaluating effect-modification by groups. </span>
<span id="cb54-457"><a href="#cb54-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-458"><a href="#cb54-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-459"><a href="#cb54-459" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary of what we learned</span></span>
<span id="cb54-460"><a href="#cb54-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-461"><a href="#cb54-461" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interaction targets a joint intervention in a population</span>
<span id="cb54-462"><a href="#cb54-462" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Effect modificiation targets how a single intervention varies by groups within a population</span>
<span id="cb54-463"><a href="#cb54-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-464"><a href="#cb54-464" aria-hidden="true" tabindex="-1"></a>Note, to obtain the group-wise contrasts, we must be able to imagine the groups as belonging to a larger population. When thinking of people, we all belong Later we shall consider how measurement complicates this assumption, even if all humans belong to the same species...</span>
<span id="cb54-465"><a href="#cb54-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-466"><a href="#cb54-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-467"><a href="#cb54-467" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab Part 1: Setting up your data</span></span>
<span id="cb54-468"><a href="#cb54-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-469"><a href="#cb54-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-470"><a href="#cb54-470" aria-hidden="true" tabindex="-1"></a><span class="fu">### Set up your libraries</span></span>
<span id="cb54-471"><a href="#cb54-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-474"><a href="#cb54-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-475"><a href="#cb54-475" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb54-476"><a href="#cb54-476" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb54-477"><a href="#cb54-477" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb54-478"><a href="#cb54-478" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"here"</span>)</span>
<span id="cb54-479"><a href="#cb54-479" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"skimr"</span>)</span>
<span id="cb54-480"><a href="#cb54-480" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(gtsummary)) <span class="fu">install.packages</span>(<span class="st">"gtsummary"</span>)</span>
<span id="cb54-481"><a href="#cb54-481" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(janitor)) <span class="fu">install.packages</span>(<span class="st">"janitor"</span>)</span>
<span id="cb54-482"><a href="#cb54-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-483"><a href="#cb54-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-484"><a href="#cb54-484" aria-hidden="true" tabindex="-1"></a><span class="co"># if you need to update the margot package, uncomment and do this</span></span>
<span id="cb54-485"><a href="#cb54-485" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("go-bayes/margot")</span></span>
<span id="cb54-486"><a href="#cb54-486" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("go-bayes/margot")</span></span>
<span id="cb54-487"><a href="#cb54-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-488"><a href="#cb54-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-489"><a href="#cb54-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-490"><a href="#cb54-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-491"><a href="#cb54-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-492"><a href="#cb54-492" aria-hidden="true" tabindex="-1"></a><span class="fu">### Set up a path to a folder in your directory </span></span>
<span id="cb54-493"><a href="#cb54-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-494"><a href="#cb54-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-495"><a href="#cb54-495" aria-hidden="true" tabindex="-1"></a>This will allow you to save the outputs of models and other information, which will be handy when you are producing your manuscript. Call this <span class="in">`push_mods`</span></span>
<span id="cb54-496"><a href="#cb54-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-499"><a href="#cb54-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-500"><a href="#cb54-500" aria-hidden="true" tabindex="-1"></a><span class="do">### Set up a path to a folder in your directory </span></span>
<span id="cb54-501"><a href="#cb54-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-502"><a href="#cb54-502" aria-hidden="true" tabindex="-1"></a><span class="co"># create a folder called saved and make a path like this</span></span>
<span id="cb54-503"><a href="#cb54-503" aria-hidden="true" tabindex="-1"></a>push_mods <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">'/Users/joseph/Library/CloudStorage/Dropbox-v-project/data/saved'</span>)</span>
<span id="cb54-504"><a href="#cb54-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-505"><a href="#cb54-505" aria-hidden="true" tabindex="-1"></a><span class="co"># view it (will be different for you)</span></span>
<span id="cb54-506"><a href="#cb54-506" aria-hidden="true" tabindex="-1"></a>push_mods</span>
<span id="cb54-507"><a href="#cb54-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-508"><a href="#cb54-508" aria-hidden="true" tabindex="-1"></a><span class="co"># another option</span></span>
<span id="cb54-509"><a href="#cb54-509" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(object, here::here(push_mods, "object"))</span></span>
<span id="cb54-510"><a href="#cb54-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-511"><a href="#cb54-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-512"><a href="#cb54-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-513"><a href="#cb54-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-514"><a href="#cb54-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-515"><a href="#cb54-515" aria-hidden="true" tabindex="-1"></a><span class="fu">### Initial Data Wrangling to select the study sample</span></span>
<span id="cb54-516"><a href="#cb54-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-517"><a href="#cb54-517" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Where to find variable names information</span></span>
<span id="cb54-518"><a href="#cb54-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-519"><a href="#cb54-519" aria-hidden="true" tabindex="-1"></a>Find it the data directory here: <span class="ot">&lt;https://osf.io/75snb/&gt;</span></span>
<span id="cb54-520"><a href="#cb54-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-521"><a href="#cb54-521" aria-hidden="true" tabindex="-1"></a>Also see here: <span class="ot">&lt;https://github.com/go-bayes/templates/tree/main/method&gt;</span></span>
<span id="cb54-522"><a href="#cb54-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-523"><a href="#cb54-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-524"><a href="#cb54-524" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Think, what are my eligibility criteria? </span></span>
<span id="cb54-525"><a href="#cb54-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-526"><a href="#cb54-526" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Participated in at baseline</span>
<span id="cb54-527"><a href="#cb54-527" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Participated at treatment wave</span>
<span id="cb54-528"><a href="#cb54-528" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>May have been lost to follow up at the end of the study</span>
<span id="cb54-529"><a href="#cb54-529" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Full information on the treatment variable (think about this...)</span>
<span id="cb54-530"><a href="#cb54-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-531"><a href="#cb54-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-532"><a href="#cb54-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-535"><a href="#cb54-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-536"><a href="#cb54-536" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb54-537"><a href="#cb54-537" aria-hidden="true" tabindex="-1"></a><span class="co"># eliminate haven labels</span></span>
<span id="cb54-538"><a href="#cb54-538" aria-hidden="true" tabindex="-1"></a>df_nz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df_nz)</span>
<span id="cb54-539"><a href="#cb54-539" aria-hidden="true" tabindex="-1"></a>df_nz <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">zap_formats</span>(df_nz)</span>
<span id="cb54-540"><a href="#cb54-540" aria-hidden="true" tabindex="-1"></a>df_nz <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">zap_label</span>(df_nz)</span>
<span id="cb54-541"><a href="#cb54-541" aria-hidden="true" tabindex="-1"></a>df_nz <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">zap_widths</span>(df_nz)</span>
<span id="cb54-542"><a href="#cb54-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-543"><a href="#cb54-543" aria-hidden="true" tabindex="-1"></a><span class="co"># name output folder</span></span>
<span id="cb54-544"><a href="#cb54-544" aria-hidden="true" tabindex="-1"></a>push_mods <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"outputs"</span>)</span>
<span id="cb54-545"><a href="#cb54-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-546"><a href="#cb54-546" aria-hidden="true" tabindex="-1"></a><span class="co"># set exposure name</span></span>
<span id="cb54-547"><a href="#cb54-547" aria-hidden="true" tabindex="-1"></a>name_exposure <span class="ot">&lt;-</span>  <span class="st">"perfectionism"</span></span>
<span id="cb54-548"><a href="#cb54-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-549"><a href="#cb54-549" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain ids for individuals who participated in 2018 and have no missing baseline exposure</span></span>
<span id="cb54-550"><a href="#cb54-550" aria-hidden="true" tabindex="-1"></a>ids_2018 <span class="ot">&lt;-</span> df_nz <span class="sc">%&gt;%</span></span>
<span id="cb54-551"><a href="#cb54-551" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(year_measured <span class="sc">==</span> <span class="dv">1</span>, wave <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-552"><a href="#cb54-552" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(name_exposure))) <span class="sc">|&gt;</span> <span class="co"># criteria, no missing</span></span>
<span id="cb54-553"><a href="#cb54-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id)</span>
<span id="cb54-554"><a href="#cb54-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-555"><a href="#cb54-555" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain ids for individuals who participated in 2019</span></span>
<span id="cb54-556"><a href="#cb54-556" aria-hidden="true" tabindex="-1"></a>ids_2019 <span class="ot">&lt;-</span> df_nz <span class="sc">%&gt;%</span></span>
<span id="cb54-557"><a href="#cb54-557" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(year_measured <span class="sc">==</span> <span class="dv">1</span>, wave <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-558"><a href="#cb54-558" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(name_exposure))) <span class="sc">|&gt;</span> <span class="co"># criteria, no missing</span></span>
<span id="cb54-559"><a href="#cb54-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id)</span>
<span id="cb54-560"><a href="#cb54-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-561"><a href="#cb54-561" aria-hidden="true" tabindex="-1"></a><span class="co"># intersect IDs from 2018 and 2019 to ensure participation in both years</span></span>
<span id="cb54-562"><a href="#cb54-562" aria-hidden="true" tabindex="-1"></a>ids_2018_2019 <span class="ot">&lt;-</span> <span class="fu">intersect</span>(ids_2018, ids_2019)</span>
<span id="cb54-563"><a href="#cb54-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-564"><a href="#cb54-564" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling</span></span>
<span id="cb54-565"><a href="#cb54-565" aria-hidden="true" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span></span>
<span id="cb54-566"><a href="#cb54-566" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(id <span class="sc">%in%</span> ids_2018_2019 <span class="sc">&amp;</span></span>
<span id="cb54-567"><a href="#cb54-567" aria-hidden="true" tabindex="-1"></a>                  wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb54-568"><a href="#cb54-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, wave) <span class="sc">|&gt;</span></span>
<span id="cb54-569"><a href="#cb54-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb54-570"><a href="#cb54-570" aria-hidden="true" tabindex="-1"></a>    <span class="st">"id"</span>,</span>
<span id="cb54-571"><a href="#cb54-571" aria-hidden="true" tabindex="-1"></a>    <span class="st">"wave"</span>,</span>
<span id="cb54-572"><a href="#cb54-572" aria-hidden="true" tabindex="-1"></a>    <span class="st">"year_measured"</span>,</span>
<span id="cb54-573"><a href="#cb54-573" aria-hidden="true" tabindex="-1"></a>    <span class="st">"age"</span>,</span>
<span id="cb54-574"><a href="#cb54-574" aria-hidden="true" tabindex="-1"></a>    <span class="st">"male"</span>,</span>
<span id="cb54-575"><a href="#cb54-575" aria-hidden="true" tabindex="-1"></a>    <span class="st">"born_nz"</span>,</span>
<span id="cb54-576"><a href="#cb54-576" aria-hidden="true" tabindex="-1"></a>    <span class="st">"eth_cat"</span>,</span>
<span id="cb54-577"><a href="#cb54-577" aria-hidden="true" tabindex="-1"></a>    <span class="co">#factor(EthCat, labels = c("Euro", "Maori", "Pacific", "Asian")),</span></span>
<span id="cb54-578"><a href="#cb54-578" aria-hidden="true" tabindex="-1"></a>    <span class="st">"employed"</span>,</span>
<span id="cb54-579"><a href="#cb54-579" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Are you currently employed? (this includes self-employment or casual work)</span></span>
<span id="cb54-580"><a href="#cb54-580" aria-hidden="true" tabindex="-1"></a>    <span class="st">"edu"</span>,</span>
<span id="cb54-581"><a href="#cb54-581" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "gen_cohort",</span></span>
<span id="cb54-582"><a href="#cb54-582" aria-hidden="true" tabindex="-1"></a>    <span class="st">"household_inc"</span>,</span>
<span id="cb54-583"><a href="#cb54-583" aria-hidden="true" tabindex="-1"></a>    <span class="st">"partner"</span>,</span>
<span id="cb54-584"><a href="#cb54-584" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 0 = no, 1 = yes</span></span>
<span id="cb54-585"><a href="#cb54-585" aria-hidden="true" tabindex="-1"></a>    <span class="st">"parent"</span>,</span>
<span id="cb54-586"><a href="#cb54-586" aria-hidden="true" tabindex="-1"></a>    <span class="st">"alert_level_combined_lead"</span>, <span class="co"># see bibliography</span></span>
<span id="cb54-587"><a href="#cb54-587" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 0 = no, 1 = yes</span></span>
<span id="cb54-588"><a href="#cb54-588" aria-hidden="true" tabindex="-1"></a>    <span class="st">"political_conservative"</span>, <span class="co"># see nzavs sheet</span></span>
<span id="cb54-589"><a href="#cb54-589" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hours_exercise"</span>, <span class="co"># see nzavs sheet</span></span>
<span id="cb54-590"><a href="#cb54-590" aria-hidden="true" tabindex="-1"></a>    <span class="st">"agreeableness"</span>, </span>
<span id="cb54-591"><a href="#cb54-591" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mini-IPIP6 Agreeableness (also modelled as empathy facet)</span></span>
<span id="cb54-592"><a href="#cb54-592" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sympathize with others' feelings.</span></span>
<span id="cb54-593"><a href="#cb54-593" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am not interested in other people's problems.</span></span>
<span id="cb54-594"><a href="#cb54-594" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Feel others' emotions.</span></span>
<span id="cb54-595"><a href="#cb54-595" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am not really interested in others.</span></span>
<span id="cb54-596"><a href="#cb54-596" aria-hidden="true" tabindex="-1"></a>    <span class="st">"conscientiousness"</span>,</span>
<span id="cb54-597"><a href="#cb54-597" aria-hidden="true" tabindex="-1"></a>    <span class="co"># see mini ipip6</span></span>
<span id="cb54-598"><a href="#cb54-598" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get chores done right away.</span></span>
<span id="cb54-599"><a href="#cb54-599" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Like order.</span></span>
<span id="cb54-600"><a href="#cb54-600" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make a mess of things.</span></span>
<span id="cb54-601"><a href="#cb54-601" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Often forget to put things back in their proper place.</span></span>
<span id="cb54-602"><a href="#cb54-602" aria-hidden="true" tabindex="-1"></a>    <span class="st">"extraversion"</span>,</span>
<span id="cb54-603"><a href="#cb54-603" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mini-IPIP6 Extraversion</span></span>
<span id="cb54-604"><a href="#cb54-604" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am the life of the party.</span></span>
<span id="cb54-605"><a href="#cb54-605" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Don't talk a lot.</span></span>
<span id="cb54-606"><a href="#cb54-606" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep in the background.</span></span>
<span id="cb54-607"><a href="#cb54-607" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Talk to a lot of different people at parties.</span></span>
<span id="cb54-608"><a href="#cb54-608" aria-hidden="true" tabindex="-1"></a>    <span class="st">"honesty_humility"</span>,</span>
<span id="cb54-609"><a href="#cb54-609" aria-hidden="true" tabindex="-1"></a>    <span class="co"># see mini ipip6</span></span>
<span id="cb54-610"><a href="#cb54-610" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Would like to be seen driving around in a very expensive car.</span></span>
<span id="cb54-611"><a href="#cb54-611" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Would get a lot of pleasure from owning expensive luxury goods.</span></span>
<span id="cb54-612"><a href="#cb54-612" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Feel entitled to more of everything.</span></span>
<span id="cb54-613"><a href="#cb54-613" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Deserve more things in life.</span></span>
<span id="cb54-614"><a href="#cb54-614" aria-hidden="true" tabindex="-1"></a>    <span class="st">"openness"</span>,</span>
<span id="cb54-615"><a href="#cb54-615" aria-hidden="true" tabindex="-1"></a>    <span class="co"># see mini ipip6</span></span>
<span id="cb54-616"><a href="#cb54-616" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Have a vivid imagination.</span></span>
<span id="cb54-617"><a href="#cb54-617" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Have difficulty understanding abstract ideas.</span></span>
<span id="cb54-618"><a href="#cb54-618" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Do not have a good imagination.</span></span>
<span id="cb54-619"><a href="#cb54-619" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am not interested in abstract ideas.</span></span>
<span id="cb54-620"><a href="#cb54-620" aria-hidden="true" tabindex="-1"></a>    <span class="st">"neuroticism"</span>,</span>
<span id="cb54-621"><a href="#cb54-621" aria-hidden="true" tabindex="-1"></a>    <span class="co"># see mini ipip6</span></span>
<span id="cb54-622"><a href="#cb54-622" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Have frequent mood swings.</span></span>
<span id="cb54-623"><a href="#cb54-623" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Am relaxed most of the time.</span></span>
<span id="cb54-624"><a href="#cb54-624" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get upset easily.</span></span>
<span id="cb54-625"><a href="#cb54-625" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Seldom feel blue.</span></span>
<span id="cb54-626"><a href="#cb54-626" aria-hidden="true" tabindex="-1"></a>    <span class="st">"modesty"</span>,</span>
<span id="cb54-627"><a href="#cb54-627" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # see mini ipip6</span></span>
<span id="cb54-628"><a href="#cb54-628" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # I want people to know that I am an important person of high status,</span></span>
<span id="cb54-629"><a href="#cb54-629" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # I am an ordinary person who is no better than others.</span></span>
<span id="cb54-630"><a href="#cb54-630" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # I wouldn’t want people to treat me as though I were superior to them.</span></span>
<span id="cb54-631"><a href="#cb54-631" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # I think that I am entitled to more respect than the average person is</span></span>
<span id="cb54-632"><a href="#cb54-632" aria-hidden="true" tabindex="-1"></a>    <span class="co">#"w_gend_age_ethnic",</span></span>
<span id="cb54-633"><a href="#cb54-633" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sample_weights"</span>, <span class="co"># see nzavs sheet</span></span>
<span id="cb54-634"><a href="#cb54-634" aria-hidden="true" tabindex="-1"></a>    <span class="st">"neighbourhood_community"</span>,</span>
<span id="cb54-635"><a href="#cb54-635" aria-hidden="true" tabindex="-1"></a>    <span class="co"># #I feel a sense of community with others in my local neighbourhood.</span></span>
<span id="cb54-636"><a href="#cb54-636" aria-hidden="true" tabindex="-1"></a>    <span class="st">"belong"</span>, <span class="co"># see nzavs sheet</span></span>
<span id="cb54-637"><a href="#cb54-637" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rural_gch_2018_l"</span>,<span class="co"># see nzavs sheet</span></span>
<span id="cb54-638"><a href="#cb54-638" aria-hidden="true" tabindex="-1"></a>    <span class="st">"support"</span>,</span>
<span id="cb54-639"><a href="#cb54-639" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "support_help",</span></span>
<span id="cb54-640"><a href="#cb54-640" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # 'There are people I can depend on to help me if I really need it.</span></span>
<span id="cb54-641"><a href="#cb54-641" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "support_turnto",</span></span>
<span id="cb54-642"><a href="#cb54-642" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # There is no one I can turn to for guidance in times of stress.</span></span>
<span id="cb54-643"><a href="#cb54-643" aria-hidden="true" tabindex="-1"></a>    <span class="co"># "support_rnoguidance",</span></span>
<span id="cb54-644"><a href="#cb54-644" aria-hidden="true" tabindex="-1"></a>    <span class="co">#There is no one I can turn to for guidance in times of stress.</span></span>
<span id="cb54-645"><a href="#cb54-645" aria-hidden="true" tabindex="-1"></a>    <span class="st">"perfectionism"</span>,</span>
<span id="cb54-646"><a href="#cb54-646" aria-hidden="true" tabindex="-1"></a>    <span class="st">"religion_religious"</span>,</span>
<span id="cb54-647"><a href="#cb54-647" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kessler_latent_depression"</span>,</span>
<span id="cb54-648"><a href="#cb54-648" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kessler_latent_anxiety"</span></span>
<span id="cb54-649"><a href="#cb54-649" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb54-650"><a href="#cb54-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-651"><a href="#cb54-651" aria-hidden="true" tabindex="-1"></a>    <span class="co">#initialize 'censored'</span></span>
<span id="cb54-652"><a href="#cb54-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">censored =</span> <span class="fu">ifelse</span>(<span class="fu">lead</span>(year_measured) <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb54-653"><a href="#cb54-653" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-654"><a href="#cb54-654" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify 'censored' based on the condition; no need to check for NA here as 'censored' is already defined in the previous step</span></span>
<span id="cb54-655"><a href="#cb54-655" aria-hidden="true" tabindex="-1"></a>    <span class="at">censored =</span>  <span class="fu">ifelse</span>(<span class="fu">is.na</span>(censored) <span class="sc">&amp;</span></span>
<span id="cb54-656"><a href="#cb54-656" aria-hidden="true" tabindex="-1"></a>                         year_measured <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, censored)</span>
<span id="cb54-657"><a href="#cb54-657" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb54-658"><a href="#cb54-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>year_measured) <span class="sc">|&gt;</span></span>
<span id="cb54-659"><a href="#cb54-659" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb54-660"><a href="#cb54-660" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rescale these variables, to get all variables on a similar scale</span></span>
<span id="cb54-661"><a href="#cb54-661" aria-hidden="true" tabindex="-1"></a>    <span class="co"># otherwise your models can blow up, or become uninterpretable. </span></span>
<span id="cb54-662"><a href="#cb54-662" aria-hidden="true" tabindex="-1"></a>    <span class="at">household_inc_log =</span> <span class="fu">log</span>(household_inc <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb54-663"><a href="#cb54-663" aria-hidden="true" tabindex="-1"></a>    <span class="at">hours_exercise_log =</span> <span class="fu">log</span>(hours_exercise <span class="sc">+</span> <span class="dv">1</span>)  ) <span class="sc">|&gt;</span></span>
<span id="cb54-664"><a href="#cb54-664" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb54-665"><a href="#cb54-665" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb54-666"><a href="#cb54-666" aria-hidden="true" tabindex="-1"></a>      household_inc,</span>
<span id="cb54-667"><a href="#cb54-667" aria-hidden="true" tabindex="-1"></a>      hours_exercise)</span>
<span id="cb54-668"><a href="#cb54-668" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb54-669"><a href="#cb54-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span></span>
<span id="cb54-670"><a href="#cb54-670" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::rename(sample_weights = w_gend_age_ethnic,</span></span>
<span id="cb54-671"><a href="#cb54-671" aria-hidden="true" tabindex="-1"></a>  <span class="co">#               sample_origin =  sample_origin_names_combined) |&gt;</span></span>
<span id="cb54-672"><a href="#cb54-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, wave) <span class="sc">|&gt;</span></span>
<span id="cb54-673"><a href="#cb54-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-674"><a href="#cb54-674" aria-hidden="true" tabindex="-1"></a>  <span class="at">rural_gch_2018_l =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(rural_gch_2018_l)),</span>
<span id="cb54-675"><a href="#cb54-675" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   parent = as.numeric(as.character(parent)),</span></span>
<span id="cb54-676"><a href="#cb54-676" aria-hidden="true" tabindex="-1"></a>  <span class="at">partner =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(partner)),</span>
<span id="cb54-677"><a href="#cb54-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">born_nz =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(born_nz)),</span>
<span id="cb54-678"><a href="#cb54-678" aria-hidden="true" tabindex="-1"></a>  <span class="at">censored =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(censored)),</span>
<span id="cb54-679"><a href="#cb54-679" aria-hidden="true" tabindex="-1"></a>  <span class="at">employed =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(employed))</span>
<span id="cb54-680"><a href="#cb54-680" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb54-681"><a href="#cb54-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span></span>
<span id="cb54-682"><a href="#cb54-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb54-683"><a href="#cb54-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="sc">|&gt;</span></span>
<span id="cb54-684"><a href="#cb54-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, wave) <span class="sc">|&gt;</span></span>
<span id="cb54-685"><a href="#cb54-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb54-686"><a href="#cb54-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-687"><a href="#cb54-687" aria-hidden="true" tabindex="-1"></a><span class="co"># check n in this sample</span></span>
<span id="cb54-688"><a href="#cb54-688" aria-hidden="true" tabindex="-1"></a>n_participants <span class="ot">&lt;-</span> skimr<span class="sc">::</span><span class="fu">n_unique</span>(dat_long<span class="sc">$</span>id)</span>
<span id="cb54-689"><a href="#cb54-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-690"><a href="#cb54-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-691"><a href="#cb54-691" aria-hidden="true" tabindex="-1"></a><span class="co"># make number pretty</span></span>
<span id="cb54-692"><a href="#cb54-692" aria-hidden="true" tabindex="-1"></a>n_participants<span class="ot">&lt;-</span> <span class="fu">prettyNum</span>(n_participants,<span class="at">big.mark=</span><span class="st">","</span>)</span>
<span id="cb54-693"><a href="#cb54-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-694"><a href="#cb54-694" aria-hidden="true" tabindex="-1"></a><span class="co"># save this so that you can use it in your manuscript</span></span>
<span id="cb54-695"><a href="#cb54-695" aria-hidden="true" tabindex="-1"></a>margot<span class="sc">::</span><span class="fu">here_save</span>(n_participants, <span class="st">"n_participants"</span>)</span>
<span id="cb54-696"><a href="#cb54-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-697"><a href="#cb54-697" aria-hidden="true" tabindex="-1"></a><span class="co"># try reading </span></span>
<span id="cb54-698"><a href="#cb54-698" aria-hidden="true" tabindex="-1"></a>n_participants_did_it_work_question_mark <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">here_read</span>(<span class="st">"n_participants"</span>)</span>
<span id="cb54-699"><a href="#cb54-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-700"><a href="#cb54-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-701"><a href="#cb54-701" aria-hidden="true" tabindex="-1"></a><span class="co"># view</span></span>
<span id="cb54-702"><a href="#cb54-702" aria-hidden="true" tabindex="-1"></a><span class="co"># n_participants_did_it_work_question_mark</span></span>
<span id="cb54-703"><a href="#cb54-703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-704"><a href="#cb54-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-705"><a href="#cb54-705" aria-hidden="true" tabindex="-1"></a>There are N = <span class="in">`r n_participants_did_it_work_question_mark`</span> participants.</span>
<span id="cb54-706"><a href="#cb54-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-707"><a href="#cb54-707" aria-hidden="true" tabindex="-1"></a><span class="fu">### Define your baseline covariates, treatment (exposure), and outcome</span></span>
<span id="cb54-708"><a href="#cb54-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-709"><a href="#cb54-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-712"><a href="#cb54-712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-713"><a href="#cb54-713" aria-hidden="true" tabindex="-1"></a><span class="co"># for example </span></span>
<span id="cb54-714"><a href="#cb54-714" aria-hidden="true" tabindex="-1"></a>baseline_vars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"male"</span>, <span class="st">"edu"</span>, <span class="st">"eth_cat"</span>, <span class="st">"partner"</span>, <span class="st">"employed"</span>, <span class="st">"born_nz"</span>, <span class="st">"neighbourhood_community"</span>, <span class="st">"household_inc_log"</span>,</span>
<span id="cb54-715"><a href="#cb54-715" aria-hidden="true" tabindex="-1"></a><span class="st">"parent"</span>, <span class="st">"religion_religious"</span>, <span class="st">"rural_gch_2018_l"</span>,<span class="st">"sample_weights"</span>, <span class="st">"employed"</span>, <span class="st">"alert_level_combined_lead"</span>)</span>
<span id="cb54-716"><a href="#cb54-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-717"><a href="#cb54-717" aria-hidden="true" tabindex="-1"></a><span class="co"># treatment</span></span>
<span id="cb54-718"><a href="#cb54-718" aria-hidden="true" tabindex="-1"></a>exposure_var <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"perfectionism"</span>, <span class="st">"censored"</span>) <span class="co"># we will use the censored variable later</span></span>
<span id="cb54-719"><a href="#cb54-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-720"><a href="#cb54-720" aria-hidden="true" tabindex="-1"></a><span class="co"># outcome, can be many</span></span>
<span id="cb54-721"><a href="#cb54-721" aria-hidden="true" tabindex="-1"></a>outcome_vars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"kessler_latent_anxiety"</span>, <span class="st">"kessler_latent_depression"</span>)</span>
<span id="cb54-722"><a href="#cb54-722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-723"><a href="#cb54-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-724"><a href="#cb54-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-725"><a href="#cb54-725" aria-hidden="true" tabindex="-1"></a><span class="fu">### Make your baseline table</span></span>
<span id="cb54-726"><a href="#cb54-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-729"><a href="#cb54-729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-730"><a href="#cb54-730" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb54-731"><a href="#cb54-731" aria-hidden="true" tabindex="-1"></a><span class="co"># the setdiff command allows us to remove names from the baseline vars list that we do not want</span></span>
<span id="cb54-732"><a href="#cb54-732" aria-hidden="true" tabindex="-1"></a>base_var <span class="ot">&lt;-</span></span>
<span id="cb54-733"><a href="#cb54-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(baseline_vars, <span class="fu">c</span>(<span class="st">"censored"</span>, <span class="st">"sample_weights"</span>, <span class="st">"alert_level_combined_lead"</span>, outcome_vars))</span>
<span id="cb54-734"><a href="#cb54-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-735"><a href="#cb54-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-736"><a href="#cb54-736" aria-hidden="true" tabindex="-1"></a><span class="co">#  we only want the data at baseline </span></span>
<span id="cb54-737"><a href="#cb54-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-738"><a href="#cb54-738" aria-hidden="true" tabindex="-1"></a><span class="co"># select only baseline wave</span></span>
<span id="cb54-739"><a href="#cb54-739" aria-hidden="true" tabindex="-1"></a>dt_18 <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span> </span>
<span id="cb54-740"><a href="#cb54-740" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span>)</span>
<span id="cb54-741"><a href="#cb54-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-742"><a href="#cb54-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-743"><a href="#cb54-743" aria-hidden="true" tabindex="-1"></a><span class="co"># get only the baseline variables for the table</span></span>
<span id="cb54-744"><a href="#cb54-744" aria-hidden="true" tabindex="-1"></a>selected_base_cols <span class="ot">&lt;-</span></span>
<span id="cb54-745"><a href="#cb54-745" aria-hidden="true" tabindex="-1"></a>  dt_18 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">all_of</span>(base_var))</span>
<span id="cb54-746"><a href="#cb54-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-747"><a href="#cb54-747" aria-hidden="true" tabindex="-1"></a><span class="co">#check</span></span>
<span id="cb54-748"><a href="#cb54-748" aria-hidden="true" tabindex="-1"></a>colnames_use <span class="ot">&lt;-</span> <span class="fu">colnames</span>(selected_base_cols)</span>
<span id="cb54-749"><a href="#cb54-749" aria-hidden="true" tabindex="-1"></a>colnames_use</span>
<span id="cb54-750"><a href="#cb54-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-751"><a href="#cb54-751" aria-hidden="true" tabindex="-1"></a><span class="co"># # aside to get different names in lists</span></span>
<span id="cb54-752"><a href="#cb54-752" aria-hidden="true" tabindex="-1"></a><span class="co"># everything_better_cols &lt;- c(colnames_use, "inkuk")</span></span>
<span id="cb54-753"><a href="#cb54-753" aria-hidden="true" tabindex="-1"></a><span class="co"># everything_better_cols</span></span>
<span id="cb54-754"><a href="#cb54-754" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb54-755"><a href="#cb54-755" aria-hidden="true" tabindex="-1"></a><span class="co"># # get rid of name</span></span>
<span id="cb54-756"><a href="#cb54-756" aria-hidden="true" tabindex="-1"></a><span class="co"># everything_worse_cols &lt;- setdiff(everything_better_cols, "inkuk")</span></span>
<span id="cb54-757"><a href="#cb54-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-758"><a href="#cb54-758" aria-hidden="true" tabindex="-1"></a><span class="co"># baseline table</span></span>
<span id="cb54-759"><a href="#cb54-759" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb54-760"><a href="#cb54-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-761"><a href="#cb54-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-762"><a href="#cb54-762" aria-hidden="true" tabindex="-1"></a><span class="co"># this is just a demo of another package, which can be useful for quick tables, less for your manuscripts</span></span>
<span id="cb54-763"><a href="#cb54-763" aria-hidden="true" tabindex="-1"></a>no_miss_df <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span> </span>
<span id="cb54-764"><a href="#cb54-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb54-765"><a href="#cb54-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-766"><a href="#cb54-766" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">table1</span>( <span class="sc">~</span> perfectionism  <span class="sc">|</span> wave <span class="sc">*</span> eth_cat ,</span>
<span id="cb54-767"><a href="#cb54-767" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> no_miss_df,</span>
<span id="cb54-768"><a href="#cb54-768" aria-hidden="true" tabindex="-1"></a>                <span class="at">overall =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-769"><a href="#cb54-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-770"><a href="#cb54-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-771"><a href="#cb54-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-772"><a href="#cb54-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-773"><a href="#cb54-773" aria-hidden="true" tabindex="-1"></a>table_baseline <span class="ot">&lt;-</span> selected_base_cols <span class="sc">|&gt;</span> </span>
<span id="cb54-774"><a href="#cb54-774" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>(<span class="at">case =</span> <span class="st">"title"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-775"><a href="#cb54-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb54-776"><a href="#cb54-776" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing =</span> <span class="st">"ifany"</span>,</span>
<span id="cb54-777"><a href="#cb54-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"column"</span>,</span>
<span id="cb54-778"><a href="#cb54-778" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb54-779"><a href="#cb54-779" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="fu">c</span>(</span>
<span id="cb54-780"><a href="#cb54-780" aria-hidden="true" tabindex="-1"></a>        <span class="st">"{mean} ({sd})"</span>, <span class="co"># Mean and SD</span></span>
<span id="cb54-781"><a href="#cb54-781" aria-hidden="true" tabindex="-1"></a>        <span class="st">"{min}, {max}"</span>, <span class="co"># Range (Min, Max)</span></span>
<span id="cb54-782"><a href="#cb54-782" aria-hidden="true" tabindex="-1"></a>        <span class="st">"{p25}, {p75}"</span> <span class="co"># IQR (25th percentile, 75th percentile)</span></span>
<span id="cb54-783"><a href="#cb54-783" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb54-784"><a href="#cb54-784" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb54-785"><a href="#cb54-785" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"continuous2"</span></span>
<span id="cb54-786"><a href="#cb54-786" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb54-787"><a href="#cb54-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Exposure + Demographic Variables**"</span>) <span class="sc">|&gt;</span> <span class="co"># update the column header</span></span>
<span id="cb54-788"><a href="#cb54-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>() </span>
<span id="cb54-789"><a href="#cb54-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-790"><a href="#cb54-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-791"><a href="#cb54-791" aria-hidden="true" tabindex="-1"></a><span class="co"># baseline</span></span>
<span id="cb54-792"><a href="#cb54-792" aria-hidden="true" tabindex="-1"></a>table_baseline</span>
<span id="cb54-793"><a href="#cb54-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-794"><a href="#cb54-794" aria-hidden="true" tabindex="-1"></a><span class="co"># save your baseline table</span></span>
<span id="cb54-795"><a href="#cb54-795" aria-hidden="true" tabindex="-1"></a>margot<span class="sc">::</span><span class="fu">here_save</span>(table_baseline, <span class="st">"table_baseline"</span>)</span>
<span id="cb54-796"><a href="#cb54-796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-797"><a href="#cb54-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-798"><a href="#cb54-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-799"><a href="#cb54-799" aria-hidden="true" tabindex="-1"></a><span class="fu">### Make exposure wave table</span></span>
<span id="cb54-800"><a href="#cb54-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-801"><a href="#cb54-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-802"><a href="#cb54-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-805"><a href="#cb54-805" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-806"><a href="#cb54-806" aria-hidden="true" tabindex="-1"></a><span class="co"># get first and second wave</span></span>
<span id="cb54-807"><a href="#cb54-807" aria-hidden="true" tabindex="-1"></a>dt_18_19 <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span> </span>
<span id="cb54-808"><a href="#cb54-808" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span> <span class="sc">|</span> wave <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-809"><a href="#cb54-809" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we need to drop unused levels of the wave</span></span>
<span id="cb54-810"><a href="#cb54-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb54-811"><a href="#cb54-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-812"><a href="#cb54-812" aria-hidden="true" tabindex="-1"></a><span class="co"># get vars.</span></span>
<span id="cb54-813"><a href="#cb54-813" aria-hidden="true" tabindex="-1"></a>selected_exposure_cols <span class="ot">&lt;-</span></span>
<span id="cb54-814"><a href="#cb54-814" aria-hidden="true" tabindex="-1"></a>  dt_18_19 <span class="sc">%&gt;%</span> <span class="fu">select</span>(</span>
<span id="cb54-815"><a href="#cb54-815" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb54-816"><a href="#cb54-816" aria-hidden="true" tabindex="-1"></a>      <span class="st">"perfectionism"</span>,</span>
<span id="cb54-817"><a href="#cb54-817" aria-hidden="true" tabindex="-1"></a>      <span class="st">"wave"</span></span>
<span id="cb54-818"><a href="#cb54-818" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-819"><a href="#cb54-819" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-820"><a href="#cb54-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-821"><a href="#cb54-821" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb54-822"><a href="#cb54-822" aria-hidden="true" tabindex="-1"></a><span class="co">#str(selected_exposure_cols)</span></span>
<span id="cb54-823"><a href="#cb54-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-824"><a href="#cb54-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-825"><a href="#cb54-825" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb54-826"><a href="#cb54-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-827"><a href="#cb54-827" aria-hidden="true" tabindex="-1"></a>table_exposures <span class="ot">&lt;-</span> selected_exposure_cols <span class="sc">%&gt;%</span></span>
<span id="cb54-828"><a href="#cb54-828" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>(<span class="at">case =</span> <span class="st">"title"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-829"><a href="#cb54-829" aria-hidden="true" tabindex="-1"></a>  labelled<span class="sc">::</span><span class="fu">to_factor</span>() <span class="sc">%&gt;%</span>  <span class="co"># ensure consistent use of pipe operator</span></span>
<span id="cb54-830"><a href="#cb54-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb54-831"><a href="#cb54-831" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"Wave"</span>,  <span class="co">#specify the grouping variable. Adjust "Wave" to match the cleaned column name</span></span>
<span id="cb54-832"><a href="#cb54-832" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing =</span> <span class="st">"always"</span>, </span>
<span id="cb54-833"><a href="#cb54-833" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"column"</span>,</span>
<span id="cb54-834"><a href="#cb54-834" aria-hidden="true" tabindex="-1"></a>    <span class="co"># statistic = list(all_continuous() ~ "{mean} ({sd})")  # Uncomment and adjust if needed for continuous variables</span></span>
<span id="cb54-835"><a href="#cb54-835" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb54-836"><a href="#cb54-836" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  add_n() %&gt;%  # Add column with total number of non-missing observations</span></span>
<span id="cb54-837"><a href="#cb54-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Exposure Variables by Wave**"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Update the column header</span></span>
<span id="cb54-838"><a href="#cb54-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>()</span>
<span id="cb54-839"><a href="#cb54-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-840"><a href="#cb54-840" aria-hidden="true" tabindex="-1"></a>table_exposures</span>
<span id="cb54-841"><a href="#cb54-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-842"><a href="#cb54-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-843"><a href="#cb54-843" aria-hidden="true" tabindex="-1"></a><span class="co"># save baseline</span></span>
<span id="cb54-844"><a href="#cb54-844" aria-hidden="true" tabindex="-1"></a><span class="fu">here_save</span>(table_exposures, <span class="st">"table_exposures"</span>)</span>
<span id="cb54-845"><a href="#cb54-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-846"><a href="#cb54-846" aria-hidden="true" tabindex="-1"></a>table_exposures</span>
<span id="cb54-847"><a href="#cb54-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-848"><a href="#cb54-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-849"><a href="#cb54-849" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table for the outcome</span></span>
<span id="cb54-850"><a href="#cb54-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-853"><a href="#cb54-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-854"><a href="#cb54-854" aria-hidden="true" tabindex="-1"></a><span class="co"># outcome table -----------------------------------------------------------</span></span>
<span id="cb54-855"><a href="#cb54-855" aria-hidden="true" tabindex="-1"></a>dt_18_20 <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span> </span>
<span id="cb54-856"><a href="#cb54-856" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span> <span class="sc">|</span> wave <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-857"><a href="#cb54-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb54-858"><a href="#cb54-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-859"><a href="#cb54-859" aria-hidden="true" tabindex="-1"></a>names_outcomes_tab <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(outcome_vars, dt_18_20)</span>
<span id="cb54-860"><a href="#cb54-860" aria-hidden="true" tabindex="-1"></a>names_outcomes_sorted <span class="ot">&lt;-</span> <span class="fu">sort</span>(names_outcomes_tab)</span>
<span id="cb54-861"><a href="#cb54-861" aria-hidden="true" tabindex="-1"></a>names_outcomes_final <span class="ot">&lt;-</span> names_outcomes_sorted <span class="co"># consistent workflow</span></span>
<span id="cb54-862"><a href="#cb54-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-863"><a href="#cb54-863" aria-hidden="true" tabindex="-1"></a><span class="co"># better names if desirable</span></span>
<span id="cb54-864"><a href="#cb54-864" aria-hidden="true" tabindex="-1"></a>selected_outcome_cols <span class="ot">&lt;-</span></span>
<span id="cb54-865"><a href="#cb54-865" aria-hidden="true" tabindex="-1"></a>  dt_18_20 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(names_outcomes_final),</span>
<span id="cb54-866"><a href="#cb54-866" aria-hidden="true" tabindex="-1"></a>                      wave) </span>
<span id="cb54-867"><a href="#cb54-867" aria-hidden="true" tabindex="-1"></a><span class="co"># |&gt; # example if you want to rename your variables for the table</span></span>
<span id="cb54-868"><a href="#cb54-868" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(</span></span>
<span id="cb54-869"><a href="#cb54-869" aria-hidden="true" tabindex="-1"></a><span class="co">#     Social_belonging = belong,</span></span>
<span id="cb54-870"><a href="#cb54-870" aria-hidden="true" tabindex="-1"></a><span class="co">#     Annual_charity = charity_donate,</span></span>
<span id="cb54-871"><a href="#cb54-871" aria-hidden="true" tabindex="-1"></a><span class="co">#     Volunteering_hours = hours_charity,</span></span>
<span id="cb54-872"><a href="#cb54-872" aria-hidden="true" tabindex="-1"></a><span class="co">#     Community_gives_money_binary = community_money_binary,</span></span>
<span id="cb54-873"><a href="#cb54-873" aria-hidden="true" tabindex="-1"></a><span class="co">#     Community_gives_time_binary = community_time_binary,</span></span>
<span id="cb54-874"><a href="#cb54-874" aria-hidden="true" tabindex="-1"></a><span class="co">#     Family_gives_money_binary = family_money_binary,</span></span>
<span id="cb54-875"><a href="#cb54-875" aria-hidden="true" tabindex="-1"></a><span class="co">#     Family_gives_time_binary = family_time_binary,</span></span>
<span id="cb54-876"><a href="#cb54-876" aria-hidden="true" tabindex="-1"></a><span class="co">#     Friends_give_money_binary = friends_money_binary,</span></span>
<span id="cb54-877"><a href="#cb54-877" aria-hidden="true" tabindex="-1"></a><span class="co">#     Friends_give_time = friends_time_binary,</span></span>
<span id="cb54-878"><a href="#cb54-878" aria-hidden="true" tabindex="-1"></a><span class="co">#     Social_support = support,</span></span>
<span id="cb54-879"><a href="#cb54-879" aria-hidden="true" tabindex="-1"></a><span class="co">#     Sense_neighbourhood_community = neighbourhood_community</span></span>
<span id="cb54-880"><a href="#cb54-880" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb54-881"><a href="#cb54-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-882"><a href="#cb54-882" aria-hidden="true" tabindex="-1"></a><span class="co"># order names correctly</span></span>
<span id="cb54-883"><a href="#cb54-883" aria-hidden="true" tabindex="-1"></a>selected_outcome_cols <span class="ot">&lt;-</span> selected_outcome_cols <span class="sc">%&gt;%</span></span>
<span id="cb54-884"><a href="#cb54-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">sort</span>(<span class="fu">names</span>(selected_outcome_cols)))</span>
<span id="cb54-885"><a href="#cb54-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-886"><a href="#cb54-886" aria-hidden="true" tabindex="-1"></a><span class="co"># checks</span></span>
<span id="cb54-887"><a href="#cb54-887" aria-hidden="true" tabindex="-1"></a><span class="co"># str(selected_outcome_cols)</span></span>
<span id="cb54-888"><a href="#cb54-888" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(selected_outcome_cols)</span></span>
<span id="cb54-889"><a href="#cb54-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-890"><a href="#cb54-890" aria-hidden="true" tabindex="-1"></a>table_outcomes <span class="ot">&lt;-</span> selected_outcome_cols <span class="sc">%&gt;%</span></span>
<span id="cb54-891"><a href="#cb54-891" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>(<span class="at">case =</span> <span class="st">"title"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-892"><a href="#cb54-892" aria-hidden="true" tabindex="-1"></a>  labelled<span class="sc">::</span><span class="fu">to_factor</span>() <span class="sc">%&gt;%</span>  <span class="co"># ensure consistent use of pipe operator</span></span>
<span id="cb54-893"><a href="#cb54-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb54-894"><a href="#cb54-894" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"Wave"</span>,  <span class="co">#specify the grouping variable. Adjust "Wave" to match the cleaned column name</span></span>
<span id="cb54-895"><a href="#cb54-895" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing =</span> <span class="st">"always"</span>, </span>
<span id="cb54-896"><a href="#cb54-896" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> <span class="st">"column"</span>,</span>
<span id="cb54-897"><a href="#cb54-897" aria-hidden="true" tabindex="-1"></a>    <span class="co"># statistic = list(all_continuous() ~ "{mean} ({sd})")  # Uncomment and adjust if needed for continuous variables</span></span>
<span id="cb54-898"><a href="#cb54-898" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb54-899"><a href="#cb54-899" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  add_n() %&gt;%  # Add column with total number of non-missing observations</span></span>
<span id="cb54-900"><a href="#cb54-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_header</span>(<span class="at">label =</span> <span class="st">"**Outcome Variables by Wave**"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Update the column header</span></span>
<span id="cb54-901"><a href="#cb54-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>()</span>
<span id="cb54-902"><a href="#cb54-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-903"><a href="#cb54-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-904"><a href="#cb54-904" aria-hidden="true" tabindex="-1"></a><span class="co"># save</span></span>
<span id="cb54-905"><a href="#cb54-905" aria-hidden="true" tabindex="-1"></a>margot<span class="sc">::</span><span class="fu">here_save</span>(table_outcomes, <span class="st">"table_outcomes"</span>)</span>
<span id="cb54-906"><a href="#cb54-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-907"><a href="#cb54-907" aria-hidden="true" tabindex="-1"></a><span class="co"># read if needed</span></span>
<span id="cb54-908"><a href="#cb54-908" aria-hidden="true" tabindex="-1"></a>table_outcomes <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">here_read</span>(<span class="st">"table_outcomes"</span>)</span>
<span id="cb54-909"><a href="#cb54-909" aria-hidden="true" tabindex="-1"></a>table_outcomes</span>
<span id="cb54-910"><a href="#cb54-910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-911"><a href="#cb54-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-912"><a href="#cb54-912" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inspect the distribution of the exposure in treatment wave</span></span>
<span id="cb54-913"><a href="#cb54-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-916"><a href="#cb54-916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-917"><a href="#cb54-917" aria-hidden="true" tabindex="-1"></a><span class="co"># select 2019 wave</span></span>
<span id="cb54-918"><a href="#cb54-918" aria-hidden="true" tabindex="-1"></a>dt_19 <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2019</span>)</span>
<span id="cb54-919"><a href="#cb54-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-920"><a href="#cb54-920" aria-hidden="true" tabindex="-1"></a><span class="co"># mean</span></span>
<span id="cb54-921"><a href="#cb54-921" aria-hidden="true" tabindex="-1"></a>mean_exposure <span class="ot">&lt;-</span><span class="fu">mean</span>(dt_19<span class="sc">$</span>perfectionism, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb54-922"><a href="#cb54-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-923"><a href="#cb54-923" aria-hidden="true" tabindex="-1"></a><span class="co"># median</span></span>
<span id="cb54-924"><a href="#cb54-924" aria-hidden="true" tabindex="-1"></a>median_exposure <span class="ot">&lt;-</span><span class="fu">median</span>(dt_19<span class="sc">$</span>perfectionism, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb54-925"><a href="#cb54-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-926"><a href="#cb54-926" aria-hidden="true" tabindex="-1"></a><span class="co"># check if you like</span></span>
<span id="cb54-927"><a href="#cb54-927" aria-hidden="true" tabindex="-1"></a><span class="co"># median_exposure</span></span>
<span id="cb54-928"><a href="#cb54-928" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_exposure</span></span>
<span id="cb54-929"><a href="#cb54-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-930"><a href="#cb54-930" aria-hidden="true" tabindex="-1"></a><span class="co"># # generate bar plot</span></span>
<span id="cb54-931"><a href="#cb54-931" aria-hidden="true" tabindex="-1"></a>graph_density_of_exposure_up <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">coloured_histogram_shift</span>(</span>
<span id="cb54-932"><a href="#cb54-932" aria-hidden="true" tabindex="-1"></a>  dt_19,</span>
<span id="cb54-933"><a href="#cb54-933" aria-hidden="true" tabindex="-1"></a>  <span class="at">shift =</span> <span class="st">"up"</span>,</span>
<span id="cb54-934"><a href="#cb54-934" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_name =</span> <span class="st">"perfectionism"</span>,</span>
<span id="cb54-935"><a href="#cb54-935" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> .<span class="dv">25</span>, </span>
<span id="cb54-936"><a href="#cb54-936" aria-hidden="true" tabindex="-1"></a>  <span class="at">range_highlight =</span> <span class="fu">c</span>(<span class="dv">0</span>,mean_exposure)</span>
<span id="cb54-937"><a href="#cb54-937" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-938"><a href="#cb54-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-939"><a href="#cb54-939" aria-hidden="true" tabindex="-1"></a><span class="co"># show</span></span>
<span id="cb54-940"><a href="#cb54-940" aria-hidden="true" tabindex="-1"></a>graph_density_of_exposure_up</span>
<span id="cb54-941"><a href="#cb54-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-942"><a href="#cb54-942" aria-hidden="true" tabindex="-1"></a><span class="co"># save</span></span>
<span id="cb54-943"><a href="#cb54-943" aria-hidden="true" tabindex="-1"></a><span class="co">#margot::here_save(graph_density_of_exposure_up, "graph_density_of_exposure_up")</span></span>
<span id="cb54-944"><a href="#cb54-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-945"><a href="#cb54-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-946"><a href="#cb54-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-947"><a href="#cb54-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-948"><a href="#cb54-948" aria-hidden="true" tabindex="-1"></a><span class="fu">### Another Graph: Shift Interventions Up</span></span>
<span id="cb54-949"><a href="#cb54-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-952"><a href="#cb54-952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-953"><a href="#cb54-953" aria-hidden="true" tabindex="-1"></a>margot<span class="sc">::</span><span class="fu">coloured_histogram</span>(</span>
<span id="cb54-954"><a href="#cb54-954" aria-hidden="true" tabindex="-1"></a>  dt_19,</span>
<span id="cb54-955"><a href="#cb54-955" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_name =</span> <span class="st">"perfectionism"</span>,</span>
<span id="cb54-956"><a href="#cb54-956" aria-hidden="true" tabindex="-1"></a>  <span class="at">binwidth =</span> .<span class="dv">25</span>,</span>
<span id="cb54-957"><a href="#cb54-957" aria-hidden="true" tabindex="-1"></a>  <span class="at">unit_of_change =</span> <span class="dv">1</span>,</span>
<span id="cb54-958"><a href="#cb54-958" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale_min =</span> <span class="dv">1</span>,</span>
<span id="cb54-959"><a href="#cb54-959" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale_max =</span> <span class="dv">7</span>,</span>
<span id="cb54-960"><a href="#cb54-960" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight_range =</span> <span class="st">"both"</span></span>
<span id="cb54-961"><a href="#cb54-961" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-962"><a href="#cb54-962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-963"><a href="#cb54-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-964"><a href="#cb54-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-965"><a href="#cb54-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-966"><a href="#cb54-966" aria-hidden="true" tabindex="-1"></a><span class="fu">### Check for change in the treatment (Positivity )</span></span>
<span id="cb54-967"><a href="#cb54-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-970"><a href="#cb54-970" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-971"><a href="#cb54-971" aria-hidden="true" tabindex="-1"></a><span class="co">#  select data from wave 18 and 19 </span></span>
<span id="cb54-972"><a href="#cb54-972" aria-hidden="true" tabindex="-1"></a>dt_18_19_positivity <span class="ot">&lt;-</span> dat_long <span class="sc">|&gt;</span></span>
<span id="cb54-973"><a href="#cb54-973" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span> <span class="sc">|</span> wave <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-974"><a href="#cb54-974" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perfectionism_round =</span> <span class="fu">round</span>(perfectionism, <span class="at">digits =</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb54-975"><a href="#cb54-975" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(perfectionism_round, id, wave) <span class="sc">|&gt;</span></span>
<span id="cb54-976"><a href="#cb54-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>()</span>
<span id="cb54-977"><a href="#cb54-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-978"><a href="#cb54-978" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span>margot<span class="sc">::</span><span class="fu">create_transition_matrix</span>(<span class="at">data =</span> dt_18_19_positivity, <span class="at">state_var =</span> <span class="st">"perfectionism_round"</span>, <span class="at">id_var =</span> <span class="st">"id"</span>)</span>
<span id="cb54-979"><a href="#cb54-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-980"><a href="#cb54-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-981"><a href="#cb54-981" aria-hidden="true" tabindex="-1"></a><span class="co"># t_tab_2_labels &lt;- c("&lt; weekly", "&gt;= weekly")</span></span>
<span id="cb54-982"><a href="#cb54-982" aria-hidden="true" tabindex="-1"></a><span class="co"># transition table</span></span>
<span id="cb54-983"><a href="#cb54-983" aria-hidden="true" tabindex="-1"></a>transition_table  <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">transition_table</span>(out)</span>
<span id="cb54-984"><a href="#cb54-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-985"><a href="#cb54-985" aria-hidden="true" tabindex="-1"></a><span class="co"># for import later</span></span>
<span id="cb54-986"><a href="#cb54-986" aria-hidden="true" tabindex="-1"></a><span class="co"># margot::here_save(transition_table, "transition_table")</span></span>
<span id="cb54-987"><a href="#cb54-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-988"><a href="#cb54-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-989"><a href="#cb54-989" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(transition_table<span class="sc">$</span>table)</span>
<span id="cb54-990"><a href="#cb54-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-991"><a href="#cb54-991" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-992"><a href="#cb54-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-993"><a href="#cb54-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-994"><a href="#cb54-994" aria-hidden="true" tabindex="-1"></a><span class="fu">### Explanation for the table</span></span>
<span id="cb54-995"><a href="#cb54-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-998"><a href="#cb54-998" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-999"><a href="#cb54-999" aria-hidden="true" tabindex="-1"></a>transition_table<span class="sc">$</span>explanation</span>
<span id="cb54-1000"><a href="#cb54-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1001"><a href="#cb54-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1002"><a href="#cb54-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1003"><a href="#cb54-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1004"><a href="#cb54-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab Part 2: Simulation to Clarify Why The Distribution of Effect Modifiers Matter For Estimating Treatment Effects </span></span>
<span id="cb54-1005"><a href="#cb54-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1006"><a href="#cb54-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1007"><a href="#cb54-1007" aria-hidden="true" tabindex="-1"></a>First, we load the <span class="in">`stdReg`</span> library, which obtains marginal effect estimates by simulating counterfactuals under different levels of treatment <span class="co">[</span><span class="ot">@sjölander2016</span><span class="co">]</span>. If a treatment is continuous, the levels can be specified. </span>
<span id="cb54-1008"><a href="#cb54-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1009"><a href="#cb54-1009" aria-hidden="true" tabindex="-1"></a>We also load the <span class="in">`parameters`</span> library, which creates nice tables <span class="co">[</span><span class="ot">@parameters2020</span><span class="co">]</span>.</span>
<span id="cb54-1010"><a href="#cb54-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1011"><a href="#cb54-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1014"><a href="#cb54-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1015"><a href="#cb54-1015" aria-hidden="true" tabindex="-1"></a><span class="co"># to obtain marginal effects</span></span>
<span id="cb54-1016"><a href="#cb54-1016" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stdReg)</span>
<span id="cb54-1017"><a href="#cb54-1017" aria-hidden="true" tabindex="-1"></a><span class="co"># to create nice tables</span></span>
<span id="cb54-1018"><a href="#cb54-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb54-1019"><a href="#cb54-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1020"><a href="#cb54-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1021"><a href="#cb54-1021" aria-hidden="true" tabindex="-1"></a>Next, we write a function to simulate data for the sample and and target populations. </span>
<span id="cb54-1022"><a href="#cb54-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1023"><a href="#cb54-1023" aria-hidden="true" tabindex="-1"></a>We assume the treatment effect is the same in the sample and target population. We will assume that the coefficient for the effect-modifier and the coefficient for interaction are the same.  We assume no unmeasured confounding throughout the study.  We assume only selective attrition of one effect modifier such that the baseline population differs from the sample population at the end of the study.   </span>
<span id="cb54-1024"><a href="#cb54-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1025"><a href="#cb54-1025" aria-hidden="true" tabindex="-1"></a>That is: **the distribution of effect modifiers is the only respect in which the sample will differ from the target population.**</span>
<span id="cb54-1026"><a href="#cb54-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1027"><a href="#cb54-1027" aria-hidden="true" tabindex="-1"></a>This function will generate data under a range of scenarios.<span class="ot">[^margot]</span></span>
<span id="cb54-1028"><a href="#cb54-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1029"><a href="#cb54-1029" aria-hidden="true" tabindex="-1"></a><span class="ot">[^margot]: </span>See documentation in the <span class="in">`margot`</span> package: @margot2024</span>
<span id="cb54-1030"><a href="#cb54-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1031"><a href="#cb54-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1032"><a href="#cb54-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1035"><a href="#cb54-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1036"><a href="#cb54-1036" aria-hidden="true" tabindex="-1"></a><span class="co"># function to generate data for the sample and population, </span></span>
<span id="cb54-1037"><a href="#cb54-1037" aria-hidden="true" tabindex="-1"></a><span class="co"># along with precise sample weights for the population, there are differences </span></span>
<span id="cb54-1038"><a href="#cb54-1038" aria-hidden="true" tabindex="-1"></a><span class="co"># in the distribution of the true effect modifier but no differences in the treatment effect </span></span>
<span id="cb54-1039"><a href="#cb54-1039" aria-hidden="true" tabindex="-1"></a><span class="co"># or the effect modification.all that differs between the sample and the population is </span></span>
<span id="cb54-1040"><a href="#cb54-1040" aria-hidden="true" tabindex="-1"></a><span class="co"># the distribution of effect-modifiers.</span></span>
<span id="cb54-1041"><a href="#cb54-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1042"><a href="#cb54-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1043"><a href="#cb54-1043" aria-hidden="true" tabindex="-1"></a><span class="co"># reproducability</span></span>
<span id="cb54-1044"><a href="#cb54-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb54-1045"><a href="#cb54-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1046"><a href="#cb54-1046" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate the data -- you can use different parameters</span></span>
<span id="cb54-1047"><a href="#cb54-1047" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> margot<span class="sc">::</span><span class="fu">simulate_ate_data_with_weights</span>(</span>
<span id="cb54-1048"><a href="#cb54-1048" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_sample =</span> <span class="dv">10000</span>,</span>
<span id="cb54-1049"><a href="#cb54-1049" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_population =</span> <span class="dv">100000</span>,</span>
<span id="cb54-1050"><a href="#cb54-1050" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_z_sample =</span> <span class="fl">0.1</span>,</span>
<span id="cb54-1051"><a href="#cb54-1051" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_z_population =</span> <span class="fl">0.5</span>,</span>
<span id="cb54-1052"><a href="#cb54-1052" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_a =</span> <span class="dv">1</span>,</span>
<span id="cb54-1053"><a href="#cb54-1053" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_z =</span> <span class="fl">2.5</span>,</span>
<span id="cb54-1054"><a href="#cb54-1054" aria-hidden="true" tabindex="-1"></a>  <span class="at">noise_sd =</span> <span class="fl">0.5</span></span>
<span id="cb54-1055"><a href="#cb54-1055" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-1056"><a href="#cb54-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1057"><a href="#cb54-1057" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(data)</span>
<span id="cb54-1058"><a href="#cb54-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1059"><a href="#cb54-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1060"><a href="#cb54-1060" aria-hidden="true" tabindex="-1"></a>Ok, we have generated both sample and population data. </span>
<span id="cb54-1061"><a href="#cb54-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1062"><a href="#cb54-1062" aria-hidden="true" tabindex="-1"></a>Next, we verify that the distributions of effect modifiers differ in the sample and in the target population:</span>
<span id="cb54-1063"><a href="#cb54-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1066"><a href="#cb54-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1067"><a href="#cb54-1067" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain the generated data</span></span>
<span id="cb54-1068"><a href="#cb54-1068" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> data<span class="sc">$</span>sample_data</span>
<span id="cb54-1069"><a href="#cb54-1069" aria-hidden="true" tabindex="-1"></a>population_data <span class="ot">&lt;-</span> data<span class="sc">$</span>population_data</span>
<span id="cb54-1070"><a href="#cb54-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1071"><a href="#cb54-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1072"><a href="#cb54-1072" aria-hidden="true" tabindex="-1"></a><span class="co"># check imbalance</span></span>
<span id="cb54-1073"><a href="#cb54-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sample_data<span class="sc">$</span>z_sample) <span class="co"># type 1 is rare</span></span>
<span id="cb54-1074"><a href="#cb54-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(population_data<span class="sc">$</span>z_population) <span class="co"># type 1 is common</span></span>
<span id="cb54-1075"><a href="#cb54-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1076"><a href="#cb54-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1077"><a href="#cb54-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1078"><a href="#cb54-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1079"><a href="#cb54-1079" aria-hidden="true" tabindex="-1"></a>Good, the distributions differ. The simulation is working as intended.</span>
<span id="cb54-1080"><a href="#cb54-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1081"><a href="#cb54-1081" aria-hidden="true" tabindex="-1"></a>Next, consider the question: "What are the differences in the coefficients that we obtain from the study population at the end of study, as compared with the target population?"  </span>
<span id="cb54-1082"><a href="#cb54-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1083"><a href="#cb54-1083" aria-hidden="true" tabindex="-1"></a>First, we obtain the coefficients for the sample. They are as follows:</span>
<span id="cb54-1084"><a href="#cb54-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1085"><a href="#cb54-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1088"><a href="#cb54-1088" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1089"><a href="#cb54-1089" aria-hidden="true" tabindex="-1"></a><span class="co"># model coefficients sample</span></span>
<span id="cb54-1090"><a href="#cb54-1090" aria-hidden="true" tabindex="-1"></a>model_sample  <span class="ot">&lt;-</span></span>
<span id="cb54-1091"><a href="#cb54-1091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(y_sample <span class="sc">~</span> a_sample <span class="sc">*</span> z_sample, <span class="at">data =</span> sample_data)</span>
<span id="cb54-1092"><a href="#cb54-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1093"><a href="#cb54-1093" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb54-1094"><a href="#cb54-1094" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(model_sample, <span class="at">ci_method =</span> <span class="st">"wald"</span>)</span>
<span id="cb54-1095"><a href="#cb54-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1096"><a href="#cb54-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1097"><a href="#cb54-1097" aria-hidden="true" tabindex="-1"></a>Ok, let's obtain the coefficients for the weighted regression of the sample.   Notice that the coefficients are virtually the same:</span>
<span id="cb54-1098"><a href="#cb54-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1101"><a href="#cb54-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1102"><a href="#cb54-1102" aria-hidden="true" tabindex="-1"></a><span class="co"># model the sample weighted to the population, again note that these coefficients are similar </span></span>
<span id="cb54-1103"><a href="#cb54-1103" aria-hidden="true" tabindex="-1"></a>model_weighted_sample <span class="ot">&lt;-</span></span>
<span id="cb54-1104"><a href="#cb54-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(y_sample <span class="sc">~</span>  a_sample  <span class="sc">*</span> z_sample,</span>
<span id="cb54-1105"><a href="#cb54-1105" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> sample_data,</span>
<span id="cb54-1106"><a href="#cb54-1106" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> weights)</span>
<span id="cb54-1107"><a href="#cb54-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1108"><a href="#cb54-1108" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb54-1109"><a href="#cb54-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(parameters<span class="sc">::</span><span class="fu">model_parameters</span>(model_weighted_sample, <span class="at">ci_method =</span></span>
<span id="cb54-1110"><a href="#cb54-1110" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"wald"</span>))</span>
<span id="cb54-1111"><a href="#cb54-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1112"><a href="#cb54-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1113"><a href="#cb54-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1114"><a href="#cb54-1114" aria-hidden="true" tabindex="-1"></a>We might be tempted to infer that weighting wasn't relevant to the analysis. However, we'll see that such an interpretation would be a mistake.</span>
<span id="cb54-1115"><a href="#cb54-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1116"><a href="#cb54-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1117"><a href="#cb54-1117" aria-hidden="true" tabindex="-1"></a>Next, let us obtain model coefficients for the population. Note again there is no difference -- only narrower errors owing to the large sample size. </span>
<span id="cb54-1118"><a href="#cb54-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1119"><a href="#cb54-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1122"><a href="#cb54-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1123"><a href="#cb54-1123" aria-hidden="true" tabindex="-1"></a><span class="co"># model coefficients population -- note that these coefficients are very similar. </span></span>
<span id="cb54-1124"><a href="#cb54-1124" aria-hidden="true" tabindex="-1"></a>model_population <span class="ot">&lt;-</span></span>
<span id="cb54-1125"><a href="#cb54-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(y_population <span class="sc">~</span> a_population <span class="sc">*</span> z_population, <span class="at">data =</span> population_data)</span>
<span id="cb54-1126"><a href="#cb54-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1127"><a href="#cb54-1127" aria-hidden="true" tabindex="-1"></a>parameters<span class="sc">::</span><span class="fu">model_parameters</span>(model_population, <span class="at">ci_method =</span> <span class="st">"wald"</span>)</span>
<span id="cb54-1128"><a href="#cb54-1128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1129"><a href="#cb54-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1130"><a href="#cb54-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1131"><a href="#cb54-1131" aria-hidden="true" tabindex="-1"></a>Again, there is no difference. That is, we find that all model coefficients are practically equivalent. The different distribution of effect modifiers does not result in different coefficient values for the treatment effect, the effect-modifier "effect," or the interaction of effect modifier and treatment. </span>
<span id="cb54-1132"><a href="#cb54-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1133"><a href="#cb54-1133" aria-hidden="true" tabindex="-1"></a>Consider why this is the case: in a large sample where the causal effects are invariant -- as we have simulated them to be -- we will have good replication in the effect modifiers within the sample, so our statistical model can recover the *coefficients* for the population -- no problem. </span>
<span id="cb54-1134"><a href="#cb54-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1135"><a href="#cb54-1135" aria-hidden="true" tabindex="-1"></a>However, **in causal inference, we are interested in obtaining the marginal effect of the treatment**. That is, we seek an estimate for the counterfactual contrast in which everyone in a pre-specified population was subject to one level of treatment compared with a counterfactual condition in which everyone in a population was subject to another level of the same treatment. **When the sample population differs in the distribution of effect modifiers from the target population effect, the marginal effect estimates will typically differ.**</span>
<span id="cb54-1136"><a href="#cb54-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1137"><a href="#cb54-1137" aria-hidden="true" tabindex="-1"></a>To see this, we use the <span class="in">`stdReg`</span> package to recover marginal effect estimates, comparing (1) the sample ATE, (2) the true oracle ATE for the population, and (3) the weighted sample ATE.  We will use the outputs of the same models above. The only difference is that we will calculate marginal effects from these outputs. We will contrast a difference from an intervention in which everyone receives treatment = 0 with one in which everyone receives treatment = 1, however, this choice is arbitrary, and the general lessons apply irrespective of the estimand.</span>
<span id="cb54-1138"><a href="#cb54-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1139"><a href="#cb54-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1140"><a href="#cb54-1140" aria-hidden="true" tabindex="-1"></a>First, consider this ATE for the sample population. </span>
<span id="cb54-1141"><a href="#cb54-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1142"><a href="#cb54-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1143"><a href="#cb54-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1146"><a href="#cb54-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1147"><a href="#cb54-1147" aria-hidden="true" tabindex="-1"></a><span class="co"># What inference do we draw?  We cannot say the models are unbiased for the marginal effect estimates. </span></span>
<span id="cb54-1148"><a href="#cb54-1148" aria-hidden="true" tabindex="-1"></a><span class="co"># regression standardisation </span></span>
<span id="cb54-1149"><a href="#cb54-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stdReg) <span class="co"># to obtain marginal effects </span></span>
<span id="cb54-1150"><a href="#cb54-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1151"><a href="#cb54-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1152"><a href="#cb54-1152" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain sample ate</span></span>
<span id="cb54-1153"><a href="#cb54-1153" aria-hidden="true" tabindex="-1"></a>fit_std_sample <span class="ot">&lt;-</span></span>
<span id="cb54-1154"><a href="#cb54-1154" aria-hidden="true" tabindex="-1"></a>  stdReg<span class="sc">::</span><span class="fu">stdGlm</span>(model_sample, <span class="at">data =</span> sample_data, <span class="at">X =</span> <span class="st">"a_sample"</span>)</span>
<span id="cb54-1155"><a href="#cb54-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1156"><a href="#cb54-1156" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb54-1157"><a href="#cb54-1157" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_std_sample,</span>
<span id="cb54-1158"><a href="#cb54-1158" aria-hidden="true" tabindex="-1"></a>        <span class="at">contrast =</span> <span class="st">"difference"</span>,</span>
<span id="cb54-1159"><a href="#cb54-1159" aria-hidden="true" tabindex="-1"></a>        <span class="at">reference =</span> <span class="dv">0</span>)</span>
<span id="cb54-1160"><a href="#cb54-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1161"><a href="#cb54-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1162"><a href="#cb54-1162" aria-hidden="true" tabindex="-1"></a>The treatment effect is given as a 1.06 unit change in the outcome across the sample population, with a confidence interval from 1.04 to 1.08. </span>
<span id="cb54-1163"><a href="#cb54-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1164"><a href="#cb54-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1165"><a href="#cb54-1165" aria-hidden="true" tabindex="-1"></a>Next, we obtain the true (oracle) treatment effect for the population under the same intervention.</span>
<span id="cb54-1166"><a href="#cb54-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1167"><a href="#cb54-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1170"><a href="#cb54-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1171"><a href="#cb54-1171" aria-hidden="true" tabindex="-1"></a><span class="do">## note the population effect is different</span></span>
<span id="cb54-1172"><a href="#cb54-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1173"><a href="#cb54-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#obtain true ate</span></span>
<span id="cb54-1174"><a href="#cb54-1174" aria-hidden="true" tabindex="-1"></a>fit_std_population <span class="ot">&lt;-</span></span>
<span id="cb54-1175"><a href="#cb54-1175" aria-hidden="true" tabindex="-1"></a>  stdReg<span class="sc">::</span><span class="fu">stdGlm</span>(model_population, <span class="at">data =</span> population_data, <span class="at">X =</span> <span class="st">"a_population"</span>)</span>
<span id="cb54-1176"><a href="#cb54-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1177"><a href="#cb54-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb54-1178"><a href="#cb54-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_std_population,</span>
<span id="cb54-1179"><a href="#cb54-1179" aria-hidden="true" tabindex="-1"></a>        <span class="at">contrast =</span> <span class="st">"difference"</span>,</span>
<span id="cb54-1180"><a href="#cb54-1180" aria-hidden="true" tabindex="-1"></a>        <span class="at">reference =</span> <span class="dv">0</span>)</span>
<span id="cb54-1181"><a href="#cb54-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1182"><a href="#cb54-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1183"><a href="#cb54-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1184"><a href="#cb54-1184" aria-hidden="true" tabindex="-1"></a>Note, the true treatment effect is a 1.25 unit change in the population, with a confidence bound between 1.24 and 1.26. This is well outside the ATE that we obtain from the sample population!</span>
<span id="cb54-1185"><a href="#cb54-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1186"><a href="#cb54-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1187"><a href="#cb54-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1188"><a href="#cb54-1188" aria-hidden="true" tabindex="-1"></a>Next, consider the ATE in the weighted regression, where the sample was weighted to the target population's true distribution of effect modifiers. </span>
<span id="cb54-1189"><a href="#cb54-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1190"><a href="#cb54-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1193"><a href="#cb54-1193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1194"><a href="#cb54-1194" aria-hidden="true" tabindex="-1"></a><span class="do">## next try weights adjusted ate where we correctly assign population weights to the sample</span></span>
<span id="cb54-1195"><a href="#cb54-1195" aria-hidden="true" tabindex="-1"></a>fit_std_weighted_sample_weights <span class="ot">&lt;-</span> stdReg<span class="sc">::</span><span class="fu">stdGlm</span>( model_weighted_sample, </span>
<span id="cb54-1196"><a href="#cb54-1196" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> sample_data, </span>
<span id="cb54-1197"><a href="#cb54-1197" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> <span class="st">"a_sample"</span>)</span>
<span id="cb54-1198"><a href="#cb54-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1199"><a href="#cb54-1199" aria-hidden="true" tabindex="-1"></a><span class="co"># this gives us the right answer</span></span>
<span id="cb54-1200"><a href="#cb54-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_std_weighted_sample_weights, </span>
<span id="cb54-1201"><a href="#cb54-1201" aria-hidden="true" tabindex="-1"></a>    <span class="at">contrast =</span> <span class="st">"difference"</span>, </span>
<span id="cb54-1202"><a href="#cb54-1202" aria-hidden="true" tabindex="-1"></a>    <span class="at">reference =</span> <span class="dv">0</span>)</span>
<span id="cb54-1203"><a href="#cb54-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1204"><a href="#cb54-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1205"><a href="#cb54-1205" aria-hidden="true" tabindex="-1"></a><span class="co"># Moral of the story. When we marginalise over the entire sample we need to weight estimates to the target population. </span></span>
<span id="cb54-1206"><a href="#cb54-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1207"><a href="#cb54-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1208"><a href="#cb54-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1209"><a href="#cb54-1209" aria-hidden="true" tabindex="-1"></a>We find that we obtain the population-level causal effect estimate with accurate coverage by weighting the sample to the target population. So with appropriate weights, our results generalise from the sample to the target population.</span>
<span id="cb54-1210"><a href="#cb54-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1211"><a href="#cb54-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1212"><a href="#cb54-1212" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lessons from Lab 2</span></span>
<span id="cb54-1213"><a href="#cb54-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1214"><a href="#cb54-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Regression coefficients do not clarify the problem of sample/target population mismatch -- or selection bias as discussed in this manuscript.</span>
<span id="cb54-1215"><a href="#cb54-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The correct advice to investigators is that they should not rely on regression coefficients when evaluating the biases that arise from sample attrition. This advice applies to both methods that the authors use to investigate threats of bias. That is, to implement this advice, the authors must first take it.</span>
<span id="cb54-1216"><a href="#cb54-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generally, observed data are insufficient for assessing threats. Observed data do not clarify structural sources of bias, nor do they clarify effect-modification in the full counterfactual data condition in which all receive the treatment and all do not receive the treatment (at the same level).</span>
<span id="cb54-1217"><a href="#cb54-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>To properly assess bias, one would need access to the counterfactual outcome—what would have happened to the missing participants had they not been lost to follow-up or had they responded. Again, the join distributions over "full data" are inherently unobservable <span class="co">[</span><span class="ot">@vanderlaan2011</span><span class="co">]</span>. </span>
<span id="cb54-1218"><a href="#cb54-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In simple settings like the one we just simulated, we may address the gap between the sample and target population using methods such as modelling the censoring (e.g., censoring weighting). However, we never know what setting we are in or whether it is simple—such modelling must be handled with care. There is a large and growing epidemiology literature on this topic (see, for example, @li2023non).</span>
<span id="cb54-1219"><a href="#cb54-1219" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- - Matters become more complex when there is confounding and selection bias because the problem is not merely one of external validity but also internal validity (i.e. obtaining valid causal effect estimates for the baseline sample). See for example @scharfstein1999adjusting; @laan2003unified; @howe2016selection (note that @howe2016selection, "selection" bias is defined as collider stratification bias, a variety of confounding bias and not simple sample and target population mismatch.)   --&gt;</span></span>
<span id="cb54-1220"><a href="#cb54-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1221"><a href="#cb54-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1222"><a href="#cb54-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1223"><a href="#cb54-1223" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix A </span></span>
<span id="cb54-1224"><a href="#cb54-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1225"><a href="#cb54-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1226"><a href="#cb54-1226" aria-hidden="true" tabindex="-1"></a><span class="fu">### Evidence for effect-modification is relative to inclusion of other variables in the model</span></span>
<span id="cb54-1227"><a href="#cb54-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1228"><a href="#cb54-1228" aria-hidden="true" tabindex="-1"></a>The 'sharp-null hypothesis' states there is no effect of the exposure on</span>
<span id="cb54-1229"><a href="#cb54-1229" aria-hidden="true" tabindex="-1"></a>the outcome for any unit in the target population. Unless the 'sharp-null hypothesis' is false, there may be effect-modification. For any study worth conducting, we cannot evaluate whether the sharp-null hypothesis is false. If we could the experiment would be otiose. Therefore, we must assume the possibility of effect-modification. Notably, whether a variable is an effect-modifier also depends on which other variables are included in the model. That is, just as for the concept of a 'confounder', where a variable is an 'effect-modifier' cannot be stated without reference to an assumed causal order and an explicit statement about which other variables will be included in the model <span class="co">[</span><span class="ot">@vanderweele2012</span><span class="co">]</span>.</span>
<span id="cb54-1230"><a href="#cb54-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1231"><a href="#cb54-1231" aria-hidden="true" tabindex="-1"></a>As illustrated in  @fig-eff-mod-rel, the marginal association between $A$ and $Y$ is unbiased. Here, exposure $A$ is unconditionally associated with $Y$. Recall our convention <span class="dt">&lt;</span><span class="kw">svg</span><span class="ot"> width</span><span class="op">=</span><span class="st">"40px"</span><span class="ot"> height</span><span class="op">=</span><span class="st">"40px"</span><span class="dt">&gt;&lt;</span><span class="kw">circle</span><span class="ot"> cx</span><span class="op">=</span><span class="st">"20"</span><span class="ot"> cy</span><span class="op">=</span><span class="st">"20"</span><span class="ot"> r</span><span class="op">=</span><span class="st">"18"</span><span class="ot"> fill</span><span class="op">=</span><span class="st">"none"</span><span class="ot"> stroke</span><span class="op">=</span><span class="st">"blue"</span><span class="ot"> stroke-width</span><span class="op">=</span><span class="st">"2"</span><span class="dt">/&gt;&lt;</span><span class="kw">text</span><span class="ot"> x</span><span class="op">=</span><span class="st">"20"</span><span class="ot"> y</span><span class="op">=</span><span class="st">"20"</span><span class="ot"> alignment-baseline</span><span class="op">=</span><span class="st">"middle"</span><span class="ot"> text-anchor</span><span class="op">=</span><span class="st">"middle"</span><span class="ot"> fill</span><span class="op">=</span><span class="st">"blue"</span><span class="ot"> font-size</span><span class="op">=</span><span class="st">"16"</span><span class="dt">&gt;</span>G<span class="dt">&lt;/</span><span class="kw">text</span><span class="dt">&gt;&lt;/</span><span class="kw">svg</span><span class="dt">&gt;</span> denotes effect-modification with conditioning and <span class="dt">&lt;</span><span class="kw">svg</span><span class="ot"> width</span><span class="op">=</span><span class="st">"40px"</span><span class="ot"> height</span><span class="op">=</span><span class="st">"40px"</span><span class="dt">&gt;&lt;</span><span class="kw">circle</span><span class="ot"> cx</span><span class="op">=</span><span class="st">"20"</span><span class="ot"> cy</span><span class="op">=</span><span class="st">"20"</span><span class="ot"> r</span><span class="op">=</span><span class="st">"18"</span><span class="ot"> fill</span><span class="op">=</span><span class="st">"none"</span><span class="ot"> stroke</span><span class="op">=</span><span class="st">"blue"</span><span class="ot"> stroke-width</span><span class="op">=</span><span class="st">"2"</span><span class="ot"> stroke-dasharray</span><span class="op">=</span><span class="st">"4,4"</span><span class="dt">/&gt;&lt;</span><span class="kw">text</span><span class="ot"> x</span><span class="op">=</span><span class="st">"20"</span><span class="ot"> y</span><span class="op">=</span><span class="st">"20"</span><span class="ot"> alignment-baseline</span><span class="op">=</span><span class="st">"middle"</span><span class="ot"> text-anchor</span><span class="op">=</span><span class="st">"middle"</span><span class="ot"> fill</span><span class="op">=</span><span class="st">"blue"</span><span class="ot"> font-size</span><span class="op">=</span><span class="st">"16"</span><span class="dt">&gt;</span>Z<span class="dt">&lt;/</span><span class="kw">text</span><span class="dt">&gt;&lt;/</span><span class="kw">svg</span><span class="dt">&gt;</span> indicates effect-modification without conditioning.</span>
<span id="cb54-1232"><a href="#cb54-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1235"><a href="#cb54-1235" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb54-1236"><a href="#cb54-1236" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-eff-mod-rel</span></span>
<span id="cb54-1237"><a href="#cb54-1237" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Consider a randomised experiment. There is no confounding. Here, the marginal association between A and Y provides an unbiased estimate for the causal effect of A on Y. Does the conditional association of A on Y vary within levels of G? The causal diagram allows for a classification of G as an effect modifier of A on Y by proxy. G modifies A's effect on Y in virtue of G's relationship to Z, which, according to this graph, is a direct effect modifier for the effect of A on Y."</span></span>
<span id="cb54-1238"><a href="#cb54-1238" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb54-1239"><a href="#cb54-1239" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb54-1240"><a href="#cb54-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1241"><a href="#cb54-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1242"><a href="#cb54-1242" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb54-1243"><a href="#cb54-1243" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb54-1244"><a href="#cb54-1244" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb54-1245"><a href="#cb54-1245" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb54-1246"><a href="#cb54-1246" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb54-1247"><a href="#cb54-1247" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb54-1248"><a href="#cb54-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1249"><a href="#cb54-1249" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning, shapes.geometric, arrows.meta, decorations.pathmorphing}</span></span>
<span id="cb54-1250"><a href="#cb54-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1251"><a href="#cb54-1251" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{</span></span>
<span id="cb54-1252"><a href="#cb54-1252" aria-hidden="true" tabindex="-1"></a><span class="in">  Arrow/.style={-&gt;, &gt;=latex, line width=0.4pt},  % Defines a generic arrow style</span></span>
<span id="cb54-1253"><a href="#cb54-1253" aria-hidden="true" tabindex="-1"></a><span class="in">  emod/.style={rectangle, fill=blue!10, draw=blue, thick, minimum size=6mm},</span></span>
<span id="cb54-1254"><a href="#cb54-1254" aria-hidden="true" tabindex="-1"></a><span class="in">  emoddot/.style={circle, fill=blue!10, draw=blue, dotted, thick, minimum size=6mm}</span></span>
<span id="cb54-1255"><a href="#cb54-1255" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb54-1256"><a href="#cb54-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1257"><a href="#cb54-1257" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw, emod/.style={rectangle, fill=blue!10,draw=blue, thick},</span></span>
<span id="cb54-1258"><a href="#cb54-1258" aria-hidden="true" tabindex="-1"></a><span class="in">emoddot/.style={circle, fill=blue!10, draw=blue, dotted}]</span></span>
<span id="cb54-1259"><a href="#cb54-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1260"><a href="#cb54-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1261"><a href="#cb54-1261" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (0, 0) {A$_{1}$};</span></span>
<span id="cb54-1262"><a href="#cb54-1262" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (2, 0) {Y$_{2}$};</span></span>
<span id="cb54-1263"><a href="#cb54-1263" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emoddot] (Z) at (-3,0) {Z};</span></span>
<span id="cb54-1264"><a href="#cb54-1264" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emod] (G) at (-1, 0) {G};</span></span>
<span id="cb54-1265"><a href="#cb54-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1266"><a href="#cb54-1266" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb54-1267"><a href="#cb54-1267" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[-{Circle[open, fill=none]}, line width=0.25pt, draw=blue, bend left = 40]  (Z) to (Y);</span></span>
<span id="cb54-1268"><a href="#cb54-1268" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw = blue] (Z) to (G);</span></span>
<span id="cb54-1269"><a href="#cb54-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1270"><a href="#cb54-1270" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture} </span></span>
<span id="cb54-1271"><a href="#cb54-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1272"><a href="#cb54-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1273"><a href="#cb54-1273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1274"><a href="#cb54-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1275"><a href="#cb54-1275" aria-hidden="true" tabindex="-1"></a>@fig-dag-effect-modificationb presents the same a randomised experiment as in the previous causal diagram. We again assume that there is no confounding of the marginal association between the exposure, $A$, and the outcome, $Y$. However, suppose we were to adjust for $Z$ and ask, does the conditional association of $A$ on $Y$ vary within levels of $G$, after adjusting for $Z$? That is, does $G$ remain an effect-modifier of the exposure on the outcome? @vanderweele2007 proved that for effect-modification to occur, at least one other arrow besides the treatment must enter into the outcome. According to @fig-dag-effect-modificationb the only arrow into $Y$ other than $A$ arrives from $Z$. Because $Y$ is independent of $G$ conditional on $Z$ we may infer that $G$ is no longer an effect modifier for the effect of $A$ on $Y$. Viewed another way, $G$ no longer co-varies with $Y$</span>
<span id="cb54-1276"><a href="#cb54-1276" aria-hidden="true" tabindex="-1"></a>conditional on $Z$ and so cannot act as an effect-modifier.</span>
<span id="cb54-1277"><a href="#cb54-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1280"><a href="#cb54-1280" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb54-1281"><a href="#cb54-1281" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-effect-modificationb</span></span>
<span id="cb54-1282"><a href="#cb54-1282" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Conditioning on Z renders G independent of Y. G is no longer an effect modifier after conditioning on Z because G is independent of Y. Although Z is an unconditional effect modifier, G is not."</span></span>
<span id="cb54-1283"><a href="#cb54-1283" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb54-1284"><a href="#cb54-1284" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb54-1285"><a href="#cb54-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1286"><a href="#cb54-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1287"><a href="#cb54-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1288"><a href="#cb54-1288" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb54-1289"><a href="#cb54-1289" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb54-1290"><a href="#cb54-1290" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb54-1291"><a href="#cb54-1291" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb54-1292"><a href="#cb54-1292" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb54-1293"><a href="#cb54-1293" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb54-1294"><a href="#cb54-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1295"><a href="#cb54-1295" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning, shapes.geometric, arrows.meta, decorations.pathmorphing}</span></span>
<span id="cb54-1296"><a href="#cb54-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1297"><a href="#cb54-1297" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{</span></span>
<span id="cb54-1298"><a href="#cb54-1298" aria-hidden="true" tabindex="-1"></a><span class="in">  Arrow/.style={-&gt;, &gt;=latex, line width=0.4pt},  % Defines a generic arrow style</span></span>
<span id="cb54-1299"><a href="#cb54-1299" aria-hidden="true" tabindex="-1"></a><span class="in">  emod/.style={rectangle, fill=blue!10, draw=blue, thick, minimum size=6mm},</span></span>
<span id="cb54-1300"><a href="#cb54-1300" aria-hidden="true" tabindex="-1"></a><span class="in">  emoddot/.style={circle, fill=blue!10, draw=blue, dotted, thick, minimum size=6mm}</span></span>
<span id="cb54-1301"><a href="#cb54-1301" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb54-1302"><a href="#cb54-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1303"><a href="#cb54-1303" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw, emod/.style={rectangle, fill=blue!10,draw=blue, thick},</span></span>
<span id="cb54-1304"><a href="#cb54-1304" aria-hidden="true" tabindex="-1"></a><span class="in">squarednode/.style={rectangle, draw=blue!60, fill=red!20, very thick, minimum size=5mm}]</span></span>
<span id="cb54-1305"><a href="#cb54-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1306"><a href="#cb54-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1307"><a href="#cb54-1307" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (0, 0) {A$_{1}$};</span></span>
<span id="cb54-1308"><a href="#cb54-1308" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (2, 0) {Y$_{2}$};</span></span>
<span id="cb54-1309"><a href="#cb54-1309" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emod] (Z) at (-3,0) {Z};</span></span>
<span id="cb54-1310"><a href="#cb54-1310" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (G) at (-1, 0) {G};</span></span>
<span id="cb54-1311"><a href="#cb54-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1312"><a href="#cb54-1312" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb54-1313"><a href="#cb54-1313" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[-{Circle[open, fill=none]}, line width=0.25pt, draw=blue, bend left = 40] (Z) to (Y);</span></span>
<span id="cb54-1314"><a href="#cb54-1314" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw = black] (Z) to (G);</span></span>
<span id="cb54-1315"><a href="#cb54-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1316"><a href="#cb54-1316" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture} </span></span>
<span id="cb54-1317"><a href="#cb54-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1318"><a href="#cb54-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1319"><a href="#cb54-1319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1320"><a href="#cb54-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1321"><a href="#cb54-1321" aria-hidden="true" tabindex="-1"></a>@fig-dag-effect-modificationc presents the same a randomised experiment as in the previous graph. We assume a true effect of $A \rightarrow Y$. If we do not condition on $B$, then $G$ will not modify the effect of $A  \rightarrow Y$ because $G$ will not be associated with $Y$. However, if we were to condition on $B$, then both $B$ (an effect modifier by proxy) and $G$ may become effect-modifiers for the causal effect of $A$ on $Y$. In this setting, both $B$ and $G$ are conditional effect-modifiers.</span>
<span id="cb54-1322"><a href="#cb54-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1323"><a href="#cb54-1323" aria-hidden="true" tabindex="-1"></a>Note that casual graphs help us to evaluate classifications of conditional and unconditional effect modifiers. They may also help to clarify conditions in which conditioning on unconditional effect-modifiers may remove conditional effect-modification. However we cannot not tell from a causal diagram whether the ancestors of an</span>
<span id="cb54-1324"><a href="#cb54-1324" aria-hidden="true" tabindex="-1"></a>unconditional effect-modifier will be conditional effect-modifiers for the effect of the exposure on the outcome; see: @vanderweele2007, also @suzuki2013counterfactual. Causal diagrams express non-parametric relations. I have adopted an off-label colouring convention to denote instances of effect-modification to highlight possible pathways for effect-modification, which may be relative to other variables in a model.</span>
<span id="cb54-1325"><a href="#cb54-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1328"><a href="#cb54-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb54-1329"><a href="#cb54-1329" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-effect-modificationc</span></span>
<span id="cb54-1330"><a href="#cb54-1330" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Blue path denotes effect-modification for G by conditioning on B. Both B and G are conditional effect modifiers."</span></span>
<span id="cb54-1331"><a href="#cb54-1331" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb54-1332"><a href="#cb54-1332" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb54-1333"><a href="#cb54-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1334"><a href="#cb54-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1335"><a href="#cb54-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1336"><a href="#cb54-1336" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb54-1337"><a href="#cb54-1337" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb54-1338"><a href="#cb54-1338" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb54-1339"><a href="#cb54-1339" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb54-1340"><a href="#cb54-1340" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb54-1341"><a href="#cb54-1341" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb54-1342"><a href="#cb54-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1343"><a href="#cb54-1343" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning, shapes.geometric, arrows.meta, decorations.pathmorphing}</span></span>
<span id="cb54-1344"><a href="#cb54-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1345"><a href="#cb54-1345" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{</span></span>
<span id="cb54-1346"><a href="#cb54-1346" aria-hidden="true" tabindex="-1"></a><span class="in">  Arrow/.style={-&gt;, &gt;=latex, line width=0.4pt},  % Defines a generic arrow style</span></span>
<span id="cb54-1347"><a href="#cb54-1347" aria-hidden="true" tabindex="-1"></a><span class="in">  emod/.style={rectangle, fill=blue!10, draw=blue, thick, minimum size=6mm},</span></span>
<span id="cb54-1348"><a href="#cb54-1348" aria-hidden="true" tabindex="-1"></a><span class="in">  emoddot/.style={circle, fill=blue!10, draw=blue, dotted, thick, minimum size=6mm}</span></span>
<span id="cb54-1349"><a href="#cb54-1349" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb54-1350"><a href="#cb54-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1351"><a href="#cb54-1351" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw, emod/.style={rectangle, fill=blue!10,draw=blue, thick},</span></span>
<span id="cb54-1352"><a href="#cb54-1352" aria-hidden="true" tabindex="-1"></a><span class="in">squarednode/.style={rectangle, draw=blue!60, fill=red!20, very thick, minimum size=5mm}]</span></span>
<span id="cb54-1353"><a href="#cb54-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1354"><a href="#cb54-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1355"><a href="#cb54-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1356"><a href="#cb54-1356" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (1, 0) {A$_{1}$};</span></span>
<span id="cb54-1357"><a href="#cb54-1357" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (3, 0) {Y$_{2}$};</span></span>
<span id="cb54-1358"><a href="#cb54-1358" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emoddot, dotted, draw=blue, bend left = 40] (Z) at (-2, 1) {Z};</span></span>
<span id="cb54-1359"><a href="#cb54-1359" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emod] (G) at (-2, -1) {G};</span></span>
<span id="cb54-1360"><a href="#cb54-1360" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emod] (B) at (-1,0) {B};</span></span>
<span id="cb54-1361"><a href="#cb54-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1362"><a href="#cb54-1362" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb54-1363"><a href="#cb54-1363" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[-{Circle[open, fill=none]}, line width=0.25pt, draw=blue, bend left = 20] (Z) to (Y);</span></span>
<span id="cb54-1364"><a href="#cb54-1364" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=blue] (Z) to (B);</span></span>
<span id="cb54-1365"><a href="#cb54-1365" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=blue] (G) to (B);</span></span>
<span id="cb54-1366"><a href="#cb54-1366" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture} </span></span>
<span id="cb54-1367"><a href="#cb54-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1368"><a href="#cb54-1368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1369"><a href="#cb54-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1370"><a href="#cb54-1370" aria-hidden="true" tabindex="-1"></a>@fig-dag-effect-modificationd reveals the relativity of effect-modification. If investigators do not condition on $B$, then $G$</span>
<span id="cb54-1371"><a href="#cb54-1371" aria-hidden="true" tabindex="-1"></a>cannot be a conditional effect-modifier because $G$ would then be independent of $Z$ because $B$ is a collider. However, as we observed in</span>
<span id="cb54-1372"><a href="#cb54-1372" aria-hidden="true" tabindex="-1"></a>@fig-dag-effect-modificationc, conditioning on $B$, a collider, may open a path for effect-modification of $G$ by $Z$. Both $B$ and $G$ are</span>
<span id="cb54-1373"><a href="#cb54-1373" aria-hidden="true" tabindex="-1"></a>conditional effect modifiers.</span>
<span id="cb54-1374"><a href="#cb54-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1377"><a href="#cb54-1377" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb54-1378"><a href="#cb54-1378" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-effect-modificationd</span></span>
<span id="cb54-1379"><a href="#cb54-1379" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Blue path denotes effect-modification. Here G is not an effect modifier because B, a common effect (collider) of G and Z, is not conditioned on. Any conditional effect modification for G would require conditioning on B, and not-conditioning on G. Otherwise G will be d-separated from Y."</span></span>
<span id="cb54-1380"><a href="#cb54-1380" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb54-1381"><a href="#cb54-1381" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb54-1382"><a href="#cb54-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1383"><a href="#cb54-1383" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb54-1384"><a href="#cb54-1384" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb54-1385"><a href="#cb54-1385" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb54-1386"><a href="#cb54-1386" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb54-1387"><a href="#cb54-1387" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb54-1388"><a href="#cb54-1388" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb54-1389"><a href="#cb54-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1390"><a href="#cb54-1390" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning, shapes.geometric, arrows.meta, decorations.pathmorphing}</span></span>
<span id="cb54-1391"><a href="#cb54-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1392"><a href="#cb54-1392" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{</span></span>
<span id="cb54-1393"><a href="#cb54-1393" aria-hidden="true" tabindex="-1"></a><span class="in">  Arrow/.style={-&gt;, &gt;=latex, line width=0.4pt},  % Defines a generic arrow style</span></span>
<span id="cb54-1394"><a href="#cb54-1394" aria-hidden="true" tabindex="-1"></a><span class="in">  emod/.style={rectangle, fill=blue!10, draw=blue, thick, minimum size=6mm},</span></span>
<span id="cb54-1395"><a href="#cb54-1395" aria-hidden="true" tabindex="-1"></a><span class="in">  emoddot/.style={circle, fill=blue!10, draw=blue, dotted, thick, minimum size=6mm}</span></span>
<span id="cb54-1396"><a href="#cb54-1396" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb54-1397"><a href="#cb54-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1398"><a href="#cb54-1398" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw, emod/.style={rectangle, fill=blue!10,draw=blue},</span></span>
<span id="cb54-1399"><a href="#cb54-1399" aria-hidden="true" tabindex="-1"></a><span class="in">emoddot/.style={circle, fill=blue!10, draw=blue, dotted}]</span></span>
<span id="cb54-1400"><a href="#cb54-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1401"><a href="#cb54-1401" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (1, 0) {A$_{1}$};</span></span>
<span id="cb54-1402"><a href="#cb54-1402" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (3, 0) {Y$_{2}$};</span></span>
<span id="cb54-1403"><a href="#cb54-1403" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emoddot, dotted, draw=blue] (Z) at (-2, 1) {Z};</span></span>
<span id="cb54-1404"><a href="#cb54-1404" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw = black] (G) at (-2, -1) {G};</span></span>
<span id="cb54-1405"><a href="#cb54-1405" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emoddot] (B) at (-1,0) {B};</span></span>
<span id="cb54-1406"><a href="#cb54-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1407"><a href="#cb54-1407" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb54-1408"><a href="#cb54-1408" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[-{Circle[open, fill=none]}, line width=0.25pt, draw=blue, bend left = 20] (Z) to (Y);</span></span>
<span id="cb54-1409"><a href="#cb54-1409" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=blue] (Z) to (B);</span></span>
<span id="cb54-1410"><a href="#cb54-1410" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (G) to (B);</span></span>
<span id="cb54-1411"><a href="#cb54-1411" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture} </span></span>
<span id="cb54-1412"><a href="#cb54-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1413"><a href="#cb54-1413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1414"><a href="#cb54-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1417"><a href="#cb54-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb54-1418"><a href="#cb54-1418" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-effect-modification5c</span></span>
<span id="cb54-1419"><a href="#cb54-1419" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Blue path denotes effect-modification. Neither, G nor B are unconditional effect-modifiers for the effect of A on Y after Z is conditioned upon. If investigators condition on Z, the causal diagram implies they will not find evidence for effect-modification by B or G, which are conditionally independent of Y once Z is conditioned upon."</span></span>
<span id="cb54-1420"><a href="#cb54-1420" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb54-1421"><a href="#cb54-1421" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb54-1422"><a href="#cb54-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1423"><a href="#cb54-1423" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb54-1424"><a href="#cb54-1424" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb54-1425"><a href="#cb54-1425" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb54-1426"><a href="#cb54-1426" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb54-1427"><a href="#cb54-1427" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb54-1428"><a href="#cb54-1428" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb54-1429"><a href="#cb54-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1430"><a href="#cb54-1430" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning, shapes.geometric, arrows.meta, decorations.pathmorphing}</span></span>
<span id="cb54-1431"><a href="#cb54-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1432"><a href="#cb54-1432" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{</span></span>
<span id="cb54-1433"><a href="#cb54-1433" aria-hidden="true" tabindex="-1"></a><span class="in">  Arrow/.style={-&gt;, &gt;=latex, line width=0.4pt},  % Defines a generic arrow style</span></span>
<span id="cb54-1434"><a href="#cb54-1434" aria-hidden="true" tabindex="-1"></a><span class="in">  emod/.style={rectangle, fill=blue!10, draw=blue, thick, minimum size=6mm},</span></span>
<span id="cb54-1435"><a href="#cb54-1435" aria-hidden="true" tabindex="-1"></a><span class="in">  emoddot/.style={circle, fill=blue!10, draw=blue, dotted, thick, minimum size=6mm}</span></span>
<span id="cb54-1436"><a href="#cb54-1436" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb54-1437"><a href="#cb54-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1438"><a href="#cb54-1438" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw, emod/.style={rectangle, fill=blue!10,draw=blue},</span></span>
<span id="cb54-1439"><a href="#cb54-1439" aria-hidden="true" tabindex="-1"></a><span class="in">emoddot/.style={circle, fill=blue!10, draw=blue, dotted}]</span></span>
<span id="cb54-1440"><a href="#cb54-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1441"><a href="#cb54-1441" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (1, 0) {A$_{1}$};</span></span>
<span id="cb54-1442"><a href="#cb54-1442" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (3, 0) {Y$_{2}$};</span></span>
<span id="cb54-1443"><a href="#cb54-1443" aria-hidden="true" tabindex="-1"></a><span class="in">\node [emod, draw=blue] (Z) at (-2, 1) {Z};</span></span>
<span id="cb54-1444"><a href="#cb54-1444" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw = black] (G) at (-2, -1) {G};</span></span>
<span id="cb54-1445"><a href="#cb54-1445" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle] (B) at (-1,0) {B};</span></span>
<span id="cb54-1446"><a href="#cb54-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1447"><a href="#cb54-1447" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (A) to (Y);</span></span>
<span id="cb54-1448"><a href="#cb54-1448" aria-hidden="true" tabindex="-1"></a><span class="in">\draw[-{Circle[open, fill=none]}, line width=0.25pt, draw=blue, bend left = 40](Z) to (Y);</span></span>
<span id="cb54-1449"><a href="#cb54-1449" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Z) to (B);</span></span>
<span id="cb54-1450"><a href="#cb54-1450" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (G) to (B);</span></span>
<span id="cb54-1451"><a href="#cb54-1451" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture} </span></span>
<span id="cb54-1452"><a href="#cb54-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1453"><a href="#cb54-1453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1454"><a href="#cb54-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1455"><a href="#cb54-1455" aria-hidden="true" tabindex="-1"></a>@fig-dag-effect-modification5c considers the implications of</span>
<span id="cb54-1456"><a href="#cb54-1456" aria-hidden="true" tabindex="-1"></a>conditioning on $Z$, which is the only unconditional effect-modifier on</span>
<span id="cb54-1457"><a href="#cb54-1457" aria-hidden="true" tabindex="-1"></a>the graph. If $Z$ is measured, conditioning on $Z$ will remove</span>
<span id="cb54-1458"><a href="#cb54-1458" aria-hidden="true" tabindex="-1"></a>effect-modification for $B$ and $G$ because $B,G\coprod Y |Z$. This</span>
<span id="cb54-1459"><a href="#cb54-1459" aria-hidden="true" tabindex="-1"></a>examples again reveals the context dependency of effect-modification.</span>
<span id="cb54-1460"><a href="#cb54-1460" aria-hidden="true" tabindex="-1"></a>Here, causal diagrams are useful for clarifying features of dependent</span>
<span id="cb54-1461"><a href="#cb54-1461" aria-hidden="true" tabindex="-1"></a>and independent effect modification. For further discussion, see:</span>
<span id="cb54-1462"><a href="#cb54-1462" aria-hidden="true" tabindex="-1"></a>@suzuki2013counterfactual; @vanderweele2009distinction.</span>
<span id="cb54-1463"><a href="#cb54-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1464"><a href="#cb54-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1465"><a href="#cb54-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1466"><a href="#cb54-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1467"><a href="#cb54-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1468"><a href="#cb54-1468" aria-hidden="true" tabindex="-1"></a><span class="fu">### Packages</span></span>
<span id="cb54-1469"><a href="#cb54-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1472"><a href="#cb54-1472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-1473"><a href="#cb54-1473" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span>
<span id="cb54-1474"><a href="#cb54-1474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1475"><a href="#cb54-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1476"><a href="#cb54-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1477"><a href="#cb54-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1478"><a href="#cb54-1478" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>