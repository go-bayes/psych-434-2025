<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.20">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph Bulbulia">
<meta name="dcterms.date" content="2025-05-20">

<title>Hands on Measurement: Exploratory Factor Analysis, Confirmatory Factor Analysis (CFA), Multigroup Confirmatory Factor Analysis, Partial Invariance (Configural, Metric, and Scalar equivalence). – PSYC 434 Conducting Research Across Cultures: Trimester 1, 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-94df807a54b4aea56b59f6b1a3567e79.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d5a3029baa3e394e88f18ffb9b51a21b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSYC 434 Conducting Research Across Cultures: Trimester 1, 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../content/course-outline.html"> 
<span class="menu-text">Course Outline</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-content" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Content</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-content">    
        <li>
    <a class="dropdown-item" href="../content/glossary.pdf">
 <span class="dropdown-text">Glossary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/course-outline.html">
 <span class="dropdown-text">Course Outline</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/01-content.html">
 <span class="dropdown-text">Week 1: Course Introduction - R (installing packages)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/02-content.html">
 <span class="dropdown-text">Week 2: Causal Diagrams - Elementary Structures and Rules - R (using the interface)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/03-content.html">
 <span class="dropdown-text">Week 3: Causal Diagrams - Confounding Bias - R (regression/simulation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/04-content.html">
 <span class="dropdown-text">Week 4: Causal Diagrams - Interaction, Measurement Bias, Selection Bias - R (regression/simulation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/05-content.html">
 <span class="dropdown-text">Week 5: Causal Inference - Average Treatment Effects - R (regression/simulation: ATE)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/06-content.html">
 <span class="dropdown-text">Week 6: Conditional Average Treatment Effects (CATE) - R (regression/simulation: ATE)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/07-quiz.html">
 <span class="dropdown-text">Week 7: In Class Test</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/08-content.html">
 <span class="dropdown-text">Week 8: Estimation of ATE and CATE using machine learning - R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/09-content.html">
 <span class="dropdown-text">Week 9: Theoretically postulated Subgroups analysis- R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/10-content.html">
 <span class="dropdown-text">Week 10: Hands On: Writing Up Your Analysis: Quarto Documents</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/11-content.html">
 <span class="dropdown-text">Week 11: Measurement: Factor Analysis, CFA, MultiGroup CFA, Partial Invariance/ And How These Approaches Fail</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../content/12-content.html">
 <span class="dropdown-text">Week 12: Student Presentations</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Hands on Measurement: Exploratory Factor Analysis, Confirmatory Factor Analysis (CFA), Multigroup Confirmatory Factor Analysis, Partial Invariance (Configural, Metric, and Scalar equivalence).</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Joseph Bulbulia <a href="mailto:joseph.bulbulia@vuw.ac.nz" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-5861-2056" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Victoria University of Wellington, New Zealand
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 20, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#focus-on-kessler-6-anxiety" id="toc-focus-on-kessler-6-anxiety" class="nav-link" data-scroll-target="#focus-on-kessler-6-anxiety">Focus on Kessler-6 Anxiety</a>
  <ul class="collapse">
  <li><a href="#practical-definitions-of-the-kessler-6-items" id="toc-practical-definitions-of-the-kessler-6-items" class="nav-link" data-scroll-target="#practical-definitions-of-the-kessler-6-items">Practical Definitions of the Kessler-6 Items</a></li>
  <li><a href="#exploratory-factor-analysis" id="toc-exploratory-factor-analysis" class="nav-link" data-scroll-target="#exploratory-factor-analysis">Exploratory Factor Analysis</a></li>
  <li><a href="#confirmatory-factor-analysis-ignoring-groups" id="toc-confirmatory-factor-analysis-ignoring-groups" class="nav-link" data-scroll-target="#confirmatory-factor-analysis-ignoring-groups">Confirmatory Factor Analysis (ignoring groups)</a></li>
  <li><a href="#measurement-invariance-in-multi-group-confirmatory-factor-analysis" id="toc-measurement-invariance-in-multi-group-confirmatory-factor-analysis" class="nav-link" data-scroll-target="#measurement-invariance-in-multi-group-confirmatory-factor-analysis">Measurement Invariance in Multi-group Confirmatory Factor Analysis</a></li>
  <li><a href="#configural-invariance-results" id="toc-configural-invariance-results" class="nav-link" data-scroll-target="#configural-invariance-results">Configural Invariance Results</a></li>
  <li><a href="#analysis-of-the-results" id="toc-analysis-of-the-results" class="nav-link" data-scroll-target="#analysis-of-the-results">Analysis of the Results:</a></li>
  <li><a href="#metric-equivalence" id="toc-metric-equivalence" class="nav-link" data-scroll-target="#metric-equivalence">Metric Equivalence</a></li>
  <li><a href="#scalar-equivalence" id="toc-scalar-equivalence" class="nav-link" data-scroll-target="#scalar-equivalence">Scalar Equivalence</a></li>
  <li><a href="#conclusion-understanding-the-limits-of-association-in-factor-models" id="toc-conclusion-understanding-the-limits-of-association-in-factor-models" class="nav-link" data-scroll-target="#conclusion-understanding-the-limits-of-association-in-factor-models">Conclusion: Understanding the Limits of Association in Factor Models</a></li>
  <li><a href="#lab-assignment" id="toc-lab-assignment" class="nav-link" data-scroll-target="#lab-assignment">Lab assignment</a></li>
  </ul></li>
  <li><a href="#appendix-a.-what-is-a-correlation-matrix" id="toc-appendix-a.-what-is-a-correlation-matrix" class="nav-link" data-scroll-target="#appendix-a.-what-is-a-correlation-matrix">Appendix A. What is a Correlation Matrix?</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  </ul></li>
  <li><a href="#part-2.-how-traditional-measurement-theory-fails" id="toc-part-2.-how-traditional-measurement-theory-fails" class="nav-link" data-scroll-target="#part-2.-how-traditional-measurement-theory-fails">PART 2. How Traditional Measurement Theory Fails</a></li>
  <li><a href="#overview-1" id="toc-overview-1" class="nav-link" data-scroll-target="#overview-1">Overview</a></li>
  <li><a href="#two-ways-of-thinking-about-measurement-in-psychometric-research." id="toc-two-ways-of-thinking-about-measurement-in-psychometric-research." class="nav-link" data-scroll-target="#two-ways-of-thinking-about-measurement-in-psychometric-research.">Two ways of thinking about measurement in psychometric research.</a>
  <ul class="collapse">
  <li><a href="#reflective-model-factor-analysis" id="toc-reflective-model-factor-analysis" class="nav-link" data-scroll-target="#reflective-model-factor-analysis">Reflective Model (Factor Analysis)</a></li>
  <li><a href="#the-formative-model-factor-analysis" id="toc-the-formative-model-factor-analysis" class="nav-link" data-scroll-target="#the-formative-model-factor-analysis">The Formative Model (Factor Analysis)</a></li>
  </ul></li>
  <li><a href="#structural-interpretation-of-the-formative-model-and-reflective-models-factor-analysis" id="toc-structural-interpretation-of-the-formative-model-and-reflective-models-factor-analysis" class="nav-link" data-scroll-target="#structural-interpretation-of-the-formative-model-and-reflective-models-factor-analysis">Structural Interpretation of the formative model and reflective models (Factor Analysis)</a></li>
  <li><a href="#problems-with-the-structural-interpretations-of-the-reflective-and-formative-factor-models." id="toc-problems-with-the-structural-interpretations-of-the-reflective-and-formative-factor-models." class="nav-link" data-scroll-target="#problems-with-the-structural-interpretations-of-the-reflective-and-formative-factor-models.">Problems with the structural interpretations of the reflective and formative factor models.</a></li>
  <li><a href="#review-of-the-theory-of-multiple-versions-of-treatment" id="toc-review-of-the-theory-of-multiple-versions-of-treatment" class="nav-link" data-scroll-target="#review-of-the-theory-of-multiple-versions-of-treatment">Review of the theory of multiple versions of treatment</a>
  <ul class="collapse">
  <li><a href="#reflective-and-formative-measurement-models-may-be-approached-as-multiple-versions-of-treatment" id="toc-reflective-and-formative-measurement-models-may-be-approached-as-multiple-versions-of-treatment" class="nav-link" data-scroll-target="#reflective-and-formative-measurement-models-may-be-approached-as-multiple-versions-of-treatment">Reflective and formative measurement models may be approached as multiple versions of treatment</a></li>
  </ul></li>
  <li><a href="#vanderweeles-model-of-reality" id="toc-vanderweeles-model-of-reality" class="nav-link" data-scroll-target="#vanderweeles-model-of-reality">VanderWeele’s model of reality</a></li>
  <li><a href="#how-theory-of-dependent-and-directed-measurement-error-might-be-usefully-employed-to-develop-a-pragmatic-responses-to-construct-measurement" id="toc-how-theory-of-dependent-and-directed-measurement-error-might-be-usefully-employed-to-develop-a-pragmatic-responses-to-construct-measurement" class="nav-link" data-scroll-target="#how-theory-of-dependent-and-directed-measurement-error-might-be-usefully-employed-to-develop-a-pragmatic-responses-to-construct-measurement">How theory of dependent and directed measurement error might be usefully employed to develop a pragmatic responses to construct measurement</a>
  <ul class="collapse">
  <li><a href="#confounding-control-by-baseline-measures-of-exposure-and-outcome-dependent-directed-measurement-error-in-three-wave-panels" id="toc-confounding-control-by-baseline-measures-of-exposure-and-outcome-dependent-directed-measurement-error-in-three-wave-panels" class="nav-link" data-scroll-target="#confounding-control-by-baseline-measures-of-exposure-and-outcome-dependent-directed-measurement-error-in-three-wave-panels">Confounding control by baseline measures of exposure and outcome: Dependent Directed Measurement Error in Three-Wave Panels</a></li>
  <li><a href="#comment-on-slow-changes" id="toc-comment-on-slow-changes" class="nav-link" data-scroll-target="#comment-on-slow-changes">Comment on slow changes</a></li>
  </ul></li>
  <li><a href="#lab-advice-on-your-final-report" id="toc-lab-advice-on-your-final-report" class="nav-link" data-scroll-target="#lab-advice-on-your-final-report">Lab: Advice on Your Final Report</a></li>
  <li><a href="#intoduction" id="toc-intoduction" class="nav-link" data-scroll-target="#intoduction">Intoduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a></li>
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1">Results</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#example-anlaysis-week-10" id="toc-example-anlaysis-week-10" class="nav-link" data-scroll-target="#example-anlaysis-week-10">Example anlaysis (week 10)</a>
  <ul class="collapse">
  <li><a href="#packages-1" id="toc-packages-1" class="nav-link" data-scroll-target="#packages-1">Packages</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<div class="callout-readings page-columns page-full">
<section id="required-readings" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="required-readings">Required Readings</h3>
<ul>
<li><span class="citation" data-cites="fischer2019primer">(<a href="#ref-fischer2019primer" role="doc-biblioref">Fischer and Karl 2019</a>)</span> <a href="https://www.dropbox.com/scl/fi/1h8slzy3vzscvbtp6yrjh/FischeKarlprimer.pdf?rlkey=xl93d5y7280c1qjhn3k2g8qls&amp;dl=0">link</a></li>
</ul>
<div class="no-row-height column-margin column-container"></div></section>
<section id="optional-readings" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="optional-readings">Optional Readings</h3>
<ul>
<li><span class="citation" data-cites="Vijver2021CulturePsychology">(<a href="#ref-Vijver2021CulturePsychology" role="doc-biblioref">Vijver et al. 2021</a>)</span> <a href="https://doi.org/10.1017/9781107415188">link</a></li>
<li><span class="citation" data-cites="he2012">(<a href="#ref-he2012" role="doc-biblioref">He and Vijver 2012</a>)</span> <a href="https://www.dropbox.com/scl/fi/zuv4odmxbz8dbtdjfap3e/He-BiasandEquivalence.pdf?rlkey=wezprklb4jm6rgvvx0g58nw1n&amp;dl=0ā">link</a></li>
<li><span class="citation" data-cites="Harkness2003TRANSALTION">(<a href="#ref-Harkness2003TRANSALTION" role="doc-biblioref">J. [et. al]. Harkness 2003</a>)</span> <a href="https://www.dropbox.com/scl/fi/hmmje9vbunmcu3oiahaa5/Harkness_CC_translation.pdf?rlkey=6vqq3ap5n52qp7t1e570ubpgt&amp;dl=0">link</a></li>
</ul>
<div class="no-row-height column-margin column-container"></div></section>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>EFA</li>
<li>CFA</li>
<li>Multigroup CFA</li>
<li>Invariance Testing (configural, metric, scalar)</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>You need to know these measurement concepts</li>
</ul>
</div>
</div>
<section id="readings" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="readings">Readings</h4>
<ul>
<li><span class="citation" data-cites="fischer2019primer">(<a href="#ref-fischer2019primer" role="doc-biblioref">Fischer and Karl 2019</a>)</span> <a href="https://www.dropbox.com/scl/fi/1h8slzy3vzscvbtp6yrjh/FischeKarlprimer.pdf?rlkey=xl93d5y7280c1qjhn3k2g8qls&amp;dl=0">link</a></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-fischer2019primer" class="csl-entry" role="listitem">
Fischer, Ronald, and Johannes A Karl. 2019. <span>“A Primer to (Cross-Cultural) Multi-Group Invariance Testing Possibilities in r.”</span> <em>Frontiers in Psychology</em>, 1507.
</div></div><section id="optional-readings-1" class="level5 page-columns page-full">
<h5 class="anchored" data-anchor-id="optional-readings-1">Optional Readings</h5>
<ul>
<li><span class="citation" data-cites="Vijver2021CulturePsychology">(<a href="#ref-Vijver2021CulturePsychology" role="doc-biblioref">Vijver et al. 2021</a>)</span> <a href="https://doi.org/10.1017/9781107415188">link</a></li>
<li><span class="citation" data-cites="he2012">(<a href="#ref-he2012" role="doc-biblioref">He and Vijver 2012</a>)</span> <a href="https://www.dropbox.com/scl/fi/zuv4odmxbz8dbtdjfap3e/He-BiasandEquivalence.pdf?rlkey=wezprklb4jm6rgvvx0g58nw1n&amp;dl=0ā">link</a></li>
<li><span class="citation" data-cites="Harkness2003TRANSALTION">(<a href="#ref-Harkness2003TRANSALTION" role="doc-biblioref">J. [et. al]. Harkness 2003</a>)</span> <a href="https://www.dropbox.com/scl/fi/hmmje9vbunmcu3oiahaa5/Harkness_CC_translation.pdf?rlkey=6vqq3ap5n52qp7t1e570ubpgt&amp;dl=0">link</a></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-Vijver2021CulturePsychology" class="csl-entry" role="listitem">
Vijver, Fons J. R. van de, Kwok Leung, Velichko H. Fetvadjiev, Jia He, and Johnny R. J. Fontaine. 2021. Edited by Velichko H. Fetvadjiev, Jia He, and Johnny R. J. Fontaine. 2nd ed. Culture and Psychology 116. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/9781107415188">https://doi.org/10.1017/9781107415188</a>.
</div><div id="ref-he2012" class="csl-entry" role="listitem">
He, Jia, and Fons van de Vijver. 2012. <span>“Bias and Equivalence in Cross-Cultural Research.”</span> <em>Online Readings in Psychology and Culture</em> 2 (2). <a href="https://doi.org/10.9707/2307-0919.1111">https://doi.org/10.9707/2307-0919.1111</a>.
</div><div id="ref-Harkness2003TRANSALTION" class="csl-entry" role="listitem">
Harkness, J. [et al]. 2003. <span>“Questionnaire Translation.”</span> In <em>Cross-Cultural Survey Methods</em>, 35–56. NJ: Wiley.
</div></div></section>
</section>
<section id="lab" class="level4">
<h4 class="anchored" data-anchor-id="lab">Lab</h4>
<ul>
<li>R exercises focusing on measurement theory applications and graphing</li>
</ul>
</section>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>By the conclusion of our session, you will gain proficiency in:</p>
<ul>
<li>Exploratory Factor Analysis,</li>
<li>Confirmatory Factor Analysis (CFA),</li>
<li>Multigroup Confirmatory Factor Analysis,</li>
<li>Partial Invariance (configural, metric, and scalar equivalence)</li>
</ul>
<p>We will learn these concepts by doing an analysis.</p>
</section>
<section id="focus-on-kessler-6-anxiety" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="focus-on-kessler-6-anxiety">Focus on Kessler-6 Anxiety</h2>
<p>The code below will:</p>
<ul>
<li>Load required packages.</li>
<li>Select the Kessler 6 items</li>
<li>Check whether there is sufficient correlation among the variables to support factor analysis.</li>
</ul>
<section id="select-a-scale-to-validate-kessler-6-distress" class="level4">
<h4 class="anchored" data-anchor-id="select-a-scale-to-validate-kessler-6-distress">Select A Scale To Validate: Kessler 6 Distress</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get synthetic data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># update margot</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("go-bayes/margot")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># select the columns of the kesser-6 need. </span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>dt_only_k6 <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    kessler_depressed,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    kessler_effort,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    kessler_hopeless,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    kessler_worthless,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    kessler_nervous,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    kessler_restless</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># check factor structure</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_factorstructure</span>(dt_only_k6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Is the data suitable for Factor Analysis?


  - Sphericity: Bartlett's test of sphericity suggests that there is sufficient significant correlation in the data for factor analysis (Chisq(15) = 50402.32, p &lt; .001).
  - KMO: The Kaiser, Meyer, Olkin (KMO) overall measure of sampling adequacy suggests that data seems appropriate for factor analysis (KMO = 0.87). The individual KMO scores are: kessler_depressed (0.85), kessler_effort (0.90), kessler_hopeless (0.86), kessler_worthless (0.85), kessler_nervous (0.90), kessler_restless (0.88).</code></pre>
</div>
</div>
</section>
<section id="practical-definitions-of-the-kessler-6-items" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="practical-definitions-of-the-kessler-6-items">Practical Definitions of the Kessler-6 Items</h3>
<ul>
<li>The <code>df_nz</code> is loaded with the <code>margot</code> package. It is a synthetic dataset.</li>
<li>take items from the Kessler-6 (K6) scale: depressed, effort, hopeless, worthless, nervous, and restless <span class="citation" data-cites="kessler2002 kessler2010">(<a href="#ref-kessler2002" role="doc-biblioref">R. &nbsp;C. Kessler et al. 2002</a>; <a href="#ref-kessler2010" role="doc-biblioref">R. C. Kessler et al. 2010</a>)</span>.</li>
<li>The Kessler-6 is used as a diagnostic screening tool for depression for physicians in New Zealand</li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-kessler2002" class="csl-entry" role="listitem">
Kessler, R.&nbsp;C., G. Andrews, L.&nbsp;J. Colpe, E. Hiripi, D.&nbsp;K. Mroczek, S.-L.&nbsp;T. Normand, E.&nbsp;E. Walters, and A.&nbsp;M. Zaslavsky. 2002. <span>“Short Screening Scales to Monitor Population Prevalences and Trends in Non-Specific Psychological Distress.”</span> <em>Psychological Medicine</em> 32 (6): 959–76. <a href="https://doi.org/10.1017/S0033291702006074">https://doi.org/10.1017/S0033291702006074</a>.
</div><div id="ref-kessler2010" class="csl-entry" role="listitem">
Kessler, Ronald C., Jennifer Greif Green, Michael J. Gruber, Nancy A. Sampson, Evelyn Bromet, Marius Cuitan, Toshi A. Furukawa, et al. 2010. <span>“Screening for Serious Mental Illness in the General Population with the K6 Screening Scale: Results from the WHO World Mental Health (WMH) Survey Initiative.”</span> <em>International Journal of Methods in Psychiatric Research</em> 19 (S1): 4–22. <a href="https://doi.org/10.1002/mpr.310">https://doi.org/10.1002/mpr.310</a>.
</div></div><p>The Kessler-6 (K6) is a widely-used diagnostic screening tool designed to identify levels of psychological distress that may indicate mental health disorders such as depression and anxiety. Physicians in New Zealand to screen patients quickly <span class="citation" data-cites="krynen2013measuring">(<a href="#ref-krynen2013measuring" role="doc-biblioref"><strong>krynen2013measuring?</strong></a>)</span>. Each item on the Kessler-6 asks respondents to reflect on their feelings and behaviors over the past 30 days, with responses provided on a five-point ordinal scale:</p>
<ol type="1">
<li><strong>“…you feel hopeless”</strong>
<ul>
<li><strong>Interpretation</strong>: This item measures the frequency of feelings of hopelessness. It assesses a core symptom of depression, where the individual perceives little or no optimism about the future.</li>
</ul></li>
<li><strong>“…you feel so depressed that nothing could cheer you up”</strong>
<ul>
<li><strong>Interpretation</strong>: This statement gauges the depth of depressive feelings and the inability to gain pleasure from normally enjoyable activities, a condition known as anhedonia.</li>
</ul></li>
<li><strong>“…you feel restless or fidgety”</strong>
<ul>
<li><strong>Interpretation</strong>: This item evaluates agitation and physical restlessness, which are common in anxiety disorders but can also be present in depressive states.</li>
</ul></li>
<li><strong>“…you feel that everything was an effort”</strong>
<ul>
<li><strong>Interpretation</strong>: This query assesses feelings of fatigue or exhaustion with everyday tasks, reflecting the loss of energy that is frequently a component of depression.</li>
</ul></li>
<li><strong>“…you feel worthless”</strong>
<ul>
<li><strong>Interpretation</strong>: This item measures feelings of low self-esteem or self-worth, which are critical indicators of depressive disorders.</li>
</ul></li>
<li><strong>“…you feel nervous”</strong>
<ul>
<li><strong>Interpretation</strong>: This question is aimed at identifying symptoms of nervousness or anxiety, helping to pinpoint anxiety disorders.</li>
</ul></li>
</ol>
<section id="response-options" class="level4">
<h4 class="anchored" data-anchor-id="response-options">Response Options</h4>
<p>The ordinal response options provided for the Kessler-6 are designed to capture the frequency of these symptoms, which is crucial for assessing the severity and persistence of psychological distress:</p>
<ul>
<li><strong>1. “None of the time”</strong>: The symptom was not experienced at all.</li>
<li><strong>2. “A little of the time”</strong>: The symptom was experienced infrequently.</li>
<li><strong>3. “Some of the time”</strong>: The symptom was experienced occasionally.</li>
<li><strong>4. “Most of the time”</strong>: The symptom was experienced frequently.</li>
<li><strong>5. “All of the time”</strong>: The symptom was constantly experienced.</li>
</ul>
<p>In clinical practice, higher scores on the Kessler-6 are indicative of greater distress and a higher likelihood of a mental health disorder. Physicians use a sum score of 13 to decide on further diagnostic evaluations or immediate therapeutic interventions.</p>
<p>The simplicity and quick administration of the Kessler-6 make it an effective tool for primary care settings in New Zealand, allowing for the early detection and management of mental health issues. Let’s stop to consider this measure. Do the items in this scale cohere? Do they all relate to depression? Might we quantitatively evaluate “coherence” in this scale?</p>
</section>
</section>
<section id="exploratory-factor-analysis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="exploratory-factor-analysis">Exploratory Factor Analysis</h3>
<p>We employ <code>performance::check_factorstructure()</code> to evaluate the data’s suitability for factor analysis. Two tests are reported:</p>
<ol type="a">
<li><strong>Bartlett’s Test of Sphericity</strong></li>
</ol>
<p>Bartlett’s Test of Sphericity is used in psychometrics to assess the appropriateness of factor analysis for a dataset. It tests the hypothesis that the observed correlation matrix of is an identity matrix, which would suggest that all variables are orthogonal (i.e., uncorrelated) and therefore, factor analysis is unlikely to be appropriate. (Appendix A.)</p>
<p>The outcome:</p>
<ul>
<li><strong>Chi-square (Chisq)</strong>: 50402.32 with <strong>Degrees of Freedom (15)</strong> and a <strong>p-value</strong> &lt; .001</li>
</ul>
<p>This highly reliable result (p &lt; .001) confirms that the observed correlation matrix is not an identity matrix, substantiating the factorability of the dataset.</p>
<ol start="2" type="a">
<li><strong>Kaiser-Meyer-Olkin (KMO) Measure</strong></li>
</ol>
<p>The KMO test assesses sampling adequacy by comparing the magnitudes of observed correlation coefficients to those of partial correlation coefficients. A KMO value nearing 1 indicates appropriateness for factor analysis. The results are:</p>
<ul>
<li><strong>Overall KMO</strong>: 0.87
<ul>
<li>This value suggests good sampling adequacy, indicating that the sum of partial correlations is relatively low compared to the sum of correlations, thus supporting the potential for distinct and reliable factors.</li>
</ul></li>
</ul>
<p>Each item’s KMO value exceeds the acceptable threshold of 0.5,so suitabale for factor analysis.</p>
<section id="explore-factor-structure" class="level4">
<h4 class="anchored" data-anchor-id="explore-factor-structure">Explore Factor Structure</h4>
<p>The following R code allows us to perform exploratory factor analysis (EFA) on the Kessler 6 (K6) scale data, assuming three latent factors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exploratory factor analysis</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># explore a factor structure made of 3 latent variables</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"psych"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"parameters"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># do efa</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>efa <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(dt_only_k6, <span class="at">nfactors =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">threshold =</span> <span class="st">"max"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( efa )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Rotated loadings from Factor Analysis (oblimin-rotation)

Variable          |  MR3 |  MR1 |  MR2 | Complexity | Uniqueness
----------------------------------------------------------------
kessler_hopeless  | 0.79 |      |      |       1.00 |       0.32
kessler_worthless | 0.79 |      |      |       1.01 |       0.34
kessler_depressed |      | 0.99 |      |       1.00 |   4.98e-03
kessler_restless  |      |      | 0.72 |       1.03 |       0.47
kessler_nervous   |      |      | 0.43 |       1.91 |       0.57
kessler_effort    |      |      | 0.38 |       2.00 |       0.53

The 3 latent factors (oblimin rotation) accounted for 62.94% of the total variance of the original data (MR3 = 28.20%, MR1 = 17.56%, MR2 = 17.18%).</code></pre>
</div>
</div>
</section>
<section id="explore-factor-structure-1" class="level4">
<h4 class="anchored" data-anchor-id="explore-factor-structure-1">Explore Factor Structure</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>efa <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(dt_only_k6, <span class="at">nfactors =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">threshold =</span> <span class="st">"max"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(efa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Rotated loadings from Factor Analysis (oblimin-rotation)

Variable          |  MR3 |  MR1 |  MR2 | Complexity | Uniqueness
----------------------------------------------------------------
kessler_hopeless  | 0.79 |      |      |       1.00 |       0.32
kessler_worthless | 0.79 |      |      |       1.01 |       0.34
kessler_depressed |      | 0.99 |      |       1.00 |   4.98e-03
kessler_restless  |      |      | 0.72 |       1.03 |       0.47
kessler_nervous   |      |      | 0.43 |       1.91 |       0.57
kessler_effort    |      |      | 0.38 |       2.00 |       0.53

The 3 latent factors (oblimin rotation) accounted for 62.94% of the total variance of the original data (MR3 = 28.20%, MR1 = 17.56%, MR2 = 17.18%).</code></pre>
</div>
</div>
</section>
<section id="what-is-rotation" class="level4">
<h4 class="anchored" data-anchor-id="what-is-rotation">What is “Rotation”?</h4>
<p>In factor analysis, rotation is a mathematical technique applied to the factor solution to make it more interpretable. Rotation is like adjusting the angle of a camera to get a better view. When we rotate the factors, we are not changing the underlying data, just how we are looking at it, to make the relationships between variables and factors clearer and more meaningful.</p>
<p>The main goal of rotation is to achieve a simpler and more interpretable factor structure. This simplification is achieved by <strong>making the factors as distinct as possible,</strong> by aligning them closer with specific variables, which makes it easier to understand what each factor represents. Think of orthogonal rotation like organising books on a shelf so that each book only belongs to one category. Each category (factor) is completely independent of the others.</p>
<p>There are two types:</p>
<p><strong>Orthogonal rotations</strong> (such as Varimax), which assume that the factors are uncorrelated and keep the axes at 90 degrees to each other. This is useful when we assume that the underlying factors are independent.</p>
<p><strong>Oblique rotations</strong> (such as Oblimin), which allow the factors to correlate. Returning to our analogy, imagine a more complex library system where some categories of books overlap; for example, “history” might overlap with “political science”. Oblique rotation recognises and allows these overlaps.This is more realistic in psychological and social sciences, … here, we believe that stress and anxiety might naturally correlate with each other, so Oblique rotation is a better option.</p>
</section>
<section id="results" class="level4">
<h4 class="anchored" data-anchor-id="results">Results</h4>
<p>Using oblimin rotation, the items loaded as follows on the three factors:</p>
<ul>
<li><strong>MR3</strong>: Strongly associated with ‘kessler_hopeless’ (0.79) and ‘kessler_worthless’ (0.79). This factor might be capturing aspects related to feelings of hopelessness and worthlessness, often linked with depressive affect.</li>
<li><strong>MR1</strong>: Mostly linked with ‘kessler_depressed’ (0.99), suggesting this factor represents core depressive symptoms.</li>
<li><strong>MR2</strong>: Includes ‘kessler_restless’ (0.72), ‘kessler_nervous’ (0.43), and ‘kessler_effort’ (0.38). This factor seems to encompass symptoms related to anxiety and agitation.</li>
</ul>
<p>The <strong>complexity</strong> values indicate the number of factors each item loads on “significantly.” A complexity near 1.00 suggests that the item predominantly loads on a single factor, which is seen with most of the items except for ‘kessler_nervous’ and ‘kessler_effort’, which show higher complexity and thus share variance with more than one factor.</p>
<p><strong>Uniqueness</strong> values represent the variance in each item not explained by the common factors. Lower uniqueness values for items like ‘kessler_depressed’ indicate that the factor explains most of the variance for that item.</p>
</section>
<section id="variance-explained" class="level4">
<h4 class="anchored" data-anchor-id="variance-explained">Variance Explained</h4>
<p>The three factors together account for 62.94% of the total variance in the data, distributed as follows:</p>
<ul>
<li><strong>MR3</strong>: 28.20%</li>
<li><strong>MR1</strong>: 17.56%</li>
<li><strong>MR2</strong>: 17.18%</li>
</ul>
<p>This indicates a substantial explanation of the data’s variance by the model, with the highest contribution from the factor associated with hopelessness and worthlessness.</p>
</section>
<section id="consensus-view" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="consensus-view">Consensus View?</h4>
<p>There are different algorithms for assessing the factor structure. The performance package allows us to consider a ‘consensus’ view.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="fu">n_factors</span>(dt_only_k6)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Method Agreement Procedure:

The choice of 1 dimensions is supported by 8 (50.00%) methods out of 16 (Optimal coordinates, Acceleration factor, Parallel analysis, Kaiser criterion, Scree (SE), Scree (R2), VSS complexity 1, Velicer's MAP).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="11-content_files/figure-html/plot_factors-1.png" class="img-fluid figure-img column-page-right" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Output:</p>
<blockquote class="blockquote">
<p>The choice of 1 dimensions is supported by 8 (50.00%) methods out of 16 (Optimal coordinates, Acceleration factor, Parallel analysis, Kaiser criterion, Scree (SE), Scree (R2), VSS complexity 1, Velicer’s MAP).</p>
</blockquote>
<p>The result indicates that a single dimension is supported by half of the methods used (8 out of 16). However science isn’t a matter of voting. Also, does it make sense that there is one latent factor here? Let’s press on…</p>
</section>
</section>
<section id="confirmatory-factor-analysis-ignoring-groups" class="level3">
<h3 class="anchored" data-anchor-id="confirmatory-factor-analysis-ignoring-groups">Confirmatory Factor Analysis (ignoring groups)</h3>
<p>CFA to validate the hypothesised factor structures derived from EFA.</p>
<ul>
<li><strong>One-factor model</strong>: assumes all items measure a single underlying construct.</li>
<li><strong>Two-factor model</strong>: assumes two distinct constructs measured by the items.</li>
<li><strong>Three-factor model</strong>: assumes three distinct constructs measured by the items.</li>
</ul>
<p>Steps are:</p>
<section id="data-partition" class="level4">
<h4 class="anchored" data-anchor-id="data-partition">1. Data Partition</h4>
<p>First, we take the dataset (<code>dt_only_k6</code>) and partition it into training and testing sets. This division helps in validating the model built on the training data against an unseen test set; this enhances robustness for the factor analysis findings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>part_data <span class="ot">&lt;-</span> datawizard<span class="sc">::</span><span class="fu">data_partition</span>(dt_only_k6, <span class="at">training_proportion =</span> .<span class="dv">7</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> part_data<span class="sc">$</span>p_0<span class="fl">.7</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> part_data<span class="sc">$</span>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-setup-for-cfa" class="level4">
<h4 class="anchored" data-anchor-id="model-setup-for-cfa">2. Model Setup for CFA</h4>
<p>Bases on the EFA results, we consider three different factor structures</p>
<ul>
<li><strong>One-factor model</strong>: assumes all items measure a single underlying construct.</li>
<li><strong>Two-factor model</strong>: assumes two distinct constructs measured by the items.</li>
<li><strong>Three-factor model</strong>: assumes three distinct constructs measured by the items.</li>
</ul>
<p>We fit each model to the training data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One-factor model</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>structure_k6_one <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-factor model</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>structure_k6_two <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Three-factor model</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>structure_k6_three <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we split our data for cross-validation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first partition the data </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>part_data <span class="ot">&lt;-</span> datawizard<span class="sc">::</span><span class="fu">data_partition</span>(dt_only_k6, <span class="at">traing_proportion =</span> .<span class="dv">7</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set up training data</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> part_data<span class="sc">$</span>p_0<span class="fl">.7</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> part_data<span class="sc">$</span>test</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># one factor model</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>structure_k6_one <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># two factor model model</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>structure_k6_two <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># three factor model</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>structure_k6_three <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect models</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>structure_k6_one</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Latent variables
MR1 =~ kessler_depressed + kessler_effort + kessler_hopeless + kessler_worthless + kessler_nervous + kessler_restless + .row_id</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>structure_k6_two</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Latent variables
MR1 =~ kessler_depressed + kessler_hopeless + kessler_worthless
MR2 =~ kessler_effort + kessler_nervous + kessler_restless + .row_id</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>structure_k6_three</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Latent variables
MR1 =~ kessler_depressed + kessler_hopeless + kessler_worthless
MR2 =~ kessler_effort
MR3 =~ kessler_nervous + kessler_restless + .row_id</code></pre>
</div>
</div>
<ul>
<li><p><strong>One-Factor Model</strong>: All items are linked to a single factor (<code>MR1</code>).</p></li>
<li><p><strong>Two-Factor Model</strong>:</p>
<ul>
<li><code>MR1</code> is linked with <code>kessler_depressed</code>, <code>kessler_hopeless</code>, and <code>kessler_worthless</code>, suggesting these items might represent a more depressive aspect of <strong>distress.</strong></li>
<li><code>MR2</code> is associated with <code>kessler_effort</code>, <code>kessler_nervous</code>, and <code>kessler_restless</code>, which could indicate a different aspect, perhaps related to <strong>anxiety or agitation.</strong></li>
</ul></li>
<li><p><strong>Three-Factor Model</strong>:</p>
<ul>
<li><code>MR1</code> includes <code>kessler_depressed</code>, <code>kessler_effort</code>, <code>kessler_hopeless</code>, and <code>kessler_worthless</code>, indicating a broad factor possibly encompassing overall distress.</li>
<li><code>MR2</code> consists solely of <code>kessler_effort</code>.</li>
<li><code>MR3</code> includes <code>kessler_nervous</code> + <code>kessler_restless</code>, which might imply these are distinctivene from other distress components.</li>
</ul></li>
</ul>
<p>Do these results make sense? Note they are different from the Exploratory Factor Analysis. Why might that be?</p>
<p>Next we perform the confirmatory factor analysis itself…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit and compare models</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># one latent model</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>one_latent <span class="ot">&lt;-</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_one, <span class="at">data =</span> test))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># two latents model</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>two_latents <span class="ot">&lt;-</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_two, <span class="at">data =</span> test))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># three latents model</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>three_latents <span class="ot">&lt;-</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_three, <span class="at">data =</span> test))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>compare <span class="ot">&lt;-</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">compare_performance</span>(one_latent, two_latents, three_latents, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># select cols we want</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>key_columns_df <span class="ot">&lt;-</span> compare[, <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"Chi2"</span>, <span class="st">"Chi2_df"</span>, <span class="st">"CFI"</span>, <span class="st">"RMSEA"</span>, <span class="st">"RMSEA_CI_low"</span>, <span class="st">"RMSEA_CI_high"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>)]</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co"># view as html table</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(key_columns_df) <span class="sc">|&gt;</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Chi2</th>
<th style="text-align: right;">Chi2_df</th>
<th style="text-align: right;">CFI</th>
<th style="text-align: right;">RMSEA</th>
<th style="text-align: right;">RMSEA_CI_low</th>
<th style="text-align: right;">RMSEA_CI_high</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lavaan</td>
<td style="text-align: right;">805.47732</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.9468004</td>
<td style="text-align: right;">0.0985415</td>
<td style="text-align: right;">0.0928176</td>
<td style="text-align: right;">0.1043876</td>
<td style="text-align: right;">195671.0</td>
<td style="text-align: right;">195764.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">lavaan</td>
<td style="text-align: right;">161.24069</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.9900359</td>
<td style="text-align: right;">0.0442564</td>
<td style="text-align: right;">0.0382928</td>
<td style="text-align: right;">0.0504917</td>
<td style="text-align: right;">195028.7</td>
<td style="text-align: right;">195128.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lavaan</td>
<td style="text-align: right;">80.53628</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.9953933</td>
<td style="text-align: right;">0.0313209</td>
<td style="text-align: right;">0.0250361</td>
<td style="text-align: right;">0.0379798</td>
<td style="text-align: right;">194950.0</td>
<td style="text-align: right;">195056.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="metrics" class="level4">
<h4 class="anchored" data-anchor-id="metrics">Metrics:</h4>
<ul>
<li><strong>Chi2 (Chi-Square Test)</strong>: A lower Chi2 value indicates a better fit of the model to the data.</li>
<li><strong>df (Degrees of Freedom)</strong>: Reflects the model complexity.</li>
<li><strong>CFI (Comparative Fit Index)</strong>: Values closer to 1 indicate a better fit. A value above 0.95 is generally considered to indicate a good fit.</li>
<li><strong>RMSEA (Root Mean Square Error of Approximation)</strong>: values less than 0.05 indicate a good fit, and values up to 0.08 are acceptable.</li>
<li><strong>AIC (Akaike Information Criterion) and BIC (Bayesian Information Criterion)</strong>: lower values are better, indicating a more parsimonious model, with the BIC imposing a penalty for model complexity.</li>
</ul>
</section>
<section id="model-selection" class="level4">
<h4 class="anchored" data-anchor-id="model-selection">Model Selection:</h4>
<p>What do you think?</p>
<ul>
<li>The <strong>Three Latents Model</strong> shows the best fit across all indicators, having the lowest Chi2, RMSEA, and the highest CFI. It also has the lowest AIC and BIC scores, suggesting it not only fits well but is also the most parsimonious among the tested models.</li>
</ul>
<p>But…</p>
<ul>
<li><p><strong>The CFI</strong> for the two-factor model is 0.990, which is close to 1 and suggests a very good fit to the data. This is superior to the one-factor model (CFI = 0.9468) and slightly less than the three-factor model (CFI = 0.9954). A CFI value closer to 1 indicates a better fit of the model to the data.</p></li>
<li><p><strong>Root Mean Square Error of Approximation (RMSEA):</strong> The two-factor model has an RMSEA of 0.0443, which is within the excellent fit range (below 0.05). It significantly improves upon the one-factor model’s RMSEA of 0.0985 and is only slightly worse than the three-factor model’s 0.0313.</p></li>
<li><p>**BIC* isn’t much different, So</p></li>
</ul>
<p>We might say the two-factor model strikes a balance between simplicity and model fit. It has fewer factors than the three-factor model, making it potentially easier to interpret while still capturing the variance in the data.</p>
<p>Look at the items. What do you think?</p>
<p>Does Anxiety appear to differ from Depression?</p>
</section>
</section>
<section id="measurement-invariance-in-multi-group-confirmatory-factor-analysis" class="level3">
<h3 class="anchored" data-anchor-id="measurement-invariance-in-multi-group-confirmatory-factor-analysis">Measurement Invariance in Multi-group Confirmatory Factor Analysis</h3>
<p>When we use tools like surveys or tests to measure psychological constructs (like distress, intelligence, satisfaction), we often need to ensure that these tools work similarly across different groups of people. This is crucial for fair comparisons. Think of it as ensuring that a ruler measures inches or centimeters the same way, whether you are in Auckland or Wellington.</p>
<section id="levels-of-measurement-invariance" class="level4">
<h4 class="anchored" data-anchor-id="levels-of-measurement-invariance">Levels of Measurement Invariance</h4>
<p>Measurement invariance tests how consistently a measure operates across different groups, such as ethnic or gender groups. Consider how we can understand it through the K6 Distress Scale applied to different demographic groups in New Zealand:</p>
<ol type="1">
<li><p><strong>Configural Invariance</strong></p>
<ul>
<li><strong>What it means</strong>: The measure’s structure is the same across groups. Imagine you have a toolkit; configural invariance means that everyone has the same set of tools (screwdrivers, hammers, wrenches) in their kits.</li>
<li><strong>Application</strong>: For the K6 Distress Scale, both Māori and New Zealand Europeans use the same six questions to gauge distress. However, how strongly each question predicts distress can vary between the groups. (Not we are using “prediction” here – we are only assessessing associations.)</li>
</ul></li>
<li><p><strong>Metric Invariance</strong></p>
<ul>
<li><strong>What it means</strong>: The strength of the relationship between each tool (question) and the construct (distress) is consistent across groups. If metric invariance holds, turning a screw (answering a question about feeling nervous) tightens the screw by the same amount no matter who uses the screwdriver.</li>
<li><strong>Application</strong>: A unit change in the latent distress factor affects scores on questions (like feeling nervous or hopeless) equally for Māori and New Zealand Europeans.</li>
</ul></li>
<li><p><strong>Scalar Invariance</strong></p>
<ul>
<li><strong>What it means</strong>: Beyond having the same tools and relationships, everyone starts from the same baseline. If scalar invariance holds. It is like ensuring that every screwdriver is calibrated to the same torque setting before being used.</li>
<li><strong>Application</strong>: The actual scores on the distress scale mean the same thing across different groups. If a Māori scores 15 and a New Zealander of European descent scores 15, both are experiencing a comparable level of distress.</li>
</ul></li>
</ol>
</section>
<section id="concept-of-partial-invariance" class="level4">
<h4 class="anchored" data-anchor-id="concept-of-partial-invariance">Concept of “Partial Invariance”</h4>
<p>Sometimes, not all conditions for full metric or scalar invariance are met, which could hinder meaningful comparisons across groups. This is where the concept of “partial invariance” comes into play.</p>
<p><strong>Partial Invariance</strong> occurs when invariance holds for some but not all items of the scale across groups. Imagine if most, but not all, tools in the kits behaved the same way across different groups. If sufficient items (tools) exhibit invariance, the measure might still be usable for certain comparisons.</p>
<ul>
<li><p><strong>Metric Partial Invariance</strong>: This might mean that while most items relate similarly to the underlying factor across groups, one or two do not. Researchers might decide that there’s enough similarity to proceed with comparisons of relationships (correlations) but should proceed with caution.</p></li>
<li><p><strong>Scalar Partial Invariance</strong>: Here, most but not all items show the same intercepts across groups. It suggests that while comparisons of the construct means can be made, some scores might need adjustments or nuanced interpretation.</p></li>
</ul>
<p>In practical terms, achieving partial invariance in your analysis allows for some comparisons but signals a need for careful interpretation and potentially more careful analysis. For instance, if partial scalar invariance is found on the K6 Distress Scale, researchers might compare overall distress levels between Māori and New Zealand Europeans but should acknowledge that differences in certain item responses might reflect measurement bias rather than true differences in distress.</p>
<p>The upshot is that understanding these levels of invariance helps ensure that when we compare mental health or other constructs across different groups, we are making fair and meaningful comparisons. Partial invariance offers a flexible approach to handle real-world data where not all conditions are perfectly met. This approach allows researchers to acknowledge and account for minor discrepancies while still extracting valuable insights from their analyses.</p>
<p>The following script runs multi-group confirmatory factor analysis (MG-CFA) to assess the invariance of the Kessler 6 (K6) distress scale across two ethnic groups: European New Zealanders and Māori.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select needed columns plus 'ethnicity'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># filter dataset for only 'euro' and 'maori' ethnic categories</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>dt_eth_k6_eth <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(eth_cat <span class="sc">==</span> <span class="st">"euro"</span> <span class="sc">|</span> eth_cat <span class="sc">==</span> <span class="st">"maori"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(kessler_depressed, kessler_effort, kessler_hopeless,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>         kessler_worthless, kessler_nervous, kessler_restless, eth_cat)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># partition the dataset into training and test subsets</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># stratify by ethnic category to ensure balanced representation</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>part_data_eth <span class="ot">&lt;-</span> datawizard<span class="sc">::</span><span class="fu">data_partition</span>(dt_eth_k6_eth, <span class="at">training_proportion =</span> .<span class="dv">7</span>, <span class="at">seed =</span> <span class="dv">123</span>, <span class="at">group =</span> <span class="st">"eth_cat"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>training_eth <span class="ot">&lt;-</span> part_data_eth<span class="sc">$</span>p_0<span class="fl">.7</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>test_eth <span class="ot">&lt;-</span> part_data_eth<span class="sc">$</span>test</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># configural invariance models</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#run CFA models specifying one, two, and three latent variables without constraining across groups</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>one_latent_eth_configural <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_one, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>two_latents_eth_configural <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_two, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>three_latents_eth_configural <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_three, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co"># compare model performances for configural invariance</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>compare_eth_configural <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">compare_performance</span>(one_latent_eth_configural, two_latents_eth_configural, three_latents_eth_configural, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>compare_eth_configural</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                         |  Model |    Chi2 | Chi2_df | p (Chi2)
--------------------------------------------------------------------
one_latent_eth_configural    | lavaan | 612.807 |  28.000 |   &lt; .001
two_latents_eth_configural   | lavaan | 129.992 |  26.000 |   &lt; .001
three_latents_eth_configural | lavaan |  85.047 |  24.000 |   &lt; .001

Name                         | Baseline(42) | p (Baseline) |   GFI |  AGFI
--------------------------------------------------------------------------
one_latent_eth_configural    |    13146.709 |       &lt; .001 | 0.987 | 0.967
two_latents_eth_configural   |    13146.709 |       &lt; .001 | 0.997 | 0.993
three_latents_eth_configural |    13146.709 |       &lt; .001 | 0.998 | 0.995

Name                         |   NFI |  NNFI |   CFI | RMSEA |    RMSEA  CI
---------------------------------------------------------------------------
one_latent_eth_configural    | 0.953 | 0.933 | 0.955 | 0.089 | [0.08, 0.09]
two_latents_eth_configural   | 0.990 | 0.987 | 0.992 | 0.039 | [0.03, 0.05]
three_latents_eth_configural | 0.994 | 0.992 | 0.995 | 0.031 | [0.02, 0.04]

Name                         | p (RMSEA) |    RMR |  SRMR |   RFI |  PNFI
-------------------------------------------------------------------------
one_latent_eth_configural    |    &lt; .001 | 33.223 | 0.037 | 0.930 | 0.636
two_latents_eth_configural   |    0.997  | 30.180 | 0.016 | 0.984 | 0.613
three_latents_eth_configural |    &gt; .999 | 28.432 | 0.012 | 0.989 | 0.568

Name                         |   IFI |   RNI | Loglikelihood |   AIC (weights)
------------------------------------------------------------------------------
one_latent_eth_configural    | 0.955 | 0.955 |    -87850.050 | 1.8e+05 (&lt;.001)
two_latents_eth_configural   | 0.992 | 0.992 |    -87608.642 | 1.8e+05 (&lt;.001)
three_latents_eth_configural | 0.995 | 0.995 |    -87586.170 | 1.8e+05 (&gt;.999)

Name                         |   BIC (weights) | BIC_adjusted
-------------------------------------------------------------
one_latent_eth_configural    | 1.8e+05 (&lt;.001) |    1.759e+05
two_latents_eth_configural   | 1.8e+05 (&lt;.001) |    1.755e+05
three_latents_eth_configural | 1.8e+05 (&gt;.999) |    1.754e+05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># metric invariance models</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># run CFA models holding factor loadings equal across groups</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>one_latent_eth_metric <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_one, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">group.equal =</span> <span class="st">"loadings"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>two_latents_eth_metric  <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_two, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">group.equal =</span> <span class="st">"loadings"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>three_latents_eth_metric  <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_three, <span class="at">group =</span> <span class="st">"eth_cat"</span>,<span class="at">group.equal =</span> <span class="st">"loadings"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compare model performances for metric invariance</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>compare_eth_metric  <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">compare_performance</span>(one_latent_eth_metric, two_latents_eth_metric, three_latents_eth_metric, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># scalar invariance models</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># run CFA models holding factor loadings and intercepts equal across groups</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>one_latent_eth_scalar <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_one, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>,<span class="st">"intercepts"</span>), <span class="at">data =</span> test_eth))</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>two_latents_eth_scalar  <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_two, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">group.equal =</span>  <span class="fu">c</span>(<span class="st">"loadings"</span>,<span class="st">"intercepts"</span>), <span class="at">data =</span> test_eth))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>three_latents_eth_scalar  <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_three, <span class="at">group =</span> <span class="st">"eth_cat"</span>,<span class="at">group.equal =</span>  <span class="fu">c</span>(<span class="st">"loadings"</span>,<span class="st">"intercepts"</span>), <span class="at">data =</span> test_eth))</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare model performances for scalar invariance</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>compare_eth_scalar <span class="ot">&lt;-</span> compare_eth_scalar  <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">compare_performance</span>(one_latent_eth_scalar, two_latents_eth_scalar, three_latents_eth_scalar, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="configural-invariance-results" class="level3">
<h3 class="anchored" data-anchor-id="configural-invariance-results">Configural Invariance Results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>compare_eth_configural_key <span class="ot">&lt;-</span> compare_eth_configural[, <span class="fu">c</span>(<span class="st">"Name"</span>, <span class="st">"Chi2"</span>, <span class="st">"Chi2_df"</span>,<span class="st">"RFI"</span>, <span class="st">"NNFI"</span>, <span class="st">"CFI"</span>,<span class="st">"GFI"</span>,<span class="st">"RMSEA"</span>, <span class="st">"RMSEA_CI_low"</span>, <span class="st">"RMSEA_CI_high"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>)]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(compare_eth_configural_key)<span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: right;">Chi2</th>
<th style="text-align: right;">Chi2_df</th>
<th style="text-align: right;">RFI</th>
<th style="text-align: right;">NNFI</th>
<th style="text-align: right;">CFI</th>
<th style="text-align: right;">GFI</th>
<th style="text-align: right;">RMSEA</th>
<th style="text-align: right;">RMSEA_CI_low</th>
<th style="text-align: right;">RMSEA_CI_high</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">one_latent_eth_configural</td>
<td style="text-align: right;">612.80668</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0.9300806</td>
<td style="text-align: right;">0.9330615</td>
<td style="text-align: right;">0.9553743</td>
<td style="text-align: right;">0.9866606</td>
<td style="text-align: right;">0.0887694</td>
<td style="text-align: right;">0.0827342</td>
<td style="text-align: right;">0.0949488</td>
<td style="text-align: right;">175784.1</td>
<td style="text-align: right;">176060.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">two_latents_eth_configural</td>
<td style="text-align: right;">129.99163</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">0.9840274</td>
<td style="text-align: right;">0.9871812</td>
<td style="text-align: right;">0.9920646</td>
<td style="text-align: right;">0.9972721</td>
<td style="text-align: right;">0.0388462</td>
<td style="text-align: right;">0.0323467</td>
<td style="text-align: right;">0.0456186</td>
<td style="text-align: right;">175305.3</td>
<td style="text-align: right;">175594.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">three_latents_eth_configural</td>
<td style="text-align: right;">85.04735</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.9886791</td>
<td style="text-align: right;">0.9918477</td>
<td style="text-align: right;">0.9953416</td>
<td style="text-align: right;">0.9982007</td>
<td style="text-align: right;">0.0309787</td>
<td style="text-align: right;">0.0239993</td>
<td style="text-align: right;">0.0382454</td>
<td style="text-align: right;">175264.3</td>
<td style="text-align: right;">175566.8</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The table represents the comparison of three multi-group confirmatory factor analysis (CFA) models conducted to test for configural invariance across different ethnic categories (eth_cat). Configural invariance refers to whether the pattern of factor loadings is the same across groups. It’s the most basic form of measurement invariance.</p>
<p>Looking at the results, we can draw the following conclusions:</p>
<ol type="1">
<li><p><strong>Chi2 (Chi-square)</strong>: a lower value suggests a better model fit. In this case, the three looks best</p></li>
<li><p><strong>GFI (Goodness of Fit Index) and AGFI (Adjusted Goodness of Fit Index)</strong>: These values range from 0 to 1, with values closer to 1 suggesting a better fit. All models are close.</p></li>
<li><p><strong>NFI (Normed Fit Index), NNFI (Non-Normed Fit Index, also called TLI), CFI (Comparative Fit Index)</strong>: These range from 0 to 1, with values closer to 1 suggesting a better fit. The two and three factors models have the highest values.</p></li>
<li><p><strong>RMSEA (Root Mean Square Error of Approximation)</strong>: lower values are better, with values below 0.05 considered good and up to 0.08 considered acceptable.Only two and three meet this threshold.</p></li>
<li><p><strong>RMR (Root Mean Square Residual) and SRMR (Standardized Root Mean Square Residual)</strong>: three is best.</p></li>
<li><p><strong>RFI (Relative Fit Index), PNFI (Parsimonious Normed Fit Index), IFI (Incremental Fit Index), RNI (Relative Noncentrality Index)</strong>: These range from 0 to 1, with values closer to 1 suggesting a better fit. Again three is the winner.</p></li>
<li><p><strong>AIC (Akaike Information Criterion) and BIC (Bayesian Information Criterion)</strong>: The three factor model win’s again.</p></li>
</ol>
</section>
<section id="analysis-of-the-results" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-the-results">Analysis of the Results:</h3>
<ul>
<li><p><strong>One Latent Model</strong>: shows the poorest fit among the models with a high RMSEA and the lowest CFI. The model’s Chi-squared value is also significantly high, indicating a substantial misfit with the observed data.</p></li>
<li><p><strong>Two Latents Model</strong>: displays a much improved fit compared to the one latent model, as evident from its much lower Chi-squared value, lower RMSEA, and higher CFI. This suggests that two factors might be necessary to adequately represent the underlying structure in the data.</p></li>
<li><p><strong>Three Latents Model</strong>: provides the best fit metrics among the three configurations.</p></li>
</ul>
</section>
<section id="metric-equivalence" class="level3">
<h3 class="anchored" data-anchor-id="metric-equivalence">Metric Equivalence</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>compare_eth_metric <span class="ot">&lt;-</span> compare_eth_metric[, <span class="fu">c</span>(<span class="st">"Name"</span>, <span class="st">"Chi2"</span>, <span class="st">"Chi2_df"</span>,<span class="st">"RFI"</span>, <span class="st">"NNFI"</span>, <span class="st">"CFI"</span>,<span class="st">"GFI"</span>,<span class="st">"RMSEA"</span>, <span class="st">"RMSEA_CI_low"</span>, <span class="st">"RMSEA_CI_high"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>)]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(compare_eth_metric)<span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: right;">Chi2</th>
<th style="text-align: right;">Chi2_df</th>
<th style="text-align: right;">RFI</th>
<th style="text-align: right;">NNFI</th>
<th style="text-align: right;">CFI</th>
<th style="text-align: right;">GFI</th>
<th style="text-align: right;">RMSEA</th>
<th style="text-align: right;">RMSEA_CI_low</th>
<th style="text-align: right;">RMSEA_CI_high</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">one_latent_eth_metric</td>
<td style="text-align: right;">631.4181</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">0.9406705</td>
<td style="text-align: right;">0.9436854</td>
<td style="text-align: right;">0.9544120</td>
<td style="text-align: right;">0.9862901</td>
<td style="text-align: right;">0.0814209</td>
<td style="text-align: right;">0.0759304</td>
<td style="text-align: right;">0.0870395</td>
<td style="text-align: right;">175790.7</td>
<td style="text-align: right;">176027.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">two_latents_eth_metric</td>
<td style="text-align: right;">146.8837</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">0.9848628</td>
<td style="text-align: right;">0.9880193</td>
<td style="text-align: right;">0.9911571</td>
<td style="text-align: right;">0.9968735</td>
<td style="text-align: right;">0.0375549</td>
<td style="text-align: right;">0.0315677</td>
<td style="text-align: right;">0.0437721</td>
<td style="text-align: right;">175312.2</td>
<td style="text-align: right;">175568.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">three_latents_eth_metric</td>
<td style="text-align: right;">101.6930</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0.9883971</td>
<td style="text-align: right;">0.9915649</td>
<td style="text-align: right;">0.9943766</td>
<td style="text-align: right;">0.9978055</td>
<td style="text-align: right;">0.0315116</td>
<td style="text-align: right;">0.0250581</td>
<td style="text-align: right;">0.0382135</td>
<td style="text-align: right;">175273.0</td>
<td style="text-align: right;">175549.2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This table presents the results of a multi-group confirmatory factor analysis (CFA) conducted to test metric equivalence (also known as weak measurement invariance) across different ethnic categories (eth_cat).</p>
<p>The three factor model wins again.</p>
</section>
<section id="scalar-equivalence" class="level3">
<h3 class="anchored" data-anchor-id="scalar-equivalence">Scalar Equivalence</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view as html table</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>compare_eth_scalar <span class="ot">&lt;-</span> compare_eth_scalar[, <span class="fu">c</span>(<span class="st">"Name"</span>, <span class="st">"Chi2"</span>, <span class="st">"Chi2_df"</span>,<span class="st">"RFI"</span>, <span class="st">"NNFI"</span>, <span class="st">"CFI"</span>,<span class="st">"GFI"</span>,<span class="st">"RMSEA"</span>, <span class="st">"RMSEA_CI_low"</span>, <span class="st">"RMSEA_CI_high"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>)]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(compare_eth_scalar)<span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: right;">Chi2</th>
<th style="text-align: right;">Chi2_df</th>
<th style="text-align: right;">RFI</th>
<th style="text-align: right;">NNFI</th>
<th style="text-align: right;">CFI</th>
<th style="text-align: right;">GFI</th>
<th style="text-align: right;">RMSEA</th>
<th style="text-align: right;">RMSEA_CI_low</th>
<th style="text-align: right;">RMSEA_CI_high</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">one_latent_eth_scalar</td>
<td style="text-align: right;">669.8690</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">0.9464990</td>
<td style="text-align: right;">0.9495325</td>
<td style="text-align: right;">0.9519357</td>
<td style="text-align: right;">0.9854887</td>
<td style="text-align: right;">0.0770781</td>
<td style="text-align: right;">0.0720058</td>
<td style="text-align: right;">0.0822646</td>
<td style="text-align: right;">175817.2</td>
<td style="text-align: right;">176014.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">two_latents_eth_scalar</td>
<td style="text-align: right;">177.4574</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">0.9842521</td>
<td style="text-align: right;">0.9874065</td>
<td style="text-align: right;">0.9892056</td>
<td style="text-align: right;">0.9961614</td>
<td style="text-align: right;">0.0385033</td>
<td style="text-align: right;">0.0329544</td>
<td style="text-align: right;">0.0442492</td>
<td style="text-align: right;">175332.8</td>
<td style="text-align: right;">175556.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">three_latents_eth_scalar</td>
<td style="text-align: right;">128.2153</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0.9871996</td>
<td style="text-align: right;">0.9903636</td>
<td style="text-align: right;">0.9926580</td>
<td style="text-align: right;">0.9971838</td>
<td style="text-align: right;">0.0336809</td>
<td style="text-align: right;">0.0277002</td>
<td style="text-align: right;">0.0398839</td>
<td style="text-align: right;">175291.5</td>
<td style="text-align: right;">175541.4</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Overall, it seems that we have good evidence for the three-factor model of Kessler-6, but two-factor is close.</p>
<p>Consider: when might we prefer a two-factor model? When might we prefer a three-factor model? When might we prefer a one-factor model?</p>
</section>
<section id="conclusion-understanding-the-limits-of-association-in-factor-models" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-understanding-the-limits-of-association-in-factor-models">Conclusion: Understanding the Limits of Association in Factor Models</h3>
<p>This discussion of measurement invariance across different demographic groups underscores the reliance of factor models on the underlying associations in the data. It is crucial to remember that these models are fundamentally descriptive, not prescriptive; they organize the observed data into a coherent structure based on correlations and assumed relationships among variables.</p>
<p>Next week, we will consider the causal assumptions inherent in these factor models. Factor analysis assumes that the latent variables (factors) causally influence the observed indicators. This is a stron assumption that can profoundly affect the interpretation of the results. Understanding and critically evaluating our assumptions is important when applying factor analysis to real-world scenarios.</p>
<p>The assumption that latent variables cause the observed indicators, rather than merely being associated with them, suggests a directional relationship that can affect decisions made based on the analysis. For instance, if we believe that a latent construct like psychological distress causally influences responses on the K6 scale, interventions might be designed to target this distress directly. However, if the relationship is more complex or bidirectional, such straightforward interventions might not be as effective.</p>
<p>Next week’s session on causal assumptions will provide a deeper insight into how these assumptions shape our interpretations and the strategies we derive from factor models. This understanding is critical for applying these models appropriately and effectively in psychological research and practice.</p>
</section>
<section id="lab-assignment" class="level3">
<h3 class="anchored" data-anchor-id="lab-assignment">Lab assignment</h3>
<p>Using the code above, perform MG-CFA on personality measures using the <code>df_nz</code> data set.</p>
</section>
</section>
<section id="appendix-a.-what-is-a-correlation-matrix" class="level2">
<h2 class="anchored" data-anchor-id="appendix-a.-what-is-a-correlation-matrix">Appendix A. What is a Correlation Matrix?</h2>
<p>A correlation matrix is a square matrix that contains the Pearson correlation coefficients between each pair of variables within a dataset. Each element in the matrix represents the correlation between two variables.</p>
<section id="structure" class="level4">
<h4 class="anchored" data-anchor-id="structure">Structure</h4>
<ul>
<li><strong>Dimensions</strong>: the matrix is <span class="math inline">p \times p</span> where <span class="math inline">p</span> is the number of variables.</li>
<li><strong>Diagonal Elements</strong>: all diagonal elements are 1, because each variable has a perfect correlation with itself.</li>
<li><strong>Off-Diagonal Elements</strong>: These elements, denoted as <span class="math inline">r_{ij}</span>, are the Pearson correlation coefficients between the <span class="math inline">i^{th}</span> and <span class="math inline">j^{th}</span> variables, ranging from -1 to +1.
<ul>
<li><span class="math inline">r_{ij} = 1</span> indicates a perfect positive linear relationship.</li>
<li><span class="math inline">r_{ij} = -1</span> indicates a perfect negative linear relationship.</li>
<li><span class="math inline">r_{ij} = 0</span> indicates no linear relationship.</li>
</ul></li>
</ul>
</section>
<section id="properties" class="level4">
<h4 class="anchored" data-anchor-id="properties">Properties</h4>
<ul>
<li><strong>Symmetry</strong>: the matrix is symmetric around the diagonal, meaning <span class="math inline">r_{ij} = r_{ji}</span>.</li>
<li><strong>Real Values</strong>: all entries are real numbers.</li>
<li><strong>Bounded Values</strong>: values are constrained between -1 and 1, inclusive.</li>
</ul>
</section>
<section id="use" class="level4">
<h4 class="anchored" data-anchor-id="use">Use</h4>
<ul>
<li>Exploring relationships between variables.</li>
<li>Conducting factor analysis to identify latent factors, as here.</li>
<li>…</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the correlation matrix</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>dt_only_k6 <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    kessler_depressed,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    kessler_effort,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    kessler_hopeless,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    kessler_worthless,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    kessler_nervous,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    kessler_restless</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(dt_only_k6, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>( cor_matrix, <span class="dv">2</span>) </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  kessler_depressed kessler_effort kessler_hopeless
kessler_depressed              1.00           0.50             0.68
kessler_effort                 0.50           1.00             0.53
kessler_hopeless               0.68           0.53             1.00
kessler_worthless              0.68           0.50             0.67
kessler_nervous                0.42           0.45             0.47
kessler_restless               0.38           0.46             0.41
                  kessler_worthless kessler_nervous kessler_restless
kessler_depressed              0.68            0.42             0.38
kessler_effort                 0.50            0.45             0.46
kessler_hopeless               0.67            0.47             0.41
kessler_worthless              1.00            0.46             0.39
kessler_nervous                0.46            1.00             0.46
kessler_restless               0.39            0.46             1.00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>cor_matrix_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cor_matrix)  <span class="co"># convert matrix to data frame</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>cor_matrix_df<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cor_matrix_df)  <span class="co"># add a new column for rownames</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>long_cor_matrix <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(cor_matrix_df, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cols =</span> <span class="sc">-</span>variable, </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">names_to =</span> <span class="st">"comparison"</span>, </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">values_to =</span> <span class="st">"correlation"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_cor_matrix, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> comparison, <span class="at">fill =</span> correlation)) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Variables"</span>, <span class="at">fill =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11-content_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - Barrett M (2021). _ggokabeito: 'Okabe-Ito' Scales for 'ggplot2' and 'ggraph'_. R package version 0.1.0, &lt;https://CRAN.R-project.org/package=ggokabeito&gt;.
  - Bulbulia J (2024). _margot: MARGinal Observational Treatment-effects_. doi:10.5281/zenodo.10907724 &lt;https://doi.org/10.5281/zenodo.10907724&gt;, R package version 0.3.1.0 Functions to obtain MARGinal Observational Treatment-effects from observational data., &lt;https://go-bayes.github.io/margot/&gt;.
  - Chang W (2023). _extrafont: Tools for Using Fonts_. R package version 0.19, &lt;https://CRAN.R-project.org/package=extrafont&gt;.
  - Firke S (2024). _janitor: Simple Tools for Examining and Cleaning Dirty Data_. R package version 2.2.1, &lt;https://CRAN.R-project.org/package=janitor&gt;.
  - Greifer N (2024). _WeightIt: Weighting for Covariate Balance in Observational Studies_. R package version 1.3.2, &lt;https://CRAN.R-project.org/package=WeightIt&gt;.
  - Grolemund G, Wickham H (2011). "Dates and Times Made Easy with lubridate." _Journal of Statistical Software_, *40*(3), 1-25. &lt;https://www.jstatsoft.org/v40/i03/&gt;.
  - Lüdecke D, Ben-Shachar M, Patil I, Makowski D (2020). "Extracting, Computing and Exploring the Parameters of Statistical Models using R." _Journal of Open Source Software_, *5*(53), 2445. doi:10.21105/joss.02445 &lt;https://doi.org/10.21105/joss.02445&gt;.
  - Lüdecke D, Ben-Shachar M, Patil I, Waggoner P, Makowski D (2021). "performance: An R Package for Assessment, Comparison and Testing of Statistical Models." _Journal of Open Source Software_, *6*(60), 3139. doi:10.21105/joss.03139 &lt;https://doi.org/10.21105/joss.03139&gt;.
  - Müller K, Wickham H (2023). _tibble: Simple Data Frames_. R package version 3.2.1, &lt;https://CRAN.R-project.org/package=tibble&gt;.
  - Patil I, Makowski D, Ben-Shachar M, Wiernik B, Bacher E, Lüdecke D (2022). "datawizard: An R Package for Easy Data Preparation and Statistical Transformations." _Journal of Open Source Software_, *7*(78), 4684. doi:10.21105/joss.04684 &lt;https://doi.org/10.21105/joss.04684&gt;.
  - Pedersen T (2024). _patchwork: The Composer of Plots_. R package version 1.3.0, &lt;https://CRAN.R-project.org/package=patchwork&gt;.
  - R Core Team (2024). _R: A Language and Environment for Statistical Computing_. R Foundation for Statistical Computing, Vienna, Austria. &lt;https://www.R-project.org/&gt;.
  - Rosseel Y (2012). "lavaan: An R Package for Structural Equation Modeling." _Journal of Statistical Software_, *48*(2), 1-36. doi:10.18637/jss.v048.i02 &lt;https://doi.org/10.18637/jss.v048.i02&gt;.
  - VanderWeele TJ, Ding P (2011). "Sensitivity analysis in observational research: introducing the E-value." _Annals of Internal Medicine_, *167*(4), 268-274. Mathur MB, VanderWeele TJ (2019). "Sensitivity analysis for unmeasured confounding in meta-analyses." _Journal of the American Statistical Association&gt;_. Smith LH, VanderWeele TJ (2019). "Bounding bias due to selection." _Epidemiology_.
  - Wickham H (2016). _ggplot2: Elegant Graphics for Data Analysis_. Springer-Verlag New York. ISBN 978-3-319-24277-4, &lt;https://ggplot2.tidyverse.org&gt;.
  - Wickham H (2023). _forcats: Tools for Working with Categorical Variables (Factors)_. R package version 1.0.0, &lt;https://CRAN.R-project.org/package=forcats&gt;.
  - Wickham H (2023). _stringr: Simple, Consistent Wrappers for Common String Operations_. R package version 1.5.1, &lt;https://CRAN.R-project.org/package=stringr&gt;.
  - Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). "Welcome to the tidyverse." _Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 &lt;https://doi.org/10.21105/joss.01686&gt;.
  - Wickham H, François R, Henry L, Müller K, Vaughan D (2023). _dplyr: A Grammar of Data Manipulation_. R package version 1.1.4, &lt;https://CRAN.R-project.org/package=dplyr&gt;.
  - Wickham H, Henry L (2023). _purrr: Functional Programming Tools_. R package version 1.0.2, &lt;https://CRAN.R-project.org/package=purrr&gt;.
  - Wickham H, Hester J, Bryan J (2024). _readr: Read Rectangular Text Data_. R package version 2.1.5, &lt;https://CRAN.R-project.org/package=readr&gt;.
  - Wickham H, Vaughan D, Girlich M (2024). _tidyr: Tidy Messy Data_. R package version 1.3.1, &lt;https://CRAN.R-project.org/package=tidyr&gt;.
  - William Revelle (2024). _psych: Procedures for Psychological, Psychometric, and Personality Research_. Northwestern University, Evanston, Illinois. R package version 2.4.12, &lt;https://CRAN.R-project.org/package=psych&gt;.
  - Xie Y (2024). _knitr: A General-Purpose Package for Dynamic Report Generation in R_. R package version 1.49, &lt;https://yihui.org/knitr/&gt;. Xie Y (2015). _Dynamic Documents with R and knitr_, 2nd edition. Chapman and Hall/CRC, Boca Raton, Florida. ISBN 978-1498716963, &lt;https://yihui.org/knitr/&gt;. Xie Y (2014). "knitr: A Comprehensive Tool for Reproducible Research in R." In Stodden V, Leisch F, Peng RD (eds.), _Implementing Reproducible Computational Research_. Chapman and Hall/CRC. ISBN 978-1466561595.
  - Xie Y (2024). _tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents_. R package version 0.54, &lt;https://github.com/rstudio/tinytex&gt;. Xie Y (2019). "TinyTeX: A lightweight, cross-platform, and easy-to-maintain LaTeX distribution based on TeX Live." _TUGboat_, *40*(1), 30-32. &lt;https://tug.org/TUGboat/Contents/contents40-1.html&gt;.
  - Zhu H (2024). _kableExtra: Construct Complex Table with 'kable' and Pipe Syntax_. R package version 1.4.0, &lt;https://CRAN.R-project.org/package=kableExtra&gt;.</code></pre>
</div>
</div>
</section>
</section>
<section id="part-2.-how-traditional-measurement-theory-fails" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="part-2.-how-traditional-measurement-theory-fails">PART 2. How Traditional Measurement Theory Fails</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Required</strong></p>
<ul>
<li><span class="citation" data-cites="vanderweele2022">(<a href="#ref-vanderweele2022" role="doc-biblioref">Tyler J. VanderWeele 2022</a>)</span> <a href="https://www.dropbox.com/scl/fi/mmyguc0hrci8wtyyfkv6w/tyler-vanderweele-contruct-measures.pdf?rlkey=o18fiyajdqqpyjgssyh6mz6qm&amp;dl=0">link</a></li>
</ul>
<p><strong>Suggested</strong></p>
<ul>
<li><span class="citation" data-cites="harkness2003questionnaire">(<a href="#ref-harkness2003questionnaire" role="doc-biblioref">J. A. Harkness, Van de Vijver, and Johnson 2003</a>)</span> <a href="https://www.dropbox.com/scl/fi/uhj73050r1i7rznn6i57f/HarknessvandeVijver2003_Chapter-2.pdf?rlkey=ijxobrh7czj3rfnq9air342d2&amp;dl=0">link</a></li>
</ul>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="ref-harkness2003questionnaire" class="csl-entry" role="listitem">
Harkness, Janet A, Fons JR Van de Vijver, and Timothy P Johnson. 2003. <span>“Questionnaire Design in Comparative Research.”</span> <em>Cross-Cultural Survey Methods</em>, 19–34.
</div></div><div class="no-row-height column-margin column-container"></div><div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The Formative Model in Factor Analysis</li>
<li>The Reflective Model in Factor Analysis</li>
<li>How to use causal Diagrams to evaluate assumptions.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Understanding causal assumptions of measurement theory</li>
<li>Guidance on your final assessment.</li>
</ul>
</div>
</div>
</section>
<section id="overview-1" class="level2">
<h2 class="anchored" data-anchor-id="overview-1">Overview</h2>
<p>By the end of this lecture you will:</p>
<ol type="1">
<li><p>Understand the causal assumptions implied by the factor analytic interpretation of the formative and reflective models.</p></li>
<li><p>Be able to distinguish between statistical and structural interpretations of these models.</p></li>
<li><p>Understand why Vanderweele thinks consistent causal estimation is possible using the theory of multiple versions of treatments for constructs with multiple indicators</p></li>
</ol>
</section>
<section id="two-ways-of-thinking-about-measurement-in-psychometric-research." class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="two-ways-of-thinking-about-measurement-in-psychometric-research.">Two ways of thinking about measurement in psychometric research.</h2>
<p>In psychometric research, formative and reflective models describe the relationship between latent variables and their respective indicators. VanderWeele discusses this in the assigned reading for this week <span class="citation" data-cites="vanderweele2022">(<a href="#ref-vanderweele2022" role="doc-biblioref">Tyler J. VanderWeele 2022</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-vanderweele2022" class="csl-entry" role="listitem">
VanderWeele, Tyler J. 2022. <span>“Constructed Measures and Causal Inference: Towards a New Model of Measurement for Psychosocial Constructs.”</span> <em>Epidemiology</em> 33 (1): 141. <a href="https://doi.org/10.1097/EDE.0000000000001434">https://doi.org/10.1097/EDE.0000000000001434</a>.
</div></div><section id="reflective-model-factor-analysis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="reflective-model-factor-analysis">Reflective Model (Factor Analysis)</h3>
<p>In a reflective measurement model, also known as an effect indicator model, the latent variable is understood to cause the observed variables. In this model, changes in the latent variable cause changes in the observed variables. Each indicator (observed variable) is a ‘reflection’ of the latent variable. In other words, they are effects or manifestations of the latent variable. These relations are presented in <a href="#fig-dag-latent-1" class="quarto-xref">Figure&nbsp;1</a>.</p>
<p>The reflective model may be expressed:</p>
<p><span class="math display">X_i = \lambda_i \eta + \varepsilon_i</span></p>
<p>Here, <span class="math inline">X_i</span> is an observed variable (indicator), <span class="math inline">\lambda_i</span> is the factor loading for <span class="math inline">X_i</span>, <span class="math inline">\eta</span> is the latent variable, and <span class="math inline">\varepsilon_i</span> is the error term associated with <span class="math inline">X_i</span>. It is assumed that all the indicators are interchangeable and have a common cause, which is the latent variable <span class="math inline">\eta</span>.</p>
<p>In the conventional approach of factor analysis, the assumption is that a common latent variable is responsible for the correlation seen among the indicators. Thus, any fluctuation in the latent variable should immediately lead to similar changes in the indicators.These assumptions are presented in <a href="#fig-dag-latent-1" class="quarto-xref">Figure&nbsp;1</a>.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-latent-1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-latent-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-latent-1-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-latent-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Reflective model: assume univariate latent variable η giving rise to indicators X1…X3. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-formative-model-factor-analysis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-formative-model-factor-analysis">The Formative Model (Factor Analysis)</h3>
<p>In a formative measurement model, the observed variables are seen as causing or determining the latent variable. Here again, there is a single latent variable. However this latent variable is taken to be an effect of the underlying indicators. These relations are presented in <a href="#fig-dag-latent-formative_0" class="quarto-xref">Figure&nbsp;2</a>.</p>
<p>The formative model may be expressed:</p>
<p><span class="math display">\eta = \sum_i\lambda_i X_i + \varepsilon</span></p>
<p>In this equation, <span class="math inline">\eta</span> is the latent variable, <span class="math inline">\lambda_i</span> is the weight for <span class="math inline">X_i</span> (the observed variable), and <span class="math inline">\varepsilon</span> is the error term. The latent variable <span class="math inline">\eta</span> is a composite of the observed variables <span class="math inline">X_i</span>.</p>
<p>In the context of a formative model, correlation or interchangeability between indicators is not required. Each indicator contributes distinctively to the latent variable. As such, a modification in one indicator doesn’t automatically imply a corresponding change in the other indicators.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-latent-formative_0" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-latent-formative_0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-latent-formative_0-1.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-latent-formative_0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Formative model:: assume univariate latent variable from which the indicators X1…X3 give rise. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="structural-interpretation-of-the-formative-model-and-reflective-models-factor-analysis" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="structural-interpretation-of-the-formative-model-and-reflective-models-factor-analysis">Structural Interpretation of the formative model and reflective models (Factor Analysis)</h2>
<blockquote class="blockquote">
<p>However, this analysis of reflective and formative models assumed that the latent η was causally efficacious. This may not be the case (VanderWeele 2022)</p>
</blockquote>
<p>VanderWeele distinguishes between statistical and structural interpretations of the equations preesented above.</p>
<ol type="1">
<li><p><strong>Statistical Model:</strong> a mathematical construct that shows how observable variables, also known as indicators, are related to latent or unseen variables. These are presented in the equations above</p></li>
<li><p><strong>Structural Model:</strong> A structural model refers to the causal assumptions or hypotheses about the relationships among variables in a statistical model. The assumptions of the factor analytic tradition are presented in <a href="#fig-dag-latent-formative_0" class="quarto-xref">Figure&nbsp;2</a> and <a href="#fig-dag-latent-1" class="quarto-xref">Figure&nbsp;1</a> are structural models.</p></li>
</ol>
<p>We have seen that the <strong>reflective model</strong> statistically implies that the observed variables (indicators) are reflections or manifestations of the latent variable, expressed as <span class="math inline">X_i = \lambda_i \eta + \varepsilon_i</span>. However, the factor analytic tradition makes the additional structural assumption that a univariate latent variable is causally efficacious and influences the observed variables, as in: <a href="#fig-structural-assumptions-reflective-model" class="quarto-xref">Figure&nbsp;3 (a)</a>.</p>
<p>We have also seen that the <strong>formative model</strong> statistically implies that the latent variable is formed or influenced by the observed variables, expressed as <span class="math inline">\eta = \sum_i\lambda_i X_i + \varepsilon</span>. However, the factor analytic tradition makes the additional assumption that the observed variables give rise to a univariate latent variable, as in <a href="#fig-dag-reflective-assumptions_note" class="quarto-xref">Figure&nbsp;3 (b)</a>.</p>
<div id="fig-latent" class="quarto-layout-panel page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-latent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row page-full">
<div class="cell quarto-layout-cell-subref quarto-layout-cell page-columns page-full" data-ref-parent="fig-latent" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="cell-output-display quarto-layout-cell-subref page-columns page-full" data-ref-parent="fig-latent">
<div id="fig-structural-assumptions-reflective-model" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-subfloat-fig figure page-columns page-full">
<div aria-describedby="fig-structural-assumptions-reflective-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-structural-assumptions-reflective-model-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-latent">
</div>
<figcaption class="quarto-float-caption-margin quarto-subfloat-caption quarto-subfloat-fig margin-caption" id="fig-structural-assumptions-reflective-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Reflective Model: causal assumptions. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="cell quarto-layout-cell-subref quarto-layout-cell page-columns page-full" data-ref-parent="fig-latent" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="cell-output-display quarto-layout-cell-subref page-columns page-full" data-ref-parent="fig-latent">
<div id="fig-dag-reflective-assumptions_note" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-subfloat-fig figure page-columns page-full">
<div aria-describedby="fig-dag-reflective-assumptions_note-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-reflective-assumptions_note-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-latent">
</div>
<figcaption class="quarto-float-caption-margin quarto-subfloat-caption quarto-subfloat-fig margin-caption" id="fig-dag-reflective-assumptions_note-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Formative model: causal assumptions. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>The reflective model implies <span class="math inline">X_i = \lambda_i \eta + \varepsilon_i</span>, which factor analysts take to imply <a href="#fig-structural-assumptions-reflective-model" class="quarto-xref">Figure&nbsp;3 (a)</a>.</p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-latent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The formative model implies <span class="math inline">\eta = \sum_i\lambda_i X_i + \varepsilon</span>, which factor analysts take to imply <a href="#fig-dag-reflective-assumptions_note" class="quarto-xref">Figure&nbsp;3 (b)</a>.
</figcaption>
</figure>
</div>
</section>
<section id="problems-with-the-structural-interpretations-of-the-reflective-and-formative-factor-models." class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="problems-with-the-structural-interpretations-of-the-reflective-and-formative-factor-models.">Problems with the structural interpretations of the reflective and formative factor models.</h2>
<p>While the statistical model <span class="math inline">X_i = \lambda_i \eta + \varepsilon_i</span> aligns with <a href="#fig-structural-assumptions-reflective-model" class="quarto-xref">Figure&nbsp;3 (a)</a>, it also alings with <a href="#fig-dag-formative-assumptions-compatible" class="quarto-xref">Figure&nbsp;4</a>. Cross-sectional data, unfortunately, do not provide enough information to discern between these different structural interpretations.</p>
<p>Similarly, the statistical model <span class="math inline">\eta = \sum_i\lambda_i X_i + \varepsilon</span> agrees with <a href="#fig-dag-reflective-assumptions_note" class="quarto-xref">Figure&nbsp;3 (b)</a> but it also agrees with@fig-dag-reflectiveassumptions-compatible_again. Here too, cross-sectional data cannot decide between these two potential structural interpretations.</p>
<p>There are other, compatible structural interprestations as well. The formative and reflective conceptions of factor analysis are compatible with indicators having causal effects as shown in <span class="citation" data-cites="fig_dag_multivariate_reality_again">(<a href="#ref-fig_dag_multivariate_reality_again" role="doc-biblioref"><strong>fig_dag_multivariate_reality_again?</strong></a>)</span>. They are also compatible with a multivariate reality giving rise to multiple indicators as shown in <a href="#fig-dag-multivariate-reality-bulbulia" class="quarto-xref">Figure&nbsp;6</a>.</p>
<div class="quarto-layout-panel page-columns page-full" data-layout-ncol="1">
<div class="quarto-layout-row page-full">
<div class="cell quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-formative-assumptions-compatible" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-formative-assumptions-compatible-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-formative-assumptions-compatible-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-formative-assumptions-compatible-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Formative model is compatible with indicators causing outcome.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="cell quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-reflectiveassumptions-compatible_again" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-reflectiveassumptions-compatible_again-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-reflectiveassumptions-compatible_again-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-reflectiveassumptions-compatible_again-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Reflective model is compatible with indicators causing the outcome. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="cell quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="11-content_files/figure-html/fig_dag_multivariate_reality_again-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="margin-caption">Multivariate reality gives rise to the indicators, from which we draw our measures. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="cell quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-multivariate-reality-bulbulia" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-multivariate-reality-bulbulia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-multivariate-reality-bulbulia-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-multivariate-reality-bulbulia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Although we take our constructs, A, to be functions of indicators, X, such that, perhaps only one or several of the indicators are efficacious.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>VanderWeele’s key observation is this:</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p><strong>While cross-sectional data can provide insights into the relationships between variables, they cannot conclusively determine the causal direction of these relationships.</strong></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>This results is worrying. The structural assumptions of factor analysis underpin nearly all psychological research. If the cross-sectional data used to derive factor structures cannot decide whether the structural interpretations of factor models are accurate, where does that leave us?</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>More worrying still, VanderWeele discusses several longitudinal tests for structural interpretations of univariate latent variables that do not pass.</p>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>Where does that leave us? In psychology we have heard about a replication crisis. We might describe the reliance on factor models as an aspect of a much larger, and more worrying “causal crisis” <span class="citation" data-cites="bulbulia2022">(<a href="#ref-bulbulia2022" role="doc-biblioref">Bulbulia 2023</a>)</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-bulbulia2022" class="csl-entry" role="listitem">
Bulbulia, Joseph A. 2023. <span>“A Workflow for Causal Inference in Cross-Cultural Psychology.”</span> <em>Religion, Brain &amp; Behavior</em> 13 (3): 291–306. <a href="https://doi.org/10.1080/2153599X.2022.2070245">https://doi.org/10.1080/2153599X.2022.2070245</a>.
</div></div></div>
</div>
</div>
</section>
<section id="review-of-the-theory-of-multiple-versions-of-treatment" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="review-of-the-theory-of-multiple-versions-of-treatment">Review of the theory of multiple versions of treatment</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="11-content_files/figure-html/fig_dag_multiple_version_treatment_dag-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="margin-caption">Multiple Versions of treatment. Heae, A is regarded to bbe a coarseneed version of K</figcaption>
</figure>
</div>
</div>
</div>
<p>Perhaps not all is lost. VanderWeele looks to the theory of multiple versions of treatment for solace.</p>
<p>Recall, a causal effect is defined as the difference in the expected potential outcome when everyone is exposed (perhaps contrary to fact) to one level of a treatment, conditional on their levels of a confounder, with the expected potential outcome when everyone is exposed to a a different level of a treatement (perhaps contrary to fact), conditional on their levels of a counfounder.</p>
<p><span class="math display"> \delta = \sum_l \left( \mathbb{E}[Y|A=a,l] - \mathbb{E}[Y|A=a^*,l] \right) P(l)</span></p>
<p>where <span class="math inline">\delta</span> is the causal estimand on the difference scale <span class="math inline">(\mathbb{E}[Y^0 - Y^0])</span>.</p>
<p>In causal inference, the multiple versions of treatment theory allows us to handle situations where the treatment isn’t uniform, but instead has several variations. Each variation of the treatment, or “version”, can have a different impact on the outcome. Consistency is not violated because it is redefined: for each version of the treatment, the outcome under that version is equal to the observed outcome when that version is received. Put differently we may think of the indicator <span class="math inline">A</span> as corresponding to many version of the true treament <span class="math inline">K</span>. Where conditional independence holds such that there is a absence of confounding for the effect of <span class="math inline">K</span> on <span class="math inline">Y</span> given <span class="math inline">L</span>, we have: <span class="math inline">Y_k \coprod A|K,L</span>. This states conditional on <span class="math inline">L</span>, <span class="math inline">A</span> gives no information about <span class="math inline">Y</span> once <span class="math inline">K</span> and <span class="math inline">L</span> are accounted for. When <span class="math inline">Y = Y_k</span> if <span class="math inline">K = k</span> and Y<span class="math inline">_k</span> is independent of <span class="math inline">K</span>, condition on <span class="math inline">L</span>, then <span class="math inline">A</span> may be thought of as a coarsened indicator of <span class="math inline">K</span>, as shown in <span class="citation" data-cites="fig_dag_multiple_version_treatment_dag">(<a href="#ref-fig_dag_multiple_version_treatment_dag" role="doc-biblioref"><strong>fig_dag_multiple_version_treatment_dag?</strong></a>)</span>. We may estimate consistent causal effects where:</p>
<p><span class="math display"> \delta = \sum_{k,l} \mathbb{E}[Y_k|l] P(k|a,l) P(l) - \sum_{k,l} \mathbb{E}[Y_k|l] P(k|a^*,l) P(l)</span></p>
<p>The scenario represents a hypothetical randomised trial where within strata of covariates <span class="math inline">L</span>, individuals in one group receive a treatment <span class="math inline">K</span> version randomly assigned from the distribution of <span class="math inline">K</span> distribution <span class="math inline">(A = 1, L = l)</span> sub-population. Meanwhile, individuals in the other group receive a randomly assigned <span class="math inline">K</span> version from <span class="math inline">(A = 0, L = l)</span></p>
<p>This theory finds its utility in practical scenarios where treatments seldom resemble each other – we discussed the example of obesity last week (see: <span class="citation" data-cites="vanderweele2013">(<a href="#ref-vanderweele2013" role="doc-biblioref">Tyler J. VanderWeele and Hernan 2013</a>)</span>).</p>
<div class="no-row-height column-margin column-container"><div id="ref-vanderweele2013" class="csl-entry" role="listitem">
VanderWeele, Tyler J, and Miguel A Hernan. 2013. <span>“Causal Inference Under Multiple Versions of Treatment.”</span> <em>Journal of Causal Inference</em> 1 (1): 1–20.
</div></div><section id="reflective-and-formative-measurement-models-may-be-approached-as-multiple-versions-of-treatment" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="reflective-and-formative-measurement-models-may-be-approached-as-multiple-versions-of-treatment">Reflective and formative measurement models may be approached as multiple versions of treatment</h3>
<p>Vanderweele applies the following substitution:</p>
<p><span class="math display">\delta = \sum_{\eta,l} \mathbb{E}[Y_\eta|l] P(\eta|A=a+1,l) P(l) - \sum_{\eta,l} \mathbb{E}[Y_\eta|l] P(\eta|A=a,l) P(l)</span></p>
<p>Specifically, we substitue <span class="math inline">K</span> with <span class="math inline">\eta</span> from the previous section, and compare the measurement response <span class="math inline">A = a + 1</span> with <span class="math inline">A = a</span>. We discover that if the influence of <span class="math inline">\eta</span> on <span class="math inline">Y</span> is not confounded given <span class="math inline">L</span>, then the multiple versions of reality consistent with the reflective and formative statistical models of reality will not lead to biased estimation. <span class="math inline">\delta</span> retains its interpretability as a comparison in a hypothetical randomised trial in which the distribution of coarsened measures of <span class="math inline">\eta_A</span> are balanced within levels of the treatment, conditional on <span class="math inline">\eta_L</span>.</p>
<p>This connection between measurement and the multiple versions of treatment framework provides a hope for consistent causal inference varying reliabilities of measurement.</p>
<p>However, as with the theory of multiple treatments, we might not known how to interpret our results because we don’t know the true relationships between our measured indicators and underlying reality.</p>
<p>How can we do better?</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-multiple-version-treatment-applied-measurement" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-multiple-version-treatment-applied-measurement-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-multiple-version-treatment-applied-measurement-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-multiple-version-treatment-applied-measurement-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Multiple Versions of treatment applied to measuremen.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="vanderweeles-model-of-reality" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="vanderweeles-model-of-reality">VanderWeele’s model of reality</h2>
<p>VanderWeele’s article concludes as follows:</p>
<blockquote class="blockquote">
<p>A preliminary outline of a more adequate approach to the construction and use of psychosocial measures might thus be summarized by the following propositions, that I have argued for in this article: (1) Traditional univariate reflective and formative models do not adequately capture the relations between the underlying causally relevant phenomena and our indicators and measures. (2) The causally relevant constituents of reality related to our constructs are almost always multidimensional, giving rise both to our indicators from which we construct measures, and also to our language and concepts, from which we can more precisely define constructs. (3) In measure construction, we ought to always specify a definition of the underlying construct, from which items are derived, and by which analytic relations of the items to the definition are made clear. (4) The presumption of a structural univariate reflective model impairs measure construction, evaluation, and use. (5) If a structural interpretation of a univariate reflective factor model is being proposed this should be formally tested, not presumed; factor analysis is not sufficient for assessing the relevant evidence. (6) Even when the causally relevant constituents of reality are multidimensional, and a univariate measure is used, we can still interpret associations with outcomes using theory for multiple versions of treatment, though the interpretation is obscured when we do not have a clear sense of what the causally relevant constituents are. (7) When data permit, examining associations item-by-item, or with conceptually related item sets, may give insight into the various facets of the construct.</p>
</blockquote>
<blockquote class="blockquote">
<p>A new integrated theory of measurement for psychosocial constructs is needed in light of these points – one that better respects the relations between our constructs, items, indicators, measures, and the underlying causally relevant phenomena. (VanderWeele 2022)</p>
</blockquote>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-multivariate-reality-complete" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-multivariate-reality-complete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-multivariate-reality-complete-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-multivariate-reality-complete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Multivariate reality gives rise to the latent variables.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434
</figcaption>
</figure>
</div>
</div>
</div>
<p>This seems to me sensible. However, <a href="#fig-dag-multivariate-reality-complete" class="quarto-xref">Figure&nbsp;8</a> this is not a causal graph. The arrows to not clearly represent causal relations. It leaves me unclear about what to practically do.</p>
<p>Let’s return to the three wave many-outcomes model described in previous weeks. How should we revise this model in light of measurement theory?</p>
</section>
<section id="how-theory-of-dependent-and-directed-measurement-error-might-be-usefully-employed-to-develop-a-pragmatic-responses-to-construct-measurement" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="how-theory-of-dependent-and-directed-measurement-error-might-be-usefully-employed-to-develop-a-pragmatic-responses-to-construct-measurement">How theory of dependent and directed measurement error might be usefully employed to develop a pragmatic responses to construct measurement</h2>
<p>By now you are all familiar with The New Zealand Attitudes and Values Study (NZAVS),which is a national probability survey collects a wide range of information, including data on distress, exercise habits, and cultural backgrounds.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-uu-null" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-uu-null-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-uu-null-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-uu-null-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Uncorrelated non-differential measurement error does not bias estimates under the null. Note, however, we assume that L is measured with sufficient precision to block the path from A_eta –&gt; L_eta –&gt; Y_eta, which, otherwise, we would assume to be open.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Consider a study that seeks to use this dataset to investigate the effect of regular exercise on psychological distress. In contrast to previous graphs, let us allow for latent reality to affect our measurements, as well as the discrepencies between our measurements and true underlying reality. We shall use <a href="#fig-dag-uu-null" class="quarto-xref">Figure&nbsp;9</a> as our initial guide.</p>
<p>We represent the true exercise by <span class="math inline">\eta_A</span>. We represent true psychological distress by <span class="math inline">\eta_Y</span>. Let <span class="math inline">\eta_L</span> denote a persons true workload, and assume that this state of work affects both levels of excercise and psychological distress.</p>
<p>To bring the model into contact with measurement theory, Let us describe measurements of these latent true underlying realities as functions of multiple indicators: <span class="math inline">L_{f(X_1\dots X_n)}</span>, <span class="math inline">A_{f(X_1\dots X_n)}</span>, and <span class="math inline">A_{f(X_1\dots X_n)}</span>. These constructs are measured realisations of the underlying true states. We assume that the true states of these variables affect their corresponding measured states, and so draw arrows from <span class="math inline">\eta_L\rightarrow{L_{f(X_1\dots X_n)}}</span>, <span class="math inline">\eta_A\rightarrow{A_{f(X_1\dots X_n)}}</span>, <span class="math inline">\eta_Y\rightarrow{Y_{f(X_1\dots X_n)}}</span>.</p>
<p>We also assume unmeasured sources of error that affect the measurements: <span class="math inline">U_{L} \rightarrow</span> <span class="math inline">L_{f(X_1\dots X_n)}</span>, <span class="math inline">U_{A} \rightarrow</span> <span class="math inline">A_{f(X_1\dots X_n)}</span>, and <span class="math inline">U_{Y} \rightarrow</span> <span class="math inline">Y_{f(X_1\dots X_n)}</span>. That is, we allow that our measured indicators may “see as through a mirror, in darkness,” the underlying true reality they hope to capture (Corinthians 13:12). We use <span class="math inline">U_{L}</span>, <span class="math inline">U_{A}</span> and <span class="math inline">U_{Y}</span> to denote the unmeasured sources of error in the measured indicators. These are the unknown, and perhaps unknowable, darkness and mirror.</p>
<p>Allow that the true underlying reality represented by the <span class="math inline">\eta_{var}</span> may be multivariate. Similarly, allow the true underlying reality represented by <span class="math inline">\U_{var}</span> is multivariate.</p>
<p>We now have a causal diagramme that more precisely captures VanderWeele’s thinking as presented in <a href="#fig-dag-multivariate-reality-complete" class="quarto-xref">Figure&nbsp;8</a>. In our <a href="#fig-dag-uu-null" class="quarto-xref">Figure&nbsp;9</a>, we have fleshed out <span class="math inline">\mathcal{R}</span> in a way that may include natural language concepts and scientific language, or constructs, as latent realities and latent unmeasured sources of error in our constructs.</p>
<p>The utility of describing the measurement dynamics using causal graphs is apparrent. We can understand that the measured states, once conditioned upon create <em>collider biases</em> which opens path between the unmeasured sources of error and the true underlying state that gives rise to our measurements. This is depicted by a the arrows <span class="math inline">U_{var}</span> and from <span class="math inline">\eta_{var}</span> into each <span class="math inline">var_{f(X1, X2,\dots X_n)}</span></p>
<p>Notice: <strong>where true unmeasured (multivariate) psycho-physical states are related to true unmeasured (multivariate) sources of error in the measurement of those states, the very act of measurement opens pathways to confounding.</strong></p>
<p>If for each measured construct <span class="math inline">var_{f(X1, X2,\dots X_n)}</span>, the sources of error <span class="math inline">U_{var}</span> and the unmeasured consituents of reality that give rise to our measures <span class="math inline">\eta_{var}</span> are uncorrelated with other variables <span class="math inline">U\prime_{var}</span> and from <span class="math inline">\eta\prime_{var}</span> and <span class="math inline">var\prime_{f(X1, X2,\dots X_n)}</span>, our estimates may be downwardly biased toward the null. However, d-separation is preserved. Where errors are uncorrelated with true latent realities, there is no new pathway that opens information between our exposure and outcome. Consider the relations presented in <a href="#fig-dag-dep-udir-effect-confounders-3wave" class="quarto-xref">Figure&nbsp;10</a></p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-dep-udir-effect-confounders-3wave" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-dep-udir-effect-confounders-3wave-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-dep-udir-effect-confounders-3wave-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-dep-udir-effect-confounders-3wave-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Measurement error opens an additional pathway to confounding if either there are correlated errors, or a directed effect of the exposure on the errors of measured outcome.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here,</p>
<p><span class="math inline">\eta_L \rightarrow L</span>: We assume that the true workload state affects its measurement. This measurement, however, may be affected by an unmeasured error source, <span class="math inline">U_{L}</span>. Personal perceptions of workload can introduce this error. For instance, a person may perceive their workload differently based on recent personal experiences or cultural backgrounds. Additionally, unmeasured cultural influences like societal expectations of productivity could shape their responses independently of the true workload state. There may be cultural differences - Americans may verstate; the British may present effortless superiority.</p>
<p><span class="math inline">\eta_A \rightarrow A</span>: When it comes to exercise, the true state may affect the measured frequency (questions about exercise are not totally uninformative). However, this measurement is also affected by an unmeasured source of error, which we denote by <span class="math inline">U_{A}</span>. For example, a cultural shift towards valuing physical health might prompt participants toreport higher activity levels, introducing an error, <span class="math inline">U_{A}</span>.</p>
<p><span class="math inline">\eta_Y \rightarrow Y</span>: We assume questions about distress are not totally uninformative: actual distress affects the measured distress. However this measurement is subject to unmeasured error: <span class="math inline">U_{Y}</span>. For instance, an increased societal acceptance of mental health might change how distress is reported creating an error, <span class="math inline">U_{Y}</span>, in the measurement of distress. Such norms, moreover, may change over time.</p>
<p><span class="math inline">U_{L} \rightarrow L</span>, <span class="math inline">U_{A} \rightarrow A</span>, and <span class="math inline">U_{Y} \rightarrow Y</span>: These edges between the nodes indicate how each unmeasured error source can influence its corresponding measurement, leading to a discrepancy between the true state and the measured state.</p>
<p><span class="math inline">U_{L} \rightarrow U_{A}</span> and <span class="math inline">U_{L} \rightarrow U_{Y}</span>: These relationships indicate that the error in the stress measurement can correlate with those in the exercise and mood measurements. This could stem from a common cultural bias affecting how a participant self-reports across these areas.</p>
<p><span class="math inline">\eta_A \rightarrow U_{Y}</span> and <span class="math inline">\eta_L \rightarrow U_{A}</span>: These relationships indicate that the actual state of one variable can affect the error in another variable’s measurement. For example, a cultural emphasis on physical health leading to increased exercise might, in turn, affect the reporting of distress levels, causing an error, <span class="math inline">U_{Y}</span>, in the distress measurement. Similarly, if a cultural trend pushes people to work more, it might cause them to over or underestimate their exercise frequency, introducing an error, <span class="math inline">U_{A}</span>, in the exercise measurement.</p>
<section id="confounding-control-by-baseline-measures-of-exposure-and-outcome-dependent-directed-measurement-error-in-three-wave-panels" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="confounding-control-by-baseline-measures-of-exposure-and-outcome-dependent-directed-measurement-error-in-three-wave-panels">Confounding control by baseline measures of exposure and outcome: Dependent Directed Measurement Error in Three-Wave Panels</h3>
<ol type="1">
<li><p>We propose a three-wave panel design to control confounding. This design adjusts for baseline measurements of both exposure and the outcome.</p></li>
<li><p>Understanding this approach in the context of potential directed and correlated measurement errors gives us a clearer picture of its strengths and limitations.</p></li>
<li><p>This three-wave panel design incorporates baseline measurements of both exposure and confounders. As a result, any bias that could come from unmeasured sources of measurement errors should be uncorrelated with their baseline effects.</p></li>
<li><p>For instance, if individuals have a social desirability bias at the baseline, they would have to develop a different bias unrelated to the initial one for new bias to occur due to correlated unmeasured sources of measurement errors.</p></li>
<li><p>However, we cannot completely eliminate the possibility of such new bias development. There could also be potential new sources of bias from directed effects of the exposure on the error term of the outcome, which can often occur due to panel attrition.</p></li>
<li><p>To mitigate this risk, we adjust for panel attrition/non-response using methods like multiple imputation. We also consistently perform sensitivity analyses to detect any unanticipated bias.</p></li>
<li><p>Despite these potential challenges, it is worth noting that by including measures of both exposure and outcome at baseline, the chances of new confounding are significantly reduced.</p></li>
<li><p>Therefore, adopting this practice should be a standard procedure in multi-wave studies as it substantially minimizes the likelihood of introducing novel confounding factors.</p></li>
</ol>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-dep-udir-effect-confounders-3wave-new" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-dag-dep-udir-effect-confounders-3wave-new-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11-content_files/figure-html/fig-dag-dep-udir-effect-confounders-3wave-new-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-dag-dep-udir-effect-confounders-3wave-new-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: TBA
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="comment-on-slow-changes" class="level3">
<h3 class="anchored" data-anchor-id="comment-on-slow-changes">Comment on slow changes</h3>
<p>Over long periods of time we can expect additional sources of confounding. Changes in cultural norms and attitudes can occur over the duration of a longitudinal study like the NZAVS, leading to residual confounding. For example, if there is a cultural shift towards increased acceptance of mental health issues, this might change how psychological distress is reported over time, irrespective of baseline responses.</p>
<!-- It's also important to consider that cultural influences might not be entirely captured by the survey. Factors such as societal expectations, shared beliefs, and norms within a culture could influence both exercise behaviour and distress states. These could change over time due to sociocultural shifts, and if these changes aren't accounted for, could lead to residual confounding. For example, a societal shift towards valuing physical health might encourage more exercise independently of baseline responses -->
<!-- 1.  **Baseline Measures and Cultural Differences:** The NZAVS contains data from diverse cultural backgrounds. Therefore, controlling for baseline measures of exercise and distress would also help account for cultural differences that might influence these variables at the outset. For instance, certain cultural groups might have different baseline physical activity or baseline distress states due to various socio-cultural factors. -->
<!-- 2.  **Residual Confounding and Exercise:** Let's consider the construct $\eta_{A}$, representing the true state of exercise behaviour. If we control for baseline exercise, we're adjusting for the initial state of this behaviour. However, there could still be cultural factors that impact how exercise changes over time. For instance, a cultural event or festival that significantly increases physical activity for a certain period might occur. This change might be independent of the baseline state of exercise, thus leading to residual confounding. -->
<!-- 3.  **Residual Confounding and Depression:** Similarly for $\eta_{Y}$, the true state of Depression/Anxiety. Controlling for baseline states adjusts for the initial emotional state. However, cultural factors such as societal norms or expectations about emotional expression could change over time independently of the baseline distress. These changes could result in residual confounding. For example, a significant cultural event might induce communal feelings of joy or sadness, influencing the distress state irrespective of the baseline level. -->
<!-- 4.  **Unmeasured Cultural Factors**: It's also important to consider that cultural influences might not be entirely captured by the survey. Factors such as societal expectations, shared beliefs, and norms within a culture could influence both exercise behaviour and distress states. These could change over time due to sociocultural shifts, and if these changes aren't accounted for, could lead to residual confounding. For example, a societal shift towards valuing physical health might encourage more exercise independently of baseline responses -->
<!-- 5.  **Change over time**: Finally, time itself can be a factor. Changes in cultural norms and attitudes can occur over the duration of a longitudinal study like the NZAVS. If the timing of these changes isn't aligned with the measurement times, this can also lead to residual confounding. For example, if there is a cultural shift towards increased acceptance of mental health issues, this might change how mood is reported over time, irrespective of baseline responses. -->
<!-- 6.  **Directed Measurement Error:** Consider a situation where individuals from certain cultural backgrounds might systematically under-report their physical activity due to societal norms or expectations, introducing a directed measurement error. Similarly, reporting of mood states might also be influenced by cultural perspectives on expressing emotions. These culturally influenced errors in measurement can introduce bias, even after controlling for baseline measures. -->
<!-- 7.  **Undirected Measurement Error:** Undirected errors could also occur due to random variations in understanding or interpreting survey questions across different cultures, introducing variability in the data. If these random errors correlate with the error in measuring other variables (for instance, if misunderstanding of exercise questions correlates with misunderstanding of mood questions), this can introduce bias. -->
<!-- 8.  **Correlated Errors and Cultural Differences:** The culturally influenced measurement errors ($U_{A}$, $U_{Y}$) could be correlated, as the cultural factors influencing the reporting of exercise might also influence the reporting of mood. This correlation between errors introduces further complexity and potential bias. -->
<!-- 9.  **Residual Confounding:** Despite controlling for baseline measures, there can still be residual confounding due to unmeasured cultural factors. For instance, even if we control for baseline exercise and mood, there might still be cultural factors that impact the changes in these variables over time independently of the baseline measures. -->
<!-- In short, controlling for baseline measures in the NZAVS helps to reduce some bias and account for cultural differences that influence the exposure and outcome. However, potential bias due to unmeasured confounding and measurement error, for example, if these are influenced by cultural factors, still remain. -->
<ol start="10" type="1">
<li><strong>Need for Sensitivity Analysis</strong> The Key takehome message is that we must always perform sensitivity analyses because we can never be certain that our confounding control strategy has worked.</li>
</ol>
</section>
</section>
<section id="lab-advice-on-your-final-report" class="level2">
<h2 class="anchored" data-anchor-id="lab-advice-on-your-final-report">Lab: Advice on Your Final Report</h2>
</section>
<section id="intoduction" class="level2">
<h2 class="anchored" data-anchor-id="intoduction">Intoduction</h2>
<p>Answer the following:</p>
<ul>
<li>State the Question: is my question clearly stated? If not, state it.</li>
<li>Relevance of the Question: Have I explained its importance? If not, explain.</li>
<li>Subgroup Analysis: Does my question involve a subgroup (e.g., cultural group)? If not, develop a subgroup analysis question.</li>
<li>Causality of the Question: Is my question causal? Briefly explain what this means with reference to the potential outcomes framework.</li>
<li>State how you will use time-series data to address causality.</li>
<li>Define your exposure.</li>
<li>Define your outcome(s)</li>
<li>Explain how the the exposure and outcome is relevant to your question.</li>
<li>Define your causal estimand (see: lecture 9). Hint: it is ATE_g_risk difference = E[Y(1)-(0)|G,L], where G is your multiple-group indicator and L is your set of baseline confounders.</li>
</ul>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<ul>
<li>Consider any ethical implications.</li>
<li>Explain the sample. Provide descriptive statistics</li>
<li>Discuss inclusion criteria.</li>
<li>Discuss how your sample relates to the “source population” (lecture 9.)</li>
<li>Explain NZAVS measures. State the questions used in the items</li>
<li>In your own words describe how the data meet the following assumptions required for causal inference:</li>
<li>Positivity: Can we intervene on the exposure at all levels of the covariates? Use the code I provided to test whether there is change in the exposure from the baseline in the source population(s)</li>
<li>Consistency: Can I interpret what it means to intervene on the exposure?</li>
<li>Exchangeability: Are different versions of the exposure conditionally exchangeable given measured baseline confounders? This requires stating baseline confounders and explaining how they may be related to both the exposure and outcome. As part of this, <strong>you must explain why the baseline measure of your exposure and outcome are included as potential confounders.</strong></li>
<li>Note: Unmeasured Confounders: Does previous science suggest the presence of unmeasured confounders? (e.g.&nbsp;childhood exposures that are not measured).</li>
<li>Draw a causal diagram: Have I drawn a causal diagram (DAG) to highlight both measured and unmeasured sources of confounding?</li>
<li>Measurement Error: Have I described potential biases from measurement errors? Return to lecture 11.</li>
<li>State that you do not have missing data in this synthetic dataset, but that ordinarily missing data would need to be handled.</li>
<li>State what your estimator will be. Note I’ve given you the following text to modify:</li>
</ul>
<blockquote class="blockquote">
<p>The Doubly Robust Estimation method for Subgroup Analysis Estimator is a sophisticated tool combining features of both IPTW and G-computation methods, providing unbiased estimates if either the propensity score or outcome model is correctly specified. The process involves five main steps:</p>
</blockquote>
<blockquote class="blockquote">
<p>Step 1 involves the estimation of the propensity score, a measure of the conditional probability of exposure given the covariates and the subgroup indicator. This score is calculated using statistical models such as logistic regression, with the model choice depending on the nature of the data and exposure. Weights for each individual are then calculated using this propensity score. These weights depend on the exposure status and are computed differently for exposed and unexposed individuals. The estimation of propensity scores is performed separately within each subgroup stratum.</p>
</blockquote>
<blockquote class="blockquote">
<p>Step 2 focuses on fitting a weighted outcome model, making use of the previously calculated weights from the propensity scores. This model estimates the outcome conditional on exposure, covariates, and subgroup, integrating the weights into the estimation process. Unlike in propensity score model estimation, covariates are included as variables in the outcome model. This inclusion makes the method doubly robust - providing a consistent effect estimate if either the propensity score or the outcome model is correctly specified, thereby reducing the assumption of correct model specification.</p>
</blockquote>
<blockquote class="blockquote">
<p>Step 3 entails the simulation of potential outcomes for each individual in each subgroup. These hypothetical scenarios assume universal exposure to the intervention within each subgroup, regardless of actual exposure levels. The expectation of potential outcomes is calculated for each individual in each subgroup, using individual-specific weights. These scenarios are performed for both the current and alternative interventions.</p>
</blockquote>
<blockquote class="blockquote">
<p>Step 4 is the estimation of the average causal effect for each subgroup, achieved by comparing the computed expected values of potential outcomes under each intervention level. The difference represents the average causal effect of changing the exposure within each subgroup.</p>
</blockquote>
<blockquote class="blockquote">
<p>Step 5 involves comparing differences in causal effects across groups by calculating the differences in the estimated causal effects between different subgroups. Confidence intervals and standard errors for these calculations are determined using simulation-based inference methods (Greifer et al.&nbsp;2023). This step allows for a comprehensive comparison of the impact of different interventions across various subgroups, while encorporating uncertainty.</p>
</blockquote>
<p>Also see the appendix <a href="https://go-bayes.github.io/psych-434-2023/content/09-content.html#comprehensive-checklist-for-detailed-reporting-of-a-causal-inferenctial-study-e.g.-assessment-3-option-2">here</a></p>
<ul>
<li>State what E-values are and how you will use them to clarify the risk of unmeasured confounding.</li>
</ul>
</section>
<section id="results-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="results-1">Results</h2>
<ul>
<li>Use the scripts I have provided as a template for your analysis.</li>
<li>Propensity Score Reporting: Detail the process of propensity score derivation, including the model used and any variable transformations: e.g.: <code>A ~ x1 + x2 + x3 + ....</code> using logistic regression, all continuous predictors were transformed to z-scores
<ul>
<li>WeightIt Package Utilisation: Explicitly mention the use of the ‘WeightIt’ package in R, including any specific options or parameters used in the propensity score estimation process <span class="citation" data-cites="greifer2023a">(<a href="#ref-greifer2023a" role="doc-biblioref">Greifer 2023</a>)</span>.</li>
<li>Report if different methods were used to obtain propensity scores, and the reasons behind the choice of methods such as ‘ebal’, ‘energy’, and ‘ps’.</li>
<li>If your exposure is continuous only the ‘energy’ option was used for propensity score estimation.</li>
<li>Subgroup Estimation: Confirm that the propensity scores for subgroups were estimated separately, and discuss how the weights were subsequently combined with the original data.</li>
<li>Covariate Balance: Include a Love plot to visually represent covariate balance on the exposure both before and after weighting. The script will generate these plots.</li>
<li>Weighting Algorithm Statistics: Report the statistics for the weighting algorithms as provided by the WeightIt package, including any measures of balance or fit. The script I gave you will generate this information</li>
</ul></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-greifer2023a" class="csl-entry" role="listitem">
Greifer, Noah. 2023. <em>WeightIt: Weighting for Covariate Balance in Observational Studies</em>.
</div></div><p>Example:</p>
<blockquote class="blockquote">
<p>We estimated propensity scores by fitting a model for the exposure A as it is predicted by the set of baseline covariates defined by L. Because we are interested in effect modification by group, we fit different propensity score models for within strata of G using the <code>subgroup</code> command of the <code>WeightIt</code> package. Thus the propensity score is the the probability of receiving a value of a treatment (A=a) conditional on the covariates L, and stratum within G. We compared balance using the following methods of weighting: “ebal” or entropy balancing, “energy” or energy balancing, and “ps” or traditional inverse probability of weighting balancing. Of these methods “ebal” performed the best. Table X and Figure Y present the results of the ebalancing method.</p>
</blockquote>
<ul>
<li><p>Interpretation of Propensity Scores: we interpret the proposensity scores as yeilding good balance across the exposure conditions.</p></li>
<li><p>Outcome Regression Model: Clearly report the type of regression model used to estimate outcome model coefficients (e.g., linear regression, Poisson, binomial), and mention if the exposure was interacted with the baseline covariates. Do not report model coefficients as these have no interpretation. Example</p></li>
</ul>
<div class="page-columns page-full"><blockquote class="blockquote">
<p>We fit a linear model using maximum likelihood estimation with the outcome Y predicted by the exposure A. We interacted the exposure with all baseline confounders L. Continuous baseline confounders were converted to z-scores, whereas categorical exposures were not. Also interacted with all baseline confounders was a term for the subgroup interactoin. This allowed uas to flexibily fit non-linearities for the modification of the effect of the exposure within levels of the levels of the cultural group strata of interest. We note that model coefficients have no interpretation in this context so are not reported. The remaining steps of Doubly-Robust estimation were performed as outlined in the <em>Method</em> section. We calculated confidence intervals and standard errors, using the <code>clarify</code> package in R, which relies on simulation based inference for these quantities of interest <span class="citation" data-cites="greifer2023">(<a href="#ref-greifer2023" role="doc-biblioref">Greifer et al. 2023</a>)</span></p>
</blockquote><div class="no-row-height column-margin column-container"><div id="ref-greifer2023" class="csl-entry" role="listitem">
Greifer, Noah, Steven Worthington, Stefano Iacus, and Gary King. 2023. <em>Clarify: Simulation-Based Inference for Regression Models</em>. <a href="https://iqss.github.io/clarify/">https://iqss.github.io/clarify/</a>.
</div></div></div>
<p><strong>Report the causal estimates.</strong></p>
<ul>
<li>ATE contrasts for groups in setting the exposure to for each group in setting level A = a and A = a*</li>
<li>differences between groups in the magnitude of the effects. (ATE_group 1 - ATE_group_2)</li>
<li>Report the E-value: how sensitive are your results to unmeasured confounding?</li>
</ul>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>Make sure to hit these points:</p>
<p>Consider the following ideas about what to discuss in one’s findings. The order of exposition might be different.</p>
<ol type="1">
<li><p><strong>Summary of results</strong>: What did you find?</p></li>
<li><p><strong>Interpretation of E-values:</strong> Interpret the E-values used for sensitivity analysis. State what they represent in terms of the robustness of the findings to potential unmeasured confounding.</p></li>
<li><p><strong>Causal Effect Interpretation:</strong> What is the interest of the effect, if any, if an effect was observed? Interpret the average causal effect of changing the exposure level within each subgroup, and discuss its relevance to the research question.</p></li>
<li><p><strong>Comparison of Subgroups:</strong> Discuss how differences in causal effect estimates between different subgroups, if observed, or if not observed, contribute to the overall findings of the study.</p></li>
<li><p><strong>Uncertainty and Confidence Intervals:</strong> Consider the uncertainty around the estimated causal effects, and interpret the confidence intervals to understand the precision of the estimates.</p></li>
<li><p><strong>Generalisability and Transportability:</strong> Reflect on the generalizability of the study results to other contexts or populations. Discuss any factors that might influence the transportability of the causal effects found in the study. (Again see lecture 9.)</p></li>
<li><p><strong>Assumptions and Limitations:</strong> Reflect on the assumptions made during the study and identify any limitations in the methodology that could affect the interpretation of results. State that the implications of different intervention levels on potential outcomes are not analysed.</p></li>
<li><p><strong>Theoretical Relevance</strong>: How are these findings relevant to existing theories.</p></li>
<li><p><strong>Replication and Future Research:</strong> Consider how the study could be replicated or expanded upon in future research, and how the findings contribute to the existing body of knowledge in the field.</p></li>
<li><p><strong>Real-World Implications:</strong> Discuss the real-world implications of the findings, and how they could be applied in policy, practice, or further research.</p></li>
</ol>
</section>
<section id="example-anlaysis-week-10" class="level2">
<h2 class="anchored" data-anchor-id="example-anlaysis-week-10">Example anlaysis (week 10)</h2>
<section id="packages-1" class="level3">
<h3 class="anchored" data-anchor-id="packages-1">Packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  - Arel-Bundock V, Greifer N, Heiss A (2024). "How to Interpret Statistical Models Using marginaleffects for R and Python." _Journal of Statistical Software_, *111*(9), 1-32. doi:10.18637/jss.v111.i09 &lt;https://doi.org/10.18637/jss.v111.i09&gt;.
  - Barrett M (2021). _ggokabeito: 'Okabe-Ito' Scales for 'ggplot2' and 'ggraph'_. R package version 0.1.0, &lt;https://CRAN.R-project.org/package=ggokabeito&gt;.
  - Bates D, Mächler M, Bolker B, Walker S (2015). "Fitting Linear Mixed-Effects Models Using lme4." _Journal of Statistical Software_, *67*(1), 1-48. doi:10.18637/jss.v067.i01 &lt;https://doi.org/10.18637/jss.v067.i01&gt;.
  - Bates D, Maechler M, Jagan M (2025). _Matrix: Sparse and Dense Matrix Classes and Methods_. R package version 1.7-2, &lt;https://CRAN.R-project.org/package=Matrix&gt;.
  - Bengtsson H (2021). "A Unifying Framework for Parallel and Distributed Processing in R using Futures." _The R Journal_, *13*(2), 208-227. doi:10.32614/RJ-2021-048 &lt;https://doi.org/10.32614/RJ-2021-048&gt;, &lt;https://doi.org/10.32614/RJ-2021-048&gt;.
  - Bengtsson H (2021). "A Unifying Framework for Parallel and Distributed Processing in R using Futures." _The R Journal_, *13*(2), 208-227. doi:10.32614/RJ-2021-048 &lt;https://doi.org/10.32614/RJ-2021-048&gt;, &lt;https://doi.org/10.32614/RJ-2021-048&gt;.
  - Bengtsson H (2024). _progressr: An Inclusive, Unifying API for Progress Updates_. R package version 0.15.1, &lt;https://CRAN.R-project.org/package=progressr&gt;.
  - Blair G, Cooper J, Coppock A, Humphreys M, Bicalho C, Fultz N, Medina L (2021). _DesignLibrary: Library of Research Designs_. R package version 0.1.10, &lt;https://CRAN.R-project.org/package=DesignLibrary&gt;.
  - Blair G, Cooper J, Coppock A, Humphreys M, Rudkin A, Fultz N (2024). _fabricatr: Imagine Your Data Before You Collect It_. R package version 1.0.2, &lt;https://CRAN.R-project.org/package=fabricatr&gt;.
  - Blair G, Cooper J, Coppock A, Humphreys M, Sonnet L (2024). _estimatr: Fast Estimators for Design-Based Inference_. R package version 1.0.4, &lt;https://CRAN.R-project.org/package=estimatr&gt;.
  - Blair G, Coppock A, Humphreys M (2023). _Research Design in the Social Sciences: Declaration, Diagnosis, and Redesign_. Princeton University Press, Princeton. &lt;https://book.declaredesign.org&gt;. Blair G, Cooper J, Coppock A, Humphreys M (2019). "Declaring and Diagnosing Research Designs." _American Political Science Review_, *113*, 838-859. &lt;https://declaredesign.org/paper.pdf&gt;.
  - Brown C (2018). _formula.tools: Programmatic Utilities for Manipulating Formulas, Expressions, Calls, Assignments and Other R Objects_. R package version 1.7.1, &lt;https://CRAN.R-project.org/package=formula.tools&gt;.
  - Bulbulia J (2024). _margot: MARGinal Observational Treatment-effects_. doi:10.5281/zenodo.10907724 &lt;https://doi.org/10.5281/zenodo.10907724&gt;, R package version 0.3.1.0 Functions to obtain MARGinal Observational Treatment-effects from observational data., &lt;https://go-bayes.github.io/margot/&gt;.
  - Chang W (2023). _extrafont: Tools for Using Fonts_. R package version 0.19, &lt;https://CRAN.R-project.org/package=extrafont&gt;.
  - Chen T, He T, Benesty M, Khotilovich V, Tang Y, Cho H, Chen K, Mitchell R, Cano I, Zhou T, Li M, Xie J, Lin M, Geng Y, Li Y, Yuan J (2024). _xgboost: Extreme Gradient Boosting_. R package version 1.7.8.1, &lt;https://CRAN.R-project.org/package=xgboost&gt;.
  - Christopher H. Jackson (2011). "Multi-State Models for Panel Data: The msm Package for R." _Journal of Statistical Software_, *38*(8), 1-29. doi:10.18637/jss.v038.i08 &lt;https://doi.org/10.18637/jss.v038.i08&gt;.
  - Coppock A (2023). _randomizr: Easy-to-Use Tools for Common Forms of Random Assignment and Sampling_. R package version 1.0.0, &lt;https://CRAN.R-project.org/package=randomizr&gt;.
  - Csárdi G, Hester J, Wickham H, Chang W, Morgan M, Tenenbaum D (2024). _remotes: R Package Installation from Remote Repositories, Including 'GitHub'_. R package version 2.5.0, &lt;https://CRAN.R-project.org/package=remotes&gt;.
  - Eddelbuettel D, Francois R, Allaire J, Ushey K, Kou Q, Russell N, Ucar I, Bates D, Chambers J (2025). _Rcpp: Seamless R and C++ Integration_. R package version 1.0.14, &lt;https://CRAN.R-project.org/package=Rcpp&gt;. Eddelbuettel D, François R (2011). "Rcpp: Seamless R and C++ Integration." _Journal of Statistical Software_, *40*(8), 1-18. doi:10.18637/jss.v040.i08 &lt;https://doi.org/10.18637/jss.v040.i08&gt;. Eddelbuettel D (2013). _Seamless R and C++ Integration with Rcpp_. Springer, New York. doi:10.1007/978-1-4614-6868-4 &lt;https://doi.org/10.1007/978-1-4614-6868-4&gt;, ISBN 978-1-4614-6867-7. Eddelbuettel D, Balamuta J (2018). "Extending R with C++: A Brief Introduction to Rcpp." _The American Statistician_, *72*(1), 28-36. doi:10.1080/00031305.2017.1375990 &lt;https://doi.org/10.1080/00031305.2017.1375990&gt;.
  - Firke S (2024). _janitor: Simple Tools for Examining and Cleaning Dirty Data_. R package version 2.2.1, &lt;https://CRAN.R-project.org/package=janitor&gt;.
  - Friedman J, Tibshirani R, Hastie T (2010). "Regularization Paths for Generalized Linear Models via Coordinate Descent." _Journal of Statistical Software_, *33*(1), 1-22. doi:10.18637/jss.v033.i01 &lt;https://doi.org/10.18637/jss.v033.i01&gt;. Simon N, Friedman J, Tibshirani R, Hastie T (2011). "Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent." _Journal of Statistical Software_, *39*(5), 1-13. doi:10.18637/jss.v039.i05 &lt;https://doi.org/10.18637/jss.v039.i05&gt;. Tay JK, Narasimhan B, Hastie T (2023). "Elastic Net Regularization Paths for All Generalized Linear Models." _Journal of Statistical Software_, *106*(1), 1-31. doi:10.18637/jss.v106.i01 &lt;https://doi.org/10.18637/jss.v106.i01&gt;.
  - Greifer N (2024). _cobalt: Covariate Balance Tables and Plots_. R package version 4.5.5, &lt;https://CRAN.R-project.org/package=cobalt&gt;.
  - Greifer N (2024). _WeightIt: Weighting for Covariate Balance in Observational Studies_. R package version 1.3.2, &lt;https://CRAN.R-project.org/package=WeightIt&gt;.
  - Greifer N, Worthington S, Iacus S, King G (2024). _clarify: Simulation-Based Inference for Regression Models_. R package version 0.2.1, &lt;https://CRAN.R-project.org/package=clarify&gt;.
  - Grolemund G, Wickham H (2011). "Dates and Times Made Easy with lubridate." _Journal of Statistical Software_, *40*(3), 1-25. &lt;https://www.jstatsoft.org/v40/i03/&gt;.
  - Halekoh U, Højsgaard S, Yan J (2006). "The R Package geepack for Generalized Estimating Equations." _Journal of Statistical Software_, *15/2*, 1-11. Yan J, Fine JP (2004). "Estimating Equations for Association Structures." _Statistics in Medicine_, *23*, 859-880. Yan J (2002). "geepack: Yet Another Package for Generalized Estimating Equations." _R-News_, *2/3*, 12-14.
  - Hansen BB, Klopfer SO (2006). "Optimal full matching and related designs via network flows." _Journal of Computational and Graphical Statistics_, *15*(3), 609-627.
  - Hastie T (2024). _gam: Generalized Additive Models_. R package version 1.22-5, &lt;https://CRAN.R-project.org/package=gam&gt;.
  - Helske S, Helske J (2019). "Mixture Hidden Markov Models for Sequence Data: The seqHMM Package in R." _Journal of Statistical Software_, *88*(3), 1-32. doi:10.18637/jss.v088.i03 &lt;https://doi.org/10.18637/jss.v088.i03&gt;. Helske J, Helske S (2023). _seqHMM: Mixture hidden Markov models for social sequence data and other multivariate, multichannel categorical time series_. R package version 1.2.6, &lt;https://cran.r-project.org/package=seqHMM&gt;.
  - Henry L, Wickham H (2025). _rlang: Functions for Base Types and Core R and 'Tidyverse' Features_. R package version 1.1.5, &lt;https://CRAN.R-project.org/package=rlang&gt;.
  - Hester J, Bryan J (2024). _glue: Interpreted String Literals_. R package version 1.8.0, &lt;https://CRAN.R-project.org/package=glue&gt;.
  - Hester J, Wickham H, Csárdi G (2024). _fs: Cross-Platform File System Operations Based on 'libuv'_. R package version 1.6.5, &lt;https://CRAN.R-project.org/package=fs&gt;.
  - Ho D, Imai K, King G, Stuart E (2011). "MatchIt: Nonparametric Preprocessing for Parametric Causal Inference." _Journal of Statistical Software_, *42*(8), 1-28. doi:10.18637/jss.v042.i08 &lt;https://doi.org/10.18637/jss.v042.i08&gt;.
  - Honaker J, King G, Blackwell M (2011). "Amelia II: A Program for Missing Data." _Journal of Statistical Software_, *45*(7), 1-47. doi:10.18637/jss.v045.i07 &lt;https://doi.org/10.18637/jss.v045.i07&gt;.
  - Iannone R, Cheng J, Schloerke B, Hughes E, Lauer A, Seo J, Brevoort K, Roy O (2024). _gt: Easily Create Presentation-Ready Display Tables_. R package version 0.11.1, &lt;https://CRAN.R-project.org/package=gt&gt;.
  - Kassambara A (2023). _ggpubr: 'ggplot2' Based Publication Ready Plots_. R package version 0.6.0, &lt;https://CRAN.R-project.org/package=ggpubr&gt;.
  - Kay M (2024). "ggdist: Visualizations of Distributions and Uncertainty in the Grammar of Graphics." _IEEE Transactions on Visualization and Computer Graphics_, *30*(1), 414-424. doi:10.1109/TVCG.2023.3327195 &lt;https://doi.org/10.1109/TVCG.2023.3327195&gt;. Kay M (2024). _ggdist: Visualizations of Distributions and Uncertainty_. doi:10.5281/zenodo.3879620 &lt;https://doi.org/10.5281/zenodo.3879620&gt;, R package version 3.3.2, &lt;https://mjskay.github.io/ggdist/&gt;.
  - Lüdecke D (2018). "ggeffects: Tidy Data Frames of Marginal Effects from Regression Models." _Journal of Open Source Software_, *3*(26), 772. doi:10.21105/joss.00772 &lt;https://doi.org/10.21105/joss.00772&gt;.
  - Lüdecke D, Ben-Shachar M, Patil I, Makowski D (2020). "Extracting, Computing and Exploring the Parameters of Statistical Models using R." _Journal of Open Source Software_, *5*(53), 2445. doi:10.21105/joss.02445 &lt;https://doi.org/10.21105/joss.02445&gt;.
  - Lüdecke D, Ben-Shachar M, Patil I, Waggoner P, Makowski D (2021). "performance: An R Package for Assessment, Comparison and Testing of Statistical Models." _Journal of Open Source Software_, *6*(60), 3139. doi:10.21105/joss.03139 &lt;https://doi.org/10.21105/joss.03139&gt;.
  - Lumley T (2024). "survey: analysis of complex survey samples." R package version 4.4. Lumley T (2004). "Analysis of Complex Survey Samples." _Journal of Statistical Software_, *9*(1), 1-19. R package verson 2.2. Lumley T (2010). _Complex Surveys: A Guide to Analysis Using R: A Guide to Analysis Using R_. John Wiley and Sons.
  - Microsoft, Weston S (2022). _foreach: Provides Foreach Looping Construct_. R package version 1.5.2, &lt;https://CRAN.R-project.org/package=foreach&gt;.
  - Mullen KM, van Stokkum IHM (2024). _nnls: The Lawson-Hanson Algorithm for Non-Negative Least Squares (NNLS)_. R package version 1.6, &lt;https://CRAN.R-project.org/package=nnls&gt;.
  - Müller K (2020). _here: A Simpler Way to Find Your Files_. R package version 1.0.1, &lt;https://CRAN.R-project.org/package=here&gt;.
  - Müller K, Wickham H (2023). _tibble: Simple Data Frames_. R package version 3.2.1, &lt;https://CRAN.R-project.org/package=tibble&gt;.
  - Ooms J (2024). _katex: Rendering Math to HTML, 'MathML', or R-Documentation Format_. R package version 1.5.0, &lt;https://CRAN.R-project.org/package=katex&gt;.
  - Ooms J (2024). _pdftools: Text Extraction, Rendering and Converting of PDF Documents_. R package version 3.4.1, &lt;https://CRAN.R-project.org/package=pdftools&gt;.
  - Patil I, Makowski D, Ben-Shachar M, Wiernik B, Bacher E, Lüdecke D (2022). "datawizard: An R Package for Easy Data Preparation and Statistical Transformations." _Journal of Open Source Software_, *7*(78), 4684. doi:10.21105/joss.04684 &lt;https://doi.org/10.21105/joss.04684&gt;.
  - Pedersen T (2024). _patchwork: The Composer of Plots_. R package version 1.3.0, &lt;https://CRAN.R-project.org/package=patchwork&gt;.
  - Pishgar F, Greifer N, Leyrat C, Stuart E (2021). "MatchThem:: Matching and Weighting after Multiple Imputation." _The R Journal_. doi:10.32614/RJ-2021-073 &lt;https://doi.org/10.32614/RJ-2021-073&gt;, &lt;https://journal.r-project.org/archive/2021/RJ-2021-073/&gt;.
  - Polley E, LeDell E, Kennedy C, van der Laan M (2024). _SuperLearner: Super Learner Prediction_. R package version 2.0-29, &lt;https://CRAN.R-project.org/package=SuperLearner&gt;.
  - R Core Team (2024). _R: A Language and Environment for Statistical Computing_. R Foundation for Statistical Computing, Vienna, Austria. &lt;https://www.R-project.org/&gt;.
  - Rich B (2023). _table1: Tables of Descriptive Statistics in HTML_. R package version 1.4.3, &lt;https://CRAN.R-project.org/package=table1&gt;.
  - Richardson N, Cook I, Crane N, Dunnington D, François R, Keane J, Moldovan-Grünfeld D, Ooms J, Wujciak-Jens J, Apache Arrow (2025). _arrow: Integration to 'Apache' 'Arrow'_. R package version 18.1.0.1, &lt;https://CRAN.R-project.org/package=arrow&gt;.
  - Robinson D, Hayes A, Couch S (2024). _broom: Convert Statistical Objects into Tidy Tibbles_. R package version 1.0.7, &lt;https://CRAN.R-project.org/package=broom&gt;.
  - Robitzsch A, Grund S (2024). _miceadds: Some Additional Multiple Imputation Functions, Especially for 'mice'_. R package version 3.17-44, &lt;https://CRAN.R-project.org/package=miceadds&gt;.
  - Rosseel Y (2012). "lavaan: An R Package for Structural Equation Modeling." _Journal of Statistical Software_, *48*(2), 1-36. doi:10.18637/jss.v048.i02 &lt;https://doi.org/10.18637/jss.v048.i02&gt;.
  - Sjoberg D, Whiting K, Curry M, Lavery J, Larmarange J (2021). "Reproducible Summary Tables with the gtsummary Package." _The R Journal_, *13*, 570-580. doi:10.32614/RJ-2021-053 &lt;https://doi.org/10.32614/RJ-2021-053&gt;, &lt;https://doi.org/10.32614/RJ-2021-053&gt;.
  - Sjolander A, Dahlqwist E (2021). _stdReg: Regression Standardization_. R package version 3.4.1, &lt;https://CRAN.R-project.org/package=stdReg&gt;.
  - Therneau T (2024). _A Package for Survival Analysis in R_. R package version 3.8-3, &lt;https://CRAN.R-project.org/package=survival&gt;. Terry M. Therneau, Patricia M. Grambsch (2000). _Modeling Survival Data: Extending the Cox Model_. Springer, New York. ISBN 0-387-98784-3.
  - Tibshirani J, Athey S, Sverdrup E, Wager S (2024). _grf: Generalized Random Forests_. R package version 2.4.0, commit e2a2040690c3e461e793f98bce1c6f7163a8af7b, &lt;https://github.com/grf-labs/grf&gt;.
  - Tierney N, Cook D (2023). "Expanding Tidy Data Principles to Facilitate Missing Data Exploration, Visualization and Assessment of Imputations." _Journal of Statistical Software_, *105*(7), 1-31. doi:10.18637/jss.v105.i07 &lt;https://doi.org/10.18637/jss.v105.i07&gt;.
  - van Buuren S, Groothuis-Oudshoorn K (2011). "mice: Multivariate Imputation by Chained Equations in R." _Journal of Statistical Software_, *45*(3), 1-67. doi:10.18637/jss.v045.i03 &lt;https://doi.org/10.18637/jss.v045.i03&gt;.
  - van der Wal WM, Geskus RB (2011). "ipw: An R Package for Inverse Probability Weighting." _Journal of Statistical Software_, *43*(13), 1-23. doi:10.18637/jss.v043.i13 &lt;https://doi.org/10.18637/jss.v043.i13&gt;.
  - VanderWeele TJ, Ding P (2011). "Sensitivity analysis in observational research: introducing the E-value." _Annals of Internal Medicine_, *167*(4), 268-274. Mathur MB, VanderWeele TJ (2019). "Sensitivity analysis for unmeasured confounding in meta-analyses." _Journal of the American Statistical Association&gt;_. Smith LH, VanderWeele TJ (2019). "Bounding bias due to selection." _Epidemiology_.
  - Waring E, Quinn M, McNamara A, Arino de la Rubia E, Zhu H, Ellis S (2022). _skimr: Compact and Flexible Summaries of Data_. R package version 2.1.5, &lt;https://CRAN.R-project.org/package=skimr&gt;.
  - Wickham H (2016). _ggplot2: Elegant Graphics for Data Analysis_. Springer-Verlag New York. ISBN 978-3-319-24277-4, &lt;https://ggplot2.tidyverse.org&gt;.
  - Wickham H (2023). _conflicted: An Alternative Conflict Resolution Strategy_. R package version 1.2.0, &lt;https://CRAN.R-project.org/package=conflicted&gt;.
  - Wickham H (2023). _forcats: Tools for Working with Categorical Variables (Factors)_. R package version 1.0.0, &lt;https://CRAN.R-project.org/package=forcats&gt;.
  - Wickham H (2023). _stringr: Simple, Consistent Wrappers for Common String Operations_. R package version 1.5.1, &lt;https://CRAN.R-project.org/package=stringr&gt;.
  - Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). "Welcome to the tidyverse." _Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 &lt;https://doi.org/10.21105/joss.01686&gt;.
  - Wickham H, Bryan J, Barrett M, Teucher A (2024). _usethis: Automate Package and Project Setup_. R package version 3.1.0, &lt;https://CRAN.R-project.org/package=usethis&gt;.
  - Wickham H, François R, Henry L, Müller K, Vaughan D (2023). _dplyr: A Grammar of Data Manipulation_. R package version 1.1.4, &lt;https://CRAN.R-project.org/package=dplyr&gt;.
  - Wickham H, Henry L (2023). _purrr: Functional Programming Tools_. R package version 1.0.2, &lt;https://CRAN.R-project.org/package=purrr&gt;.
  - Wickham H, Hester J, Bryan J (2024). _readr: Read Rectangular Text Data_. R package version 2.1.5, &lt;https://CRAN.R-project.org/package=readr&gt;.
  - Wickham H, Hester J, Chang W, Bryan J (2022). _devtools: Tools to Make Developing R Packages Easier_. R package version 2.4.5, &lt;https://CRAN.R-project.org/package=devtools&gt;.
  - Wickham H, Vaughan D, Girlich M (2024). _tidyr: Tidy Messy Data_. R package version 1.3.1, &lt;https://CRAN.R-project.org/package=tidyr&gt;.
  - William Revelle (2024). _psych: Procedures for Psychological, Psychometric, and Personality Research_. Northwestern University, Evanston, Illinois. R package version 2.4.12, &lt;https://CRAN.R-project.org/package=psych&gt;.
  - Williams N, Díaz I (2023). "lmtp: An R package for estimating the causal effects of modified treatment policies." _Observational Studies_. &lt;https://muse.jhu.edu/article/883479&gt;. Díaz I, Williams N, Hoffman K, Schneck E (2021). "Non-parametric causal effects based on longitudinal modified treatment policies." _Journal of the American Statistical Association_. doi:10.1080/01621459.2021.1955691 &lt;https://doi.org/10.1080/01621459.2021.1955691&gt;.
  - Wright MN, Ziegler A (2017). "ranger: A Fast Implementation of Random Forests for High Dimensional Data in C++ and R." _Journal of Statistical Software_, *77*(1), 1-17. doi:10.18637/jss.v077.i01 &lt;https://doi.org/10.18637/jss.v077.i01&gt;.
  - Xie Y (2024). _knitr: A General-Purpose Package for Dynamic Report Generation in R_. R package version 1.49, &lt;https://yihui.org/knitr/&gt;. Xie Y (2015). _Dynamic Documents with R and knitr_, 2nd edition. Chapman and Hall/CRC, Boca Raton, Florida. ISBN 978-1498716963, &lt;https://yihui.org/knitr/&gt;. Xie Y (2014). "knitr: A Comprehensive Tool for Reproducible Research in R." In Stodden V, Leisch F, Peng RD (eds.), _Implementing Reproducible Computational Research_. Chapman and Hall/CRC. ISBN 978-1466561595.
  - Xie Y (2024). _tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents_. R package version 0.54, &lt;https://github.com/rstudio/tinytex&gt;. Xie Y (2019). "TinyTeX: A lightweight, cross-platform, and easy-to-maintain LaTeX distribution based on TeX Live." _TUGboat_, *40*(1), 30-32. &lt;https://tug.org/TUGboat/Contents/contents40-1.html&gt;.
  - Zeileis A, Croissant Y (2010). "Extended Model Formulas in R: Multiple Parts and Multiple Responses." _Journal of Statistical Software_, *34*(1), 1-13. doi:10.18637/jss.v034.i01 &lt;https://doi.org/10.18637/jss.v034.i01&gt;.
  - Zeileis A, Köll S, Graham N (2020). "Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R." _Journal of Statistical Software_, *95*(1), 1-36. doi:10.18637/jss.v095.i01 &lt;https://doi.org/10.18637/jss.v095.i01&gt;. Zeileis A (2004). "Econometric Computing with HC and HAC Covariance Matrix Estimators." _Journal of Statistical Software_, *11*(10), 1-17. doi:10.18637/jss.v011.i10 &lt;https://doi.org/10.18637/jss.v011.i10&gt;. Zeileis A (2006). "Object-Oriented Computation of Sandwich Estimators." _Journal of Statistical Software_, *16*(9), 1-16. doi:10.18637/jss.v016.i09 &lt;https://doi.org/10.18637/jss.v016.i09&gt;.
  - Zhu H (2024). _kableExtra: Construct Complex Table with 'kable' and Pipe Syntax_. R package version 1.4.0, &lt;https://CRAN.R-project.org/package=kableExtra&gt;.</code></pre>
</div>
</div>


<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb32" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Hands on Measurement: Exploratory Factor Analysis, Confirmatory Factor Analysis (CFA), Multigroup Confirmatory Factor Analysis, Partial Invariance (Configural, Metric, and Scalar equivalence)."</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-MAY-20"</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> /Users/joseph/GIT/templates/bib/references.bib</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">    warnings: FALSE</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">    error: FALSE</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">    messages: FALSE</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: kate</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools:</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: FALSE</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="an">html-math-method:</span><span class="co"> katex</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="an">citation-location:</span><span class="co"> margin</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="an">code-block-border-left:</span><span class="co"> true</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co">#read libraries</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"all"</span>)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"parameters"</span>)</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyr"</span>)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"kableExtra"</span>)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"psych"</span>)</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"lavaan"</span>)</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"datawizard"</span>)</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/libs2.R")</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/funs.R")</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"/Users/joseph/GIT/templates/functions/experimental_funs.R"</span>)</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>::: {.callout-readings}</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a><span class="fu">### Required Readings</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@fischer2019primer</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/1h8slzy3vzscvbtp6yrjh/FischeKarlprimer.pdf?rlkey=xl93d5y7280c1qjhn3k2g8qls&amp;dl=0)</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a><span class="fu">### Optional Readings </span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@Vijver2021CulturePsychology</span><span class="co">] [link]</span>(https://doi.org/10.1017/9781107415188)</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@he2012</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/zuv4odmxbz8dbtdjfap3e/He-BiasandEquivalence.pdf?rlkey=wezprklb4jm6rgvvx0g58nw1n&amp;dl=0ā)</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@Harkness2003TRANSALTION</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/hmmje9vbunmcu3oiahaa5/Harkness_CC_translation.pdf?rlkey=6vqq3ap5n52qp7t1e570ubpgt&amp;dl=0)</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key concepts</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>EFA</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>CFA</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multigroup CFA</span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Invariance Testing (configural, metric, scalar)</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You need to know these measurement concepts</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Readings</span></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@fischer2019primer</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/1h8slzy3vzscvbtp6yrjh/FischeKarlprimer.pdf?rlkey=xl93d5y7280c1qjhn3k2g8qls&amp;dl=0)</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Optional Readings </span></span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@Vijver2021CulturePsychology</span><span class="co">] [link]</span>(https://doi.org/10.1017/9781107415188)</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@he2012</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/zuv4odmxbz8dbtdjfap3e/He-BiasandEquivalence.pdf?rlkey=wezprklb4jm6rgvvx0g58nw1n&amp;dl=0ā)</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@Harkness2003TRANSALTION</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/hmmje9vbunmcu3oiahaa5/Harkness_CC_translation.pdf?rlkey=6vqq3ap5n52qp7t1e570ubpgt&amp;dl=0)</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Lab</span></span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>R exercises focusing on measurement theory applications and graphing</span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>By the conclusion of our session, you will gain proficiency in:</span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exploratory Factor Analysis,</span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Confirmatory Factor Analysis (CFA),</span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multigroup Confirmatory Factor Analysis,</span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Partial Invariance (configural, metric, and scalar equivalence) </span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a>We will learn these concepts by doing an analysis.</span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Focus on Kessler-6 Anxiety</span></span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-106"><a href="#cb32-106" aria-hidden="true" tabindex="-1"></a>The code below will:</span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Load required packages.</span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Select the Kessler 6 items</span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Check whether there is sufficient correlation among the variables to support factor analysis.</span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Select A Scale To Validate: Kessler 6 Distress</span></span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-118"><a href="#cb32-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cfa_factor_structure</span></span>
<span id="cb32-119"><a href="#cb32-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a><span class="co"># get synthetic data</span></span>
<span id="cb32-121"><a href="#cb32-121" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb32-122"><a href="#cb32-122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-123"><a href="#cb32-123" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb32-124"><a href="#cb32-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a><span class="co"># update margot</span></span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment</span></span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("go-bayes/margot")</span></span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-130"><a href="#cb32-130" aria-hidden="true" tabindex="-1"></a><span class="co"># select the columns of the kesser-6 need. </span></span>
<span id="cb32-131"><a href="#cb32-131" aria-hidden="true" tabindex="-1"></a>dt_only_k6 <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span> </span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a>    kessler_depressed,</span>
<span id="cb32-135"><a href="#cb32-135" aria-hidden="true" tabindex="-1"></a>    kessler_effort,</span>
<span id="cb32-136"><a href="#cb32-136" aria-hidden="true" tabindex="-1"></a>    kessler_hopeless,</span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a>    kessler_worthless,</span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a>    kessler_nervous,</span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a>    kessler_restless</span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a><span class="co"># check factor structure</span></span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_factorstructure</span>(dt_only_k6)</span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practical Definitions of the Kessler-6 Items</span></span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The <span class="in">`df_nz`</span> is loaded with the <span class="in">`margot`</span> package. It is a synthetic dataset. </span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>take items from the Kessler-6 (K6) scale: depressed, effort, hopeless, worthless, nervous, and restless <span class="co">[</span><span class="ot">@kessler2002; @kessler2010</span><span class="co">]</span>.</span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>The Kessler-6 is used as a diagnostic screening tool for depression for physicians in New Zealand </span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a>The Kessler-6 (K6) is a widely-used diagnostic screening tool designed to identify levels of psychological distress that may indicate mental health disorders such as depression and anxiety. Physicians in New Zealand to screen patients quickly <span class="co">[</span><span class="ot">@krynen2013measuring</span><span class="co">]</span>. Each item on the Kessler-6 asks respondents to reflect on their feelings and behaviors over the past 30 days, with responses provided on a five-point ordinal scale: </span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**"...you feel hopeless"**</span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Interpretation**: This item measures the frequency of feelings of hopelessness. It assesses a core symptom of depression, where the individual perceives little or no optimism about the future.</span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**"...you feel so depressed that nothing could cheer you up"**</span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Interpretation**: This statement gauges the depth of depressive feelings and the inability to gain pleasure from normally enjoyable activities, a condition known as anhedonia.</span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**"...you feel restless or fidgety"**</span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Interpretation**: This item evaluates agitation and physical restlessness, which are common in anxiety disorders but can also be present in depressive states.</span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**"...you feel that everything was an effort"**</span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Interpretation**: This query assesses feelings of fatigue or exhaustion with everyday tasks, reflecting the loss of energy that is frequently a component of depression.</span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-168"><a href="#cb32-168" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**"...you feel worthless"**</span>
<span id="cb32-169"><a href="#cb32-169" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Interpretation**: This item measures feelings of low self-esteem or self-worth, which are critical indicators of depressive disorders.</span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**"...you feel nervous"**</span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Interpretation**: This question is aimed at identifying symptoms of nervousness or anxiety, helping to pinpoint anxiety disorders.</span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Response Options</span></span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a>The ordinal response options provided for the Kessler-6 are designed to capture the frequency of these symptoms, which is crucial for assessing the severity and persistence of psychological distress:</span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-178"><a href="#cb32-178" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**1. "None of the time"**: The symptom was not experienced at all.</span>
<span id="cb32-179"><a href="#cb32-179" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2. "A little of the time"**: The symptom was experienced infrequently.</span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**3. "Some of the time"**: The symptom was experienced occasionally.</span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**4. "Most of the time"**: The symptom was experienced frequently.</span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**5. "All of the time"**: The symptom was constantly experienced.</span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a>In clinical practice, higher scores on the Kessler-6 are indicative of greater distress and a higher likelihood of a mental health disorder. Physicians use a sum score of 13 to decide on further diagnostic evaluations or immediate therapeutic interventions. </span>
<span id="cb32-186"><a href="#cb32-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-187"><a href="#cb32-187" aria-hidden="true" tabindex="-1"></a>The simplicity and quick administration of the Kessler-6 make it an effective tool for primary care settings in New Zealand, allowing for the early detection and management of mental health issues. Let's stop to consider this measure. Do the items in this scale cohere? Do they all relate to depression? Might we quantitatively evaluate "coherence" in this scale?  </span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exploratory Factor Analysis</span></span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a>We employ <span class="in">`performance::check_factorstructure()`</span> to evaluate the data's suitability for factor analysis. Two tests are reported:</span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-194"><a href="#cb32-194" aria-hidden="true" tabindex="-1"></a>a. **Bartlett's Test of Sphericity**</span>
<span id="cb32-195"><a href="#cb32-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-196"><a href="#cb32-196" aria-hidden="true" tabindex="-1"></a>Bartlett's Test of Sphericity is used in psychometrics to assess the appropriateness of factor analysis for a dataset. It tests the hypothesis that the observed correlation matrix of is an identity matrix, which would suggest that all variables are orthogonal (i.e., uncorrelated) and therefore, factor analysis is unlikely to be appropriate. (Appendix A.)</span>
<span id="cb32-197"><a href="#cb32-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-198"><a href="#cb32-198" aria-hidden="true" tabindex="-1"></a>The outcome:</span>
<span id="cb32-199"><a href="#cb32-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-200"><a href="#cb32-200" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Chi-square (Chisq)**: 50402.32 with **Degrees of Freedom (15)** and a **p-value** &lt; .001</span>
<span id="cb32-201"><a href="#cb32-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-202"><a href="#cb32-202" aria-hidden="true" tabindex="-1"></a>This highly reliable result (p &lt; .001) confirms that the observed correlation matrix is not an identity matrix, substantiating the factorability of the dataset.</span>
<span id="cb32-203"><a href="#cb32-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-204"><a href="#cb32-204" aria-hidden="true" tabindex="-1"></a>b. **Kaiser-Meyer-Olkin (KMO) Measure**</span>
<span id="cb32-205"><a href="#cb32-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-206"><a href="#cb32-206" aria-hidden="true" tabindex="-1"></a>The KMO test assesses sampling adequacy by comparing the magnitudes of observed correlation coefficients to those of partial correlation coefficients. A KMO value nearing 1 indicates appropriateness for factor analysis. The results are:</span>
<span id="cb32-207"><a href="#cb32-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-208"><a href="#cb32-208" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Overall KMO**: 0.87</span>
<span id="cb32-209"><a href="#cb32-209" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>This value suggests good sampling adequacy, indicating that the sum of partial correlations is relatively low compared to the sum of correlations, thus supporting the potential for distinct and reliable factors.</span>
<span id="cb32-210"><a href="#cb32-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-211"><a href="#cb32-211" aria-hidden="true" tabindex="-1"></a>Each item’s KMO value exceeds the acceptable threshold of 0.5,so suitabale for factor analysis.</span>
<span id="cb32-212"><a href="#cb32-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-213"><a href="#cb32-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-214"><a href="#cb32-214" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Explore Factor Structure </span></span>
<span id="cb32-215"><a href="#cb32-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-216"><a href="#cb32-216" aria-hidden="true" tabindex="-1"></a>The following R code allows us to perform exploratory factor analysis (EFA) on the Kessler 6 (K6) scale data, assuming three latent factors. </span>
<span id="cb32-217"><a href="#cb32-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-218"><a href="#cb32-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-221"><a href="#cb32-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-222"><a href="#cb32-222" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: efa_made_easy</span></span>
<span id="cb32-223"><a href="#cb32-223" aria-hidden="true" tabindex="-1"></a><span class="co"># exploratory factor analysis</span></span>
<span id="cb32-224"><a href="#cb32-224" aria-hidden="true" tabindex="-1"></a><span class="co"># explore a factor structure made of 3 latent variables</span></span>
<span id="cb32-225"><a href="#cb32-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-226"><a href="#cb32-226" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"psych"</span>)</span>
<span id="cb32-227"><a href="#cb32-227" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"parameters"</span>)</span>
<span id="cb32-228"><a href="#cb32-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-229"><a href="#cb32-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-230"><a href="#cb32-230" aria-hidden="true" tabindex="-1"></a><span class="co"># do efa</span></span>
<span id="cb32-231"><a href="#cb32-231" aria-hidden="true" tabindex="-1"></a>efa <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(dt_only_k6, <span class="at">nfactors =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-232"><a href="#cb32-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">threshold =</span> <span class="st">"max"</span>)</span>
<span id="cb32-233"><a href="#cb32-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-234"><a href="#cb32-234" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( efa )</span>
<span id="cb32-235"><a href="#cb32-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-236"><a href="#cb32-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-237"><a href="#cb32-237" aria-hidden="true" tabindex="-1"></a><span class="fu">####  Explore Factor Structure</span></span>
<span id="cb32-238"><a href="#cb32-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-241"><a href="#cb32-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-242"><a href="#cb32-242" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb32-243"><a href="#cb32-243" aria-hidden="true" tabindex="-1"></a>efa <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(dt_only_k6, <span class="at">nfactors =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-244"><a href="#cb32-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">threshold =</span> <span class="st">"max"</span>)</span>
<span id="cb32-245"><a href="#cb32-245" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(efa)</span>
<span id="cb32-246"><a href="#cb32-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-247"><a href="#cb32-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-248"><a href="#cb32-248" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What is "Rotation"?</span></span>
<span id="cb32-249"><a href="#cb32-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-250"><a href="#cb32-250" aria-hidden="true" tabindex="-1"></a>In factor analysis, rotation is a mathematical technique applied to the factor solution to make it more interpretable. Rotation is like adjusting the angle of a camera to get a better view. When we rotate the factors, we are not changing the underlying data, just how we are looking at it, to make the relationships between variables and factors clearer and more meaningful.</span>
<span id="cb32-251"><a href="#cb32-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-252"><a href="#cb32-252" aria-hidden="true" tabindex="-1"></a>The main goal of rotation is to achieve a simpler and more interpretable factor structure. This simplification is achieved by **making the factors as distinct as possible,** by aligning them closer with specific variables, which makes it easier to understand what each factor represents. Think of orthogonal rotation like organising books on a shelf so that each book only belongs to one category. Each category (factor) is completely independent of the others.</span>
<span id="cb32-253"><a href="#cb32-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-254"><a href="#cb32-254" aria-hidden="true" tabindex="-1"></a>There are two types:</span>
<span id="cb32-255"><a href="#cb32-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-256"><a href="#cb32-256" aria-hidden="true" tabindex="-1"></a>**Orthogonal rotations** (such as Varimax), which assume that the factors are uncorrelated and keep the axes at 90 degrees to each other. This is useful when we assume that the underlying factors are independent.</span>
<span id="cb32-257"><a href="#cb32-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-258"><a href="#cb32-258" aria-hidden="true" tabindex="-1"></a>**Oblique rotations** (such as Oblimin), which allow the factors to correlate. Returning to our analogy, imagine a more complex library system where some categories of books overlap; for example, "history" might overlap with "political science". Oblique rotation recognises and allows these overlaps.This is more realistic in psychological and social sciences, ... here, we believe that stress and anxiety might naturally correlate with each other, so Oblique rotation is a better option.</span>
<span id="cb32-259"><a href="#cb32-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-260"><a href="#cb32-260" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results </span></span>
<span id="cb32-261"><a href="#cb32-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-262"><a href="#cb32-262" aria-hidden="true" tabindex="-1"></a>Using oblimin rotation, the items loaded as follows on the three factors:</span>
<span id="cb32-263"><a href="#cb32-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-264"><a href="#cb32-264" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MR3**: Strongly associated with 'kessler_hopeless' (0.79) and 'kessler_worthless' (0.79). This factor might be capturing aspects related to feelings of hopelessness and worthlessness, often linked with depressive affect.</span>
<span id="cb32-265"><a href="#cb32-265" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MR1**: Mostly linked with 'kessler_depressed' (0.99), suggesting this factor represents core depressive symptoms.</span>
<span id="cb32-266"><a href="#cb32-266" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MR2**: Includes 'kessler_restless' (0.72), 'kessler_nervous' (0.43), and 'kessler_effort' (0.38). This factor seems to encompass symptoms related to anxiety and agitation.</span>
<span id="cb32-267"><a href="#cb32-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-268"><a href="#cb32-268" aria-hidden="true" tabindex="-1"></a>The **complexity** values indicate the number of factors each item loads on "significantly."  A complexity near 1.00 suggests that the item predominantly loads on a single factor, which is seen with most of the items except for 'kessler_nervous' and 'kessler_effort', which show higher complexity and thus share variance with more than one factor.</span>
<span id="cb32-269"><a href="#cb32-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-270"><a href="#cb32-270" aria-hidden="true" tabindex="-1"></a>**Uniqueness** values represent the variance in each item not explained by the common factors. Lower uniqueness values for items like 'kessler_depressed' indicate that the factor explains most of the variance for that item.</span>
<span id="cb32-271"><a href="#cb32-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-272"><a href="#cb32-272" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variance Explained</span></span>
<span id="cb32-273"><a href="#cb32-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-274"><a href="#cb32-274" aria-hidden="true" tabindex="-1"></a>The three factors together account for 62.94% of the total variance in the data, distributed as follows:</span>
<span id="cb32-275"><a href="#cb32-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-276"><a href="#cb32-276" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MR3**: 28.20%</span>
<span id="cb32-277"><a href="#cb32-277" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MR1**: 17.56%</span>
<span id="cb32-278"><a href="#cb32-278" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MR2**: 17.18%</span>
<span id="cb32-279"><a href="#cb32-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-280"><a href="#cb32-280" aria-hidden="true" tabindex="-1"></a>This indicates a substantial explanation of the data’s variance by the model, with the highest contribution from the factor associated with hopelessness and worthlessness.</span>
<span id="cb32-281"><a href="#cb32-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-282"><a href="#cb32-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-283"><a href="#cb32-283" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Consensus View?</span></span>
<span id="cb32-284"><a href="#cb32-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-285"><a href="#cb32-285" aria-hidden="true" tabindex="-1"></a>There are different algorithms for assessing the factor structure.  The performance package allows us to consider a 'consensus' view.</span>
<span id="cb32-286"><a href="#cb32-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-287"><a href="#cb32-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-290"><a href="#cb32-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-291"><a href="#cb32-291" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: plot_factors</span></span>
<span id="cb32-292"><a href="#cb32-292" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb32-293"><a href="#cb32-293" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-294"><a href="#cb32-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-295"><a href="#cb32-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-296"><a href="#cb32-296" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="fu">n_factors</span>(dt_only_k6)</span>
<span id="cb32-297"><a href="#cb32-297" aria-hidden="true" tabindex="-1"></a>n</span>
<span id="cb32-298"><a href="#cb32-298" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb32-299"><a href="#cb32-299" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb32-300"><a href="#cb32-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-301"><a href="#cb32-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-302"><a href="#cb32-302" aria-hidden="true" tabindex="-1"></a>Output: </span>
<span id="cb32-303"><a href="#cb32-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-304"><a href="#cb32-304" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The choice of 1 dimensions is supported by 8 (50.00%) methods out of 16 (Optimal coordinates, Acceleration factor, Parallel analysis, Kaiser criterion, Scree (SE), Scree (R2), VSS complexity 1, Velicer's MAP). </span></span>
<span id="cb32-305"><a href="#cb32-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-306"><a href="#cb32-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-307"><a href="#cb32-307" aria-hidden="true" tabindex="-1"></a>The result indicates that a single dimension is supported by half of the methods used (8 out of 16).  However science isn't a matter of voting. Also, does it make sense that there is one latent factor here?  Let's press on...</span>
<span id="cb32-308"><a href="#cb32-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-309"><a href="#cb32-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-310"><a href="#cb32-310" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confirmatory Factor Analysis (ignoring groups)</span></span>
<span id="cb32-311"><a href="#cb32-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-312"><a href="#cb32-312" aria-hidden="true" tabindex="-1"></a>CFA to validate the hypothesised factor structures derived from EFA. </span>
<span id="cb32-313"><a href="#cb32-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-314"><a href="#cb32-314" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**One-factor model**: assumes all items measure a single underlying construct.</span>
<span id="cb32-315"><a href="#cb32-315" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Two-factor model**: assumes two distinct constructs measured by the items.</span>
<span id="cb32-316"><a href="#cb32-316" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Three-factor model**: assumes three distinct constructs measured by the items.</span>
<span id="cb32-317"><a href="#cb32-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-318"><a href="#cb32-318" aria-hidden="true" tabindex="-1"></a>Steps are:</span>
<span id="cb32-319"><a href="#cb32-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-320"><a href="#cb32-320" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 1. Data Partition</span></span>
<span id="cb32-321"><a href="#cb32-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-322"><a href="#cb32-322" aria-hidden="true" tabindex="-1"></a>First, we take the dataset (<span class="in">`dt_only_k6`</span>) and partition it into training and testing sets. This division helps in validating the model built on the training data against an unseen test set; this enhances robustness for the factor analysis findings.</span>
<span id="cb32-323"><a href="#cb32-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-326"><a href="#cb32-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-327"><a href="#cb32-327" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-328"><a href="#cb32-328" aria-hidden="true" tabindex="-1"></a>part_data <span class="ot">&lt;-</span> datawizard<span class="sc">::</span><span class="fu">data_partition</span>(dt_only_k6, <span class="at">training_proportion =</span> .<span class="dv">7</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb32-329"><a href="#cb32-329" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> part_data<span class="sc">$</span>p_0<span class="fl">.7</span></span>
<span id="cb32-330"><a href="#cb32-330" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> part_data<span class="sc">$</span>test</span>
<span id="cb32-331"><a href="#cb32-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-332"><a href="#cb32-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-333"><a href="#cb32-333" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2. Model Setup for CFA</span></span>
<span id="cb32-334"><a href="#cb32-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-335"><a href="#cb32-335" aria-hidden="true" tabindex="-1"></a>Bases on the EFA results, we consider three different factor structures</span>
<span id="cb32-336"><a href="#cb32-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-337"><a href="#cb32-337" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**One-factor model**: assumes all items measure a single underlying construct.</span>
<span id="cb32-338"><a href="#cb32-338" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Two-factor model**: assumes two distinct constructs measured by the items.</span>
<span id="cb32-339"><a href="#cb32-339" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Three-factor model**: assumes three distinct constructs measured by the items.</span>
<span id="cb32-340"><a href="#cb32-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-341"><a href="#cb32-341" aria-hidden="true" tabindex="-1"></a>We fit each model to the training data:</span>
<span id="cb32-342"><a href="#cb32-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-345"><a href="#cb32-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-346"><a href="#cb32-346" aria-hidden="true" tabindex="-1"></a><span class="co"># One-factor model</span></span>
<span id="cb32-347"><a href="#cb32-347" aria-hidden="true" tabindex="-1"></a>structure_k6_one <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-348"><a href="#cb32-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb32-349"><a href="#cb32-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-350"><a href="#cb32-350" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-factor model</span></span>
<span id="cb32-351"><a href="#cb32-351" aria-hidden="true" tabindex="-1"></a>structure_k6_two <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-352"><a href="#cb32-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb32-353"><a href="#cb32-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-354"><a href="#cb32-354" aria-hidden="true" tabindex="-1"></a><span class="co"># Three-factor model</span></span>
<span id="cb32-355"><a href="#cb32-355" aria-hidden="true" tabindex="-1"></a>structure_k6_three <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-356"><a href="#cb32-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb32-357"><a href="#cb32-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-358"><a href="#cb32-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-359"><a href="#cb32-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-360"><a href="#cb32-360" aria-hidden="true" tabindex="-1"></a>Then we split our data for cross-validation</span>
<span id="cb32-361"><a href="#cb32-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-364"><a href="#cb32-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-365"><a href="#cb32-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cfa</span></span>
<span id="cb32-366"><a href="#cb32-366" aria-hidden="true" tabindex="-1"></a><span class="co"># first partition the data </span></span>
<span id="cb32-367"><a href="#cb32-367" aria-hidden="true" tabindex="-1"></a>part_data <span class="ot">&lt;-</span> datawizard<span class="sc">::</span><span class="fu">data_partition</span>(dt_only_k6, <span class="at">traing_proportion =</span> .<span class="dv">7</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb32-368"><a href="#cb32-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-369"><a href="#cb32-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-370"><a href="#cb32-370" aria-hidden="true" tabindex="-1"></a><span class="co"># set up training data</span></span>
<span id="cb32-371"><a href="#cb32-371" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> part_data<span class="sc">$</span>p_0<span class="fl">.7</span></span>
<span id="cb32-372"><a href="#cb32-372" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> part_data<span class="sc">$</span>test</span>
<span id="cb32-373"><a href="#cb32-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-374"><a href="#cb32-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-375"><a href="#cb32-375" aria-hidden="true" tabindex="-1"></a><span class="co"># one factor model</span></span>
<span id="cb32-376"><a href="#cb32-376" aria-hidden="true" tabindex="-1"></a>structure_k6_one <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-377"><a href="#cb32-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb32-378"><a href="#cb32-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-379"><a href="#cb32-379" aria-hidden="true" tabindex="-1"></a><span class="co"># two factor model model</span></span>
<span id="cb32-380"><a href="#cb32-380" aria-hidden="true" tabindex="-1"></a>structure_k6_two <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-381"><a href="#cb32-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb32-382"><a href="#cb32-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-383"><a href="#cb32-383" aria-hidden="true" tabindex="-1"></a><span class="co"># three factor model</span></span>
<span id="cb32-384"><a href="#cb32-384" aria-hidden="true" tabindex="-1"></a>structure_k6_three <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">fa</span>(training, <span class="at">nfactors =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-385"><a href="#cb32-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">efa_to_cfa</span>()</span>
<span id="cb32-386"><a href="#cb32-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-387"><a href="#cb32-387" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect models</span></span>
<span id="cb32-388"><a href="#cb32-388" aria-hidden="true" tabindex="-1"></a>structure_k6_one</span>
<span id="cb32-389"><a href="#cb32-389" aria-hidden="true" tabindex="-1"></a>structure_k6_two</span>
<span id="cb32-390"><a href="#cb32-390" aria-hidden="true" tabindex="-1"></a>structure_k6_three</span>
<span id="cb32-391"><a href="#cb32-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-392"><a href="#cb32-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-393"><a href="#cb32-393" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**One-Factor Model**: All items are linked to a single factor (<span class="in">`MR1`</span>).</span>
<span id="cb32-394"><a href="#cb32-394" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-395"><a href="#cb32-395" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Two-Factor Model**: </span>
<span id="cb32-396"><a href="#cb32-396" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`MR1`</span> is linked with <span class="in">`kessler_depressed`</span>, <span class="in">`kessler_hopeless`</span>, and <span class="in">`kessler_worthless`</span>, suggesting these items might represent a more depressive aspect of **distress.**</span>
<span id="cb32-397"><a href="#cb32-397" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`MR2`</span> is associated with <span class="in">`kessler_effort`</span>, <span class="in">`kessler_nervous`</span>, and <span class="in">`kessler_restless`</span>, which could indicate a different aspect, perhaps related to **anxiety or agitation.**</span>
<span id="cb32-398"><a href="#cb32-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-399"><a href="#cb32-399" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Three-Factor Model**: </span>
<span id="cb32-400"><a href="#cb32-400" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`MR1`</span> includes <span class="in">`kessler_depressed`</span>, <span class="in">`kessler_effort`</span>, <span class="in">`kessler_hopeless`</span>, and <span class="in">`kessler_worthless`</span>, indicating a broad factor possibly encompassing overall distress.</span>
<span id="cb32-401"><a href="#cb32-401" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`MR2`</span> consists solely of <span class="in">`kessler_effort`</span>.</span>
<span id="cb32-402"><a href="#cb32-402" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`MR3`</span> includes <span class="in">`kessler_nervous`</span> + <span class="in">`kessler_restless`</span>, which might imply these are distinctivene from other distress components.</span>
<span id="cb32-403"><a href="#cb32-403" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-404"><a href="#cb32-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-405"><a href="#cb32-405" aria-hidden="true" tabindex="-1"></a>Do these results make sense?  Note they are different from the Exploratory Factor Analysis. Why might that be? </span>
<span id="cb32-406"><a href="#cb32-406" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-407"><a href="#cb32-407" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-408"><a href="#cb32-408" aria-hidden="true" tabindex="-1"></a>Next we perform the confirmatory factor analysis itself...</span>
<span id="cb32-409"><a href="#cb32-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-412"><a href="#cb32-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-413"><a href="#cb32-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fit-models</span></span>
<span id="cb32-414"><a href="#cb32-414" aria-hidden="true" tabindex="-1"></a><span class="co"># fit and compare models</span></span>
<span id="cb32-415"><a href="#cb32-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-416"><a href="#cb32-416" aria-hidden="true" tabindex="-1"></a><span class="co"># one latent model</span></span>
<span id="cb32-417"><a href="#cb32-417" aria-hidden="true" tabindex="-1"></a>one_latent <span class="ot">&lt;-</span></span>
<span id="cb32-418"><a href="#cb32-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_one, <span class="at">data =</span> test))</span>
<span id="cb32-419"><a href="#cb32-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-420"><a href="#cb32-420" aria-hidden="true" tabindex="-1"></a><span class="co"># two latents model</span></span>
<span id="cb32-421"><a href="#cb32-421" aria-hidden="true" tabindex="-1"></a>two_latents <span class="ot">&lt;-</span></span>
<span id="cb32-422"><a href="#cb32-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_two, <span class="at">data =</span> test))</span>
<span id="cb32-423"><a href="#cb32-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-424"><a href="#cb32-424" aria-hidden="true" tabindex="-1"></a><span class="co"># three latents model</span></span>
<span id="cb32-425"><a href="#cb32-425" aria-hidden="true" tabindex="-1"></a>three_latents <span class="ot">&lt;-</span></span>
<span id="cb32-426"><a href="#cb32-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_three, <span class="at">data =</span> test))</span>
<span id="cb32-427"><a href="#cb32-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-428"><a href="#cb32-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-429"><a href="#cb32-429" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models</span></span>
<span id="cb32-430"><a href="#cb32-430" aria-hidden="true" tabindex="-1"></a>compare <span class="ot">&lt;-</span></span>
<span id="cb32-431"><a href="#cb32-431" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">compare_performance</span>(one_latent, two_latents, three_latents, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-432"><a href="#cb32-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-433"><a href="#cb32-433" aria-hidden="true" tabindex="-1"></a><span class="co"># select cols we want</span></span>
<span id="cb32-434"><a href="#cb32-434" aria-hidden="true" tabindex="-1"></a>key_columns_df <span class="ot">&lt;-</span> compare[, <span class="fu">c</span>(<span class="st">"Model"</span>, <span class="st">"Chi2"</span>, <span class="st">"Chi2_df"</span>, <span class="st">"CFI"</span>, <span class="st">"RMSEA"</span>, <span class="st">"RMSEA_CI_low"</span>, <span class="st">"RMSEA_CI_high"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>)]</span>
<span id="cb32-435"><a href="#cb32-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-436"><a href="#cb32-436" aria-hidden="true" tabindex="-1"></a><span class="co"># view as html table</span></span>
<span id="cb32-437"><a href="#cb32-437" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(key_columns_df) <span class="sc">|&gt;</span></span>
<span id="cb32-438"><a href="#cb32-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span>
<span id="cb32-439"><a href="#cb32-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-440"><a href="#cb32-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-441"><a href="#cb32-441" aria-hidden="true" tabindex="-1"></a><span class="fu">####  Metrics:</span></span>
<span id="cb32-442"><a href="#cb32-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-443"><a href="#cb32-443" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Chi2 (Chi-Square Test)**: A lower Chi2 value indicates a better fit of the model to the data.</span>
<span id="cb32-444"><a href="#cb32-444" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**df (Degrees of Freedom)**: Reflects the model complexity.</span>
<span id="cb32-445"><a href="#cb32-445" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**CFI (Comparative Fit Index)**: Values closer to 1 indicate a better fit. A value above 0.95 is generally considered to indicate a good fit.</span>
<span id="cb32-446"><a href="#cb32-446" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**RMSEA (Root Mean Square Error of Approximation)**: values less than 0.05 indicate a good fit, and values up to 0.08 are acceptable.</span>
<span id="cb32-447"><a href="#cb32-447" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**AIC (Akaike Information Criterion) and BIC (Bayesian Information Criterion)**: lower values are better, indicating a more parsimonious model, with the BIC imposing a penalty for model complexity.</span>
<span id="cb32-448"><a href="#cb32-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-449"><a href="#cb32-449" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Selection:</span></span>
<span id="cb32-450"><a href="#cb32-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-451"><a href="#cb32-451" aria-hidden="true" tabindex="-1"></a>What do you think? </span>
<span id="cb32-452"><a href="#cb32-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-453"><a href="#cb32-453" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **Three Latents Model** shows the best fit across all indicators, having the lowest Chi2, RMSEA, and the highest CFI. It also has the lowest AIC and BIC scores, suggesting it not only fits well but is also the most parsimonious among the tested models. </span>
<span id="cb32-454"><a href="#cb32-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-455"><a href="#cb32-455" aria-hidden="true" tabindex="-1"></a>But... </span>
<span id="cb32-456"><a href="#cb32-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-457"><a href="#cb32-457" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**The CFI** for the two-factor model is 0.990, which is close to 1 and suggests a very good fit to the data. This is superior to the one-factor model (CFI = 0.9468) and slightly less than the three-factor model (CFI = 0.9954). A CFI value closer to 1 indicates a better fit of the model to the data.</span>
<span id="cb32-458"><a href="#cb32-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-459"><a href="#cb32-459" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Root Mean Square Error of Approximation (RMSEA):** The two-factor model has an RMSEA of 0.0443, which is within the excellent fit range (below 0.05). It significantly improves upon the one-factor model's RMSEA of 0.0985 and is only slightly worse than the three-factor model's 0.0313.</span>
<span id="cb32-460"><a href="#cb32-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-461"><a href="#cb32-461" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**BIC* isn't much different, So</span>
<span id="cb32-462"><a href="#cb32-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-463"><a href="#cb32-463" aria-hidden="true" tabindex="-1"></a>We might say the two-factor model strikes a balance between simplicity and model fit. It has fewer factors than the three-factor model, making it potentially easier to interpret while still capturing the variance in the data.</span>
<span id="cb32-464"><a href="#cb32-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-465"><a href="#cb32-465" aria-hidden="true" tabindex="-1"></a>Look at the items. What do you think? </span>
<span id="cb32-466"><a href="#cb32-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-467"><a href="#cb32-467" aria-hidden="true" tabindex="-1"></a>Does Anxiety appear to differ from Depression? </span>
<span id="cb32-468"><a href="#cb32-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-469"><a href="#cb32-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-470"><a href="#cb32-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-471"><a href="#cb32-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-472"><a href="#cb32-472" aria-hidden="true" tabindex="-1"></a><span class="fu">### Measurement Invariance in Multi-group Confirmatory Factor Analysis</span></span>
<span id="cb32-473"><a href="#cb32-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-474"><a href="#cb32-474" aria-hidden="true" tabindex="-1"></a>When we use tools like surveys or tests to measure psychological constructs (like distress, intelligence, satisfaction), we often need to ensure that these tools work similarly across different groups of people. This is crucial for fair comparisons. Think of it as ensuring that a ruler measures inches or centimeters the same way, whether you are in Auckland or Wellington.</span>
<span id="cb32-475"><a href="#cb32-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-476"><a href="#cb32-476" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Levels of Measurement Invariance</span></span>
<span id="cb32-477"><a href="#cb32-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-478"><a href="#cb32-478" aria-hidden="true" tabindex="-1"></a>Measurement invariance tests how consistently a measure operates across different groups, such as ethnic or gender groups. Consider how we can understand it through the K6 Distress Scale applied to different demographic groups in New Zealand:</span>
<span id="cb32-479"><a href="#cb32-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-480"><a href="#cb32-480" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Configural Invariance**</span>
<span id="cb32-481"><a href="#cb32-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-482"><a href="#cb32-482" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**What it means**: The measure's structure is the same across groups. Imagine you have a toolkit; configural invariance means that everyone has the same set of tools (screwdrivers, hammers, wrenches) in their kits.</span>
<span id="cb32-483"><a href="#cb32-483" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Application**: For the K6 Distress Scale, both Māori and New Zealand Europeans use the same six questions to gauge distress. However, how strongly each question predicts distress can vary between the groups. (Not we are using "prediction" here -- we are only assessessing associations.)</span>
<span id="cb32-484"><a href="#cb32-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-485"><a href="#cb32-485" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Metric Invariance**</span>
<span id="cb32-486"><a href="#cb32-486" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**What it means**: The strength of the relationship between each tool (question) and the construct (distress) is consistent across groups. If metric invariance holds, turning a screw (answering a question about feeling nervous) tightens the screw by the same amount no matter who uses the screwdriver.</span>
<span id="cb32-487"><a href="#cb32-487" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Application**: A unit change in the latent distress factor affects scores on questions (like feeling nervous or hopeless) equally for Māori and New Zealand Europeans. </span>
<span id="cb32-488"><a href="#cb32-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-489"><a href="#cb32-489" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Scalar Invariance**</span>
<span id="cb32-490"><a href="#cb32-490" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**What it means**: Beyond having the same tools and relationships, everyone starts from the same baseline. If scalar invariance holds. It is like ensuring that every screwdriver is calibrated to the same torque setting before being used.</span>
<span id="cb32-491"><a href="#cb32-491" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Application**: The actual scores on the distress scale mean the same thing across different groups. If a Māori scores 15 and a New Zealander of European descent scores 15, both are experiencing a comparable level of distress.</span>
<span id="cb32-492"><a href="#cb32-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-493"><a href="#cb32-493" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Concept of "Partial Invariance"</span></span>
<span id="cb32-494"><a href="#cb32-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-495"><a href="#cb32-495" aria-hidden="true" tabindex="-1"></a>Sometimes, not all conditions for full metric or scalar invariance are met, which could hinder meaningful comparisons across groups. This is where the concept of "partial invariance" comes into play.</span>
<span id="cb32-496"><a href="#cb32-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-497"><a href="#cb32-497" aria-hidden="true" tabindex="-1"></a>**Partial Invariance** occurs when invariance holds for some but not all items of the scale across groups. Imagine if most, but not all, tools in the kits behaved the same way across different groups. If sufficient items (tools) exhibit invariance, the measure might still be usable for certain comparisons.</span>
<span id="cb32-498"><a href="#cb32-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-499"><a href="#cb32-499" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Metric Partial Invariance**: This might mean that while most items relate similarly to the underlying factor across groups, one or two do not. Researchers might decide that there’s enough similarity to proceed with comparisons of relationships (correlations) but should proceed with caution.</span>
<span id="cb32-500"><a href="#cb32-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-501"><a href="#cb32-501" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Scalar Partial Invariance**: Here, most but not all items show the same intercepts across groups. It suggests that while comparisons of the construct means can be made, some scores might need adjustments or nuanced interpretation.</span>
<span id="cb32-502"><a href="#cb32-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-503"><a href="#cb32-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-504"><a href="#cb32-504" aria-hidden="true" tabindex="-1"></a>In practical terms, achieving partial invariance in your analysis allows for some comparisons but signals a need for careful interpretation and potentially more careful analysis. For instance, if partial scalar invariance is found on the K6 Distress Scale, researchers might compare overall distress levels between Māori and New Zealand Europeans but should acknowledge that differences in certain item responses might reflect measurement bias rather than true differences in distress.</span>
<span id="cb32-505"><a href="#cb32-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-506"><a href="#cb32-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-507"><a href="#cb32-507" aria-hidden="true" tabindex="-1"></a>The upshot is that understanding these levels of invariance helps ensure that when we compare mental health or other constructs across different groups, we are making fair and meaningful comparisons. Partial invariance offers a flexible approach to handle real-world data where not all conditions are perfectly met. This approach allows researchers to acknowledge and account for minor discrepancies while still extracting valuable insights from their analyses.</span>
<span id="cb32-508"><a href="#cb32-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-509"><a href="#cb32-509" aria-hidden="true" tabindex="-1"></a>The following script runs multi-group confirmatory factor analysis (MG-CFA) to assess the invariance of the Kessler 6 (K6) distress scale across two ethnic groups: European New Zealanders and Māori.</span>
<span id="cb32-510"><a href="#cb32-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-513"><a href="#cb32-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-514"><a href="#cb32-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: group_by_cfa</span></span>
<span id="cb32-515"><a href="#cb32-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-516"><a href="#cb32-516" aria-hidden="true" tabindex="-1"></a><span class="co"># select needed columns plus 'ethnicity'</span></span>
<span id="cb32-517"><a href="#cb32-517" aria-hidden="true" tabindex="-1"></a><span class="co"># filter dataset for only 'euro' and 'maori' ethnic categories</span></span>
<span id="cb32-518"><a href="#cb32-518" aria-hidden="true" tabindex="-1"></a>dt_eth_k6_eth <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span> </span>
<span id="cb32-519"><a href="#cb32-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-520"><a href="#cb32-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(eth_cat <span class="sc">==</span> <span class="st">"euro"</span> <span class="sc">|</span> eth_cat <span class="sc">==</span> <span class="st">"maori"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-521"><a href="#cb32-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(kessler_depressed, kessler_effort, kessler_hopeless,</span>
<span id="cb32-522"><a href="#cb32-522" aria-hidden="true" tabindex="-1"></a>         kessler_worthless, kessler_nervous, kessler_restless, eth_cat)</span>
<span id="cb32-523"><a href="#cb32-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-524"><a href="#cb32-524" aria-hidden="true" tabindex="-1"></a><span class="co"># partition the dataset into training and test subsets</span></span>
<span id="cb32-525"><a href="#cb32-525" aria-hidden="true" tabindex="-1"></a><span class="co"># stratify by ethnic category to ensure balanced representation</span></span>
<span id="cb32-526"><a href="#cb32-526" aria-hidden="true" tabindex="-1"></a>part_data_eth <span class="ot">&lt;-</span> datawizard<span class="sc">::</span><span class="fu">data_partition</span>(dt_eth_k6_eth, <span class="at">training_proportion =</span> .<span class="dv">7</span>, <span class="at">seed =</span> <span class="dv">123</span>, <span class="at">group =</span> <span class="st">"eth_cat"</span>)</span>
<span id="cb32-527"><a href="#cb32-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-528"><a href="#cb32-528" aria-hidden="true" tabindex="-1"></a>training_eth <span class="ot">&lt;-</span> part_data_eth<span class="sc">$</span>p_0<span class="fl">.7</span></span>
<span id="cb32-529"><a href="#cb32-529" aria-hidden="true" tabindex="-1"></a>test_eth <span class="ot">&lt;-</span> part_data_eth<span class="sc">$</span>test</span>
<span id="cb32-530"><a href="#cb32-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-531"><a href="#cb32-531" aria-hidden="true" tabindex="-1"></a><span class="co"># configural invariance models</span></span>
<span id="cb32-532"><a href="#cb32-532" aria-hidden="true" tabindex="-1"></a><span class="co">#run CFA models specifying one, two, and three latent variables without constraining across groups</span></span>
<span id="cb32-533"><a href="#cb32-533" aria-hidden="true" tabindex="-1"></a>one_latent_eth_configural <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_one, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb32-534"><a href="#cb32-534" aria-hidden="true" tabindex="-1"></a>two_latents_eth_configural <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_two, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb32-535"><a href="#cb32-535" aria-hidden="true" tabindex="-1"></a>three_latents_eth_configural <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_three, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb32-536"><a href="#cb32-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-537"><a href="#cb32-537" aria-hidden="true" tabindex="-1"></a><span class="co"># compare model performances for configural invariance</span></span>
<span id="cb32-538"><a href="#cb32-538" aria-hidden="true" tabindex="-1"></a>compare_eth_configural <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">compare_performance</span>(one_latent_eth_configural, two_latents_eth_configural, three_latents_eth_configural, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-539"><a href="#cb32-539" aria-hidden="true" tabindex="-1"></a>compare_eth_configural</span>
<span id="cb32-540"><a href="#cb32-540" aria-hidden="true" tabindex="-1"></a><span class="co"># metric invariance models</span></span>
<span id="cb32-541"><a href="#cb32-541" aria-hidden="true" tabindex="-1"></a><span class="co"># run CFA models holding factor loadings equal across groups</span></span>
<span id="cb32-542"><a href="#cb32-542" aria-hidden="true" tabindex="-1"></a>one_latent_eth_metric <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_one, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">group.equal =</span> <span class="st">"loadings"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb32-543"><a href="#cb32-543" aria-hidden="true" tabindex="-1"></a>two_latents_eth_metric  <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_two, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">group.equal =</span> <span class="st">"loadings"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb32-544"><a href="#cb32-544" aria-hidden="true" tabindex="-1"></a>three_latents_eth_metric  <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_three, <span class="at">group =</span> <span class="st">"eth_cat"</span>,<span class="at">group.equal =</span> <span class="st">"loadings"</span>, <span class="at">data =</span> test_eth))</span>
<span id="cb32-545"><a href="#cb32-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-546"><a href="#cb32-546" aria-hidden="true" tabindex="-1"></a><span class="co"># compare model performances for metric invariance</span></span>
<span id="cb32-547"><a href="#cb32-547" aria-hidden="true" tabindex="-1"></a>compare_eth_metric  <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">compare_performance</span>(one_latent_eth_metric, two_latents_eth_metric, three_latents_eth_metric, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-548"><a href="#cb32-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-549"><a href="#cb32-549" aria-hidden="true" tabindex="-1"></a><span class="co"># scalar invariance models</span></span>
<span id="cb32-550"><a href="#cb32-550" aria-hidden="true" tabindex="-1"></a><span class="co"># run CFA models holding factor loadings and intercepts equal across groups</span></span>
<span id="cb32-551"><a href="#cb32-551" aria-hidden="true" tabindex="-1"></a>one_latent_eth_scalar <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_one, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">"loadings"</span>,<span class="st">"intercepts"</span>), <span class="at">data =</span> test_eth))</span>
<span id="cb32-552"><a href="#cb32-552" aria-hidden="true" tabindex="-1"></a>two_latents_eth_scalar  <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_two, <span class="at">group =</span> <span class="st">"eth_cat"</span>, <span class="at">group.equal =</span>  <span class="fu">c</span>(<span class="st">"loadings"</span>,<span class="st">"intercepts"</span>), <span class="at">data =</span> test_eth))</span>
<span id="cb32-553"><a href="#cb32-553" aria-hidden="true" tabindex="-1"></a>three_latents_eth_scalar  <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(lavaan<span class="sc">::</span><span class="fu">cfa</span>(structure_k6_three, <span class="at">group =</span> <span class="st">"eth_cat"</span>,<span class="at">group.equal =</span>  <span class="fu">c</span>(<span class="st">"loadings"</span>,<span class="st">"intercepts"</span>), <span class="at">data =</span> test_eth))</span>
<span id="cb32-554"><a href="#cb32-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-555"><a href="#cb32-555" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare model performances for scalar invariance</span></span>
<span id="cb32-556"><a href="#cb32-556" aria-hidden="true" tabindex="-1"></a>compare_eth_scalar <span class="ot">&lt;-</span> compare_eth_scalar  <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">compare_performance</span>(one_latent_eth_scalar, two_latents_eth_scalar, three_latents_eth_scalar, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-557"><a href="#cb32-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-558"><a href="#cb32-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-559"><a href="#cb32-559" aria-hidden="true" tabindex="-1"></a><span class="fu">### Configural Invariance Results</span></span>
<span id="cb32-560"><a href="#cb32-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-563"><a href="#cb32-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-564"><a href="#cb32-564" aria-hidden="true" tabindex="-1"></a>compare_eth_configural_key <span class="ot">&lt;-</span> compare_eth_configural[, <span class="fu">c</span>(<span class="st">"Name"</span>, <span class="st">"Chi2"</span>, <span class="st">"Chi2_df"</span>,<span class="st">"RFI"</span>, <span class="st">"NNFI"</span>, <span class="st">"CFI"</span>,<span class="st">"GFI"</span>,<span class="st">"RMSEA"</span>, <span class="st">"RMSEA_CI_low"</span>, <span class="st">"RMSEA_CI_high"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>)]</span>
<span id="cb32-565"><a href="#cb32-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-566"><a href="#cb32-566" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(compare_eth_configural_key)<span class="sc">|&gt;</span></span>
<span id="cb32-567"><a href="#cb32-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span>
<span id="cb32-568"><a href="#cb32-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-569"><a href="#cb32-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-570"><a href="#cb32-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-571"><a href="#cb32-571" aria-hidden="true" tabindex="-1"></a>The table represents the comparison of three multi-group confirmatory factor analysis (CFA) models conducted to test for configural invariance across different ethnic categories (eth_cat). Configural invariance refers to whether the pattern of factor loadings is the same across groups. It's the most basic form of measurement invariance.</span>
<span id="cb32-572"><a href="#cb32-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-573"><a href="#cb32-573" aria-hidden="true" tabindex="-1"></a>Looking at the results, we can draw the following conclusions:</span>
<span id="cb32-574"><a href="#cb32-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-575"><a href="#cb32-575" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Chi2 (Chi-square)**: a lower value suggests a better model fit. In this case, the three looks best </span>
<span id="cb32-576"><a href="#cb32-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-577"><a href="#cb32-577" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**GFI (Goodness of Fit Index) and AGFI (Adjusted Goodness of Fit Index)**: These values range from 0 to 1, with values closer to 1 suggesting a better fit. All models are close. </span>
<span id="cb32-578"><a href="#cb32-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-579"><a href="#cb32-579" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**NFI (Normed Fit Index), NNFI (Non-Normed Fit Index, also called TLI), CFI (Comparative Fit Index)**: These range from 0 to 1, with values closer to 1 suggesting a better fit. The two and three factors models have the highest values.</span>
<span id="cb32-580"><a href="#cb32-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-581"><a href="#cb32-581" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**RMSEA (Root Mean Square Error of Approximation)**: lower values are better, with values below 0.05 considered good and up to 0.08 considered acceptable.Only two and three meet this threshold.</span>
<span id="cb32-582"><a href="#cb32-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-583"><a href="#cb32-583" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**RMR (Root Mean Square Residual) and SRMR (Standardized Root Mean Square Residual)**: three is best.</span>
<span id="cb32-584"><a href="#cb32-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-585"><a href="#cb32-585" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>**RFI (Relative Fit Index), PNFI (Parsimonious Normed Fit Index), IFI (Incremental Fit Index), RNI (Relative Noncentrality Index)**: These range from 0 to 1, with values closer to 1 suggesting a better fit. Again three is the winner.</span>
<span id="cb32-586"><a href="#cb32-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-587"><a href="#cb32-587" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>**AIC (Akaike Information Criterion) and BIC (Bayesian Information Criterion)**: The three factor model win's again.</span>
<span id="cb32-588"><a href="#cb32-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-589"><a href="#cb32-589" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of the Results:</span></span>
<span id="cb32-590"><a href="#cb32-590" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**One Latent Model**: shows the poorest fit among the models with a high RMSEA and the lowest CFI. The model's Chi-squared value is also significantly high, indicating a substantial misfit with the observed data.</span>
<span id="cb32-591"><a href="#cb32-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-592"><a href="#cb32-592" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Two Latents Model**: displays a much improved fit compared to the one latent model, as evident from its much lower Chi-squared value, lower RMSEA, and higher CFI. This suggests that two factors might be necessary to adequately represent the underlying structure in the data.</span>
<span id="cb32-593"><a href="#cb32-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-594"><a href="#cb32-594" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Three Latents Model**: provides the best fit metrics among the three configurations.</span>
<span id="cb32-595"><a href="#cb32-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-596"><a href="#cb32-596" aria-hidden="true" tabindex="-1"></a><span class="fu">### Metric Equivalence</span></span>
<span id="cb32-597"><a href="#cb32-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-600"><a href="#cb32-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-601"><a href="#cb32-601" aria-hidden="true" tabindex="-1"></a>compare_eth_metric <span class="ot">&lt;-</span> compare_eth_metric[, <span class="fu">c</span>(<span class="st">"Name"</span>, <span class="st">"Chi2"</span>, <span class="st">"Chi2_df"</span>,<span class="st">"RFI"</span>, <span class="st">"NNFI"</span>, <span class="st">"CFI"</span>,<span class="st">"GFI"</span>,<span class="st">"RMSEA"</span>, <span class="st">"RMSEA_CI_low"</span>, <span class="st">"RMSEA_CI_high"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>)]</span>
<span id="cb32-602"><a href="#cb32-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-603"><a href="#cb32-603" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(compare_eth_metric)<span class="sc">|&gt;</span></span>
<span id="cb32-604"><a href="#cb32-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span>
<span id="cb32-605"><a href="#cb32-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-606"><a href="#cb32-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-607"><a href="#cb32-607" aria-hidden="true" tabindex="-1"></a>This table presents the results of a multi-group confirmatory factor analysis (CFA) conducted to test metric equivalence (also known as weak measurement invariance) across different ethnic categories (eth_cat).  </span>
<span id="cb32-608"><a href="#cb32-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-609"><a href="#cb32-609" aria-hidden="true" tabindex="-1"></a>The three factor model wins again.</span>
<span id="cb32-610"><a href="#cb32-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-611"><a href="#cb32-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-612"><a href="#cb32-612" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scalar Equivalence</span></span>
<span id="cb32-613"><a href="#cb32-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-616"><a href="#cb32-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-617"><a href="#cb32-617" aria-hidden="true" tabindex="-1"></a><span class="co"># view as html table</span></span>
<span id="cb32-618"><a href="#cb32-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-619"><a href="#cb32-619" aria-hidden="true" tabindex="-1"></a>compare_eth_scalar <span class="ot">&lt;-</span> compare_eth_scalar[, <span class="fu">c</span>(<span class="st">"Name"</span>, <span class="st">"Chi2"</span>, <span class="st">"Chi2_df"</span>,<span class="st">"RFI"</span>, <span class="st">"NNFI"</span>, <span class="st">"CFI"</span>,<span class="st">"GFI"</span>,<span class="st">"RMSEA"</span>, <span class="st">"RMSEA_CI_low"</span>, <span class="st">"RMSEA_CI_high"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>)]</span>
<span id="cb32-620"><a href="#cb32-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-621"><a href="#cb32-621" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(compare_eth_scalar)<span class="sc">|&gt;</span></span>
<span id="cb32-622"><a href="#cb32-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span>
<span id="cb32-623"><a href="#cb32-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-624"><a href="#cb32-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-625"><a href="#cb32-625" aria-hidden="true" tabindex="-1"></a>Overall, it seems that we have good evidence for the three-factor model of Kessler-6, but two-factor is close.</span>
<span id="cb32-626"><a href="#cb32-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-627"><a href="#cb32-627" aria-hidden="true" tabindex="-1"></a>Consider: when might we prefer a two-factor model?  When might we prefer a three-factor model?  When might we prefer a one-factor model? </span>
<span id="cb32-628"><a href="#cb32-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-629"><a href="#cb32-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-630"><a href="#cb32-630" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusion: Understanding the Limits of Association in Factor Models</span></span>
<span id="cb32-631"><a href="#cb32-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-632"><a href="#cb32-632" aria-hidden="true" tabindex="-1"></a>This discussion of measurement invariance across different demographic groups underscores the reliance of factor models on the underlying associations in the data. It is crucial to remember that these models are fundamentally descriptive, not prescriptive; they organize the observed data into a coherent structure based on correlations and assumed relationships among variables.</span>
<span id="cb32-633"><a href="#cb32-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-634"><a href="#cb32-634" aria-hidden="true" tabindex="-1"></a>Next week, we will consider the causal assumptions inherent in these factor models. Factor analysis assumes that the latent variables (factors) causally influence the observed indicators. This is a stron assumption that can profoundly affect the interpretation of the results. Understanding and critically evaluating our assumptions is important when applying factor analysis to real-world scenarios.</span>
<span id="cb32-635"><a href="#cb32-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-636"><a href="#cb32-636" aria-hidden="true" tabindex="-1"></a>The assumption that latent variables cause the observed indicators, rather than merely being associated with them, suggests a directional relationship that can affect decisions made based on the analysis. For instance, if we believe that a latent construct like psychological distress causally influences responses on the K6 scale, interventions might be designed to target this distress directly. However, if the relationship is more complex or bidirectional, such straightforward interventions might not be as effective.</span>
<span id="cb32-637"><a href="#cb32-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-638"><a href="#cb32-638" aria-hidden="true" tabindex="-1"></a>Next week's session on causal assumptions will provide a deeper insight into how these assumptions shape our interpretations and the strategies we derive from factor models. This understanding is critical for applying these models appropriately and effectively in psychological research and practice.</span>
<span id="cb32-639"><a href="#cb32-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-640"><a href="#cb32-640" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lab assignment</span></span>
<span id="cb32-641"><a href="#cb32-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-642"><a href="#cb32-642" aria-hidden="true" tabindex="-1"></a>Using the code above, perform MG-CFA on personality measures using the <span class="in">`df_nz`</span> data set. </span>
<span id="cb32-643"><a href="#cb32-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-644"><a href="#cb32-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-645"><a href="#cb32-645" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix A. What is a Correlation Matrix? </span></span>
<span id="cb32-646"><a href="#cb32-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-647"><a href="#cb32-647" aria-hidden="true" tabindex="-1"></a>A correlation matrix is a square matrix that contains the Pearson correlation coefficients between each pair of variables within a dataset. Each element in the matrix represents the correlation between two variables.</span>
<span id="cb32-648"><a href="#cb32-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-649"><a href="#cb32-649" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Structure</span></span>
<span id="cb32-650"><a href="#cb32-650" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Dimensions**: the matrix is $p \times p$ where $p$ is the number of variables.</span>
<span id="cb32-651"><a href="#cb32-651" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Diagonal Elements**: all diagonal elements are 1, because each variable has a perfect correlation with itself.</span>
<span id="cb32-652"><a href="#cb32-652" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Off-Diagonal Elements**: These elements, denoted as $r_{ij}$, are the Pearson correlation coefficients between the $i^{th}$ and $j^{th}$ variables, ranging from -1 to +1.</span>
<span id="cb32-653"><a href="#cb32-653" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$r_{ij} = 1$ indicates a perfect positive linear relationship.</span>
<span id="cb32-654"><a href="#cb32-654" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$r_{ij} = -1$ indicates a perfect negative linear relationship.</span>
<span id="cb32-655"><a href="#cb32-655" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>$r_{ij} = 0$ indicates no linear relationship.</span>
<span id="cb32-656"><a href="#cb32-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-657"><a href="#cb32-657" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Properties</span></span>
<span id="cb32-658"><a href="#cb32-658" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Symmetry**: the matrix is symmetric around the diagonal, meaning $r_{ij} = r_{ji}$.</span>
<span id="cb32-659"><a href="#cb32-659" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Real Values**: all entries are real numbers.</span>
<span id="cb32-660"><a href="#cb32-660" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Bounded Values**: values are constrained between -1 and 1, inclusive.</span>
<span id="cb32-661"><a href="#cb32-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-662"><a href="#cb32-662" aria-hidden="true" tabindex="-1"></a><span class="fu">####  Use</span></span>
<span id="cb32-663"><a href="#cb32-663" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exploring relationships between variables.</span>
<span id="cb32-664"><a href="#cb32-664" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conducting factor analysis to identify latent factors, as here.</span>
<span id="cb32-665"><a href="#cb32-665" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>... </span>
<span id="cb32-666"><a href="#cb32-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-669"><a href="#cb32-669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-670"><a href="#cb32-670" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the correlation matrix</span></span>
<span id="cb32-671"><a href="#cb32-671" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margot)</span>
<span id="cb32-672"><a href="#cb32-672" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-673"><a href="#cb32-673" aria-hidden="true" tabindex="-1"></a>dt_only_k6 <span class="ot">&lt;-</span> df_nz <span class="sc">|&gt;</span> </span>
<span id="cb32-674"><a href="#cb32-674" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-675"><a href="#cb32-675" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb32-676"><a href="#cb32-676" aria-hidden="true" tabindex="-1"></a>    kessler_depressed,</span>
<span id="cb32-677"><a href="#cb32-677" aria-hidden="true" tabindex="-1"></a>    kessler_effort,</span>
<span id="cb32-678"><a href="#cb32-678" aria-hidden="true" tabindex="-1"></a>    kessler_hopeless,</span>
<span id="cb32-679"><a href="#cb32-679" aria-hidden="true" tabindex="-1"></a>    kessler_worthless,</span>
<span id="cb32-680"><a href="#cb32-680" aria-hidden="true" tabindex="-1"></a>    kessler_nervous,</span>
<span id="cb32-681"><a href="#cb32-681" aria-hidden="true" tabindex="-1"></a>    kessler_restless</span>
<span id="cb32-682"><a href="#cb32-682" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-683"><a href="#cb32-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-684"><a href="#cb32-684" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(dt_only_k6, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb32-685"><a href="#cb32-685" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( </span>
<span id="cb32-686"><a href="#cb32-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>( cor_matrix, <span class="dv">2</span>) </span>
<span id="cb32-687"><a href="#cb32-687" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-688"><a href="#cb32-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-689"><a href="#cb32-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-690"><a href="#cb32-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-693"><a href="#cb32-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-694"><a href="#cb32-694" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb32-695"><a href="#cb32-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-696"><a href="#cb32-696" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb32-697"><a href="#cb32-697" aria-hidden="true" tabindex="-1"></a>cor_matrix_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cor_matrix)  <span class="co"># convert matrix to data frame</span></span>
<span id="cb32-698"><a href="#cb32-698" aria-hidden="true" tabindex="-1"></a>cor_matrix_df<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cor_matrix_df)  <span class="co"># add a new column for rownames</span></span>
<span id="cb32-699"><a href="#cb32-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-700"><a href="#cb32-700" aria-hidden="true" tabindex="-1"></a>long_cor_matrix <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(cor_matrix_df, </span>
<span id="cb32-701"><a href="#cb32-701" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cols =</span> <span class="sc">-</span>variable, </span>
<span id="cb32-702"><a href="#cb32-702" aria-hidden="true" tabindex="-1"></a>                                <span class="at">names_to =</span> <span class="st">"comparison"</span>, </span>
<span id="cb32-703"><a href="#cb32-703" aria-hidden="true" tabindex="-1"></a>                                <span class="at">values_to =</span> <span class="st">"correlation"</span>)</span>
<span id="cb32-704"><a href="#cb32-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-705"><a href="#cb32-705" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_cor_matrix, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> comparison, <span class="at">fill =</span> correlation)) <span class="sc">+</span></span>
<span id="cb32-706"><a href="#cb32-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb32-707"><a href="#cb32-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb32-708"><a href="#cb32-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-709"><a href="#cb32-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Variables"</span>, <span class="at">fill =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb32-710"><a href="#cb32-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb32-711"><a href="#cb32-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-712"><a href="#cb32-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-713"><a href="#cb32-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-714"><a href="#cb32-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-715"><a href="#cb32-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-716"><a href="#cb32-716" aria-hidden="true" tabindex="-1"></a><span class="fu">### Packages</span></span>
<span id="cb32-717"><a href="#cb32-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-720"><a href="#cb32-720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-721"><a href="#cb32-721" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span>
<span id="cb32-722"><a href="#cb32-722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-723"><a href="#cb32-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-724"><a href="#cb32-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-725"><a href="#cb32-725" aria-hidden="true" tabindex="-1"></a><span class="fu">## PART 2. How Traditional Measurement Theory Fails</span></span>
<span id="cb32-726"><a href="#cb32-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-727"><a href="#cb32-727" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb32-728"><a href="#cb32-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-729"><a href="#cb32-729" aria-hidden="true" tabindex="-1"></a>**Required**</span>
<span id="cb32-730"><a href="#cb32-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-731"><a href="#cb32-731" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@vanderweele2022</span><span class="co">]</span>  <span class="co">[</span><span class="ot">link</span><span class="co">](https://www.dropbox.com/scl/fi/mmyguc0hrci8wtyyfkv6w/tyler-vanderweele-contruct-measures.pdf?rlkey=o18fiyajdqqpyjgssyh6mz6qm&amp;dl=0)</span></span>
<span id="cb32-732"><a href="#cb32-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-733"><a href="#cb32-733" aria-hidden="true" tabindex="-1"></a>**Suggested**</span>
<span id="cb32-734"><a href="#cb32-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-735"><a href="#cb32-735" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">@harkness2003questionnaire</span><span class="co">] [link]</span>(https://www.dropbox.com/scl/fi/uhj73050r1i7rznn6i57f/HarknessvandeVijver2003_Chapter-2.pdf?rlkey=ijxobrh7czj3rfnq9air342d2&amp;dl=0)</span>
<span id="cb32-736"><a href="#cb32-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-737"><a href="#cb32-737" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-738"><a href="#cb32-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-739"><a href="#cb32-739" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb32-740"><a href="#cb32-740" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key concepts</span></span>
<span id="cb32-741"><a href="#cb32-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-742"><a href="#cb32-742" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The Formative Model in Factor Analysis</span>
<span id="cb32-743"><a href="#cb32-743" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The Reflective Model in Factor Analysis</span>
<span id="cb32-744"><a href="#cb32-744" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How to use causal Diagrams to evaluate assumptions.</span>
<span id="cb32-745"><a href="#cb32-745" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-746"><a href="#cb32-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-747"><a href="#cb32-747" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb32-748"><a href="#cb32-748" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understanding causal assumptions of measurement theory</span>
<span id="cb32-749"><a href="#cb32-749" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Guidance on your final assessment.</span>
<span id="cb32-750"><a href="#cb32-750" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-751"><a href="#cb32-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-752"><a href="#cb32-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-753"><a href="#cb32-753" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb32-754"><a href="#cb32-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-755"><a href="#cb32-755" aria-hidden="true" tabindex="-1"></a>By the end of this lecture you will:</span>
<span id="cb32-756"><a href="#cb32-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-757"><a href="#cb32-757" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Understand the causal assumptions implied by the factor analytic interpretation of the formative and reflective models.</span>
<span id="cb32-758"><a href="#cb32-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-759"><a href="#cb32-759" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Be able to distinguish between statistical and structural interpretations of these models.</span>
<span id="cb32-760"><a href="#cb32-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-761"><a href="#cb32-761" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Understand why Vanderweele thinks consistent causal estimation is possible using the theory of multiple versions of treatments for constructs with multiple indicators</span>
<span id="cb32-762"><a href="#cb32-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-763"><a href="#cb32-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-766"><a href="#cb32-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-767"><a href="#cb32-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb32-768"><a href="#cb32-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-769"><a href="#cb32-769" aria-hidden="true" tabindex="-1"></a><span class="co">#read libraries</span></span>
<span id="cb32-770"><a href="#cb32-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-771"><a href="#cb32-771" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb32-772"><a href="#cb32-772" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb32-773"><a href="#cb32-773" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">"all"</span>)</span>
<span id="cb32-774"><a href="#cb32-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-775"><a href="#cb32-775" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb32-776"><a href="#cb32-776" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margot"</span>)</span>
<span id="cb32-777"><a href="#cb32-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-778"><a href="#cb32-778" aria-hidden="true" tabindex="-1"></a><span class="co"># read libraries</span></span>
<span id="cb32-779"><a href="#cb32-779" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"/Users/joseph/GIT/templates/functions/libs2.R"</span>)</span>
<span id="cb32-780"><a href="#cb32-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-781"><a href="#cb32-781" aria-hidden="true" tabindex="-1"></a><span class="co"># read functions</span></span>
<span id="cb32-782"><a href="#cb32-782" aria-hidden="true" tabindex="-1"></a><span class="co">#source("/Users/joseph/GIT/templates/functions/funs.R")</span></span>
<span id="cb32-783"><a href="#cb32-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-784"><a href="#cb32-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-785"><a href="#cb32-785" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two ways of thinking about measurement in psychometric research.</span></span>
<span id="cb32-786"><a href="#cb32-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-787"><a href="#cb32-787" aria-hidden="true" tabindex="-1"></a>In psychometric research, formative and reflective models describe the relationship between latent variables and their respective indicators. VanderWeele discusses this in the assigned reading for this week <span class="co">[</span><span class="ot">@vanderweele2022</span><span class="co">]</span>.</span>
<span id="cb32-788"><a href="#cb32-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-789"><a href="#cb32-789" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reflective Model (Factor Analysis)</span></span>
<span id="cb32-790"><a href="#cb32-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-791"><a href="#cb32-791" aria-hidden="true" tabindex="-1"></a>In a reflective measurement model, also known as an effect indicator model, the latent variable is understood to cause the observed variables. In this model, changes in the latent variable cause changes in the observed variables. Each indicator (observed variable) is a 'reflection' of the latent variable. In other words, they are effects or manifestations of the latent variable. These relations are presented in @fig-dag-latent-1.</span>
<span id="cb32-792"><a href="#cb32-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-793"><a href="#cb32-793" aria-hidden="true" tabindex="-1"></a>The reflective model may be expressed:</span>
<span id="cb32-794"><a href="#cb32-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-795"><a href="#cb32-795" aria-hidden="true" tabindex="-1"></a>$$X_i = \lambda_i \eta + \varepsilon_i$$</span>
<span id="cb32-796"><a href="#cb32-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-797"><a href="#cb32-797" aria-hidden="true" tabindex="-1"></a>Here, $X_i$ is an observed variable (indicator), $\lambda_i$ is the factor loading for $X_i$, $\eta$ is the latent variable, and $\varepsilon_i$ is the error term associated with $X_i$. It is assumed that all the indicators are interchangeable and have a common cause, which is the latent variable $\eta$.</span>
<span id="cb32-798"><a href="#cb32-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-799"><a href="#cb32-799" aria-hidden="true" tabindex="-1"></a>In the conventional approach of factor analysis, the assumption is that a common latent variable is responsible for the correlation seen among the indicators. Thus, any fluctuation in the latent variable should immediately lead to similar changes in the indicators.These assumptions are presented in @fig-dag-latent-1.</span>
<span id="cb32-800"><a href="#cb32-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-803"><a href="#cb32-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-804"><a href="#cb32-804" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-latent-1</span></span>
<span id="cb32-805"><a href="#cb32-805" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Reflective model: assume univariate latent variable η giving rise to indicators X1...X3. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-806"><a href="#cb32-806" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb32-807"><a href="#cb32-807" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-808"><a href="#cb32-808" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-809"><a href="#cb32-809" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-810"><a href="#cb32-810" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-811"><a href="#cb32-811" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-812"><a href="#cb32-812" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-813"><a href="#cb32-813" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-814"><a href="#cb32-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-815"><a href="#cb32-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-816"><a href="#cb32-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-817"><a href="#cb32-817" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-818"><a href="#cb32-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-819"><a href="#cb32-819" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (eta) at (0, 0) {$\eta$};</span></span>
<span id="cb32-820"><a href="#cb32-820" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X1) at (6, 1) {X$_1$};</span></span>
<span id="cb32-821"><a href="#cb32-821" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X2) at (6, 0) {$\vdots$};</span></span>
<span id="cb32-822"><a href="#cb32-822" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Xn) at (6, -1) {X$_n$};</span></span>
<span id="cb32-823"><a href="#cb32-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-824"><a href="#cb32-824" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (X1);</span></span>
<span id="cb32-825"><a href="#cb32-825" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (X2);</span></span>
<span id="cb32-826"><a href="#cb32-826" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (Xn);</span></span>
<span id="cb32-827"><a href="#cb32-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-828"><a href="#cb32-828" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-829"><a href="#cb32-829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-830"><a href="#cb32-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-831"><a href="#cb32-831" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Formative Model (Factor Analysis)</span></span>
<span id="cb32-832"><a href="#cb32-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-833"><a href="#cb32-833" aria-hidden="true" tabindex="-1"></a>In a formative measurement model, the observed variables are seen as causing or determining the latent variable. Here again, there is a single latent variable. However this latent variable is taken to be an effect of the underlying indicators. These relations are presented in @fig-dag-latent-formative_0.</span>
<span id="cb32-834"><a href="#cb32-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-835"><a href="#cb32-835" aria-hidden="true" tabindex="-1"></a>The formative model may be expressed:</span>
<span id="cb32-836"><a href="#cb32-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-837"><a href="#cb32-837" aria-hidden="true" tabindex="-1"></a>$$\eta = \sum_i\lambda_i X_i + \varepsilon$$</span>
<span id="cb32-838"><a href="#cb32-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-839"><a href="#cb32-839" aria-hidden="true" tabindex="-1"></a>In this equation, $\eta$ is the latent variable, $\lambda_i$ is the weight for $X_i$ (the observed variable), and $\varepsilon$ is the error term. The latent variable $\eta$ is a composite of the observed variables $X_i$.</span>
<span id="cb32-840"><a href="#cb32-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-841"><a href="#cb32-841" aria-hidden="true" tabindex="-1"></a>In the context of a formative model, correlation or interchangeability between indicators is not required. Each indicator contributes distinctively to the latent variable. As such, a modification in one indicator doesn't automatically imply a corresponding change in the other indicators.</span>
<span id="cb32-842"><a href="#cb32-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-845"><a href="#cb32-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-846"><a href="#cb32-846" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-latent-formative_0</span></span>
<span id="cb32-847"><a href="#cb32-847" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Formative model:: assume univariate latent variable from which the indicators X1...X3 give rise. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-848"><a href="#cb32-848" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 80%</span></span>
<span id="cb32-849"><a href="#cb32-849" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-850"><a href="#cb32-850" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-851"><a href="#cb32-851" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-852"><a href="#cb32-852" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-853"><a href="#cb32-853" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-854"><a href="#cb32-854" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-855"><a href="#cb32-855" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-856"><a href="#cb32-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-857"><a href="#cb32-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-858"><a href="#cb32-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-859"><a href="#cb32-859" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-860"><a href="#cb32-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-861"><a href="#cb32-861" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (X1) at (0, 1) {X1};</span></span>
<span id="cb32-862"><a href="#cb32-862" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X2) at (0, 0) {$\vdots$};</span></span>
<span id="cb32-863"><a href="#cb32-863" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (Xn) at (0, -1) {X$_n$};</span></span>
<span id="cb32-864"><a href="#cb32-864" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (eta) at (6, 0) {$\eta$};</span></span>
<span id="cb32-865"><a href="#cb32-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-866"><a href="#cb32-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-867"><a href="#cb32-867" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X1) to (eta);</span></span>
<span id="cb32-868"><a href="#cb32-868" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X2) to (eta);</span></span>
<span id="cb32-869"><a href="#cb32-869" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Xn) to (eta);</span></span>
<span id="cb32-870"><a href="#cb32-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-871"><a href="#cb32-871" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-872"><a href="#cb32-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-873"><a href="#cb32-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-874"><a href="#cb32-874" aria-hidden="true" tabindex="-1"></a><span class="fu">## Structural Interpretation of the formative model and reflective models (Factor Analysis)</span></span>
<span id="cb32-875"><a href="#cb32-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-876"><a href="#cb32-876" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; However, this analysis of reflective and formative models assumed that the latent η was causally efficacious. This may not be the case (VanderWeele 2022)</span></span>
<span id="cb32-877"><a href="#cb32-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-878"><a href="#cb32-878" aria-hidden="true" tabindex="-1"></a>VanderWeele distinguishes between statistical and structural interpretations of the equations preesented above.</span>
<span id="cb32-879"><a href="#cb32-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-880"><a href="#cb32-880" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Statistical Model:** a mathematical construct that shows how observable variables, also known as indicators, are related to latent or unseen variables. These are presented in the equations above</span>
<span id="cb32-881"><a href="#cb32-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-882"><a href="#cb32-882" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Structural Model:** A structural model refers to the causal assumptions or hypotheses about the relationships among variables in a statistical model. The assumptions of the factor analytic tradition are presented in @fig-dag-latent-formative_0 and @fig-dag-latent-1 are structural models.</span>
<span id="cb32-883"><a href="#cb32-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-884"><a href="#cb32-884" aria-hidden="true" tabindex="-1"></a>We have seen that the **reflective model** statistically implies that the observed variables (indicators) are reflections or manifestations of the latent variable, expressed as $X_i = \lambda_i \eta + \varepsilon_i$. However, the factor analytic tradition makes the additional structural assumption that a univariate latent variable is causally efficacious and influences the observed variables, as in: @fig-structural-assumptions-reflective-model.</span>
<span id="cb32-885"><a href="#cb32-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-886"><a href="#cb32-886" aria-hidden="true" tabindex="-1"></a>We have also seen that the **formative model** statistically implies that the latent variable is formed or influenced by the observed variables, expressed as $\eta = \sum_i\lambda_i X_i + \varepsilon$. However, the factor analytic tradition makes the additional assumption that the observed variables give rise to a univariate latent variable, as in @fig-dag-reflective-assumptions_note.</span>
<span id="cb32-887"><a href="#cb32-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-888"><a href="#cb32-888" aria-hidden="true" tabindex="-1"></a>::: {#fig-latent layout-ncol="1"}</span>
<span id="cb32-891"><a href="#cb32-891" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-892"><a href="#cb32-892" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-structural-assumptions-reflective-model</span></span>
<span id="cb32-893"><a href="#cb32-893" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Reflective Model: causal assumptions. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-894"><a href="#cb32-894" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-895"><a href="#cb32-895" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-896"><a href="#cb32-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-897"><a href="#cb32-897" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-898"><a href="#cb32-898" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-899"><a href="#cb32-899" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-900"><a href="#cb32-900" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-901"><a href="#cb32-901" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-902"><a href="#cb32-902" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-903"><a href="#cb32-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-904"><a href="#cb32-904" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-905"><a href="#cb32-905" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (L) at (0, 0) {L};</span></span>
<span id="cb32-906"><a href="#cb32-906" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (eta) at (2, 0) {$\eta$};</span></span>
<span id="cb32-907"><a href="#cb32-907" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X1) at (4, 1) {X1};</span></span>
<span id="cb32-908"><a href="#cb32-908" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X2) at (4, 0) {$\vdots$};</span></span>
<span id="cb32-909"><a href="#cb32-909" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Xn) at (4, -1) {X$_n$};</span></span>
<span id="cb32-910"><a href="#cb32-910" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (6, 0) {A};</span></span>
<span id="cb32-911"><a href="#cb32-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-912"><a href="#cb32-912" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (8, 0) {Y};</span></span>
<span id="cb32-913"><a href="#cb32-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-914"><a href="#cb32-914" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend right=80, draw=black] (L) to (Y);</span></span>
<span id="cb32-915"><a href="#cb32-915" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (L) to (eta);</span></span>
<span id="cb32-916"><a href="#cb32-916" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend left=90, draw=red] (eta) to (Y);</span></span>
<span id="cb32-917"><a href="#cb32-917" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (X1);</span></span>
<span id="cb32-918"><a href="#cb32-918" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (X2);</span></span>
<span id="cb32-919"><a href="#cb32-919" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (Xn);</span></span>
<span id="cb32-920"><a href="#cb32-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-921"><a href="#cb32-921" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X1) to (A);</span></span>
<span id="cb32-922"><a href="#cb32-922" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X2) to (A);</span></span>
<span id="cb32-923"><a href="#cb32-923" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Xn) to (A);</span></span>
<span id="cb32-924"><a href="#cb32-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-925"><a href="#cb32-925" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-926"><a href="#cb32-926" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-927"><a href="#cb32-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-930"><a href="#cb32-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-931"><a href="#cb32-931" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-reflective-assumptions_note</span></span>
<span id="cb32-932"><a href="#cb32-932" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Formative model: causal assumptions. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-933"><a href="#cb32-933" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-934"><a href="#cb32-934" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-935"><a href="#cb32-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-936"><a href="#cb32-936" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-937"><a href="#cb32-937" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-938"><a href="#cb32-938" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-939"><a href="#cb32-939" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-940"><a href="#cb32-940" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-941"><a href="#cb32-941" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-942"><a href="#cb32-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-943"><a href="#cb32-943" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-944"><a href="#cb32-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-945"><a href="#cb32-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-946"><a href="#cb32-946" aria-hidden="true" tabindex="-1"></a><span class="in">\node [draw=black] (L) at (0, 0) {L};</span></span>
<span id="cb32-947"><a href="#cb32-947" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (X1) at (3, 1) {X1};</span></span>
<span id="cb32-948"><a href="#cb32-948" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X2) at (3, 0) {$\vdots$};</span></span>
<span id="cb32-949"><a href="#cb32-949" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (Xn) at (3, -1) {X$_n$};</span></span>
<span id="cb32-950"><a href="#cb32-950" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (eta) at (6, 0) {$\eta$};</span></span>
<span id="cb32-951"><a href="#cb32-951" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (9, 0) {Y};</span></span>
<span id="cb32-952"><a href="#cb32-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-953"><a href="#cb32-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-954"><a href="#cb32-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-955"><a href="#cb32-955" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X1) to (eta);</span></span>
<span id="cb32-956"><a href="#cb32-956" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X2) to (eta);</span></span>
<span id="cb32-957"><a href="#cb32-957" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Xn) to (eta);</span></span>
<span id="cb32-958"><a href="#cb32-958" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend right=80, draw=black] (L) to (Y);</span></span>
<span id="cb32-959"><a href="#cb32-959" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, bend left = 80] (L) to (eta);</span></span>
<span id="cb32-960"><a href="#cb32-960" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (eta) to (Y);</span></span>
<span id="cb32-961"><a href="#cb32-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-962"><a href="#cb32-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-963"><a href="#cb32-963" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-964"><a href="#cb32-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-965"><a href="#cb32-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-966"><a href="#cb32-966" aria-hidden="true" tabindex="-1"></a>The reflective model implies $X_i = \lambda_i \eta + \varepsilon_i$, which factor analysts take to imply @fig-structural-assumptions-reflective-model.</span>
<span id="cb32-967"><a href="#cb32-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-968"><a href="#cb32-968" aria-hidden="true" tabindex="-1"></a>The formative model implies $\eta = \sum_i\lambda_i X_i + \varepsilon$, which factor analysts take to imply @fig-dag-reflective-assumptions_note.</span>
<span id="cb32-969"><a href="#cb32-969" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-970"><a href="#cb32-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-971"><a href="#cb32-971" aria-hidden="true" tabindex="-1"></a><span class="fu">## Problems with the structural interpretations of the reflective and formative factor models.</span></span>
<span id="cb32-972"><a href="#cb32-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-973"><a href="#cb32-973" aria-hidden="true" tabindex="-1"></a>While the statistical model $X_i = \lambda_i \eta + \varepsilon_i$ aligns with @fig-structural-assumptions-reflective-model, it also alings with @fig-dag-formative-assumptions-compatible. Cross-sectional data, unfortunately, do not provide enough information to discern between these different structural interpretations.</span>
<span id="cb32-974"><a href="#cb32-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-975"><a href="#cb32-975" aria-hidden="true" tabindex="-1"></a>Similarly, the statistical model $\eta = \sum_i\lambda_i X_i + \varepsilon$ agrees with @fig-dag-reflective-assumptions_note but it also agrees with\@fig-dag-reflectiveassumptions-compatible_again. Here too, cross-sectional data cannot decide between these two potential structural interpretations.</span>
<span id="cb32-976"><a href="#cb32-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-977"><a href="#cb32-977" aria-hidden="true" tabindex="-1"></a>There are other, compatible structural interprestations as well. The formative and reflective conceptions of factor analysis are compatible with indicators having causal effects as shown in @fig_dag_multivariate_reality_again. They are also compatible with a multivariate reality giving rise to multiple indicators as shown in @fig-dag-multivariate-reality-bulbulia.</span>
<span id="cb32-978"><a href="#cb32-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-979"><a href="#cb32-979" aria-hidden="true" tabindex="-1"></a>::: {layout-ncol="1"}</span>
<span id="cb32-982"><a href="#cb32-982" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-983"><a href="#cb32-983" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-formative-assumptions-compatible</span></span>
<span id="cb32-984"><a href="#cb32-984" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Formative model is compatible with indicators causing outcome.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-985"><a href="#cb32-985" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-986"><a href="#cb32-986" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-987"><a href="#cb32-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-988"><a href="#cb32-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-989"><a href="#cb32-989" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-990"><a href="#cb32-990" aria-hidden="true" tabindex="-1"></a><span class="in">%\node [rectangle, draw=white] (L) at (0, 0) {L};</span></span>
<span id="cb32-991"><a href="#cb32-991" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (eta) at (2, 0) {$\eta$};</span></span>
<span id="cb32-992"><a href="#cb32-992" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X1) at (4, 1) {X1};</span></span>
<span id="cb32-993"><a href="#cb32-993" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X2) at (4, 0) {$\vdots$};</span></span>
<span id="cb32-994"><a href="#cb32-994" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Xn) at (4, -1) {X$_n$};</span></span>
<span id="cb32-995"><a href="#cb32-995" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (6, 0) {Y};</span></span>
<span id="cb32-996"><a href="#cb32-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-997"><a href="#cb32-997" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, bend right=80, draw=black] (L) to (Y);</span></span>
<span id="cb32-998"><a href="#cb32-998" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, bend left=60, draw=black] (L) to (X1);</span></span>
<span id="cb32-999"><a href="#cb32-999" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, bend left=40, draw=black] (L) to (X2);</span></span>
<span id="cb32-1000"><a href="#cb32-1000" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, bend right=60, draw=black] (L) to (Xn);</span></span>
<span id="cb32-1001"><a href="#cb32-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1002"><a href="#cb32-1002" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (X1);</span></span>
<span id="cb32-1003"><a href="#cb32-1003" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (X2);</span></span>
<span id="cb32-1004"><a href="#cb32-1004" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (Xn);</span></span>
<span id="cb32-1005"><a href="#cb32-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1006"><a href="#cb32-1006" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (X1) to (Y);</span></span>
<span id="cb32-1007"><a href="#cb32-1007" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (X2) to (Y);</span></span>
<span id="cb32-1008"><a href="#cb32-1008" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (Xn) to (Y);</span></span>
<span id="cb32-1009"><a href="#cb32-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1010"><a href="#cb32-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1011"><a href="#cb32-1011" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1012"><a href="#cb32-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1013"><a href="#cb32-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1016"><a href="#cb32-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-1017"><a href="#cb32-1017" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-reflectiveassumptions-compatible_again</span></span>
<span id="cb32-1018"><a href="#cb32-1018" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Reflective model is compatible with indicators causing the outcome. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-1019"><a href="#cb32-1019" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-1020"><a href="#cb32-1020" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-1021"><a href="#cb32-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1022"><a href="#cb32-1022" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-1023"><a href="#cb32-1023" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-1024"><a href="#cb32-1024" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-1025"><a href="#cb32-1025" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-1026"><a href="#cb32-1026" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-1027"><a href="#cb32-1027" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-1028"><a href="#cb32-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1029"><a href="#cb32-1029" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-1030"><a href="#cb32-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1031"><a href="#cb32-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1032"><a href="#cb32-1032" aria-hidden="true" tabindex="-1"></a><span class="in">%\node [draw=white] (L) at (0, 0) {L};</span></span>
<span id="cb32-1033"><a href="#cb32-1033" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X1) at (2, 1) {X1};</span></span>
<span id="cb32-1034"><a href="#cb32-1034" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X2) at (2, 0) {$\vdots$};</span></span>
<span id="cb32-1035"><a href="#cb32-1035" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Xn) at (2, -1) {X$_n$};</span></span>
<span id="cb32-1036"><a href="#cb32-1036" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (eta) at (4, 0) {$\eta$};</span></span>
<span id="cb32-1037"><a href="#cb32-1037" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (6, 0) {Y};</span></span>
<span id="cb32-1038"><a href="#cb32-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1039"><a href="#cb32-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1040"><a href="#cb32-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1041"><a href="#cb32-1041" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X1) to (eta);</span></span>
<span id="cb32-1042"><a href="#cb32-1042" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X2) to (eta);</span></span>
<span id="cb32-1043"><a href="#cb32-1043" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Xn) to (eta);</span></span>
<span id="cb32-1044"><a href="#cb32-1044" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, bend left=80, draw=black] (L) to (Y);</span></span>
<span id="cb32-1045"><a href="#cb32-1045" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend left=60, draw=red] (X1) to (Y);</span></span>
<span id="cb32-1046"><a href="#cb32-1046" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend left=40, draw=red] (X2) to (Y);</span></span>
<span id="cb32-1047"><a href="#cb32-1047" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend right =60,  draw=red] (Xn) to (Y);</span></span>
<span id="cb32-1048"><a href="#cb32-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1049"><a href="#cb32-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1050"><a href="#cb32-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1051"><a href="#cb32-1051" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1052"><a href="#cb32-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1053"><a href="#cb32-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1056"><a href="#cb32-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-1057"><a href="#cb32-1057" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig_dag_multivariate_reality_again</span></span>
<span id="cb32-1058"><a href="#cb32-1058" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Multivariate reality gives rise to the indicators, from which we draw our measures. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-1059"><a href="#cb32-1059" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-1060"><a href="#cb32-1060" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-1061"><a href="#cb32-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1062"><a href="#cb32-1062" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-1063"><a href="#cb32-1063" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-1064"><a href="#cb32-1064" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-1065"><a href="#cb32-1065" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-1066"><a href="#cb32-1066" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-1067"><a href="#cb32-1067" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-1068"><a href="#cb32-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1069"><a href="#cb32-1069" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-1070"><a href="#cb32-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1071"><a href="#cb32-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1072"><a href="#cb32-1072" aria-hidden="true" tabindex="-1"></a><span class="in">\node [draw=white] (eta1) at (0, 1) {$\eta_1$};</span></span>
<span id="cb32-1073"><a href="#cb32-1073" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (eta2) at (0, 0) {$\vdots$};</span></span>
<span id="cb32-1074"><a href="#cb32-1074" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (etan) at (0, -1) {$\eta_n$};</span></span>
<span id="cb32-1075"><a href="#cb32-1075" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X1) at (2, 1) {X$_1$};</span></span>
<span id="cb32-1076"><a href="#cb32-1076" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X2) at (2, 0) {$\vdots$};</span></span>
<span id="cb32-1077"><a href="#cb32-1077" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Xn) at (2, -1 ) {X$_n$};</span></span>
<span id="cb32-1078"><a href="#cb32-1078" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (4, 0 ) {A};</span></span>
<span id="cb32-1079"><a href="#cb32-1079" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (6, 0 ) {Y};</span></span>
<span id="cb32-1080"><a href="#cb32-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1081"><a href="#cb32-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1082"><a href="#cb32-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1083"><a href="#cb32-1083" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta1) to (X1);</span></span>
<span id="cb32-1084"><a href="#cb32-1084" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta2) to (X2);</span></span>
<span id="cb32-1085"><a href="#cb32-1085" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (etan) to (Xn);</span></span>
<span id="cb32-1086"><a href="#cb32-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1087"><a href="#cb32-1087" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X1) to (A);</span></span>
<span id="cb32-1088"><a href="#cb32-1088" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X2) to (A);</span></span>
<span id="cb32-1089"><a href="#cb32-1089" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Xn) to (A);</span></span>
<span id="cb32-1090"><a href="#cb32-1090" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend left=80, draw=red] (eta1) to (Y);</span></span>
<span id="cb32-1091"><a href="#cb32-1091" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend right=80, draw=red] (etan) to (Y);</span></span>
<span id="cb32-1092"><a href="#cb32-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1093"><a href="#cb32-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1094"><a href="#cb32-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1095"><a href="#cb32-1095" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1096"><a href="#cb32-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1097"><a href="#cb32-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1100"><a href="#cb32-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-1101"><a href="#cb32-1101" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-multivariate-reality-bulbulia</span></span>
<span id="cb32-1102"><a href="#cb32-1102" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Although we take our constructs, A, to be functions of indicators, X, such that, perhaps only one or several of the indicators are efficacious.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-1103"><a href="#cb32-1103" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-1104"><a href="#cb32-1104" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-1105"><a href="#cb32-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1106"><a href="#cb32-1106" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-1107"><a href="#cb32-1107" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-1108"><a href="#cb32-1108" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-1109"><a href="#cb32-1109" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-1110"><a href="#cb32-1110" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-1111"><a href="#cb32-1111" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-1112"><a href="#cb32-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1113"><a href="#cb32-1113" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-1114"><a href="#cb32-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1115"><a href="#cb32-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1116"><a href="#cb32-1116" aria-hidden="true" tabindex="-1"></a><span class="in">\node [draw=white] (eta1) at (0, 1) {$\eta_1$};</span></span>
<span id="cb32-1117"><a href="#cb32-1117" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (eta2) at (0, 0) {$\vdots$};</span></span>
<span id="cb32-1118"><a href="#cb32-1118" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (etan) at (0, -1) {$\eta_n$};</span></span>
<span id="cb32-1119"><a href="#cb32-1119" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X1) at (2, 1) {X$_1$};</span></span>
<span id="cb32-1120"><a href="#cb32-1120" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X2) at (2, 0) {$\vdots$};</span></span>
<span id="cb32-1121"><a href="#cb32-1121" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Xn) at (2, -1 ) {X$_n$};</span></span>
<span id="cb32-1122"><a href="#cb32-1122" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (6, 0 ) {Y};</span></span>
<span id="cb32-1123"><a href="#cb32-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1124"><a href="#cb32-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1125"><a href="#cb32-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1126"><a href="#cb32-1126" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta1) to (X1);</span></span>
<span id="cb32-1127"><a href="#cb32-1127" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta2) to (X2);</span></span>
<span id="cb32-1128"><a href="#cb32-1128" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (etan) to (Xn);</span></span>
<span id="cb32-1129"><a href="#cb32-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1130"><a href="#cb32-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1131"><a href="#cb32-1131" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend left=80, draw=red] (eta1) to (Y);</span></span>
<span id="cb32-1132"><a href="#cb32-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1133"><a href="#cb32-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1134"><a href="#cb32-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1135"><a href="#cb32-1135" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1136"><a href="#cb32-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1137"><a href="#cb32-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1138"><a href="#cb32-1138" aria-hidden="true" tabindex="-1"></a>VanderWeele's key observation is this:</span>
<span id="cb32-1139"><a href="#cb32-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1140"><a href="#cb32-1140" aria-hidden="true" tabindex="-1"></a>**While cross-sectional data can provide insights into the relationships between variables, they cannot conclusively determine the causal direction of these relationships.**</span>
<span id="cb32-1141"><a href="#cb32-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1142"><a href="#cb32-1142" aria-hidden="true" tabindex="-1"></a>This results is worrying. The structural assumptions of factor analysis underpin nearly all psychological research. If the cross-sectional data used to derive factor structures cannot decide whether the structural interpretations of factor models are accurate, where does that leave us?</span>
<span id="cb32-1143"><a href="#cb32-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1144"><a href="#cb32-1144" aria-hidden="true" tabindex="-1"></a>More worrying still, VanderWeele discusses several longitudinal tests for structural interpretations of univariate latent variables that do not pass.</span>
<span id="cb32-1145"><a href="#cb32-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1146"><a href="#cb32-1146" aria-hidden="true" tabindex="-1"></a>Where does that leave us? In psychology we have heard about a replication crisis. We might describe the reliance on factor models as an aspect of a much larger, and more worrying "causal crisis" <span class="co">[</span><span class="ot">@bulbulia2022</span><span class="co">]</span></span>
<span id="cb32-1147"><a href="#cb32-1147" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-1148"><a href="#cb32-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1149"><a href="#cb32-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">## Review of the theory of multiple versions of treatment</span></span>
<span id="cb32-1150"><a href="#cb32-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1153"><a href="#cb32-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-1154"><a href="#cb32-1154" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig_dag_multiple_version_treatment_dag</span></span>
<span id="cb32-1155"><a href="#cb32-1155" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Multiple Versions of treatment. Heae, A is regarded to bbe a coarseneed version of K"</span></span>
<span id="cb32-1156"><a href="#cb32-1156" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-1157"><a href="#cb32-1157" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-1158"><a href="#cb32-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1159"><a href="#cb32-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1160"><a href="#cb32-1160" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-1161"><a href="#cb32-1161" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-1162"><a href="#cb32-1162" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-1163"><a href="#cb32-1163" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-1164"><a href="#cb32-1164" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-1165"><a href="#cb32-1165" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-1166"><a href="#cb32-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1167"><a href="#cb32-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1168"><a href="#cb32-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1169"><a href="#cb32-1169" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-1170"><a href="#cb32-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1171"><a href="#cb32-1171" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (L0) at (0, 0) {L};</span></span>
<span id="cb32-1172"><a href="#cb32-1172" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (K1) at (2, 0) {K};</span></span>
<span id="cb32-1173"><a href="#cb32-1173" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (A1) at (4, 0) {A};</span></span>
<span id="cb32-1174"><a href="#cb32-1174" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y2) at (6, 0) {Y$_k$};</span></span>
<span id="cb32-1175"><a href="#cb32-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1176"><a href="#cb32-1176" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (L0) to (K1);</span></span>
<span id="cb32-1177"><a href="#cb32-1177" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend right, draw=black] (L0) to (Y2);</span></span>
<span id="cb32-1178"><a href="#cb32-1178" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (K1) to (A1);</span></span>
<span id="cb32-1179"><a href="#cb32-1179" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, bend left] (K1) to (Y2);</span></span>
<span id="cb32-1180"><a href="#cb32-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1181"><a href="#cb32-1181" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1182"><a href="#cb32-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1183"><a href="#cb32-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1184"><a href="#cb32-1184" aria-hidden="true" tabindex="-1"></a>Perhaps not all is lost. VanderWeele looks to the theory of multiple versions of treatment for solace.</span>
<span id="cb32-1185"><a href="#cb32-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1186"><a href="#cb32-1186" aria-hidden="true" tabindex="-1"></a>Recall, a causal effect is defined as the difference in the expected potential outcome when everyone is exposed (perhaps contrary to fact) to one level of a treatment, conditional on their levels of a confounder, with the expected potential outcome when everyone is exposed to a a different level of a treatement (perhaps contrary to fact), conditional on their levels of a counfounder.</span>
<span id="cb32-1187"><a href="#cb32-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1188"><a href="#cb32-1188" aria-hidden="true" tabindex="-1"></a>$$ \delta = \sum_l \left( \mathbb{E}<span class="co">[</span><span class="ot">Y|A=a,l</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y|A=a^*,l</span><span class="co">]</span> \right) P(l)$$</span>
<span id="cb32-1189"><a href="#cb32-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1190"><a href="#cb32-1190" aria-hidden="true" tabindex="-1"></a>where $\delta$ is the causal estimand on the difference scale $(\mathbb{E}<span class="co">[</span><span class="ot">Y^0 - Y^0</span><span class="co">]</span>)$.</span>
<span id="cb32-1191"><a href="#cb32-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1192"><a href="#cb32-1192" aria-hidden="true" tabindex="-1"></a>In causal inference, the multiple versions of treatment theory allows us to handle situations where the treatment isn't uniform, but instead has several variations. Each variation of the treatment, or "version", can have a different impact on the outcome. Consistency is not violated because it is redefined: for each version of the treatment, the outcome under that version is equal to the observed outcome when that version is received. Put differently we may think of the indicator $A$ as corresponding to many version of the true treament $K$. Where conditional independence holds such that there is a absence of confounding for the effect of $K$ on $Y$ given $L$, we have: $Y_k \coprod A|K,L$. This states conditional on $L$, $A$ gives no information about $Y$ once $K$ and $L$ are accounted for. When $Y = Y_k$ if $K = k$ and Y$_k$ is independent of $K$, condition on $L$, then $A$ may be thought of as a coarsened indicator of $K$, as shown in @fig_dag_multiple_version_treatment_dag. We may estimate consistent causal effects where:</span>
<span id="cb32-1193"><a href="#cb32-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1194"><a href="#cb32-1194" aria-hidden="true" tabindex="-1"></a>$$ \delta = \sum_{k,l} \mathbb{E}<span class="co">[</span><span class="ot">Y_k|l</span><span class="co">]</span> P(k|a,l) P(l) - \sum_{k,l} \mathbb{E}<span class="co">[</span><span class="ot">Y_k|l</span><span class="co">]</span> P(k|a^*,l) P(l)$$</span>
<span id="cb32-1195"><a href="#cb32-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1196"><a href="#cb32-1196" aria-hidden="true" tabindex="-1"></a>The scenario represents a hypothetical randomised trial where within strata of covariates $L$, individuals in one group receive a treatment $K$ version randomly assigned from the distribution of $K$ distribution $(A = 1, L = l)$ sub-population. Meanwhile, individuals in the other group receive a randomly assigned $K$ version from $(A = 0, L = l)$</span>
<span id="cb32-1197"><a href="#cb32-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1198"><a href="#cb32-1198" aria-hidden="true" tabindex="-1"></a>This theory finds its utility in practical scenarios where treatments seldom resemble each other -- we discussed the example of obesity last week (see: <span class="co">[</span><span class="ot">@vanderweele2013</span><span class="co">]</span>).</span>
<span id="cb32-1199"><a href="#cb32-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1200"><a href="#cb32-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reflective and formative measurement models may be approached as multiple versions of treatment</span></span>
<span id="cb32-1201"><a href="#cb32-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1202"><a href="#cb32-1202" aria-hidden="true" tabindex="-1"></a>Vanderweele applies the following substitution:</span>
<span id="cb32-1203"><a href="#cb32-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1204"><a href="#cb32-1204" aria-hidden="true" tabindex="-1"></a>$$\delta = \sum_{\eta,l} \mathbb{E}<span class="co">[</span><span class="ot">Y_\eta|l</span><span class="co">]</span> P(\eta|A=a+1,l) P(l) - \sum_{\eta,l} \mathbb{E}<span class="co">[</span><span class="ot">Y_\eta|l</span><span class="co">]</span> P(\eta|A=a,l) P(l)$$</span>
<span id="cb32-1205"><a href="#cb32-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1206"><a href="#cb32-1206" aria-hidden="true" tabindex="-1"></a>Specifically, we substitue $K$ with $\eta$ from the previous section, and compare the measurement response $A = a + 1$ with $A = a$. We discover that if the influence of $\eta$ on $Y$ is not confounded given $L$, then the multiple versions of reality consistent with the reflective and formative statistical models of reality will not lead to biased estimation. $\delta$ retains its interpretability as a comparison in a hypothetical randomised trial in which the distribution of coarsened measures of $\eta_A$ are balanced within levels of the treatment, conditional on $\eta_L$.</span>
<span id="cb32-1207"><a href="#cb32-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1208"><a href="#cb32-1208" aria-hidden="true" tabindex="-1"></a>This connection between measurement and the multiple versions of treatment framework provides a hope for consistent causal inference varying reliabilities of measurement.</span>
<span id="cb32-1209"><a href="#cb32-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1210"><a href="#cb32-1210" aria-hidden="true" tabindex="-1"></a>However, as with the theory of multiple treatments, we might not known how to interpret our results because we don't know the true relationships between our measured indicators and underlying reality.</span>
<span id="cb32-1211"><a href="#cb32-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1212"><a href="#cb32-1212" aria-hidden="true" tabindex="-1"></a>How can we do better?</span>
<span id="cb32-1213"><a href="#cb32-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1216"><a href="#cb32-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-1217"><a href="#cb32-1217" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-multiple-version-treatment-applied-measurement</span></span>
<span id="cb32-1218"><a href="#cb32-1218" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Multiple Versions of treatment applied to measuremen.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-1219"><a href="#cb32-1219" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-1220"><a href="#cb32-1220" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-1221"><a href="#cb32-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1222"><a href="#cb32-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1223"><a href="#cb32-1223" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-1224"><a href="#cb32-1224" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-1225"><a href="#cb32-1225" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-1226"><a href="#cb32-1226" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-1227"><a href="#cb32-1227" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-1228"><a href="#cb32-1228" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-1229"><a href="#cb32-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1230"><a href="#cb32-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1231"><a href="#cb32-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1232"><a href="#cb32-1232" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-1233"><a href="#cb32-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1234"><a href="#cb32-1234" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (L0) at (0, 0) {L};</span></span>
<span id="cb32-1235"><a href="#cb32-1235" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (K1) at (2, 0) {$\eta$=K};</span></span>
<span id="cb32-1236"><a href="#cb32-1236" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X1) at (5, 0) {$(X_1, X_2, \dots X_n)$};</span></span>
<span id="cb32-1237"><a href="#cb32-1237" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (A1) at (8, 0) {A};</span></span>
<span id="cb32-1238"><a href="#cb32-1238" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y2) at (10, 0) {Y$_k$};</span></span>
<span id="cb32-1239"><a href="#cb32-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1240"><a href="#cb32-1240" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (L0) to (K1);</span></span>
<span id="cb32-1241"><a href="#cb32-1241" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend right, draw=black] (L0) to (Y2);</span></span>
<span id="cb32-1242"><a href="#cb32-1242" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (K1) to (X1);</span></span>
<span id="cb32-1243"><a href="#cb32-1243" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X1) to (A1);</span></span>
<span id="cb32-1244"><a href="#cb32-1244" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, draw=white, bend left] (K1) to (Y2); # fix later</span></span>
<span id="cb32-1245"><a href="#cb32-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1246"><a href="#cb32-1246" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1247"><a href="#cb32-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1248"><a href="#cb32-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1249"><a href="#cb32-1249" aria-hidden="true" tabindex="-1"></a><span class="fu">## VanderWeele's model of reality</span></span>
<span id="cb32-1250"><a href="#cb32-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1251"><a href="#cb32-1251" aria-hidden="true" tabindex="-1"></a>VanderWeele's article concludes as follows:</span>
<span id="cb32-1252"><a href="#cb32-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1253"><a href="#cb32-1253" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A preliminary outline of a more adequate approach to the construction and use of psychosocial measures might thus be summarized by the following propositions, that I have argued for in this article: (1) Traditional univariate reflective and formative models do not adequately capture the relations between the underlying causally relevant phenomena and our indicators and measures. (2) The causally relevant constituents of reality related to our constructs are almost always multidimensional, giving rise both to our indicators from which we construct measures, and also to our language and concepts, from which we can more precisely define constructs. (3) In measure construction, we ought to always specify a definition of the underlying construct, from which items are derived, and by which analytic relations of the items to the definition are made clear. (4) The presumption of a structural univariate reflective model impairs measure construction, evaluation, and use. (5) If a structural interpretation of a univariate reflective factor model is being proposed this should be formally tested, not presumed; factor analysis is not sufficient for assessing the relevant evidence. (6) Even when the causally relevant constituents of reality are multidimensional, and a univariate measure is used, we can still interpret associations with outcomes using theory for multiple versions of treatment, though the interpretation is obscured when we do not have a clear sense of what the causally relevant constituents are. (7) When data permit, examining associations item-by-item, or with conceptually related item sets, may give insight into the various facets of the construct.</span></span>
<span id="cb32-1254"><a href="#cb32-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1255"><a href="#cb32-1255" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A new integrated theory of measurement for psychosocial constructs is needed in light of these points -- one that better respects the relations between our constructs, items, indicators, measures, and the underlying causally relevant phenomena. (VanderWeele 2022)</span></span>
<span id="cb32-1256"><a href="#cb32-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1259"><a href="#cb32-1259" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-1260"><a href="#cb32-1260" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-multivariate-reality-complete</span></span>
<span id="cb32-1261"><a href="#cb32-1261" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Multivariate reality gives rise to the latent variables.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"</span></span>
<span id="cb32-1262"><a href="#cb32-1262" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-1263"><a href="#cb32-1263" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-1264"><a href="#cb32-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1265"><a href="#cb32-1265" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-1266"><a href="#cb32-1266" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-1267"><a href="#cb32-1267" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-1268"><a href="#cb32-1268" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-1269"><a href="#cb32-1269" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-1270"><a href="#cb32-1270" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-1271"><a href="#cb32-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1272"><a href="#cb32-1272" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-1273"><a href="#cb32-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1274"><a href="#cb32-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1275"><a href="#cb32-1275" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (R) at (0, 0 ) {$\mathcal{R}$};</span></span>
<span id="cb32-1276"><a href="#cb32-1276" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (c) at (2, -1 ) {concepts};</span></span>
<span id="cb32-1277"><a href="#cb32-1277" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (cs) at (4, -2 ) {constructs};</span></span>
<span id="cb32-1278"><a href="#cb32-1278" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (eta) at (4, 0 ) {$\eta$};</span></span>
<span id="cb32-1279"><a href="#cb32-1279" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (X) at (6, 0 ) {(X$_1 \dots$X$_n$)};</span></span>
<span id="cb32-1280"><a href="#cb32-1280" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (A) at (8, 0 ) {A};</span></span>
<span id="cb32-1281"><a href="#cb32-1281" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Y) at (10, 0 ) {Y};</span></span>
<span id="cb32-1282"><a href="#cb32-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1283"><a href="#cb32-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1284"><a href="#cb32-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1285"><a href="#cb32-1285" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, dashed] (R) to (c);</span></span>
<span id="cb32-1286"><a href="#cb32-1286" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, dashed] (c) to (cs);</span></span>
<span id="cb32-1287"><a href="#cb32-1287" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (R) to (eta);</span></span>
<span id="cb32-1288"><a href="#cb32-1288" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (eta) to (X);</span></span>
<span id="cb32-1289"><a href="#cb32-1289" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (X) to (A);</span></span>
<span id="cb32-1290"><a href="#cb32-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1291"><a href="#cb32-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1292"><a href="#cb32-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1293"><a href="#cb32-1293" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, bend left=80, draw=red] (eta) to (Y);</span></span>
<span id="cb32-1294"><a href="#cb32-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1295"><a href="#cb32-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1296"><a href="#cb32-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1297"><a href="#cb32-1297" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1298"><a href="#cb32-1298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1299"><a href="#cb32-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1300"><a href="#cb32-1300" aria-hidden="true" tabindex="-1"></a>This seems to me sensible. However, @fig-dag-multivariate-reality-complete this is not a causal graph. The arrows to not clearly represent causal relations. It leaves me unclear about what to practically do.</span>
<span id="cb32-1301"><a href="#cb32-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1302"><a href="#cb32-1302" aria-hidden="true" tabindex="-1"></a>Let's return to the three wave many-outcomes model described in previous weeks. How should we revise this model in light of measurement theory?</span>
<span id="cb32-1303"><a href="#cb32-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1304"><a href="#cb32-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">## How theory of dependent and directed measurement error might be usefully employed to develop a pragmatic responses to construct measurement</span></span>
<span id="cb32-1305"><a href="#cb32-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1306"><a href="#cb32-1306" aria-hidden="true" tabindex="-1"></a>By now you are all familiar with The New Zealand Attitudes and Values Study (NZAVS),which is a national probability survey collects a wide range of information, including data on distress, exercise habits, and cultural backgrounds.</span>
<span id="cb32-1307"><a href="#cb32-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1310"><a href="#cb32-1310" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-1311"><a href="#cb32-1311" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-uu-null</span></span>
<span id="cb32-1312"><a href="#cb32-1312" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Uncorrelated non-differential  measurement error does not bias estimates under the null. Note, however, we assume that L is measured with sufficient precision to block the path from A_eta --&gt; L_eta --&gt; Y_eta, which, otherwise, we would assume to be open. "</span></span>
<span id="cb32-1313"><a href="#cb32-1313" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-1314"><a href="#cb32-1314" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-1315"><a href="#cb32-1315" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-1316"><a href="#cb32-1316" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-1317"><a href="#cb32-1317" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-1318"><a href="#cb32-1318" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-1319"><a href="#cb32-1319" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-1320"><a href="#cb32-1320" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-1321"><a href="#cb32-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1322"><a href="#cb32-1322" aria-hidden="true" tabindex="-1"></a><span class="in">% Define a simple decoration</span></span>
<span id="cb32-1323"><a href="#cb32-1323" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{cor} = [-, dotted, preaction = {decorate}]</span></span>
<span id="cb32-1324"><a href="#cb32-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1325"><a href="#cb32-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1326"><a href="#cb32-1326" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-1327"><a href="#cb32-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1328"><a href="#cb32-1328" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (UL) at (0, 1) {U$_L$};</span></span>
<span id="cb32-1329"><a href="#cb32-1329" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (UA) at (6, 2) {U$_A$};</span></span>
<span id="cb32-1330"><a href="#cb32-1330" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (UY) at (9, 3) {U$_Y$};</span></span>
<span id="cb32-1331"><a href="#cb32-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1332"><a href="#cb32-1332" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (L0) at (3, 1) {L$_{f(X_1\dots X_n)}^{t0}$};</span></span>
<span id="cb32-1333"><a href="#cb32-1333" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (A1) at (7, 1) {A$_{f(X_1\dots X_n)}^{t1}$};</span></span>
<span id="cb32-1334"><a href="#cb32-1334" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (Y2) at (11, 1) {Y$_{f(X_1\dots X_n)}^{t2}$};</span></span>
<span id="cb32-1335"><a href="#cb32-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1336"><a href="#cb32-1336" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Leta0) at (3, 0) {L$^{t0}_\eta$};</span></span>
<span id="cb32-1337"><a href="#cb32-1337" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Aeta1) at (7, 0) {A$^{t1}_\eta$};</span></span>
<span id="cb32-1338"><a href="#cb32-1338" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Yeta2) at (11, 0) {Y$^{t2}_\eta$};</span></span>
<span id="cb32-1339"><a href="#cb32-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1340"><a href="#cb32-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1341"><a href="#cb32-1341" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (UL) to (L0);</span></span>
<span id="cb32-1342"><a href="#cb32-1342" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black,bend left=20] (UA) to (A1);</span></span>
<span id="cb32-1343"><a href="#cb32-1343" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black,bend left=30] (UY) to (Y2);</span></span>
<span id="cb32-1344"><a href="#cb32-1344" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Leta0) to (L0);</span></span>
<span id="cb32-1345"><a href="#cb32-1345" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Leta0) to (Aeta1);</span></span>
<span id="cb32-1346"><a href="#cb32-1346" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, bend right=30] (Leta0) to (Yeta2);</span></span>
<span id="cb32-1347"><a href="#cb32-1347" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Aeta1) to (A1);</span></span>
<span id="cb32-1348"><a href="#cb32-1348" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Yeta2) to (Y2);</span></span>
<span id="cb32-1349"><a href="#cb32-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1350"><a href="#cb32-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1351"><a href="#cb32-1351" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [cor, draw=black, dashed,bend right=80] (UL) to (Leta0);</span></span>
<span id="cb32-1352"><a href="#cb32-1352" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [cor, draw=black, dashed, bend right = 80] (UA) to (Aeta1);</span></span>
<span id="cb32-1353"><a href="#cb32-1353" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [cor, draw=black, dashed, bend right = 80] (UY) to (Yeta2);</span></span>
<span id="cb32-1354"><a href="#cb32-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1355"><a href="#cb32-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1356"><a href="#cb32-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1357"><a href="#cb32-1357" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1358"><a href="#cb32-1358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1359"><a href="#cb32-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1360"><a href="#cb32-1360" aria-hidden="true" tabindex="-1"></a>Consider a study that seeks to use this dataset to investigate the effect of regular exercise on psychological distress. In contrast to previous graphs, let us allow for latent reality to affect our measurements, as well as the discrepencies between our measurements and true underlying reality. We shall use @fig-dag-uu-null as our initial guide.</span>
<span id="cb32-1361"><a href="#cb32-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1362"><a href="#cb32-1362" aria-hidden="true" tabindex="-1"></a>We represent the true exercise by $\eta_A$. We represent true psychological distress by $\eta_Y$. Let $\eta_L$ denote a persons true workload, and assume that this state of work affects both levels of excercise and psychological distress.</span>
<span id="cb32-1363"><a href="#cb32-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1364"><a href="#cb32-1364" aria-hidden="true" tabindex="-1"></a>To bring the model into contact with measurement theory, Let us describe measurements of these latent true underlying realities as functions of multiple indicators: $L_{f(X_1\dots X_n)}$, $A_{f(X_1\dots X_n)}$, and $A_{f(X_1\dots X_n)}$. These constructs are measured realisations of the underlying true states. We assume that the true states of these variables affect their corresponding measured states, and so draw arrows from $\eta_L\rightarrow{L_{f(X_1\dots X_n)}}$, $\eta_A\rightarrow{A_{f(X_1\dots X_n)}}$, $\eta_Y\rightarrow{Y_{f(X_1\dots X_n)}}$.</span>
<span id="cb32-1365"><a href="#cb32-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1366"><a href="#cb32-1366" aria-hidden="true" tabindex="-1"></a>We also assume unmeasured sources of error that affect the measurements: $U_{L} \rightarrow$ $L_{f(X_1\dots X_n)}$, $U_{A} \rightarrow$ $A_{f(X_1\dots X_n)}$, and $U_{Y} \rightarrow$ $Y_{f(X_1\dots X_n)}$. That is, we allow that our measured indicators may "see as through a mirror, in darkness," the underlying true reality they hope to capture (Corinthians 13:12). We use $U_{L}$, $U_{A}$ and $U_{Y}$ to denote the unmeasured sources of error in the measured indicators. These are the unknown, and perhaps unknowable, darkness and mirror.</span>
<span id="cb32-1367"><a href="#cb32-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1368"><a href="#cb32-1368" aria-hidden="true" tabindex="-1"></a>Allow that the true underlying reality represented by the $\eta_{var}$ may be multivariate. Similarly, allow the true underlying reality represented by $\U_{var}$ is multivariate.</span>
<span id="cb32-1369"><a href="#cb32-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1370"><a href="#cb32-1370" aria-hidden="true" tabindex="-1"></a>We now have a causal diagramme that more precisely captures VanderWeele's thinking as presented in @fig-dag-multivariate-reality-complete. In our @fig-dag-uu-null, we have fleshed out $\mathcal{R}$ in a way that may include natural language concepts and scientific language, or constructs, as latent realities and latent unmeasured sources of error in our constructs.</span>
<span id="cb32-1371"><a href="#cb32-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1372"><a href="#cb32-1372" aria-hidden="true" tabindex="-1"></a>The utility of describing the measurement dynamics using causal graphs is apparrent. We can understand that the measured states, once conditioned upon create *collider biases* which opens path between the unmeasured sources of error and the true underlying state that gives rise to our measurements. This is depicted by a the arrows $U_{var}$ and from $\eta_{var}$ into each $var_{f(X1, X2,\dots X_n)}$</span>
<span id="cb32-1373"><a href="#cb32-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1374"><a href="#cb32-1374" aria-hidden="true" tabindex="-1"></a>Notice: **where true unmeasured (multivariate) psycho-physical states are related to true unmeasured (multivariate) sources of error in the measurement of those states, the very act of measurement opens pathways to confounding.**</span>
<span id="cb32-1375"><a href="#cb32-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1376"><a href="#cb32-1376" aria-hidden="true" tabindex="-1"></a>If for each measured construct $var_{f(X1, X2,\dots X_n)}$, the sources of error $U_{var}$ and the unmeasured consituents of reality that give rise to our measures $\eta_{var}$ are uncorrelated with other variables $U\prime_{var}$ and from $\eta\prime_{var}$ and $var\prime_{f(X1, X2,\dots X_n)}$, our estimates may be downwardly biased toward the null. However, d-separation is preserved. Where errors are uncorrelated with true latent realities, there is no new pathway that opens information between our exposure and outcome. Consider the relations presented in @fig-dag-dep-udir-effect-confounders-3wave</span>
<span id="cb32-1377"><a href="#cb32-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1380"><a href="#cb32-1380" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-1381"><a href="#cb32-1381" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-dep-udir-effect-confounders-3wave</span></span>
<span id="cb32-1382"><a href="#cb32-1382" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Measurement error opens an additional pathway to confounding if either there are correlated errors, or a directed effect of the exposure on the errors of measured outcome."</span></span>
<span id="cb32-1383"><a href="#cb32-1383" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-1384"><a href="#cb32-1384" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-1385"><a href="#cb32-1385" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-1386"><a href="#cb32-1386" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-1387"><a href="#cb32-1387" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-1388"><a href="#cb32-1388" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-1389"><a href="#cb32-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1390"><a href="#cb32-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1391"><a href="#cb32-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1392"><a href="#cb32-1392" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-1393"><a href="#cb32-1393" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-1394"><a href="#cb32-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1395"><a href="#cb32-1395" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{blackArrowRedTip/.style={</span></span>
<span id="cb32-1396"><a href="#cb32-1396" aria-hidden="true" tabindex="-1"></a><span class="in">  decoration={markings, mark=at position 1 with {\arrow[red, thick]{latex}}},</span></span>
<span id="cb32-1397"><a href="#cb32-1397" aria-hidden="true" tabindex="-1"></a><span class="in">  postaction={decorate},</span></span>
<span id="cb32-1398"><a href="#cb32-1398" aria-hidden="true" tabindex="-1"></a><span class="in">  shorten &gt;=0.4pt}}</span></span>
<span id="cb32-1399"><a href="#cb32-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1400"><a href="#cb32-1400" aria-hidden="true" tabindex="-1"></a><span class="in">% Define a simple decoration</span></span>
<span id="cb32-1401"><a href="#cb32-1401" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{cor} = [-, dotted, preaction = {decorate}]</span></span>
<span id="cb32-1402"><a href="#cb32-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1403"><a href="#cb32-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1404"><a href="#cb32-1404" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-1405"><a href="#cb32-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1406"><a href="#cb32-1406" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (ULAY) at (0, 5) {$U_{L}$};</span></span>
<span id="cb32-1407"><a href="#cb32-1407" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (UA) at (5, 4) {$U_{A}$};</span></span>
<span id="cb32-1408"><a href="#cb32-1408" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (UY) at (10, 5) {$U_{Y}$};</span></span>
<span id="cb32-1409"><a href="#cb32-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1410"><a href="#cb32-1410" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (L0) at (0, 2) {L$_{f(X_1\dots X_n)}^{t0}$};</span></span>
<span id="cb32-1411"><a href="#cb32-1411" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (A1) at (5, 2) {A$_{f(X_1\dots X_n)}^{t1}$};</span></span>
<span id="cb32-1412"><a href="#cb32-1412" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (Y2) at (10, 2) {Y$_{f(X_1\dots X_n)}^{t2}$};</span></span>
<span id="cb32-1413"><a href="#cb32-1413" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Leta0) at (0, 0) {$\eta_L^{t0}$};</span></span>
<span id="cb32-1414"><a href="#cb32-1414" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Aeta1) at (5, 0) {$\eta_A^{t1}$};</span></span>
<span id="cb32-1415"><a href="#cb32-1415" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Yeta2) at (10, 0) {$\eta_Y^{t2}$};</span></span>
<span id="cb32-1416"><a href="#cb32-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1417"><a href="#cb32-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1418"><a href="#cb32-1418" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (ULAY) to (UA);</span></span>
<span id="cb32-1419"><a href="#cb32-1419" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (ULAY) to (UY);</span></span>
<span id="cb32-1420"><a href="#cb32-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1421"><a href="#cb32-1421" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (UA) to (A1);</span></span>
<span id="cb32-1422"><a href="#cb32-1422" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (UY) to (Y2);</span></span>
<span id="cb32-1423"><a href="#cb32-1423" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (ULAY) to (L0);</span></span>
<span id="cb32-1424"><a href="#cb32-1424" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Leta0) to (L0);</span></span>
<span id="cb32-1425"><a href="#cb32-1425" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Leta0) to (Aeta1);</span></span>
<span id="cb32-1426"><a href="#cb32-1426" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, bend right=30] (Leta0) to (Yeta2);</span></span>
<span id="cb32-1427"><a href="#cb32-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1428"><a href="#cb32-1428" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw = black] (Aeta1) to (A1);</span></span>
<span id="cb32-1429"><a href="#cb32-1429" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Yeta2) to (Y2);</span></span>
<span id="cb32-1430"><a href="#cb32-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1431"><a href="#cb32-1431" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (Aeta1) to (UY);</span></span>
<span id="cb32-1432"><a href="#cb32-1432" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (Leta0) to (UA);</span></span>
<span id="cb32-1433"><a href="#cb32-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1434"><a href="#cb32-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1435"><a href="#cb32-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1436"><a href="#cb32-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1437"><a href="#cb32-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1438"><a href="#cb32-1438" aria-hidden="true" tabindex="-1"></a><span class="in">%\draw [-latex, draw=black] (Leta0) to (UA);</span></span>
<span id="cb32-1439"><a href="#cb32-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1440"><a href="#cb32-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1441"><a href="#cb32-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1442"><a href="#cb32-1442" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [cor, draw=red, dashed,bend right=80] (ULAY) to (Leta0);</span></span>
<span id="cb32-1443"><a href="#cb32-1443" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [cor, draw=red, dashed, bend right = 80] (UA) to (Aeta1);</span></span>
<span id="cb32-1444"><a href="#cb32-1444" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [cor, draw=red, dashed, bend left = 80] (UY) to (Yeta2);</span></span>
<span id="cb32-1445"><a href="#cb32-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1446"><a href="#cb32-1446" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1447"><a href="#cb32-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1448"><a href="#cb32-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1449"><a href="#cb32-1449" aria-hidden="true" tabindex="-1"></a>Here,</span>
<span id="cb32-1450"><a href="#cb32-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1451"><a href="#cb32-1451" aria-hidden="true" tabindex="-1"></a>$\eta_L \rightarrow L$: We assume that the true workload state affects its measurement. This measurement, however, may be affected by an unmeasured error source, $U_{L}$. Personal perceptions of workload can introduce this error. For instance, a person may perceive their workload differently based on recent personal experiences or cultural backgrounds. Additionally, unmeasured cultural influences like societal expectations of productivity could shape their responses independently of the true workload state. There may be cultural differences - Americans may verstate; the British may present effortless superiority.</span>
<span id="cb32-1452"><a href="#cb32-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1453"><a href="#cb32-1453" aria-hidden="true" tabindex="-1"></a>$\eta_A \rightarrow A$: When it comes to exercise, the true state may affect the measured frequency (questions about exercise are not totally uninformative). However, this measurement is also affected by an unmeasured source of error, which we denote by $U_{A}$. For example, a cultural shift towards valuing physical health might prompt participants toreport higher activity levels, introducing an error, $U_{A}$.</span>
<span id="cb32-1454"><a href="#cb32-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1455"><a href="#cb32-1455" aria-hidden="true" tabindex="-1"></a>$\eta_Y \rightarrow Y$: We assume questions about distress are not totally uninformative: actual distress affects the measured distress. However this measurement is subject to unmeasured error: $U_{Y}$. For instance, an increased societal acceptance of mental health might change how distress is reported creating an error, $U_{Y}$, in the measurement of distress. Such norms, moreover, may change over time.</span>
<span id="cb32-1456"><a href="#cb32-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1457"><a href="#cb32-1457" aria-hidden="true" tabindex="-1"></a>$U_{L} \rightarrow L$, $U_{A} \rightarrow A$, and $U_{Y} \rightarrow Y$: These edges between the nodes indicate how each unmeasured error source can influence its corresponding measurement, leading to a discrepancy between the true state and the measured state.</span>
<span id="cb32-1458"><a href="#cb32-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1459"><a href="#cb32-1459" aria-hidden="true" tabindex="-1"></a>$U_{L} \rightarrow U_{A}$ and $U_{L} \rightarrow U_{Y}$: These relationships indicate that the error in the stress measurement can correlate with those in the exercise and mood measurements. This could stem from a common cultural bias affecting how a participant self-reports across these areas.</span>
<span id="cb32-1460"><a href="#cb32-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1461"><a href="#cb32-1461" aria-hidden="true" tabindex="-1"></a>$\eta_A \rightarrow U_{Y}$ and $\eta_L \rightarrow U_{A}$: These relationships indicate that the actual state of one variable can affect the error in another variable's measurement. For example, a cultural emphasis on physical health leading to increased exercise might, in turn, affect the reporting of distress levels, causing an error, $U_{Y}$, in the distress measurement. Similarly, if a cultural trend pushes people to work more, it might cause them to over or underestimate their exercise frequency, introducing an error, $U_{A}$, in the exercise measurement.</span>
<span id="cb32-1462"><a href="#cb32-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1463"><a href="#cb32-1463" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confounding control by baseline measures of exposure and outcome: Dependent Directed Measurement Error in Three-Wave Panels</span></span>
<span id="cb32-1464"><a href="#cb32-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1465"><a href="#cb32-1465" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>We propose a three-wave panel design to control confounding. This design adjusts for baseline measurements of both exposure and the outcome.</span>
<span id="cb32-1466"><a href="#cb32-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1467"><a href="#cb32-1467" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Understanding this approach in the context of potential directed and correlated measurement errors gives us a clearer picture of its strengths and limitations.</span>
<span id="cb32-1468"><a href="#cb32-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1469"><a href="#cb32-1469" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>This three-wave panel design incorporates baseline measurements of both exposure and confounders. As a result, any bias that could come from unmeasured sources of measurement errors should be uncorrelated with their baseline effects.</span>
<span id="cb32-1470"><a href="#cb32-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1471"><a href="#cb32-1471" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>For instance, if individuals have a social desirability bias at the baseline, they would have to develop a different bias unrelated to the initial one for new bias to occur due to correlated unmeasured sources of measurement errors.</span>
<span id="cb32-1472"><a href="#cb32-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1473"><a href="#cb32-1473" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>However, we cannot completely eliminate the possibility of such new bias development. There could also be potential new sources of bias from directed effects of the exposure on the error term of the outcome, which can often occur due to panel attrition.</span>
<span id="cb32-1474"><a href="#cb32-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1475"><a href="#cb32-1475" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>To mitigate this risk, we adjust for panel attrition/non-response using methods like multiple imputation. We also consistently perform sensitivity analyses to detect any unanticipated bias.</span>
<span id="cb32-1476"><a href="#cb32-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1477"><a href="#cb32-1477" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Despite these potential challenges, it is worth noting that by including measures of both exposure and outcome at baseline, the chances of new confounding are significantly reduced.</span>
<span id="cb32-1478"><a href="#cb32-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1479"><a href="#cb32-1479" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Therefore, adopting this practice should be a standard procedure in multi-wave studies as it substantially minimizes the likelihood of introducing novel confounding factors.</span>
<span id="cb32-1480"><a href="#cb32-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1483"><a href="#cb32-1483" aria-hidden="true" tabindex="-1"></a><span class="in">```{tikz}</span></span>
<span id="cb32-1484"><a href="#cb32-1484" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-dag-dep-udir-effect-confounders-3wave-new</span></span>
<span id="cb32-1485"><a href="#cb32-1485" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "TBA"</span></span>
<span id="cb32-1486"><a href="#cb32-1486" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb32-1487"><a href="#cb32-1487" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb32-1488"><a href="#cb32-1488" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{positioning}</span></span>
<span id="cb32-1489"><a href="#cb32-1489" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{shapes.geometric}</span></span>
<span id="cb32-1490"><a href="#cb32-1490" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{arrows}</span></span>
<span id="cb32-1491"><a href="#cb32-1491" aria-hidden="true" tabindex="-1"></a><span class="in">\usetikzlibrary{decorations}</span></span>
<span id="cb32-1492"><a href="#cb32-1492" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{Arrow} = [-&gt;, thin, preaction = {decorate}]</span></span>
<span id="cb32-1493"><a href="#cb32-1493" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzset{&gt;=latex}</span></span>
<span id="cb32-1494"><a href="#cb32-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1495"><a href="#cb32-1495" aria-hidden="true" tabindex="-1"></a><span class="in">% Define a simple decoration</span></span>
<span id="cb32-1496"><a href="#cb32-1496" aria-hidden="true" tabindex="-1"></a><span class="in">\tikzstyle{cor} = [-, dotted, preaction = {decorate}]</span></span>
<span id="cb32-1497"><a href="#cb32-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1498"><a href="#cb32-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1499"><a href="#cb32-1499" aria-hidden="true" tabindex="-1"></a><span class="in">\begin{tikzpicture}[{every node/.append style}=draw]</span></span>
<span id="cb32-1500"><a href="#cb32-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1501"><a href="#cb32-1501" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (ULAY) at (0, 2) {U$_{t0/LAY}$};</span></span>
<span id="cb32-1502"><a href="#cb32-1502" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (UA) at (6, 4) {U$_{t1/A}$};</span></span>
<span id="cb32-1503"><a href="#cb32-1503" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (UY) at (8, 5) {U$_{t2/Y}$};</span></span>
<span id="cb32-1504"><a href="#cb32-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1505"><a href="#cb32-1505" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (L0) at (4, 2) {LAY$^{t0}$};</span></span>
<span id="cb32-1506"><a href="#cb32-1506" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (A1) at (6, 2) {A$^{t1}$};</span></span>
<span id="cb32-1507"><a href="#cb32-1507" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=black] (Y2) at (8, 2) {Y$^{t2}$};</span></span>
<span id="cb32-1508"><a href="#cb32-1508" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Leta0) at (4, 0) {L$^{t0}_\eta$};</span></span>
<span id="cb32-1509"><a href="#cb32-1509" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Aeta1) at (6, 0) {A$^{t1}_\eta$};</span></span>
<span id="cb32-1510"><a href="#cb32-1510" aria-hidden="true" tabindex="-1"></a><span class="in">\node [rectangle, draw=white] (Yeta2) at (8, 0) {Y$^{t2}_\eta$};</span></span>
<span id="cb32-1511"><a href="#cb32-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1512"><a href="#cb32-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1513"><a href="#cb32-1513" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, dotted, bend left = 20] (ULAY) to (UA);</span></span>
<span id="cb32-1514"><a href="#cb32-1514" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, dotted, bend left = 30] (ULAY) to (UY);</span></span>
<span id="cb32-1515"><a href="#cb32-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1516"><a href="#cb32-1516" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (UA) to (A1);</span></span>
<span id="cb32-1517"><a href="#cb32-1517" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (UY) to (Y2);</span></span>
<span id="cb32-1518"><a href="#cb32-1518" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (ULAY) to (L0);</span></span>
<span id="cb32-1519"><a href="#cb32-1519" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Leta0) to (L0);</span></span>
<span id="cb32-1520"><a href="#cb32-1520" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Leta0) to (Aeta1);</span></span>
<span id="cb32-1521"><a href="#cb32-1521" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black, bend right=30] (Leta0) to (Yeta2);</span></span>
<span id="cb32-1522"><a href="#cb32-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1523"><a href="#cb32-1523" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Aeta1) to (A1);</span></span>
<span id="cb32-1524"><a href="#cb32-1524" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Yeta2) to (Y2);</span></span>
<span id="cb32-1525"><a href="#cb32-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1526"><a href="#cb32-1526" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=red] (Aeta1) to (UY);</span></span>
<span id="cb32-1527"><a href="#cb32-1527" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [-latex, draw=black] (Leta0) to (UA);</span></span>
<span id="cb32-1528"><a href="#cb32-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1529"><a href="#cb32-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1530"><a href="#cb32-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1531"><a href="#cb32-1531" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [cor, draw=black, dashed,bend right=30] (ULAY) to (Leta0);</span></span>
<span id="cb32-1532"><a href="#cb32-1532" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [cor, draw=black, dashed, bend right = 30] (UA) to (Aeta1);</span></span>
<span id="cb32-1533"><a href="#cb32-1533" aria-hidden="true" tabindex="-1"></a><span class="in">\draw [cor, draw=black, dashed, bend right = 100] (ULAY) to (Yeta2);</span></span>
<span id="cb32-1534"><a href="#cb32-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1535"><a href="#cb32-1535" aria-hidden="true" tabindex="-1"></a><span class="in">\end{tikzpicture}</span></span>
<span id="cb32-1536"><a href="#cb32-1536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-1537"><a href="#cb32-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1538"><a href="#cb32-1538" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comment on slow changes</span></span>
<span id="cb32-1539"><a href="#cb32-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1540"><a href="#cb32-1540" aria-hidden="true" tabindex="-1"></a>Over long periods of time we can expect additional sources of confounding. Changes in cultural norms and attitudes can occur over the duration of a longitudinal study like the NZAVS, leading to residual confounding. For example, if there is a cultural shift towards increased acceptance of mental health issues, this might change how psychological distress is reported over time, irrespective of baseline responses.</span>
<span id="cb32-1541"><a href="#cb32-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1542"><a href="#cb32-1542" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- It's also important to consider that cultural influences might not be entirely captured by the survey. Factors such as societal expectations, shared beliefs, and norms within a culture could influence both exercise behaviour and distress states. These could change over time due to sociocultural shifts, and if these changes aren't accounted for, could lead to residual confounding. For example, a societal shift towards valuing physical health might encourage more exercise independently of baseline responses --&gt;</span></span>
<span id="cb32-1543"><a href="#cb32-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1544"><a href="#cb32-1544" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 1.  **Baseline Measures and Cultural Differences:** The NZAVS contains data from diverse cultural backgrounds. Therefore, controlling for baseline measures of exercise and distress would also help account for cultural differences that might influence these variables at the outset. For instance, certain cultural groups might have different baseline physical activity or baseline distress states due to various socio-cultural factors. --&gt;</span></span>
<span id="cb32-1545"><a href="#cb32-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1546"><a href="#cb32-1546" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 2.  **Residual Confounding and Exercise:** Let's consider the construct $\eta_{A}$, representing the true state of exercise behaviour. If we control for baseline exercise, we're adjusting for the initial state of this behaviour. However, there could still be cultural factors that impact how exercise changes over time. For instance, a cultural event or festival that significantly increases physical activity for a certain period might occur. This change might be independent of the baseline state of exercise, thus leading to residual confounding. --&gt;</span></span>
<span id="cb32-1547"><a href="#cb32-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1548"><a href="#cb32-1548" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 3.  **Residual Confounding and Depression:** Similarly for $\eta_{Y}$, the true state of Depression/Anxiety. Controlling for baseline states adjusts for the initial emotional state. However, cultural factors such as societal norms or expectations about emotional expression could change over time independently of the baseline distress. These changes could result in residual confounding. For example, a significant cultural event might induce communal feelings of joy or sadness, influencing the distress state irrespective of the baseline level. --&gt;</span></span>
<span id="cb32-1549"><a href="#cb32-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1550"><a href="#cb32-1550" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 4.  **Unmeasured Cultural Factors**: It's also important to consider that cultural influences might not be entirely captured by the survey. Factors such as societal expectations, shared beliefs, and norms within a culture could influence both exercise behaviour and distress states. These could change over time due to sociocultural shifts, and if these changes aren't accounted for, could lead to residual confounding. For example, a societal shift towards valuing physical health might encourage more exercise independently of baseline responses --&gt;</span></span>
<span id="cb32-1551"><a href="#cb32-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1552"><a href="#cb32-1552" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 5.  **Change over time**: Finally, time itself can be a factor. Changes in cultural norms and attitudes can occur over the duration of a longitudinal study like the NZAVS. If the timing of these changes isn't aligned with the measurement times, this can also lead to residual confounding. For example, if there is a cultural shift towards increased acceptance of mental health issues, this might change how mood is reported over time, irrespective of baseline responses. --&gt;</span></span>
<span id="cb32-1553"><a href="#cb32-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1554"><a href="#cb32-1554" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 6.  **Directed Measurement Error:** Consider a situation where individuals from certain cultural backgrounds might systematically under-report their physical activity due to societal norms or expectations, introducing a directed measurement error. Similarly, reporting of mood states might also be influenced by cultural perspectives on expressing emotions. These culturally influenced errors in measurement can introduce bias, even after controlling for baseline measures. --&gt;</span></span>
<span id="cb32-1555"><a href="#cb32-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1556"><a href="#cb32-1556" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 7.  **Undirected Measurement Error:** Undirected errors could also occur due to random variations in understanding or interpreting survey questions across different cultures, introducing variability in the data. If these random errors correlate with the error in measuring other variables (for instance, if misunderstanding of exercise questions correlates with misunderstanding of mood questions), this can introduce bias. --&gt;</span></span>
<span id="cb32-1557"><a href="#cb32-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1558"><a href="#cb32-1558" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 8.  **Correlated Errors and Cultural Differences:** The culturally influenced measurement errors ($U_{A}$, $U_{Y}$) could be correlated, as the cultural factors influencing the reporting of exercise might also influence the reporting of mood. This correlation between errors introduces further complexity and potential bias. --&gt;</span></span>
<span id="cb32-1559"><a href="#cb32-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1560"><a href="#cb32-1560" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 9.  **Residual Confounding:** Despite controlling for baseline measures, there can still be residual confounding due to unmeasured cultural factors. For instance, even if we control for baseline exercise and mood, there might still be cultural factors that impact the changes in these variables over time independently of the baseline measures. --&gt;</span></span>
<span id="cb32-1561"><a href="#cb32-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1562"><a href="#cb32-1562" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- In short, controlling for baseline measures in the NZAVS helps to reduce some bias and account for cultural differences that influence the exposure and outcome. However, potential bias due to unmeasured confounding and measurement error, for example, if these are influenced by cultural factors, still remain. --&gt;</span></span>
<span id="cb32-1563"><a href="#cb32-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1564"><a href="#cb32-1564" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>**Need for Sensitivity Analysis** The Key takehome message is that we must always perform sensitivity analyses because we can never be certain that our confounding control strategy has worked.</span>
<span id="cb32-1565"><a href="#cb32-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1566"><a href="#cb32-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1567"><a href="#cb32-1567" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab: Advice on Your Final Report</span></span>
<span id="cb32-1568"><a href="#cb32-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1569"><a href="#cb32-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1570"><a href="#cb32-1570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Intoduction</span></span>
<span id="cb32-1571"><a href="#cb32-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1572"><a href="#cb32-1572" aria-hidden="true" tabindex="-1"></a>Answer the following:</span>
<span id="cb32-1573"><a href="#cb32-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1574"><a href="#cb32-1574" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>State the Question: is my question clearly stated? If not, state it.</span>
<span id="cb32-1575"><a href="#cb32-1575" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Relevance of the Question: Have I explained its importance? If not, explain.</span>
<span id="cb32-1576"><a href="#cb32-1576" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Subgroup Analysis: Does my question involve a subgroup (e.g., cultural group)? If not, develop a subgroup analysis question.</span>
<span id="cb32-1577"><a href="#cb32-1577" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Causality of the Question: Is my question causal? Briefly explain what this means with reference to the potential outcomes framework.</span>
<span id="cb32-1578"><a href="#cb32-1578" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>State how you will use time-series data to address causality.</span>
<span id="cb32-1579"><a href="#cb32-1579" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Define your exposure.</span>
<span id="cb32-1580"><a href="#cb32-1580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Define your outcome(s)</span>
<span id="cb32-1581"><a href="#cb32-1581" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Explain how the the exposure and outcome is relevant to your question.</span>
<span id="cb32-1582"><a href="#cb32-1582" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Define your causal estimand (see: lecture 9). Hint: it is ATE_g<span class="sc">\_</span>risk difference = E<span class="sc">\[</span>Y(1)-(0)<span class="sc">\|</span>G,L<span class="sc">\]</span>, where G is your multiple-group indicator and L is your set of baseline confounders.</span>
<span id="cb32-1583"><a href="#cb32-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1584"><a href="#cb32-1584" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods</span></span>
<span id="cb32-1585"><a href="#cb32-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1586"><a href="#cb32-1586" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Consider any ethical implications.</span>
<span id="cb32-1587"><a href="#cb32-1587" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Explain the sample. Provide descriptive statistics</span>
<span id="cb32-1588"><a href="#cb32-1588" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Discuss inclusion criteria.</span>
<span id="cb32-1589"><a href="#cb32-1589" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Discuss how your sample relates to the "source population" (lecture 9.)</span>
<span id="cb32-1590"><a href="#cb32-1590" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Explain NZAVS measures. State the questions used in the items</span>
<span id="cb32-1591"><a href="#cb32-1591" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In your own words describe how the data meet the following assumptions required for causal inference:</span>
<span id="cb32-1592"><a href="#cb32-1592" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Positivity: Can we intervene on the exposure at all levels of the covariates? Use the code I provided to test whether there is change in the exposure from the baseline in the source population(s)</span>
<span id="cb32-1593"><a href="#cb32-1593" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Consistency: Can I interpret what it means to intervene on the exposure?</span>
<span id="cb32-1594"><a href="#cb32-1594" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Exchangeability: Are different versions of the exposure conditionally exchangeable given measured baseline confounders? This requires stating baseline confounders and explaining how they may be related to both the exposure and outcome. As part of this, **you must explain why the baseline measure of your exposure and outcome are included as potential confounders.**</span>
<span id="cb32-1595"><a href="#cb32-1595" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note: Unmeasured Confounders: Does previous science suggest the presence of unmeasured confounders? (e.g. childhood exposures that are not measured).</span>
<span id="cb32-1596"><a href="#cb32-1596" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Draw a causal diagram: Have I drawn a causal diagram (DAG) to highlight both measured and unmeasured sources of confounding?</span>
<span id="cb32-1597"><a href="#cb32-1597" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Measurement Error: Have I described potential biases from measurement errors? Return to lecture 11.</span>
<span id="cb32-1598"><a href="#cb32-1598" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>State that you do not have missing data in this synthetic dataset, but that ordinarily missing data would need to be handled.</span>
<span id="cb32-1599"><a href="#cb32-1599" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>State what your estimator will be. Note I've given you the following text to modify:</span>
<span id="cb32-1600"><a href="#cb32-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1601"><a href="#cb32-1601" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The Doubly Robust Estimation method for Subgroup Analysis Estimator is a sophisticated tool combining features of both IPTW and G-computation methods, providing unbiased estimates if either the propensity score or outcome model is correctly specified. The process involves five main steps:</span></span>
<span id="cb32-1602"><a href="#cb32-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1603"><a href="#cb32-1603" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Step 1 involves the estimation of the propensity score, a measure of the conditional probability of exposure given the covariates and the subgroup indicator. This score is calculated using statistical models such as logistic regression, with the model choice depending on the nature of the data and exposure. Weights for each individual are then calculated using this propensity score. These weights depend on the exposure status and are computed differently for exposed and unexposed individuals. The estimation of propensity scores is performed separately within each subgroup stratum.</span></span>
<span id="cb32-1604"><a href="#cb32-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1605"><a href="#cb32-1605" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Step 2 focuses on fitting a weighted outcome model, making use of the previously calculated weights from the propensity scores. This model estimates the outcome conditional on exposure, covariates, and subgroup, integrating the weights into the estimation process. Unlike in propensity score model estimation, covariates are included as variables in the outcome model. This inclusion makes the method doubly robust - providing a consistent effect estimate if either the propensity score or the outcome model is correctly specified, thereby reducing the assumption of correct model specification.</span></span>
<span id="cb32-1606"><a href="#cb32-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1607"><a href="#cb32-1607" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Step 3 entails the simulation of potential outcomes for each individual in each subgroup. These hypothetical scenarios assume universal exposure to the intervention within each subgroup, regardless of actual exposure levels. The expectation of potential outcomes is calculated for each individual in each subgroup, using individual-specific weights. These scenarios are performed for both the current and alternative interventions.</span></span>
<span id="cb32-1608"><a href="#cb32-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1609"><a href="#cb32-1609" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Step 4 is the estimation of the average causal effect for each subgroup, achieved by comparing the computed expected values of potential outcomes under each intervention level. The difference represents the average causal effect of changing the exposure within each subgroup.</span></span>
<span id="cb32-1610"><a href="#cb32-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1611"><a href="#cb32-1611" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Step 5 involves comparing differences in causal effects across groups by calculating the differences in the estimated causal effects between different subgroups. Confidence intervals and standard errors for these calculations are determined using simulation-based inference methods (Greifer et al. 2023). This step allows for a comprehensive comparison of the impact of different interventions across various subgroups, while encorporating uncertainty.</span></span>
<span id="cb32-1612"><a href="#cb32-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1613"><a href="#cb32-1613" aria-hidden="true" tabindex="-1"></a>Also see the appendix <span class="co">[</span><span class="ot">here</span><span class="co">](https://go-bayes.github.io/psych-434-2023/content/09-content.html#comprehensive-checklist-for-detailed-reporting-of-a-causal-inferenctial-study-e.g.-assessment-3-option-2)</span></span>
<span id="cb32-1614"><a href="#cb32-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1615"><a href="#cb32-1615" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>State what E-values are and how you will use them to clarify the risk of unmeasured confounding.</span>
<span id="cb32-1616"><a href="#cb32-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1617"><a href="#cb32-1617" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results</span></span>
<span id="cb32-1618"><a href="#cb32-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1619"><a href="#cb32-1619" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use the scripts I have provided as a template for your analysis.</span>
<span id="cb32-1620"><a href="#cb32-1620" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Propensity Score Reporting: Detail the process of propensity score derivation, including the model used and any variable transformations: e.g.: <span class="in">`A ~ x1 + x2 + x3 + ....`</span> using logistic regression, all continuous predictors were transformed to z-scores</span>
<span id="cb32-1621"><a href="#cb32-1621" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>WeightIt Package Utilisation: Explicitly mention the use of the 'WeightIt' package in R, including any specific options or parameters used in the propensity score estimation process <span class="co">[</span><span class="ot">@greifer2023a</span><span class="co">]</span>.</span>
<span id="cb32-1622"><a href="#cb32-1622" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Report if different methods were used to obtain propensity scores, and the reasons behind the choice of methods such as 'ebal', 'energy', and 'ps'.</span>
<span id="cb32-1623"><a href="#cb32-1623" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If your exposure is continuous only the 'energy' option was used for propensity score estimation.</span>
<span id="cb32-1624"><a href="#cb32-1624" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Subgroup Estimation: Confirm that the propensity scores for subgroups were estimated separately, and discuss how the weights were subsequently combined with the original data.</span>
<span id="cb32-1625"><a href="#cb32-1625" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Covariate Balance: Include a Love plot to visually represent covariate balance on the exposure both before and after weighting. The script will generate these plots.</span>
<span id="cb32-1626"><a href="#cb32-1626" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Weighting Algorithm Statistics: Report the statistics for the weighting algorithms as provided by the WeightIt package, including any measures of balance or fit. The script I gave you will generate this information</span>
<span id="cb32-1627"><a href="#cb32-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1628"><a href="#cb32-1628" aria-hidden="true" tabindex="-1"></a>Example:</span>
<span id="cb32-1629"><a href="#cb32-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1630"><a href="#cb32-1630" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; We estimated propensity scores by fitting a model for the exposure A as it is predicted by the set of baseline covariates defined by L. Because we are interested in effect modification by group, we fit different propensity score models for within strata of G using the </span><span class="in">`subgroup`</span><span class="at"> command of the </span><span class="in">`WeightIt`</span><span class="at"> package. Thus the propensity score is the the probability of receiving a value of a treatment (A=a) conditional on the covariates L, and stratum within G. We compared balance using the following methods of weighting: "ebal" or entropy balancing, "energy" or energy balancing, and "ps" or traditional inverse probability of weighting balancing. Of these methods "ebal" performed the best. Table X and Figure Y present the results of the ebalancing method.</span></span>
<span id="cb32-1631"><a href="#cb32-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1632"><a href="#cb32-1632" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation of Propensity Scores: we interpret the proposensity scores as yeilding good balance across the exposure conditions.</span>
<span id="cb32-1633"><a href="#cb32-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1634"><a href="#cb32-1634" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Outcome Regression Model: Clearly report the type of regression model used to estimate outcome model coefficients (e.g., linear regression, Poisson, binomial), and mention if the exposure was interacted with the baseline covariates. Do not report model coefficients as these have no interpretation. Example</span>
<span id="cb32-1635"><a href="#cb32-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1636"><a href="#cb32-1636" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; We fit a linear model using maximum likelihood estimation with the outcome Y predicted by the exposure A. We interacted the exposure with all baseline confounders L. Continuous baseline confounders were converted to z-scores, whereas categorical exposures were not. Also interacted with all baseline confounders was a term for the subgroup interactoin. This allowed uas to flexibily fit non-linearities for the modification of the effect of the exposure within levels of the levels of the cultural group strata of interest. We note that model coefficients have no interpretation in this context so are not reported. The remaining steps of Doubly-Robust estimation were performed as outlined in the *Method* section. We calculated confidence intervals and standard errors, using the </span><span class="in">`clarify`</span><span class="at"> package in R, which relies on simulation based inference for these quantities of interest </span><span class="co">[</span><span class="ot">@greifer2023</span><span class="co">]</span></span>
<span id="cb32-1637"><a href="#cb32-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1638"><a href="#cb32-1638" aria-hidden="true" tabindex="-1"></a>**Report the causal estimates.**</span>
<span id="cb32-1639"><a href="#cb32-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1640"><a href="#cb32-1640" aria-hidden="true" tabindex="-1"></a><span class="ss">  -   </span>ATE contrasts for groups in setting the exposure to for each group in setting level A = a and A = a<span class="sc">\*</span></span>
<span id="cb32-1641"><a href="#cb32-1641" aria-hidden="true" tabindex="-1"></a><span class="ss">  -   </span>differences between groups in the magnitude of the effects. (ATE_group 1 - ATE_group_2)</span>
<span id="cb32-1642"><a href="#cb32-1642" aria-hidden="true" tabindex="-1"></a><span class="ss">  -   </span>Report the E-value: how sensitive are your results to unmeasured confounding? </span>
<span id="cb32-1643"><a href="#cb32-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1644"><a href="#cb32-1644" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb32-1645"><a href="#cb32-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1646"><a href="#cb32-1646" aria-hidden="true" tabindex="-1"></a>Make sure to hit these points:</span>
<span id="cb32-1647"><a href="#cb32-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1648"><a href="#cb32-1648" aria-hidden="true" tabindex="-1"></a>Consider the following ideas about what to discuss in one's findings. The order of exposition might be different.</span>
<span id="cb32-1649"><a href="#cb32-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1650"><a href="#cb32-1650" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Summary of results**: What did you find?</span>
<span id="cb32-1651"><a href="#cb32-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1652"><a href="#cb32-1652" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Interpretation of E-values:** Interpret the E-values used for sensitivity analysis. State what they represent in terms of the robustness of the findings to potential unmeasured confounding.</span>
<span id="cb32-1653"><a href="#cb32-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1654"><a href="#cb32-1654" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Causal Effect Interpretation:** What is the interest of the effect, if any, if an effect was observed? Interpret the average causal effect of changing the exposure level within each subgroup, and discuss its relevance to the research question.</span>
<span id="cb32-1655"><a href="#cb32-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1656"><a href="#cb32-1656" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Comparison of Subgroups:** Discuss how differences in causal effect estimates between different subgroups, if observed, or if not observed, contribute to the overall findings of the study.</span>
<span id="cb32-1657"><a href="#cb32-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1658"><a href="#cb32-1658" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Uncertainty and Confidence Intervals:** Consider the uncertainty around the estimated causal effects, and interpret the confidence intervals to understand the precision of the estimates.</span>
<span id="cb32-1659"><a href="#cb32-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1660"><a href="#cb32-1660" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>**Generalisability and Transportability:** Reflect on the generalizability of the study results to other contexts or populations. Discuss any factors that might influence the transportability of the causal effects found in the study. (Again see lecture 9.)</span>
<span id="cb32-1661"><a href="#cb32-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1662"><a href="#cb32-1662" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>**Assumptions and Limitations:** Reflect on the assumptions made during the study and identify any limitations in the methodology that could affect the interpretation of results. State that the implications of different intervention levels on potential outcomes are not analysed.</span>
<span id="cb32-1663"><a href="#cb32-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1664"><a href="#cb32-1664" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>**Theoretical Relevance**: How are these findings relevant to existing theories.</span>
<span id="cb32-1665"><a href="#cb32-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1666"><a href="#cb32-1666" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>**Replication and Future Research:** Consider how the study could be replicated or expanded upon in future research, and how the findings contribute to the existing body of knowledge in the field.</span>
<span id="cb32-1667"><a href="#cb32-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1668"><a href="#cb32-1668" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>**Real-World Implications:** Discuss the real-world implications of the findings, and how they could be applied in policy, practice, or further research.</span>
<span id="cb32-1669"><a href="#cb32-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1670"><a href="#cb32-1670" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example anlaysis (week 10)</span></span>
<span id="cb32-1671"><a href="#cb32-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1672"><a href="#cb32-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1673"><a href="#cb32-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1674"><a href="#cb32-1674" aria-hidden="true" tabindex="-1"></a><span class="fu">### Packages</span></span>
<span id="cb32-1675"><a href="#cb32-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1678"><a href="#cb32-1678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-1679"><a href="#cb32-1679" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">cite_packages</span>()</span>
<span id="cb32-1680"><a href="#cb32-1680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>