{
  "hash": "10eaa8d29efbb99f3a5e714537f23f7e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Causal Diagrams: The Structures of Confounding Bias\"\ndate: \"2025-MAR-11\"\nbibliography: /Users/joseph/GIT/templates/bib/references.bib\neditor_options: \n  chunk_output_type: console\nformat:\n  html:\n    warnings: FALSE\n    error: FALSE\n    messages: FALSE\n    code-overflow: scroll\n    highlight-style: kate\n    code-tools:\n      source: TRUE\n      toggle: FALSE\nhtml-math-method: katex\nreference-location: margin\ncitation-location: margin\ncap-location: margin\ncolumn: column-page-left\ncode-block-border-left: true\n---\n\n::: {.cell}\n\n:::\n\n\n::: {.callout-note}\n**Required**\n- [@hernan2024WHATIF] Chapter 6 [link](https://www.dropbox.com/scl/fi/9hy6xw1g1o4yz94ip8cvd/hernanrobins_WhatIf_2jan24.pdf?rlkey=8eaw6lqhmes7ddepuriwk5xk9&dl=0)\n\n\n**Optional**\n\n- [@suzuki2020] [link](https://www.dropbox.com/scl/fi/4midxwr9ltg9oce02e0ss/suzuki-causal-diagrams.pdf?rlkey=uktzf3nurtgpbj8m4h0xz82dn&dl=0)\n- [@bulbulia2023] [link](https://osf.io/preprints/psyarxiv/b23k7)\n- [@neal2020introduction] Chapter 3 [link]()\n:::\n\n::: {.callout-important}\n## Key concepts for the test(s):\n  - **M-bias**\n  - **Regression**\n  - **Intercept**\n  - **Regression Coefficient**\n  - **Model Fit**\n  - **Why Model Fit is Misleading for Causality**\n:::\n\n::: {.callout-important}\n## For the lab, copy and paste code chunks following the \"LAB 3\" section.\nNote: you may also download the lab here [Download the R script for Lab 03](https://raw.githubusercontent.com/go-bayes/psych-434-2025/refs/heads/main/laboratory/03-lab.R)\n:::\n\n\n# Seminar\n\n## Learning Outcomes\n\n- You will learn how to use causal diagrams to evaluate the \"no unmeasured confounding\" assumption of causal inference.\n\n- You will understand how time-series data-collection may address common confounding problems.\n\n- You will understand why time-series data-collection are insufficient for addressing other common confounding problems.\n\n## Confounding problems resolved by time-series data \n\n@fig-time-solved presents the structural features of **seven** confounding problems. We shall discuss examples of each, and how longitudinal data collection resolves each problem.  \n\n\n::: {#fig-time-solved}\n![](time-resolved-confounding.pdf){fig-align=\"left\" height=100% width=100%}\n\nThis figure is adapted from [@bulbulia2023]\n:::\n\n## Confounding problems not resolved by time-series data alone\n\n@fig-time-not-solved presents six examples of time-series data that are not resolved by longitudinal data collection. **Before seminar, consider why time series data are insufficient to address confounding in each of the six scenarios described in this figure.**\n\n::: {#fig-time-not-solved}\n![](dag-time-series-not-resolved.pdf){fig-align=\"left\" height=100% width=100%}\n\nThis figure is adapted from [@bulbulia2023]\n:::\n\n## Worked Example: The Assumptions in Causal Mediation\n\n::: {#fig-time-solved}\n![](mediation.pdf){fig-align=\"left\" height=100% width=100%}\n\nThis figure is adapted from [@bulbulia2023]\n:::\n\n\n\n# Lab 3\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(devtools, quietly = TRUE)) {\n  install.packages(\"devtools\")\n  library(devtools)\n}\n\n# simulated data (will take time to download)\n# devtools::install_github(\"go-bayes/margot\")\nlibrary(\"margot\")\nlibrary(\"margot\")\n# List all datasets available in the package\n# data(package = \"margot\")\n#data(\"df_nz\", package = \"margot\")\n\n# for equations \n# if (!require(devtools, quietly = TRUE)) {\n#   install.packages(\"remotes\")\n#   library(remotes)\n# }\n# remotes::install_github(\"datalorax/equatiomatic\")\n# \n# library(\"equatiomatic\")\n# data wrangling\nif (!require(tidyverse, quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n  library(tidyverse)\n}\n\n# regression splines\n# for equations \nif (!require(devtools, quietly = TRUE)) {\n  install.packages(\"splines\")\n  library(splines)\n}\n\n# reports\nif (!require(report, quietly = TRUE)) {\n  install.packages(\"report\")\n  library(report)\n}\n\n# for equations \nif (!require(performance, quietly = TRUE)) {\n  install.packages(\"performance\")\n  library(performance)\n}\n\n# graphs \nif (!require(ggeffects, quietly = TRUE)) {\n  install.packages(\"ggeffects\")\n  library(ggeffects)\n}\n\n# more graphs\nif (!require(sjPlot, quietly = TRUE)) {\n  install.packages(\"sjPlot\")\n  library(sjPlot)\n}\n\n# data wrangling\nif (!require(dplyr, quietly = TRUE)) {\n  install.packages(\"dplyr\")\n  library(dplyr)\n}\n\n# graphing\nif (!require(ggplot2, quietly = TRUE)) {\n  install.packages(\"ggplot2\")\n  library(ggplot2)\n}\n\n# summary stats\nif (!require(skimr, quietly = TRUE)) {\n  install.packages(\"skimr\")\n  library(skimr)\n}\n\n# tables \nif (!require(gtsummary, quietly = TRUE)) {\n  install.packages(\"gtsummary\")\n  library(gtsummary)\n}\n\n# easy tables\nif (!require(table1, quietly = TRUE)) {\n  install.packages(\"table1\")\n  library(table1)\n}\n\n\n# table summaries\nif (!require(kableExtra, quietly = TRUE)) {\n  install.packages(\"kableExtra\")\n  library(kableExtra)\n}\n\n# multi-panel plots\nif (!require(patchwork, quietly = TRUE)) {\n  install.packages(\"patchwork\")\n  library(patchwork)\n}\n\nif (!require(performance, quietly = TRUE)) {\n  install.packages(\"performance\")\n  library(performance)\n}\n```\n:::\n\n\n# Regression \nThis week we introduce regression.\n\n## Learning Outcomes\n\nBy learning regression, you will be better equipped to do psychological science and to evaluate psychological research.\n\n## What is Regression?\n\nBroadly speaking, a regression model is a method for inferring the expected average features of a population and its variance conditional on other features of the population as measured in a sample.\n\nWe'll see that regression encompasses more than this definition; however, this definition makes a start.\n\nTo understand regression, then, we need to understand the following jargon words: population, sample, measurement, and inference.\n\n#### What is a population?\n\nIn science, a population is a hypothetical construct. It is the set of all potential members of a set of things. In psychological science, that set is typically a collection of individuals. We want to understand \"The population of all human beings?\" or \"The New Zealand adult population\"; or \"The population of undergraduates who may be recruited for IPRP in New Zealand.\"\n\n#### What is a sample?\n\nA sample is a randomly realised sub-population from the larger abstract population that a scientific community hopes to generalise about.\n\nThink of selecting balls randomly from an urn. When pulled at random, the balls may inform us about the urn's contents. For example, if we select one white ball and one black ball, we may infer that the balls in the urn are not all white or all black.\n\n#### What is \"measurement\"?\n\nA measure is a tool or method for obtaining numerical descriptions of a sample. We often call measures \"scales.\"\n\nA measurement is the numerical description we obtain from sensors such as statistical surveys, census data, twitter feeds, & etc.\n\nIn the course, we have encountered numerical scales, ordinal scales, and factors. The topic of measurement in psychology is very broad. As we shall see, the trail of the serpent of measurement runs across comparative psychological research.\n\nIt is essential to remember that measures can be prone to error.\n\nError-prone scales may nevertheless be helpful. However, we need to investigate their utility against the backdrop of specific interests and purposes.\n\n#### What is a parameter?\n\nIn regression, we combine measurements on samples with probability theory to guess about the properties of a population we will never observe. We call these properties \"parameters.\"\n\n#### What is statistical inference?\n\nThe bulk of statistical inference consists of educated guessing about population parameters.\n\n#### Probability distributions and statistical guessing\n\nInference is possible because the parameters of naturally occurring populations are structured by data-generating processes that are approximated by **probability distributions.** A probability distribution is a mathematical function describing a random event's probability. Today we will be focusing on height.[^1]\n\n[^1]: The relationship of probability distributions and data-generating processes is complex, intriguing, and both historically and philosophically rich $\\dots$. Because our interests are applied, we will hardly touch up this richness in this course.\n\nToday we will discuss the \"normal\" or \"Gaussian distribution.\" A large number of data-generating processes in nature conform the normal distribution.\n\nLet's consider some examples of randomly generated samples, which we will obtain using R's `rnorm` function.\n\n#### 10-person sample of heights\n\n::: {.cell}\n\n```{.r .cell-code}\n# seed\nset.seed(123)\n\n# generate 10 samples, average 170, sd = 20\ndraws_10 <- rnorm(10, mean = 170, sd = 20)\n\n# ggplot quick-histogram\nggplot2::qplot(draws_10, binwidth = 2)\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/draws_10-1.png){width=672}\n:::\n:::\n\n#### 100-person sample of heights\n\n::: {.cell}\n\n```{.r .cell-code}\n# reproducibility \nset.seed(123)\n\n# generate 100 samples, average 170, sd = 20\ndraws_100 <-rnorm(100, mean = 170, sd = 20)\n\n# graph\nggplot2::qplot(\n  draws_100, binwidth = 2\n  )\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/draws_100-1.png){width=672}\n:::\n:::\n\n#### 10000-person sample of heights\n\n::: {.cell}\n\n```{.r .cell-code}\n# reproducibility\nset.seed(123)\n\n# N = 10,000\ndraws_10000 <- rnorm(1e5, mean = 170, sd = 20)\n\n# plot\nggplot2::qplot(draws_10000, binwidth = 2)\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/draws_10000-1.png){width=672}\n:::\n:::\n\n### How can I use regression to infer a population parameter?\n\nWe can use R to investigate the *average* height of our imaginary population from which the preceding samples were randomly drawn. We do this in R by writing an \"intercept-only\" model as follows:\n\n::: {.cell}\n\n```{.r .cell-code}\n# syntax for an intercept-only model\nmodel <- lm(outcome ~ 1, data = data)\n\n# base R summary\nsummary(model)\n```\n:::\n\nUsing the previous simulations:\n\nN = 10 random draws\n\n::: {.cell}\n\n```{.r .cell-code}\n#|code-fold: false\n\n#write the model and get a nice table for it\nsjPlot::tab_model(lm(draws_10 ~ 1))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Dependent variable</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">171.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">157.85&nbsp;&ndash;&nbsp;185.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">10</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.000 / 0.000</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\nN = 100 random draws\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nsjPlot::tab_model(lm(draws_100 ~ 1))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Dependent variable</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">171.81</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">168.19&nbsp;&ndash;&nbsp;175.43</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">100</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.000 / 0.000</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\nN = 10,000 random draws\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nsjPlot::tab_model(lm(draws_10000 ~ 1))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Dependent variable</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">170.02</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">169.90&nbsp;&ndash;&nbsp;170.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">100000</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.000 / 0.000</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\nWhat do we notice about the relationship between sample size the estimated population average?\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nsjPlot::tab_model(lm(draws_10 ~ 1),\n                  lm(draws_100 ~ 1),\n                  lm(draws_10000 ~ 1))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Dependent variable</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Dependent variable</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Dependent variable</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7\">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8\">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9\">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0\">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">171.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">157.85&nbsp;&ndash;&nbsp;185.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">171.81</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">168.19&nbsp;&ndash;&nbsp;175.43</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8\">170.02</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9\">169.90&nbsp;&ndash;&nbsp;170.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">100</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">100000</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.000 / 0.000</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.000 / 0.000</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.000 / 0.000</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n### Regression with a single co-variate\n\nDo mothers’s heights *predict* daughter height? If so, what is the magnitude of the relationship?\n\nFrancis Galton is credited with inventing regression analysis. Galton observed that offspring’s heights tend to fall between parental height and the population average, which Galton termed \"regression to the mean.\" Galton sought a method for educated guessing about heights, and this led to fitting a line of regression by a method called \"least squares\" (For a history, see: [here](https://rss.onlinelibrary.wiley.com/doi/full/10.1111/j.1740-9713.2011.00509.x)).\n\nThe following dataset is from \"The heredity of height\" by Karl Pearson and Alice Lee (1903)[@pearson1903]. I obtained it from [@gelman2020]. Let's use this dataset to investigate the relationship between mothers' and daughters' heights.\n\n::: {.cell}\n\n```{.r .cell-code}\n# import data\ndf_pearson_lee <-\n  data.frame(read.table(\n    url(\n      \"https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt\"\n    ),\n    header = TRUE\n  ))\n\n# save\n# saveRDS(df_pearson_lee, here::here(\"data\", \"df_pearson_lee\"))\n\n# Center mother's height for later example\ndf_pearson_lee_centered <- df_pearson_lee |>\n  dplyr::mutate(mother_height_c = as.numeric(scale(\n    mother_height, center = TRUE, scale = FALSE\n  )))\n\nskimr::skim(df_pearson_lee_centered)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |                        |\n|:------------------------|:-----------------------|\n|Name                     |df_pearson_lee_centered |\n|Number of rows           |5524                    |\n|Number of columns        |3                       |\n|_______________________  |                        |\n|Column type frequency:   |                        |\n|numeric                  |3                       |\n|________________________ |                        |\n|Group variables          |None                    |\n\n\n**Variable type: numeric**\n\n|skim_variable   | n_missing| complete_rate|  mean|   sd|    p0|  p25|  p50|  p75| p100|hist  |\n|:---------------|---------:|-------------:|-----:|----:|-----:|----:|----:|----:|----:|:-----|\n|daughter_height |         0|             1| 63.86| 2.62|  52.5| 62.5| 63.5| 65.5| 73.5|▁▂▇▅▁ |\n|mother_height   |         0|             1| 62.50| 2.41|  52.5| 60.5| 62.5| 64.5| 70.5|▁▂▇▇▁ |\n|mother_height_c |         0|             1|  0.00| 2.41| -10.0| -2.0|  0.0|  2.0|  8.0|▁▂▇▇▁ |\n\n\n:::\n:::\n\nPearson and Lee collected 5,524 observations from mother/daughter height pairs. Let's examine the data, first by plotting the relationship.\n\nWhat is happening here?\n\n::: {.cell}\n\n```{.r .cell-code}\n# explore pearson lee data\nexplore_md <-\n  ggplot2::ggplot(data = df_pearson_lee_centered, aes(y = daughter_height, x = mother_height)) +\n  geom_jitter(alpha = .2) +\n  labs(title = \"The relationship between mothers height and daughter's height\") +\n  ylab(\"Daughter's height\") +\n  xlab(\"Mother's height\") + theme_classic()\n\n# print\nprint( explore_md )\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/graph_pearson_lee-1.png){width=672}\n:::\n:::\n\nIs there a linear predictive relationship between these two parameters? In regression we examine the line of best fit.\n\n::: {.cell}\n\n```{.r .cell-code}\n# regression \nm1 <-\n  lm(daughter_height ~ mother_height, data = df_pearson_lee_centered)\n\n# graph\nsjPlot::tab_model(m1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">daughter height</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">29.80</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">28.25&nbsp;&ndash;&nbsp;31.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">mother height</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.54</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.52&nbsp;&ndash;&nbsp;0.57</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">5524</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.252 / 0.252</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\nWe can plot the coefficient, but in a model with one predictor, this isn't very informative. However, as we continue in the course, we'll see that plotting coefficients can be easier than deciphering the numbers in tables. Here are two methods for plotting.\n\n::: {.cell}\n\n```{.r .cell-code}\n# get model parameters\nt_m1<-parameters::model_parameters(m1,  \n                                   ci = 0.95)\n# plot \nplot(t_m1) +\n  labs(title = \"The relationship between mothers height and daughter's height\") + \n  ylab(\"Daughter's height\") \n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n## How do we interpret the regression model?\nLet's write the equation out in mathematics. How do we read this? [^2]\n[^2]: Later, we'll prefer a different way of writing regression equations in math. (Note: writing math isn't math - it's just encoding the model that we've written).\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"equatiomatic\")\n# extract equation\n#extract_eq(m1, use_coefs = FALSE)\n```\n:::\n\n$$\n\\operatorname{daughter\\_height} = \\alpha + \\beta_{1}(\\operatorname{mother\\_height}) + \\epsilon\n$$\n\n\nThe math says that the expected daughter's height in a population is predicted by the average height of the population when mothers’ heights are set to zero units (note, this is impossible - we'll come back to this) plus $\\beta ~\\times$ units of daughter's height (inches) for each additional unit of mother's height (inches)\n\nWe can plug the output of the model directly into the equation as follows:\n\n::: {.cell}\n\n```{.r .cell-code}\n# extract equation\n#extract_eq(m1, use_coefs = TRUE)\n```\n:::\n\n$$\n\\operatorname{\\widehat{daughter\\_height}} = 29.8 + 0.54(\\operatorname{mother\\_height})\n$$\n\n\n### Graph the relationship between mother's and daughter's heights\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(ggeffects)\npredictions <- ggeffects::ggpredict(m1, terms = \"mother_height\",    \n    add.data = TRUE,\n    dot.alpha = .1,\n    jitter = TRUE)\n\n\nplot_predictions <-\n  plot(predictions) +   theme_classic() + labs(title = \"Predicted values of daughter's height from the Pearson/Fox 1903 dataset\")\nplot_predictions\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n### Regression to predict beyond the range of a dataset\n\nJoyte Amge is the world's shortest woman at 25 inches. Sandy Allen was the world's tallest woman at 91 inches. What are the expected heights of their daughter and of every intermediary woman in between?\n\n::: {.cell code_folding='false'}\n\n```{.r .cell-code  code-fold=\"false\"}\n# use the `expand.grid` command to create a sequence of points for mother's height\ndf_expand_grid <- expand.grid(mother_height = c(25:91))\n\n# use the `predict` function to create a new response\ndf_predict <-\n  predict(m1,\n          type = \"response\",\n          interval = \"confidence\",\n          newdata = df_expand_grid)\n\n# have a look at the object\n#dplyr::glimpse(df_predict)\n\n# create a new dataframe for the new sequence of points for mother's height and the predicted data\nnewdata <- data.frame(df_expand_grid, df_predict)\nhead(newdata)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  mother_height      fit      lwr      upr\n1            25 43.42183 42.49099 44.35266\n2            26 43.96676 43.06065 44.87288\n3            27 44.51170 43.63030 45.39310\n4            28 45.05664 44.19995 45.91332\n5            29 45.60157 44.76960 46.43355\n6            30 46.14651 45.33924 46.95378\n```\n\n\n:::\n:::\n\nGraph the predicted results\n\n::: {.cell}\n\n```{.r .cell-code}\n# graph the expected results\npredplot <- ggplot(data = newdata,\n                   aes(x = mother_height, y = fit))  +\n  geom_point() +  geom_errorbar(aes(ymin = lwr, ymax = upr), width = .1) +\n  expand_limits(x = c(20, 91), y = c(0, 81))  + theme_classic() +\n  labs(title = \"Predicted values for a broader population\")\n\n# plot the two graphs together (making the x and y axis at the same scale \nlibrary(\"patchwork\")\n# rescale heightplot\n\n# old plot with the new axis and y-axis scales, and remove points\n\nplot_height <- plot(predplot, add.data = FALSE) +   theme_classic()\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/predict_new_data-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_height_title <-\n  plot_height +  expand_limits(x = c(20, 91), y = c(0, 81)) +  labs(title = \"Predicted values of daughter's height from the Pearson/Fox 1903 dataset\")\n\n# double graph\nplot_height_title / predplot  + plot_annotation(title = \"What do you notice about these relationships?\", tag_levels = \"a\")\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/predict_new_data-2.png){width=672}\n:::\n:::\n\nA simple method for obtaining the predicted values from your fitted model is to obtain the effects output without producing a graph.\n\n::: {.cell code_folding='false'}\n\n```{.r .cell-code}\n# prediction plots\nlibrary(ggeffects)\n# predicted values of mother height on daughter height\nggeffects::ggpredict(m1, terms = \"mother_height\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Predicted values of daughter_height\n\nmother_height | Predicted |       95% CI\n----------------------------------------\n        52.50 |     58.41 | 58.15, 58.66\n        54.50 |     59.50 | 59.29, 59.70\n        57.50 |     61.13 | 60.99, 61.27\n        59.50 |     62.22 | 62.13, 62.32\n        61.50 |     63.31 | 63.25, 63.38\n        63.50 |     64.40 | 64.34, 64.47\n        65.50 |     65.49 | 65.40, 65.59\n        70.50 |     68.22 | 68.01, 68.42\n```\n\n\n:::\n:::\n\n### Non-linear relationships\n\nLinear regression assumes linearity conditional on a model. Often your data will not be linear!\n\nConsider the following example:\n\n::: {.cell code_folding='false'}\n\n```{.r .cell-code}\n# simulate nonlinear relationship between x and y\nb <- c(2, 0.75)\nset.seed(12)\nx <- rnorm(100)\nset.seed(12)\ny <- rnorm(100, mean = b[1] * exp(b[2] * x))\ndat1 <- data.frame(x, y)\n\not1 <- lm(y ~ x, data  = dat1)\n# performance::check_model(ot1)\n\n# plot linear effect\nplot(ggeffects::ggpredict(ot1, terms = \"x\",\n     add.data = TRUE,\n     dot.alpha = .4))\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\nNon-linear relationship as modelled by a polynomial regression:\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# model: quadratic\nfit_non_linear <- lm(y ~ x + I(x ^ 2), data  = dat1)\n\n# predictive plot\nplot(ggeffects::ggpredict(fit_non_linear, terms = \"x\",\n     add.data = TRUE,\n     dot.alpha = .4))\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\nHere is another approach:\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# non-linear regression \nlibrary(splines)\n\n# fit model \nfit_non_linear_b <- lm(y ~ x + poly(x, 2), data  = dat1)\n\n# graph model\nplot(\n  ggeffects::ggpredict(fit_non_linear_b, terms = \"x\",\n  add.data = TRUE,\n  dot.alpha = .4\n))\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\nNon-linear relationship as modelled by a general additive model (spline)\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# fit spline: not specified\nfit_non_linear_c <-lm(y ~ bs(x), data  = dat1)\n\n# model parameters: coefficients are not interpretable\nparameters::model_parameters(\n  fit_non_linear_c\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter      | Coefficient |   SE |         95% CI |  t(96) |      p\n----------------------------------------------------------------------\n(Intercept)    |       -1.90 | 0.03 | [-1.95, -1.84] | -70.74 | < .001\nx [1st degree] |        2.60 | 0.06 | [ 2.48,  2.72] |  43.47 | < .001\nx [2nd degree] |        3.00 | 0.03 | [ 2.94,  3.06] |  96.12 | < .001\nx [3rd degree] |       13.33 | 0.04 | [13.26, 13.40] | 368.37 | < .001\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n#performance::check_model(ot2)\nplot(\n  ggeffects::ggpredict(fit_non_linear_c, terms = \"x\",\n  add.data = TRUE,\n  dot.alpha = .4\n))\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n### Centering\n\nAny linear transformation of a predictor is *OK*. Often we centre (or centre and scale) all indicators, which gives us an interpretable intercept (the expected population average when the other indicators are set their average).\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggeffects)\n\n# fit raw data \nfit_raw <- lm(daughter_height ~ mother_height, data = df_pearson_lee_centered)\n\n# fit centred data\nfit_centered <-\n  lm(daughter_height ~ mother_height_c, data = df_pearson_lee_centered)\n\n# compare the models\nsjPlot::tab_model(fit_raw, fit_centered)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">daughter height</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">daughter height</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7\">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">29.80</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">28.25&nbsp;&ndash;&nbsp;31.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">63.86</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">63.80&nbsp;&ndash;&nbsp;63.92</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">mother height</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.54</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.52&nbsp;&ndash;&nbsp;0.57</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">mother height c</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.54</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.52&nbsp;&ndash;&nbsp;0.57</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">5524</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">5524</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.252 / 0.252</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.252 / 0.252</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\nGraph model\n\n::: {.cell}\n\n```{.r .cell-code}\n# graph centred model\nplot(\n  ggeffects::ggpredict(fit_centered, terms = \"mother_height_c\",\n  add.data = TRUE,\n  dot.alpha = .4\n))\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\nNote: when fitting a polynomial or any interaction, it is important to center your indicators. We'll come back to this point in later lectures.\n\n### Model evaluation\n\nReviewers will sometime ask you to assess model fit. \n\nA simple, but flawed way to assess accuracy of your model fit is to compare a model with one covariate with a simple intercept-only model and to assess improvement in either the `AIC` statistic or the `BIC` statistic. The `BIC` is similar to the `AIC` but adds a penalty for extra predictors. An absolute improvement in either statistic of n \\> 10 is considered to be a “better” model.\n\n\nWe can use the `performance` package to generate a table that compares model fits.\n\n::: {.cell code_foldign='false' code_folding='false'}\n\n```{.r .cell-code}\n# load library \nlibrary(performance)\n# intercept only\nfig_intercept_only <- lm(daughter_height ~ 1, data = df_pearson_lee)\n\n# covariate added\nfig_covariate <- lm(daughter_height ~ mother_height, data = df_pearson_lee)\n\n# evaluate\nperformance::compare_performance(fig_intercept_only, fig_covariate)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Comparison of Model Performance Indices\n\nName               | Model |   AIC (weights) |  AICc (weights)\n--------------------------------------------------------------\nfig_intercept_only |    lm | 26300.0 (<.001) | 26300.0 (<.001)\nfig_covariate      |    lm | 24698.5 (>.999) | 24698.5 (>.999)\n\nName               |   BIC (weights) |    R2 | R2 (adj.) |  RMSE | Sigma\n------------------------------------------------------------------------\nfig_intercept_only | 26313.2 (<.001) | 0.000 |     0.000 | 2.615 | 2.615\nfig_covariate      | 24718.4 (>.999) | 0.252 |     0.252 | 2.262 | 2.262\n```\n\n\n:::\n:::\n\nWhat was the model \"improvement?\"\n\n::: {.cell}\n\n```{.r .cell-code}\n# improved fit\nBIC(fig_intercept_only) - BIC(fig_covariate)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1594.839\n```\n\n\n:::\n:::\n\n\n### Generate a report\n\nThis is easy with the `report` package\n\nFor example:\n\n::: {.cell code_folding='false'}\n\n```{.r .cell-code}\nreport::report_statistics(fig_covariate)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nbeta = 29.80, 95% CI [28.25, 31.35], t(5522) = 37.70, p < .001; Std. beta = 7.21e-15, 95% CI [-0.02, 0.02]\nbeta = 0.54, 95% CI [0.52, 0.57], t(5522) = 43.12, p < .001; Std. beta = 0.50, 95% CI [0.48, 0.52]\n```\n\n\n:::\n:::\n\nOr, if you want a longer report:\n\n::: {.cell code_folding='false'}\n\n```{.r .cell-code}\nreport::report(fig_covariate)\n```\n:::\n\nUse `statistically significant` in place of `significant`. This will avoid misleading your audience into thinking your result is important when what you intend to communicate is that it is reliable.\n\n## Assumptions of Regression\n\nFrom Gelman and Hill [@gelman2006]\n\n1.  **Validity**\n\n    > The most important is that the data you are analyzing should map to the research question you are trying to answer [@gelman2020, p.152]\n\n2.  **Representativeness**\n\n    > A regression model is fit to data and is used to make inferences about a larger population, hence the implicit assumption in interpreting regression coefficients is that the sample is representative of the population. [@gelman2020, p.153]\\\n\n3.  **Linearity**\n\n    > The most important mathematical assumption of the linear regression model is that its deterministic component is a linear function of the separate predictors: y = β0 + β1x1 + β2x2 +···. If additivity is violated, it might make sense to transform the data (for example, if y = abc, then log y = log a + log b + log c) or to add interactions. If linearity is violated, perhaps a predictor should be put in as 1/x or log(x) instead of simply linearly. Or a more complicated relationship could be expressed using a nonlinear function such as a spline or Gaussian process, [@gelman2020, p.153]\n\n4.  **Independence of errors**\n\n    > The simple regression model assumes that the errors from the prediction line are independent, an assumption that is violated in time series, spatial, and multilevel settings [@gelman2020, p.153]\n\n5.  **Equal variance of errors**\n\n> ...unequal variance does not affect the most important aspect of a regression model, which is the form of the predictors [@gelman2020, p.153]\n\n5.  **Normality of errors (statistical independence)**\n\n> The regression assumption that is generally least important is that the errors are normally distributed. In fact, for the purpose of estimating the regression line (as compared to predicting individual data points), the assumption of normality is barely important at all. Thus, in contrast to many regression textbooks, we do not recommend diagnostics of the normality of re-gression residuals. [@gelman2006, p. 46]\n\n> A good way to diagnose violations of some of the assumptions just considered (importantly, linearity) is to plot the residuals versus fitted values or simply individual predictors.[@gelman2006 p. 46]\n\n### Common Confusions\n\n#### Regressions do not automatically give us “effects”\n\n**People use the work \"effect\", but that is not what regression gives us, by default.**\n\n#### \"Normality Assumption\"\n\nGelman and Hill note that the \"normality\" assumption is the least important. The assumption pertains to the normality of residuals.\n\n#### Statistical Independence\n\nThis is the motivation for doing multi-level modelling: to condition on dependencies in the data. However, multi-level modelling can produce new problems if the error terms in the model are not independent of the outcome. \n\n#### External Validity (wrong population)\n\nWe sample from undergraduates, but infer about the human population.\n\n::: {.callout-important}\n**NOTE**: The concept of “better model fit” is relative to our interests and purposes.  A better (lower) AIC statistic does not tell us whether a model is better for better causal inference. We must assess whether a model satisfies the assumptions necessary for valid causal inference.\n:::\n\n## Simulation Demonstration 1: How Regression Coefficients Mislead\n\n#### Methodology\n\n1. **Data Generation**: we simulate a dataset for 1,000 individuals, where religious service attendance ($A$) affects wealth ($L$), which in turn affects charitable donations ($Y$). The simulation is based on predefined parameters that establish L as a mediator between $A$ and $Y$.\n\n2. **Parameter Definitions**:\n   - The probability of religious service ($A$) is set at 0.5.\n   - The effect of $A$ on $L$ (wealth) is given by $\\beta = 2$.\n   - The effect of $L$ on $Y$ (charity) is given by $\\delta = 1.5$.\n   - Standard deviations for $L$ and $Y$ are set at 1 and 1.5, respectively.\n\n3. **Model Specifications**:\n   - **Model 1** (Correct Assumption): considerss a linear regression model assuming $L$ as a mediator, including $A$ and $L$ as regressors on $Y$. This model aligns with the data-generating process and correctly identifies L as a mediator. According to the rules of d-separation (last week): **to identify the total effect of $A$ on $Y$ we must not include $L$**\n   - **Model 2** (Correct model): This fits a linear regression model that includes only $A$ as a regressor on $Y$ and omits the mediator $L$. This model assesses the direct effect of $A$ on $Y$ without accounting for mediation.\n\n4. **Analysis and Comparison**: the analysis compares the estimated effects of $A$ on $Y$ under both model specifications. By including $L$ as a predictor in Model 1, we induce mediation bias. Whereas Model 2 correctly excludes $L$ from the model. \n\n5. **Presentation**: the results are displayed in a comparative table formatted for publication. The table contrasts the regression coefficients and significance levels obtained under each model.\n\n\n::: {.cell tbl-cap='Code for a simulation of a data generating process in which the effect of exercise (L) fully mediates the effect of greenspace (A) on happiness (Y).'}\n\n```{.r .cell-code}\n# simulation seed\nset.seed(123) #  reproducibility\n\n# define the parameters \nn = 1000 # Number of observations\np = 0.5  # Probability of A = 1 \nalpha = 0 # Intercept for L \nbeta = 2  # Effect of A on L \ngamma = 1 # Intercept for Y \ndelta = 1.5 # Effect of L on Y\nsigma_L = 1 # Standard deviation of L\nsigma_Y = 1.5 # Standard deviation of Y\n\n# simulate the data: fully mediated effect by L\nA = rbinom(n, 1, p) # binary exposure variable\nL = alpha + beta*A + rnorm(n, 0, sigma_L) # mediator L affect by A\nY = gamma + delta*L + rnorm(n, 0, sigma_Y) # Y affected only by L,\n\n# make the data frame\ndata = data.frame(A = A, L = L, Y = Y)\n\n# fit regression in which L is assumed to be a mediator\n# (cross-sectional data is consistent with this model)\nexample_fit_1 <- lm( Y ~ A + L, data = data)\n\n# fit regression in which L is assumed to be a mediator\n# (cross-sectional data is also consistent with this model)\nexample_fit_2 <- lm( Y ~ A, data = data)\n\n# create gtsummary tables for each regression model\ntable1 <- gtsummary::tbl_regression(example_fit_1)\ntable2 <- gtsummary::tbl_regression(example_fit_2)\n\n# merge the tables for comparison\ntable_comparison <- gtsummary::tbl_merge(\n  list(table1, table2),\n  tab_spanner = c(\"Model: Wealth assumed confounder\", \n                  \"Model: Wealth assumed to be a mediator\")\n)\n# make latex table (for publication)\nmarkdown_table_0 <- as_kable_extra(table_comparison, \n                                   format = \"markdown\", \n                                   booktabs = TRUE)\n# print markdown table (note, you might prefer \"latex\" or another format)                                \nmarkdown_table_0\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"NAborder-bottom: 0;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Model: Wealth assumed confounder</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Model: Wealth assumed to be a mediator</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Characteristic </th>\n   <th style=\"text-align:center;\"> Beta </th>\n   <th style=\"text-align:center;\"> 95% CI </th>\n   <th style=\"text-align:center;\"> p-value </th>\n   <th style=\"text-align:center;\"> Beta </th>\n   <th style=\"text-align:center;\"> 95% CI </th>\n   <th style=\"text-align:center;\"> p-value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:center;\"> -0.27 </td>\n   <td style=\"text-align:center;\"> -0.53, -0.01 </td>\n   <td style=\"text-align:center;\"> 0.043 </td>\n   <td style=\"text-align:center;\"> 2.9 </td>\n   <td style=\"text-align:center;\"> 2.6, 3.2 </td>\n   <td style=\"text-align:center;\"> &lt;0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> L </td>\n   <td style=\"text-align:center;\"> 1.6 </td>\n   <td style=\"text-align:center;\"> 1.5, 1.7 </td>\n   <td style=\"text-align:center;\"> &lt;0.001 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Abbreviation: CI = Confidence Interval</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n### Compare model fits\n\n\n#### By all metrics, model 1 fits better but it is confounded\n::: {.cell}\n\n```{.r .cell-code}\nperformance::compare_performance(example_fit_1, example_fit_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Comparison of Model Performance Indices\n\nName          | Model |  AIC (weights) | AICc (weights) |  BIC (weights)\n------------------------------------------------------------------------\nexample_fit_1 |    lm | 3620.6 (>.999) | 3620.6 (>.999) | 3640.2 (>.999)\nexample_fit_2 |    lm | 4392.2 (<.001) | 4392.2 (<.001) | 4406.9 (<.001)\n\nName          |    R2 | R2 (adj.) |  RMSE | Sigma\n-------------------------------------------------\nexample_fit_1 | 0.682 |     0.682 | 1.473 | 1.475\nexample_fit_2 | 0.312 |     0.311 | 2.169 | 2.171\n```\n\n\n:::\n:::\n\nModel 1 exhibits mediator bias, but it has a considerably higher $R^2$, and a lower BIC\n\n##### Focussing on the BIC (lower is better) Model 1 fits better, but it is confounded.\n::: {.cell}\n\n```{.r .cell-code}\nBIC(example_fit_1) - BIC(example_fit_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -766.643\n```\n\n\n:::\n:::\n\n\n::: {.callout-important}\nIn this simulation, we discovered that if we assess \"effect\" by \"model fit\" we will get the wrong *sign* for the coefficient of interest. The use of model fit perpetuates the *causality crisis* in psychological science [@bulbulia2022]. Few are presently aware of this crisis. Causal diagrams show us how we can do better.\n:::\n\n\n## Simulation Demonstration 2: How Regression Coefficients Mislead\n\n#### Methodology\n\n1. **Data Generation**:  simulate a dataset for 1,000 individuals, where religious service attendance ($A$) affects wealth ($L$),and chartitable donations charitable donations ($Y$) also affects wealth $L$, but $A$ and $Y$ are not causally related\n\n2. **Parameter Definitions**:\n   - The probability of religious service ($A$) is set at 0.5.\n   - $Y$ is has a mean $0$ and sd = $1$, and is independent of $A$.\n   - $L$ is a linear function of $A$ and $Y$.\n\n3. **Model Specifications**:\n   - **Model 1** (Correct Assumption): do not control for $L$\n   - **Model 2** (Correct model): control for $L$\n\n4. **Analysis and Comparison**: compare models. \n\n5. **Presentation**: a table.\n\n\n::: {.cell tbl-cap='L is a collider of A and Y.'}\n\n```{.r .cell-code}\n# simulation seed\nset.seed(123) #  reproducibility\n\n# define parameters \nn = 1000 # Number of observations\np = 0.5  # Probability of A = 1 \nalpha = 0 # Intercept for L\n\n\n# simulate the data\nA_1 = rbinom(n, 1, p) # binary exposure variable\nY_1 = rnorm(n, 0, 1) # Y affected only by L,\nL_2 = rnorm(n, A_1 + Y_1)\n\n# make the data frame\ndata_collider = data.frame(A = A_1, L = L_2, Y = Y_1)\n\n# fit regression in which L is assumed to be a mediator\n# (cross-sectional data is consistent with this model)\ncollider_example_fit_1 <- lm( Y ~ A + L, data = data_collider)\n\n# fit regression in which L is assumed to be a mediator\n# (cross-sectional data is also consistent with this model)\ncollider_example_fit_2 <- lm( Y ~ A, data = data_collider)\nsummary(collider_example_fit_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Y ~ A + L, data = data_collider)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.16111 -0.46220 -0.00342  0.45893  1.98913 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.008157   0.030247   -0.27    0.787    \nA           -0.476938   0.045314  -10.53   <2e-16 ***\nL            0.508127   0.014894   34.12   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.681 on 997 degrees of freedom\nMultiple R-squared:  0.5386,\tAdjusted R-squared:  0.5377 \nF-statistic:   582 on 2 and 997 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# create gtsummary tables for each regression model\ncollider_table1 <- gtsummary::tbl_regression(collider_example_fit_1)\ncollider_table2 <- gtsummary::tbl_regression(collider_example_fit_2)\n\n# merge the tables for comparison\ncollider_table_comparison <- gtsummary::tbl_merge(\n  list(collider_table1, collider_table2),\n  tab_spanner = c(\"Model: Wealth assumed confounder\", \n                  \"Model: Wealth not assumed to be a mediator\")\n)\n# make latex table (for publication)\nmarkdown_table_1 <- as_kable_extra(collider_table_comparison, \n                                   format = \"markdown\", \n                                   booktabs = TRUE)\n# print markdown table (note, you might prefer \"latex\" or another format)                                \ncollider_table_comparison\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gnvxvysfyx\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gnvxvysfyx table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gnvxvysfyx thead, #gnvxvysfyx tbody, #gnvxvysfyx tfoot, #gnvxvysfyx tr, #gnvxvysfyx td, #gnvxvysfyx th {\n  border-style: none;\n}\n\n#gnvxvysfyx p {\n  margin: 0;\n  padding: 0;\n}\n\n#gnvxvysfyx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gnvxvysfyx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gnvxvysfyx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gnvxvysfyx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gnvxvysfyx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gnvxvysfyx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gnvxvysfyx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gnvxvysfyx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gnvxvysfyx .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gnvxvysfyx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gnvxvysfyx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gnvxvysfyx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gnvxvysfyx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gnvxvysfyx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gnvxvysfyx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gnvxvysfyx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gnvxvysfyx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gnvxvysfyx .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gnvxvysfyx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gnvxvysfyx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gnvxvysfyx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gnvxvysfyx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gnvxvysfyx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gnvxvysfyx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gnvxvysfyx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gnvxvysfyx .gt_left {\n  text-align: left;\n}\n\n#gnvxvysfyx .gt_center {\n  text-align: center;\n}\n\n#gnvxvysfyx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gnvxvysfyx .gt_font_normal {\n  font-weight: normal;\n}\n\n#gnvxvysfyx .gt_font_bold {\n  font-weight: bold;\n}\n\n#gnvxvysfyx .gt_font_italic {\n  font-style: italic;\n}\n\n#gnvxvysfyx .gt_super {\n  font-size: 65%;\n}\n\n#gnvxvysfyx .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gnvxvysfyx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gnvxvysfyx .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gnvxvysfyx .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gnvxvysfyx .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gnvxvysfyx .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gnvxvysfyx .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#gnvxvysfyx .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#gnvxvysfyx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"PHN0cm9uZz5DaGFyYWN0ZXJpc3RpYzwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_1\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"TW9kZWw6IFdlYWx0aCBhc3N1bWVkIGNvbmZvdW5kZXI=\"><span class='gt_from_md'>Model: Wealth assumed confounder</span></span></div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"level 1; estimate_2\">\n        <div class=\"gt_column_spanner\"><span data-qmd-base64=\"TW9kZWw6IFdlYWx0aCBub3QgYXNzdW1lZCB0byBiZSBhIG1lZGlhdG9y\"><span class='gt_from_md'>Model: Wealth not assumed to be a mediator</span></span></div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_1\"><span data-qmd-base64=\"PHN0cm9uZz5CZXRhPC9zdHJvbmc+\"><span class='gt_from_md'><strong>Beta</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_1\"><span data-qmd-base64=\"PHN0cm9uZz45NSUgQ0k8L3N0cm9uZz4=\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_1\"><span data-qmd-base64=\"PHN0cm9uZz5wLXZhbHVlPC9zdHJvbmc+\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate_2\"><span data-qmd-base64=\"PHN0cm9uZz5CZXRhPC9zdHJvbmc+\"><span class='gt_from_md'><strong>Beta</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low_2\"><span data-qmd-base64=\"PHN0cm9uZz45NSUgQ0k8L3N0cm9uZz4=\"><span class='gt_from_md'><strong>95% CI</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value_2\"><span data-qmd-base64=\"PHN0cm9uZz5wLXZhbHVlPC9zdHJvbmc+\"><span class='gt_from_md'><strong>p-value</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">A</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">-0.48</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">-0.57, -0.39</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\">0.00</td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\">-0.12, 0.13</td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\">>0.9</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">L</td>\n<td headers=\"estimate_1\" class=\"gt_row gt_center\">0.51</td>\n<td headers=\"conf.low_1\" class=\"gt_row gt_center\">0.48, 0.54</td>\n<td headers=\"p.value_1\" class=\"gt_row gt_center\"><0.001</td>\n<td headers=\"estimate_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low_2\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value_2\" class=\"gt_row gt_center\"><br /></td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"7\"><span data-qmd-base64=\"QWJicmV2aWF0aW9uOiBDSSA9IENvbmZpZGVuY2UgSW50ZXJ2YWw=\"><span class='gt_from_md'>Abbreviation: CI = Confidence Interval</span></span></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n### Compare model fits\n\n\n#### By all metrics, model 1 fits better but it is confounded. \n\n$A$ is not causally associated with $Y$. We generated the data so we know.  However, the confounded model shows a better fit, and in this model the coefficient for $A$ is significant (and negative). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nperformance::compare_performance(collider_example_fit_1, collider_example_fit_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Comparison of Model Performance Indices\n\nName                   | Model |  AIC (weights) | AICc (weights)\n----------------------------------------------------------------\ncollider_example_fit_1 |    lm | 2074.4 (>.999) | 2074.4 (>.999)\ncollider_example_fit_2 |    lm | 2845.9 (<.001) | 2845.9 (<.001)\n\nName                   |  BIC (weights) |        R2 |  R2 (adj.) |  RMSE | Sigma\n--------------------------------------------------------------------------------\ncollider_example_fit_1 | 2094.0 (>.999) |     0.539 |      0.538 | 0.680 | 0.681\ncollider_example_fit_2 | 2860.6 (<.001) | 2.784e-06 | -9.992e-04 | 1.001 | 1.002\n```\n\n\n:::\n:::\n\n\n##### Again, the BIC for (lower is better) Model 1 fits better, but it is entirely confounded.\n\n::: {.cell}\n\n```{.r .cell-code}\nBIC(collider_example_fit_1) - BIC(collider_example_fit_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -766.643\n```\n\n\n:::\n:::\n\nHow does collider bias work? If we know that someone is *not* attending church, if they are charitable then we can *predict* they are wealthy. Similarly if we know someone is not wealthy but charitable, we can *predict* they attend religious service. \n\nHowever,  in this simulation, we know the religion and wealth are *not* casually associated because we have simulated the data.\n\n::: {.callout-important}\nIn this simulation, we discovered that if we assess \"effect\" by \"model fit\", we get the **wrong scientific inference*. The use of model fit perpetuates the *causality crisis* in psychological science [@bulbulia2022]. Let's do better. \n:::\n\n## Resources on Regression that Do Not Perpetuate The Causality Crisis\n\n1.  **Statistical Rethinking** [@mcelreath2020]\n2.  **Regression and Other Stories** [@gelman2020]\n\n## Setup \n\n### Libraries\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(lubridate)\nlibrary(kableExtra)\nlibrary(gtsummary)\n```\n:::\n\n### Get data\n\n::: {.cell}\n\n```{.r .cell-code}\n# package with data\nlibrary(margot)\n\n# load data\ndata(\"df_nz\")\n```\n:::\n\n### Import `Pearson and Lee` mother's and daughters data\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_pearson_lee <-\n  data.frame(read.table(\n    url(\n      \"https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt\"\n    ),\n    header = TRUE\n  ))\n# Center mother's height for later example\ndf_pearson_lee <- df_pearson_lee|>\n  dplyr::mutate(mother_height_c = as.numeric(scale(\n    mother_height, center = TRUE, scale = FALSE\n  )))\n\n# dplyr::glimpse(df_pearson_lee)\n\n# In 1903, Pearson and Lee collected 5,524 observations from mother/daughter height pairs. See lecture 5 for details\n```\n:::\n\n### Note\n\n**For all exercises below, use only the 2018 wave of the `df_nz` dataset.**\n\ncolnames(df_nz)\n## Q1. Create a descriptive table and a descriptive graph for the `hlth_weight` and `hlth_height` variables in the `df_nz` dataset\n\nSelect `hlth_height`, `hlth_weight` from the nz dataset. \n\nFilter only the 2018 wave.\n\nCreate a descriptive table and graph these two variables\n\nAnnotate your workflow (at each step, describe what you are doing and why).\n\n\n## Q2. Regression height ~ weight and report results\n\nUsing the `df_nz` dataset, write a regression model for height as predicted by weight. \n\nCreate a table for your results. \n\nCreate a graphs/graphs to clarify the results of your regression model. \n\nBriefly report your results. \n\n\n## Q3. Regress height ~ male and report results\n\nUsing the `df_nz` dataset, write a regression model for height as predicted by `male` \n\nCreate a table for your results. \n\nCreate a graphs/graphs to clarify the results of your regression model. \n\nBriefly report your results. \n\n\n## Q4. Regression to predict\n\nUsing the regression coefficients from the Pearson and Lee 1903 dataset, predict the heights of daughters of women in the `df_nz` dataset. \n\n\n## Q5. Bonus\n\nOn average, how much taller or shorter are women in New Zealand as sampled in 2019 `df_nz` dataset compared with women in 1903 as sampled in the Pearson and Lee dataset. \n\nClarify your inference.\n\n## Solutions: Set Up\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### libraries\nlibrary(\"tidyverse\")\nlibrary(\"patchwork\")\nlibrary(\"lubridate\")\nlibrary(\"kableExtra\")\nlibrary(\"gtsummary\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# get data\nlibrary(\"margot\")\ndata(\"df_nz\")\n```\n:::\n::: {.cell}\n\n```{.r .cell-code}\n# Import `Pearson and Lee` mother's and daughters data\n# In 1903, Pearson and Lee collected 5,524 observations from mother/daughter height pairs. \n\ndf_pearson_lee <- data.frame(read.table(\n  url(\n    \"https://raw.githubusercontent.com/avehtari/ROS-Examples/master/PearsonLee/data/MotherDaughterHeights.txt\"\n  ),\n  header = TRUE\n))\n# Center mother's height for later example\ndf_pearson_lee <- df_pearson_lee|>\n  dplyr::mutate(mother_height_c = as.numeric(scale(\n    mother_height, center = TRUE, scale = FALSE\n  )))\n\n# dplyr::glimpse(df_pearson_lee)\n```\n:::\n\n\n## Solution Q1 descriptive table\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# required libraries\nlibrary(gtsummary)\nlibrary(dplyr)\nlibrary(margot)\n\n# select focal variables and rename them for clarity\ndf_nzdat <- df_nz  |>\n  dplyr::filter(wave == 2019) |>\n  dplyr::select(hlth_weight, hlth_height, male) |>\n  dplyr::rename(weight = hlth_weight,\n                height = hlth_height) |>\n  dplyr::select(weight, height, male) |>\n  dplyr::mutate(weight_c = as.numeric(scale(\n    weight, scale = F, center = TRUE\n  )))\n\n\n# create table\ndf_nzdat |> \n  dplyr::select(weight,\n                height) |> \n  gtsummary::tbl_summary(\n    #by = wave,\n    statistic = list(\n      all_continuous() ~ \"{mean} ({sd})\",\n      all_categorical() ~ \"{n} / {N} ({p}%)\"\n    ),\n    digits = all_continuous() ~ 2,\n    missing_text = \"(Missing)\"\n  )|>\n  bold_labels() \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"prvxiiaybr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#prvxiiaybr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#prvxiiaybr thead, #prvxiiaybr tbody, #prvxiiaybr tfoot, #prvxiiaybr tr, #prvxiiaybr td, #prvxiiaybr th {\n  border-style: none;\n}\n\n#prvxiiaybr p {\n  margin: 0;\n  padding: 0;\n}\n\n#prvxiiaybr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#prvxiiaybr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#prvxiiaybr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#prvxiiaybr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#prvxiiaybr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#prvxiiaybr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#prvxiiaybr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#prvxiiaybr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#prvxiiaybr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#prvxiiaybr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#prvxiiaybr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#prvxiiaybr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#prvxiiaybr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#prvxiiaybr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#prvxiiaybr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#prvxiiaybr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#prvxiiaybr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#prvxiiaybr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#prvxiiaybr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#prvxiiaybr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#prvxiiaybr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#prvxiiaybr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#prvxiiaybr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#prvxiiaybr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#prvxiiaybr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#prvxiiaybr .gt_left {\n  text-align: left;\n}\n\n#prvxiiaybr .gt_center {\n  text-align: center;\n}\n\n#prvxiiaybr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#prvxiiaybr .gt_font_normal {\n  font-weight: normal;\n}\n\n#prvxiiaybr .gt_font_bold {\n  font-weight: bold;\n}\n\n#prvxiiaybr .gt_font_italic {\n  font-style: italic;\n}\n\n#prvxiiaybr .gt_super {\n  font-size: 65%;\n}\n\n#prvxiiaybr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#prvxiiaybr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#prvxiiaybr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#prvxiiaybr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#prvxiiaybr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#prvxiiaybr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#prvxiiaybr .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#prvxiiaybr .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#prvxiiaybr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"PHN0cm9uZz5DaGFyYWN0ZXJpc3RpYzwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_0\"><span data-qmd-base64=\"PHN0cm9uZz5OID0gMjAsMDAwPC9zdHJvbmc+\"><span class='gt_from_md'><strong>N = 20,000</strong></span></span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">weight</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">79.24 (18.42)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    (Missing)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">5,655</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">height</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1.70 (0.10)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    (Missing)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">5,655</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span data-qmd-base64=\"TWVhbiAoU0Qp\"><span class='gt_from_md'>Mean (SD)</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nHere's another approach:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# libs we need\nlibrary(table1)\nlibrary(tidyverse)\nlibrary(tidyr)\nlibrary(margot)\n\n# filter 2019 wave\ndf_nz_1 <- df_nz|>\n  dplyr::filter(wave == 2019)\n\n# nicer labels\ntable1::label(df_nz_1$hlth_weight)     <- \"Weight\"\ntable1::label(df_nz_1$hlth_height)     <- \"Height\"\n\n# table\ntable1::table1(~ hlth_weight + hlth_height, data = df_nz_1)     \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=20000)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Weight</td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>79.2 (18.4)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>77.0 [38.0, 200]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>5655 (28.3%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Height</td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>1.70 (0.100)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>1.69 [1.26, 2.04]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>5655 (28.3%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n:::\n:::\n\nCreate graph\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"patchwork\")\n# create data set where filtering na vals\ndf_nzdat1 <- df_nzdat |> \n    dplyr::filter(!is.na(weight),\n                  !is.na(height),\n                  !is.na(male)) # filter na's for density plots\n  \nweight_density <-ggplot2::ggplot(data = df_nzdat1, aes(x = weight)) + geom_density(fill = \"chocolate2\") + \n  labs(title = \"Density plot of weight of NZ sample years 2019/2020\") + theme_classic()\nweight_density\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/shape_data-1.png){width=672}\n:::\n\n```{.r .cell-code}\nheight_density <-ggplot2::ggplot(data = df_nzdat1, aes(x = height)) + geom_density(fill =\"blue2\") + \n  labs(title = \"Density plot of height of NZ sample years 2019/2020\") + theme_classic()\n\nheight_density\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/shape_data-2.png){width=672}\n:::\n\n```{.r .cell-code}\nweight_density / height_density + plot_annotation(tag_levels = 'a')\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/shape_data-3.png){width=672}\n:::\n:::\n\nHere's a density plot:\n\n::: {.cell}\n\n```{.r .cell-code}\n# library\nlibrary(ggplot2)\n\n\nggplot2::ggplot(data = df_nzdat1, aes(x = weight, fill = as.factor(male))) +\n  geom_density() + \n  labs(title = \"Density plot of weight of NZ sample years 2019/2020\") +\n  theme_classic() + \n  scale_fill_viridis_d() # nicer colour\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/density_plot-1.png){width=672}\n:::\n:::\n\n\n## Solution Q2. Regress height ~ weight and report results\n\n**Using the `nz` dataset, write a regression model for height as predicted by weight.  Create a table for your results.  Create a graphs/graphs to clarify the results of your regression model.  Briefly report your results.**\n\n\nModel:\n\n::: {.cell}\n\n```{.r .cell-code}\n# regression of height ~ weight\nfit_1 <- lm(height ~ weight_c, data = df_nzdat)\n```\n:::\n\nTable:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(parameters)\n#table of model\nparameters::model_parameters( fit_1) |> \n  print_html(  digits = 2,  # options\n               select = \"{coef}{stars}|({ci})\",\n               column_labels = c(\"Estimate\", \"95% CI\")\n) \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"kgywzvlydc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#kgywzvlydc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#kgywzvlydc thead, #kgywzvlydc tbody, #kgywzvlydc tfoot, #kgywzvlydc tr, #kgywzvlydc td, #kgywzvlydc th {\n  border-style: none;\n}\n\n#kgywzvlydc p {\n  margin: 0;\n  padding: 0;\n}\n\n#kgywzvlydc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 100%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#kgywzvlydc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kgywzvlydc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kgywzvlydc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kgywzvlydc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kgywzvlydc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kgywzvlydc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kgywzvlydc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kgywzvlydc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#kgywzvlydc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#kgywzvlydc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kgywzvlydc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kgywzvlydc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kgywzvlydc .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kgywzvlydc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgywzvlydc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kgywzvlydc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kgywzvlydc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#kgywzvlydc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgywzvlydc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kgywzvlydc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgywzvlydc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kgywzvlydc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgywzvlydc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kgywzvlydc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kgywzvlydc .gt_left {\n  text-align: left;\n}\n\n#kgywzvlydc .gt_center {\n  text-align: center;\n}\n\n#kgywzvlydc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kgywzvlydc .gt_font_normal {\n  font-weight: normal;\n}\n\n#kgywzvlydc .gt_font_bold {\n  font-weight: bold;\n}\n\n#kgywzvlydc .gt_font_italic {\n  font-style: italic;\n}\n\n#kgywzvlydc .gt_super {\n  font-size: 65%;\n}\n\n#kgywzvlydc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#kgywzvlydc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kgywzvlydc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kgywzvlydc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kgywzvlydc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kgywzvlydc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kgywzvlydc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#kgywzvlydc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#kgywzvlydc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Parameter\">Parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Estimate\">Estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a(ci)\">95% CI</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">(Intercept)</td>\n<td headers=\"Estimate\" class=\"gt_row gt_center\">1.70***</td>\n<td headers=\"(ci)\" class=\"gt_row gt_center\">(1.70, 1.70)</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">weight c</td>\n<td headers=\"Estimate\" class=\"gt_row gt_center\">2.23e-03***</td>\n<td headers=\"(ci)\" class=\"gt_row gt_center\">(2.15e-03, 2.31e-03)</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"3\"></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\nPrediction:\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ensure necessary libraries are loaded\nlibrary(ggeffects)\nlibrary(ggplot2)\n\n# generate the plot with adjusted y-scale\nplot(ggeffects::ggpredict(fit_1, terms = \"weight_c\")) \n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/regression_height_nz_prediction-1.png){width=672}\n:::\n:::\n\n\nBriefly report your results. (note: please replace \"significant\" with \"statistically significant.)\n\n::: {.cell}\n\n```{.r .cell-code}\nreport::report(fit_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWe fitted a linear model (estimated using OLS) to predict height with weight_c\n(formula: height ~ weight_c). The model explains a statistically significant\nand moderate proportion of variance (R2 = 0.17, F(1, 14286) = 2858.73, p <\n.001, adj. R2 = 0.17). The model's intercept, corresponding to weight_c = 0, is\nat 1.70 (95% CI [1.70, 1.70], t(14286) = 2213.51, p < .001). Within this model:\n\n  - The effect of weight c is statistically significant and positive (beta =\n2.23e-03, 95% CI [2.15e-03, 2.31e-03], t(14286) = 53.47, p < .001; Std. beta =\n0.41, 95% CI [0.39, 0.42])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n```\n\n\n:::\n:::\n\n## Solution Q3. Regress height ~ male and report results\n\n\n**Using the `df_nz` dataset, write a regression model for height as predicted by `male`  Create a table for your results.  Create a graph/graphs to clarify the results of your regression model. Briefly report your results.**\n\n\nModel and table:\n\n::: {.cell}\n\n```{.r .cell-code}\n# regression of height ~ weight\nfit_2 <- lm(hlth_height ~ male, data = df_nz)\nsjPlot::tab_model(fit_2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">hlth height</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.65</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.65&nbsp;&ndash;&nbsp;1.65</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">male</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.13&nbsp;&ndash;&nbsp;0.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">47205</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.388 / 0.388</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\nGraph:\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot over the range of the data\nplot_fit_2 <- plot(\n  ggeffects::ggpredict(fit_2, terms = \"male[all]\",\n  jitter = .1,\n  add.data = TRUE,\n  dot.alpha = .2\n) )\n\n# plot\nplot_fit_2 + \n  scale_y_continuous(limits = c(1.2, 2.1))\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-51-1.png){width=672}\n:::\n:::\n\n\nReport\n\n::: {.cell}\n\n```{.r .cell-code}\n# report\nreport::report(fit_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWe fitted a linear model (estimated using OLS) to predict hlth_height with male\n(formula: hlth_height ~ male). The model explains a statistically significant\nand substantial proportion of variance (R2 = 0.39, F(1, 47203) = 29979.00, p <\n.001, adj. R2 = 0.39). The model's intercept, corresponding to male = 0, is at\n1.65 (95% CI [1.65, 1.65], t(47203) = 3603.30, p < .001). Within this model:\n\n  - The effect of male is statistically significant and positive (beta = 0.13,\n95% CI [0.13, 0.13], t(47203) = 173.14, p < .001; Std. beta = 0.62, 95% CI\n[0.62, 0.63])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n```\n\n\n:::\n:::\n\n\n## Solution Q4. Regression to predict\n\n**Using the regression coefficients from the Pearson and Lee 1903 dataset, predict the heights of daughters of women in the `nz` dataset.** \n::: {.cell}\n\n```{.r .cell-code}\n# model for daughter height from mother height\nfit_3 <- lm(daughter_height ~ mother_height, data = df_pearson_lee)\n\n# create data frame of not_male's in 2019\n# notice problem. not_male != woman\n# additionally, woman != mother!\n\ndf_nz_2 <- df_nz|>\n  filter(male == 1)|> # not_males\n  dplyr::select(hlth_height)|> # variable of interest\n  dplyr::mutate(mother_height = hlth_height * 39.36)|> # Convert meters to inches\n  dplyr::select(mother_height)|>\n  dplyr::arrange((mother_height))\n\n# find min and max heights, store as objects\nmin_mother_height <- min(df_nz_2$mother_height, na.rm = TRUE)\nmax_mother_height <- max(df_nz_2$mother_height, na.rm = TRUE)\n\n# expand grid, use stored objects to define boundaries.\ndf_expand_grid_nz_2 <-\n  expand.grid(mother_height = seq(\n    from = min_mother_height,\n    to = max_mother_height,\n    length.out = 200\n  ))\n\n# use the `predict` function to create a new response using the pearson and fox regression model\n\npredict_fit_3 <-\n  predict(fit_3,\n          type = \"response\",\n          interval = \"confidence\",\n          newdata = df_expand_grid_nz_2)\n\n# create a new dataframe for the response variables, following the method in lecture 5\n\n# combine variables into a data frame\ndf_expand_grid_nz_2_predict_fit_3 <-\n  data.frame(df_expand_grid_nz_2, predict_fit_3)\n\n# graph the expected average hypothetical heights of \"daughters\"\npredplot2 <-\n  ggplot(data = df_expand_grid_nz_2_predict_fit_3,\n         aes(x = mother_height,\n             y = fit))  +\n  geom_line(colour = \"cadetblue\")  +  geom_errorbar(aes(ymin = lwr, ymax = upr), width = .1) + scale_x_continuous(limits = c(50, 75)) + scale_y_continuous(limits = c(50, 75)) + theme_classic()  +\n  xlab(\"NZ 2019 female population\") +\n  ylab(\"predicted daughter heights in inches\") +\n  labs(title = \"Regression prediction for hypothetical daughter heights of NZ population in 2019 \")\n\n# plot\npredplot2\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-53-1.png){width=672}\n:::\n:::\n\n## Solution Q6. Bonus\n\n**On average, how much taller or shorter are women in New Zealand as sampled in 2019 `nz` dataset compared with women in 1903 as sampled in the Pearson and Lee dataset.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create var for 1903 dataset\n# For the historical dataset (assuming year 1903 for df_pearson_lee_2)\ndf_pearson_lee_2 <- df_pearson_lee |>\n  dplyr::select(mother_height, daughter_height) |>\n  tidyr::pivot_longer(everything(), names_to = \"relation\", values_to = \"f_height\") |>\n  dplyr::mutate(year_is = factor(\"1903\"))\n\n# create var the 2019 dataset\ndf_nz_combine_pearson_lee <- df_nz_2 |>\n  dplyr::rename(f_height = mother_height) |>\n  dplyr::mutate(year_is = factor(\"2019\"),\n                relation = factor(\"mother\"))\n\n# both dataframes have the `year_is` column but with different factor levels\n# check\nhead(df_nz_combine_pearson_lee)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  f_height year_is relation\n1 49.59360    2019   mother\n2 51.21146    2019   mother\n3 51.45691    2019   mother\n4 51.95953    2019   mother\n5 52.92635    2019   mother\n6 53.22973    2019   mother\n```\n\n\n:::\n\n```{.r .cell-code}\n# combine data frames row-wise\ndf_nz_combine_pearson_lee_1 <- rbind(df_pearson_lee_2, df_nz_combine_pearson_lee)\n\n\n# look at data structure\n#dplyr::glimpse(df_nz_combine_pearson_lee_1)\n```\n:::\n\nLook at heights in sample \n\n::: {.cell}\n\n```{.r .cell-code}\n# get min and max heights for graph range\ntable(df_nz_combine_pearson_lee_1$year_is)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n 1903  2019 \n11048 22278 \n```\n\n\n:::\n\n```{.r .cell-code}\n# box plot\nggplot2::ggplot(data =\n                  df_nz_combine_pearson_lee_1,\n                aes(x = year_is, y = f_height, fill = year_is)) +\n  geom_boxplot(notch = TRUE) +\n  labs(title = \"Comparison of female height 1903/2019\") +\n  theme_classic() + scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-55-1.png){width=672}\n:::\n:::\n\n\nPredict heights out of sample\n\n::: {.cell}\n\n```{.r .cell-code}\n# regression model\nfit_4 <- lm(f_height ~ year_is, data = df_nz_combine_pearson_lee_1)\n\n# table\nsjPlot::tab_model(fit_4)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">f height</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">63.18</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">63.12&nbsp;&ndash;&nbsp;63.23</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">year is [2019]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.97</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.90&nbsp;&ndash;&nbsp;7.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">28422</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.569 / 0.569</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\nWomen in 2019 are taller\n\n::: {.cell}\n\n```{.r .cell-code}\nreport::report(fit_4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWe fitted a linear model (estimated using OLS) to predict f_height with year_is\n(formula: f_height ~ year_is). The model explains a statistically significant\nand substantial proportion of variance (R2 = 0.57, F(1, 28420) = 37516.23, p <\n.001, adj. R2 = 0.57). The model's intercept, corresponding to year_is = 1903,\nis at 63.18 (95% CI [63.12, 63.23], t(28420) = 2244.43, p < .001). Within this\nmodel:\n\n  - The effect of year is [2019] is statistically significant and positive (beta\n= 6.97, 95% CI [6.90, 7.04], t(28420) = 193.69, p < .001; Std. beta = 1.55, 95%\nCI [1.53, 1.56])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald t-distribution approximation.\n```\n\n\n:::\n:::\n\n\nGraph:\n\n::: {.cell}\n\n```{.r .cell-code}\n# get meaningful values for the y access range\n\n# min\nmin_mother_height_for_range <- min(df_nz_combine_pearson_lee_1$f_height, na.rm = TRUE)\n\n# max\nmax_mother_height_for_range <- max(df_nz_combine_pearson_lee_1$f_height, na.rm = TRUE)\n\n# make graph \nplot(\n  ggeffects::ggpredict(fit_4, terms = \"year_is\",\n  add.data = TRUE,\n  dot.alpha = .2\n) )+ labs(title = \"Predicted difference in female heights 1903/2019\") + \n  xlab(\"Study year\") + \n  ylab (\"Predicted femal height (inches)\") +   scale_y_continuous(\n    limits = c(min_mother_height_for_range,max_mother_height_for_range))\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-58-1.png){width=672}\n:::\n:::\n\nGraph with predicted points:\n\n::: {.cell}\n\n```{.r .cell-code}\nggeffects::ggpredict(fit_4, terms = \"year_is\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Predicted values of f_height\n\nyear_is | Predicted |       95% CI\n----------------------------------\n1903    |     63.18 | 63.12, 63.23\n2019    |     70.15 | 70.11, 70.19\n```\n\n\n:::\n\n```{.r .cell-code}\n# graph with predicted values based on the model\nplot(\n  ggeffects::ggpredict(fit_4, terms = \"year_is\",\n  add.data = TRUE,\n  dot.alpha = .01,\n   colors = \"us\", # see colour pallet options \n  jitter =.5)) + labs(title = \"Predicted difference in female heights 1903/2019\") +\n  xlab(\"Study year\") +\n  ylab (\"Predicted femal height (inches)\") +\n  scale_y_continuous(limits = c(min_mother_height_for_range, max_mother_height_for_range))\n```\n\n::: {.cell-output-display}\n![](03-content_files/figure-html/unnamed-chunk-59-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# show all color palettes\n#show_pals()\n```\n:::\n\n\n\n## Appendix 1 Conceptual Background\n\nSome preliminaries about science.\n\n### Science begins with a question\n\nScience begins with a question about the world. The first step in science, then, is to clarify what you want to know.\n\nBecause science is a social practice, you will also need to clarify why your question is interesting: so what?\n\nIn short, know your question.\n\n### Scientific model (or theory)\n\nSometimes, scientists are interested in specific features of the world: how did virus x originate? Such a question might have a forensic interest: what constellation of events gave rise to a novel infectious disease?\n\nScientists typically seek generalisations. How do infectious diseases evolve? How do biological organisms evolve? Such questions have applied interests. How can we better prevent infectious diseases? How did life originate?\n\nA scientific model proposes how nature is structured (and unstructured). For example, the theory of evolution by natural selection proposes that life emerges from variation, inheritance, and differential reproduction/survival.\n\nTo evaluate a scientific model, scientists must make generalisations beyond individual cases. This is where statistics shines.\n\n### What is statistics?\n\nMathematics is a logic of certainty.\n\nStatistics is a logic of uncertainty.\n\nA statistical model uses the logic of probability to make better guesses.\n\n### Applications of statistical models in science\n\nScientific models seek to explain how nature is structured. Where scientific models conflict, we can combine statistical models with data collection to evaluate the credibility of of one theoretical model over others. To do this, a scientific model must make distinct, non-trivial predictions about the world.\n\nIf the predictions are not distinct, the observations will not enable a shift in credibility for one theory over another. Consider the theory that predicts any observation. Such a theory would be better classified as a conspiracy theory; it is compatible with any evidence.\n\n<!-- Sometimes the processes of empirical testing is called \"hypothesis testing.\" In the weeks ahead, we will distinguish the intellectually excellent concept of \"hypothesis testing\" from \"Null Hypothesis Significance Testing (NHST).\" Although there is is nothing inherently flawed with NHST, it's misunderstandings have been an abomination. -->\n\n\n\n### Packages\n\n::: {.cell}\n\n```{.r .cell-code}\nreport::cite_packages()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  - Anderson D, Heiss A, Sumners J (2024). _equatiomatic: Transform Models into 'LaTeX' Equations_. R package version 0.3.3, <https://CRAN.R-project.org/package=equatiomatic>.\n  - Bulbulia J (2024). _margot: MARGinal Observational Treatment-effects_. doi:10.5281/zenodo.10907724 <https://doi.org/10.5281/zenodo.10907724>, R package version 0.3.1.6 Functions to obtain MARGinal Observational Treatment-effects from observational data., <https://go-bayes.github.io/margot/>.\n  - Chang W (2023). _extrafont: Tools for Using Fonts_. R package version 0.19, <https://CRAN.R-project.org/package=extrafont>.\n  - Grolemund G, Wickham H (2011). \"Dates and Times Made Easy with lubridate.\" _Journal of Statistical Software_, *40*(3), 1-25. <https://www.jstatsoft.org/v40/i03/>.\n  - Lüdecke D (2018). \"ggeffects: Tidy Data Frames of Marginal Effects from Regression Models.\" _Journal of Open Source Software_, *3*(26), 772. doi:10.21105/joss.00772 <https://doi.org/10.21105/joss.00772>.\n  - Lüdecke D (2024). _sjPlot: Data Visualization for Statistics in Social Science_. R package version 2.8.17, <https://CRAN.R-project.org/package=sjPlot>.\n  - Lüdecke D, Ben-Shachar M, Patil I, Makowski D (2020). \"Extracting, Computing and Exploring the Parameters of Statistical Models using R.\" _Journal of Open Source Software_, *5*(53), 2445. doi:10.21105/joss.02445 <https://doi.org/10.21105/joss.02445>.\n  - Lüdecke D, Ben-Shachar M, Patil I, Waggoner P, Makowski D (2021). \"performance: An R Package for Assessment, Comparison and Testing of Statistical Models.\" _Journal of Open Source Software_, *6*(60), 3139. doi:10.21105/joss.03139 <https://doi.org/10.21105/joss.03139>.\n  - Makowski D, Lüdecke D, Patil I, Thériault R, Ben-Shachar M, Wiernik B (2023). \"Automated Results Reporting as a Practical Tool to Improve Reproducibility and Methodological Best Practices Adoption.\" _CRAN_. <https://easystats.github.io/report/>.\n  - Müller K, Wickham H (2023). _tibble: Simple Data Frames_. R package version 3.2.1, <https://CRAN.R-project.org/package=tibble>.\n  - Pedersen T (2024). _patchwork: The Composer of Plots_. R package version 1.3.0, <https://CRAN.R-project.org/package=patchwork>.\n  - R Core Team (2024). _R: A Language and Environment for Statistical Computing_. R Foundation for Statistical Computing, Vienna, Austria. <https://www.R-project.org/>.\n  - Rich B (2023). _table1: Tables of Descriptive Statistics in HTML_. R package version 1.4.3, <https://CRAN.R-project.org/package=table1>.\n  - Sjoberg D, Whiting K, Curry M, Lavery J, Larmarange J (2021). \"Reproducible Summary Tables with the gtsummary Package.\" _The R Journal_, *13*, 570-580. doi:10.32614/RJ-2021-053 <https://doi.org/10.32614/RJ-2021-053>, <https://doi.org/10.32614/RJ-2021-053>.\n  - Waring E, Quinn M, McNamara A, Arino de la Rubia E, Zhu H, Ellis S (2022). _skimr: Compact and Flexible Summaries of Data_. R package version 2.1.5, <https://CRAN.R-project.org/package=skimr>.\n  - Wickham H (2016). _ggplot2: Elegant Graphics for Data Analysis_. Springer-Verlag New York. ISBN 978-3-319-24277-4, <https://ggplot2.tidyverse.org>.\n  - Wickham H (2023). _forcats: Tools for Working with Categorical Variables (Factors)_. R package version 1.0.0, <https://CRAN.R-project.org/package=forcats>.\n  - Wickham H (2023). _stringr: Simple, Consistent Wrappers for Common String Operations_. R package version 1.5.1, <https://CRAN.R-project.org/package=stringr>.\n  - Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). \"Welcome to the tidyverse.\" _Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 <https://doi.org/10.21105/joss.01686>.\n  - Wickham H, Bryan J, Barrett M, Teucher A (2024). _usethis: Automate Package and Project Setup_. R package version 3.1.0, <https://CRAN.R-project.org/package=usethis>.\n  - Wickham H, François R, Henry L, Müller K, Vaughan D (2023). _dplyr: A Grammar of Data Manipulation_. R package version 1.1.4, <https://CRAN.R-project.org/package=dplyr>.\n  - Wickham H, Henry L (2025). _purrr: Functional Programming Tools_. R package version 1.0.4, <https://CRAN.R-project.org/package=purrr>.\n  - Wickham H, Hester J, Bryan J (2024). _readr: Read Rectangular Text Data_. R package version 2.1.5, <https://CRAN.R-project.org/package=readr>.\n  - Wickham H, Hester J, Chang W, Bryan J (2022). _devtools: Tools to Make Developing R Packages Easier_. R package version 2.4.5, <https://CRAN.R-project.org/package=devtools>.\n  - Wickham H, Vaughan D, Girlich M (2024). _tidyr: Tidy Messy Data_. R package version 1.3.1, <https://CRAN.R-project.org/package=tidyr>.\n  - Xie Y (2025). _tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents_. R package version 0.56, <https://github.com/rstudio/tinytex>. Xie Y (2019). \"TinyTeX: A lightweight, cross-platform, and easy-to-maintain LaTeX distribution based on TeX Live.\" _TUGboat_, *40*(1), 30-32. <https://tug.org/TUGboat/Contents/contents40-1.html>.\n  - Zhu H (2024). _kableExtra: Construct Complex Table with 'kable' and Pipe Syntax_. R package version 1.4.0, <https://CRAN.R-project.org/package=kableExtra>.\n```\n\n\n:::\n:::\n\n\n\n",
    "supporting": [
      "03-content_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/table1-1.0/table1_defaults.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}